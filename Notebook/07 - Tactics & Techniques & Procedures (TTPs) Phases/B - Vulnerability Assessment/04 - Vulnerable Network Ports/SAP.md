# SAP

## Pivot Scan Web Directories

```
msf > use auxiliary/scanner/sap/sap_service_discovery

msf auxiliary(scanner/sap/sap_service_discovery) > set proxies:<SAP_server_IP>:<SAP_Router_PROXY_PORT>

msf auxiliary(scanner/sap/sap_service_discovery) > run rhosts=<IP>
```

## Brute Force Web Directories

```
$ gobuster dir -u <URL> -w /usr/share/seclists/Discovery/Web-Content/URLs/urls-SAP.txt

$ gobuster dir -u <URL> -w /usr/share/seclists/Discovery/Web-Content/sap.txt
```

## Brute Force RFC Clients

```
msf > use auxiliary/scanner/sap/sap_soap_rfc_brute_login

msf auxiliary(scanner/sap/sap_soap_rfc_brute_login) > set proxies:<SAP_server_IP>:<SAP_Router_PROXY_PORT>

msf auxiliary(scanner/sap/sap_soap_rfc_brute_login) > set client 000,001,002,003,004,005,006,007,066

msf auxiliary(scanner/sap/sap_soap_rfc_brute_login) > run rhosts=<IP>
```

## Brute Force Credentials

```
msf > use auxiliary/scanner/sap/sap_mgmt_con_brute_login
```

```
msf > use auxiliary/scanner/sap/sap_web_gui_brute_login
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Cross Platform/SAP]]

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x00 - Exploitation/0xF - Remote Services Exploitation/Network Ports/SAP]]