# Scanners

Search Tag(s): #reconnaissance #vulnerability-assessment #webapp-pentesting #sql-injection #sqlmap #nuclei #nikto #nmap #metasploit-framework

## 01 - SQL Syntax Error Detection

```
$ nuclei -u <URL> -t ~/nuclei-templates -id php-errors
```

## 02 - URL Endpoints

Crawl URLs with parameters.

```
$ katana -list urls.txt -f qurl [-fx] -d 5 -em php,asp,aspx,jsp | httpx -mc 200 -o crawled_urls.txt

$ katana -list urls.txt -f qurl [-fx] -d 5 -ef jpg,jpeg,gif,css,tif,tiff,png,ttf,woff,woff2,ico,pdf,svg,txt,js,md | httpx -mc 200 -o crawled_urls.txt
```

Quickly scan the GET request parameters with `nuclei`.

```
$ nuclei -l crawled_urls.txt -t ~/nuclei-templates -pt http -dast -tags sqli -o sqli-output.txt
```

Perform SQL Injection on the live targets via GET request parameters.

```
$ sqlmap -m crawled_urls.txt --drop-set-cookie --dbms=mysql --smart --technique=B --batch

$ sqlmap -m crawled_urls.txt --drop-set-cookie --dbms=postgresql --smart --technique=B --batch
```

Using `nmap` to scan multiple targets.

```
$ nmap -p80,443 -Pn -n --script http-sql-injection [--script-args="http-sql-injection.url=<spider/start/path/to/URL>"],http.useragent='<user_agent>' -iL ip_targets.txt
```

## 03 - Login and registration forms

Crawl URLs with panels or forms.

```
$ katana -silent -u urls.txt -field url -cs login_urls_wordlist.txt | httpx -silent -mc 200 -o crawled_urls.txt
```

Perform SQL Injection on the live targets via forms.

```
$ sqlmap -m crawled_urls.txt --drop-set-cookie --forms --dbms=mysql --smart --technique=B --batch

$ sqlmap -m crawled_urls.txt --drop-set-cookie --forms --dbms=postgresql --smart --technique=B --batch
```

## 04 - Vulnerable Web Component

### 4.1 - Nuclei

```
$ httpx -silent -l url_targets.txt | nuclei -t ~/nuclei-templates -tags sqli -o sqli-output.txt
```

### 4.2 - Nikto

```
$ nikto -host <IP> -Tuning 9a -no404 -Plugins "content_search;tests"
```

TODO: Fill this info
## Wapiti

```
$ wapiti -u <URL> -m sql,timesql
```

## Metasploit

```
msf > use auxiliary/scanner/http/error_sql_injection
```

```
msf > use auxiliary/scanner/http/blind_sql_query
```

---
## References

- [[User Agents]]

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/B - Vulnerability Assessment/01 - Scanners/Web Vulnerability Scanner/Nikto/Usage/02 - Basic|Nikto]]

- https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt

- https://github.com/the-robot/admin-finder/blob/master/wordlist.txt

- [Hacking Articles: Exploiting Sql Injection with Nmap and Sqlmap](https://www.hackingarticles.in/exploiting-sql-injection-nmap-sqlmap/)