# Scanners

## 01 - Meta Tag

```
$ nmap -p 80,443,8000,8080,8443 -Pn -n --script http-generator [--script-args http-generator.path=<path>,http-generator.redirects=<number>,...] <IP>
```

## 02 - Default Credentials

### 2.1 - Nuclei

```
$ nuclei -u <URL> -t ~/nuclei-templates -id tomcat-default-login,tomcat-examples-login
```

### 2.2 - Nmap

Using [[03 - Default Credentials|default-http-login-hunter]] to find default credentials that only requires `nmap` installation (recommended).

```
$ default-http-login-hunter [-vvv] <URL>
```

Another NSE script to find default accounts.

```
$ nmap -p 80,443,8000,8080,8443 -Pn -n --script http-default-accounts --script-args http.useragent='<user_agent>' <IP>
```

### 2.3 - Hydra

```
$ hydra -C Seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt http-get://<IP>:<PORT>/manager/html
```

### 2.4 - Metasploit

```
msf > use auxiliary/scanner/http/tomcat_mgr_login

msf auxiliary(scanner/http/tomcat_mgr_login) > options 

Module options (auxiliary/scanner/http/tomcat_mgr_login):                                                                                                                                           

   Name              Current Setting                                                                 Required  Description                                                                                                           
   ----              ---------------                                                                 --------  -----------                                                                           
   ANONYMOUS_LOGIN   false                                                                           yes       Attempt to login with a blank username and password                                   
   BLANK_PASSWORDS   false                                                                           no        Try blank passwords for all users                                                     
   BRUTEFORCE_SPEED  5                                                                               yes       How fast to bruteforce, from 0 to 5                                                   
   DB_ALL_CREDS      false                                                                           no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false                                                                           no        Add all passwords in the current database to the list
   DB_ALL_USERS      false                                                                           no        Add all users in the current database to the list
   DB_SKIP_EXISTING  none                                                                            no        Skip existing credentials stored in the current database (Accepted: none, user, user&realm)
   PASSWORD                                                                                          no        The HTTP password to specify for authentication
   PASS_FILE         /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt      no        File containing passwords, one per line
   Proxies                                                                                           no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                                                                                            yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT             8080                                                                            yes       The target port (TCP)
   SSL               false                                                                           no        Negotiate SSL/TLS for outgoing connections
   STOP_ON_SUCCESS   false                                                                           yes       Stop guessing when a credential works for a host
   TARGETURI         /manager/html                                                                   yes       URI for Manager login. Default is /manager/html
   THREADS           1                                                                               yes       The number of concurrent threads (max one per host)
   USERNAME                                                                                          no        The HTTP username to specify for authentication
   USERPASS_FILE     /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_userpass.txt  no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false                                                                           no        Try the username as the password for all users
   USER_FILE         /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt     no        File containing users, one per line
   VERBOSE           true                                                                            yes       Whether to print output for all attempts
   VHOST                                                                                             no        HTTP server virtual host


View the full module info with the info, or info -d command.

msf auxiliary(scanner/http/tomcat_mgr_login) > STOP_ON_SUCCESS true

msf auxiliary(scanner/http/tomcat_mgr_login) > set anonymous_login <true | false>

msf auxiliary(scanner/http/tomcat_mgr_login) > set blank_passwords <true | false>

msf auxiliary(scanner/http/tomcat_mgr_login) > set --clear user_file

msf auxiliary(scanner/http/tomcat_mgr_login) > set --clear pass_file

msf auxiliary(scanner/http/tomcat_mgr_login) > set userpass_file SecLists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt

msf auxiliary(scanner/http/tomcat_mgr_login) > set rhosts <IP>

msf auxiliary(scanner/http/tomcat_mgr_login) > set rport <PORT>

msf auxiliary(scanner/http/tomcat_mgr_login) > run
```

```
msf > use auxiliary/admin/http/tomcat_administration
```

```
msf > use auxiliary/scanner/http/tomcat_enum
```

```
$ nmap -p80,443,8080,8443 --script ajp-request <IP>
```

```
$ nuclei -u <URL> -t ~/nuclei-templates -tags tomcat
```

```
$ nikto -host <URL> [-p <PORT>] -Plugins content_search -F txt -o web-vulnerability-assessment-output.txt
```

---
## References

- [Rapid7: Metasploit Framework - Tomcat MGR Login Auxiliary Module](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/auxiliary/scanner/http/tomcat_mgr_login.md)

https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/exploit/multi/http/tomcat_jsp_upload_bypass.md