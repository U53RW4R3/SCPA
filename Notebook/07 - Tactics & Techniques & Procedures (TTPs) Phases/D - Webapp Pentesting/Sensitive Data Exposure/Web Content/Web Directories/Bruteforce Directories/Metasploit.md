# Metasploit

- Metasploit auxiliary module HTTP Directory Scanner

```
msf > use auxiliary/scanner/http/dir_scanner

msf auxiliary(scanner/http/dir_scanner) > options

Module options (auxiliary/scanner/http/dir_scanner):

   Name        Current Setting                          Required  Description
   ----        ---------------                          --------  -----------
   DICTIONARY  /opt/metasploit/data/wmap/wmap_dirs.txt  no        Path of word dictionary to use
   PATH        /                                        yes       The path  to identify files
   Proxies                                              no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                                               yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT       80                                       yes       The target port (TCP)
   SSL         false                                    no        Negotiate SSL/TLS for outgoing connections
   THREADS     1                                        yes       The number of concurrent threads (max one per host)
   VHOST                                                no        HTTP server virtual host


View the full module info with the info, or info -d command.

msf auxiliary(scanner/http/dir_scanner) > set path <uri_path>

msf auxiliary(scanner/http/dir_scanner) > set dictionary </path/to/directories-wordlist.txt>

msf auxiliary(scanner/http/dir_scanner) > set threads 8

msf auxiliary(scanner/http/dir_scanner) > set rhosts <IP>

msf auxiliary(scanner/http/dir_scanner) > set rport <PORT>

msf auxiliary(scanner/http/dir_scanner) > run
```

- Metasploit auxiliary module HTTP Directory Listing Scanner

```
msf > use auxiliary/scanner/http/dir_listing

msf auxiliary(scanner/http/dir_listing) > options

Module options (auxiliary/scanner/http/dir_listing):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   PATH     /                yes       The path to identify directory listing
   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                    yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT    80               yes       The target port (TCP)
   SSL      false            no        Negotiate SSL/TLS for outgoing connections
   THREADS  1                yes       The number of concurrent threads (max one per host)
   VHOST                     no        HTTP server virtual host

msf auxiliary(scanner/http/dir_listing) > set path </uri_path>

msf auxiliary(scanner/http/dir_listing) > set threads 8

msf auxiliary(scanner/http/dir_listing) > set rhosts <IP>

msf auxiliary(scanner/http/dir_listing) > set rport <PORT>

msf auxiliary(scanner/http/dir_listing) > run
```

- Metasploit auxiliary module HTTP Interesting File Scanner

```
msf > use auxiliary/scanner/http/files_dir

msf auxiliary(scanner/http/files_dir) > options

Module options (auxiliary/scanner/http/files_dir):

   Name        Current Setting                           Required  Description
   ----        ---------------                           --------  -----------
   DICTIONARY  /opt/metasploit/data/wmap/wmap_files.txt  no        Path of word dictionary to use
   EXT                                                   no        Append file extension to use
   PATH        /                                         yes       The path  to identify files
   Proxies                                               no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                                                yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT       80                                        yes       The target port (TCP)
   SSL         false                                     no        Negotiate SSL/TLS for outgoing connections
   THREADS     1                                         yes       The number of concurrent threads (max one per host)
   VHOST                                                 no        HTTP server virtual host


View the full module info with the info, or info -d command.

msf auxiliary(scanner/http/files_dir) > set path </uri_path>

msf auxiliary(scanner/http/files_dir) > set ext <.php | .html | .htm | .tar.gz | .zip | .db | .txt | .js>

msf auxiliary(scanner/http/files_dir) > set dictionary </path/to/directories-wordlist.txt>

msf auxiliary(scanner/http/files_dir) > set threads 8

msf auxiliary(scanner/http/files_dir) > set rhosts <IP>

msf auxiliary(scanner/http/files_dir) > set rport <PORT>

msf auxiliary(scanner/http/files_dir) > run
```

Scrape

```
msf > use auxiliary/scanner/http/scraper

msf auxiliary(scanner/http/scraper) > options

Module options (auxiliary/scanner/http/scraper):

   Name     Current Setting      Required  Description
   ----     ---------------      --------  -----------
   PATH     /                    yes       The test path to the page to analize
   PATTERN  <title>(.*)</title>  yes       The regex to use (default regex is a sample to grab page title)
   Proxies                       no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                        yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT    80                   yes       The target port (TCP)
   SSL      false                no        Negotiate SSL/TLS for outgoing connections
   THREADS  1                    yes       The number of concurrent threads (max one per host)
   VHOST                         no        HTTP server virtual host


View the full module info with the info, or info -d command.

msf auxiliary(scanner/http/scraper) > set path <uri_path>

msf auxiliary(scanner/http/scraper) > set pattern <regex>

msf auxiliary(scanner/http/scraper) > set threads 2

msf auxiliary(scanner/http/scraper) > set rhosts <target_IP_1>,<target_IP_2>,<target_IP_n>

msf auxiliary(scanner/http/scraper) > set rport <PORT>

msf auxiliary(scanner/http/scraper) > run
```

---
## References

- [Rapid7: Metasploit Framework - HTTP Webpage Scraper Auxiliary Module Scanner](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/auxiliary/scanner/http/scraper.md)