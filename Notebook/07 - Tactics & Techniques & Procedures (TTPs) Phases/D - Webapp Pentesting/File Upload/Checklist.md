# Checklist

Search Tag(s): #checklist #webapp-pentesting #file-upload

Refer to [[File Upload Evasion|helper]] section for file upload exploit.

## Information Gathering

### Passive Reconnaissance

#### Passive Enumeration

- [ ] Use [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x01 - Passive Fingerprinting/0xD - Network Ports/HTTP/Webapp Information/Whatweb|whatweb]] to fingerprint the server. This includes:
	- [ ] Web Server Software
	- Content Management System (CMS)
		- [ ] Plugins
		- [ ] Themes
	- [ ] Portals
	- [ ] Panels
	- [ ] Forums
	- [ ] Web Framework
	- General information
		- [ ] Author
		- [ ] Emails
		- [ ] IP Addresses
		- [ ] Country
		- [ ] Geolocation
		- [ ] Generator Tags
	- Security Defenses
		- [ ] Web App Firewall (WAF) or IDS (Intrusion Detection System)
		- [ ] Honeypots

##### Discover Hidden URLs

TODO: Find google dorks for common file upload webapps

- [ ] Find common file upload forms via google dorks.
- [ ] Spider the web servers to find hidden URLs.
	- [[Katana|katana]]
	- [[Gospider|gospider]]
	- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x01 - Passive Fingerprinting/0xD - Network Ports/HTTP/Wayback Machine/Metasploit|metasploit]]
- [ ] Browse the website with OWASP ZAP or Burp Suite to see any hidden URLs.

### Active Reconnaissance

#### Active Enumeration

##### Discover Ports

- [ ] Probing ports to check what service version of the web servers using [[03 - Scan Techniques|nmap]].

##### Fuzz Hidden Parameters

- [ ] You can use scanners to discover hidden parameters that can be used for further enumeration.
	- [[Arjun]]
	- [[x8]]
- [ ] Bruteforce hidden parameters.
	- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/D - Webapp Pentesting/0x05 - Sensitive Data Exposure/Web Content Discovery/Fuzzers/Bruteforce Parameters/FFuF|FFuF]]
	- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/D - Webapp Pentesting/0x05 - Sensitive Data Exposure/Web Content Discovery/Fuzzers/Bruteforce Parameters/Wfuzz|Wfuzz]]

## Vulnerability Assessment

### Scanners

#### General

- [ ] Run an [[07 - Tactics & Techniques & Procedures (TTPs) Phases/D - Webapp Pentesting/File Upload/Helpers/Scanners#^32fc7f|NSE script]] to probe for file upload vulnerabilities on the web servers with `-iL ip_targets.txt` flag.
- [ ] Run [[07 - Tactics & Techniques & Procedures (TTPs) Phases/D - Webapp Pentesting/File Upload/Helpers/Scanners#^63a131|nikto]] scanner to discover for existing file upload exploits.

#### Content Management System

- [ ] Run [[02 - Basic Scan|WPScan]] to check for vulnerable wordpress plugins or themes related to file upload.
- [ ] Run [[Joomscan]] to check for vulnerable joomla plugins or themes related to file upload.

## Exploit

### Initial Foothold

#### Insufficient Blacklisting

- [ ] Upload different types of **PHP** file extension.
- [ ] Upload different types of **ASP.NET** file extension.
- [ ] Upload different types of **Java** file extension.
- [ ] Upload different types of **HTML5** file extension.
- [ ] Upload **Server Side Include (SSI)** if it was configured in apache.

#### Evasion

##### Cross Platform

- [ ] Switch the letter(s) case.
- [ ] Double extension.
- [ ] Inserting suffixes either slashes or hashtag sign.
- [ ] Strip file extension strings.
- [ ] Insert whitespace, NULL byte, newline in the extension.
- [ ] Upload the webshell without any extension.
- [ ] Maximize the filename's length.
- [ ] Modify the `Content-Type` HTTP header as it was a normal file.
- [ ] Include PHP payload in the basename of the file (the filename). For example: `<?php system($_GET['cmd']); ?>.png`.
- [ ] Use PHP filewrapper to bypass filter.
- Include metadata with `exiftool` with any of these tags:
	- [ ] `Comment`
	- [ ] `Copyright`
	- [ ] `DocumentName`
- [ ] Upload configuration file to overwrite server configuration. Here are the following:
	- `.htaccess`
	- Busybox
	- Windows IIS
	- Python
- [ ] Add Magic Bytes in the file extension.
##### Windows

- [ ] File extension handling and Windows dots.
- [ ] Use Windows **Alternate Data Stream (ADS)**

#### Local File Inclusion (LFI)

- [ ] Find a file upload form to navigate and execute it with directory traversal