# TLS Decryption

Refer to this [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x08 - Maintaining Access/Gathering Information/OSX/Analyze Packets/Capture Packets|section]] to capture packets after settings `SSLKEYLOGFILE` environment variable.

```
$ export SSLKEYLOGFILE="/path/to/sslkeyfile"
```

Open **Wireshark** then go to **Preferences** (shortcut is `Ctrl + Shift + A)`.

![[01 - Wireshark Protocols.png]]

Then scroll all the way down and select **TLS**. In **(Pre)-Master-Secret log filename** choose the `SSLKEYLOGFILE` that was captured then apply settings.

![[02 - Wireshark TLS Protocol.png]]


---
## References

- [F5: Decrypt SSL traffic with the SSLKEYLOGFILE environment variable on Firefox or Google Chrome using Wireshark](https://my.f5.com/manage/s/article/K50557518)