# Living off the Land

## 01 - MessageBox

### 1.1 - Command Prompt

```
C:\> msg * this is a message
```

### 1.2 - PowerShell

TODO: Use the C# inline MessageBox WinAPI (refer to links)

```powershell
PS C:\>
```

## 02 - Wallpaper

### 2.1 - Command Prompt

```
C:\> reg add "HKCU\Control Panel\Desktop" /v Wallpaper /t REG_SZ /d "C:\path\to\file.jpg" /f

C:\> reg add "HKCU\Control Panel\Desktop" /v WallpaperStyle /t REG_SZ /d 2 /f

C:\> rundll32.exe user32.dll,UpdatePerUserSystemParameters
```

### 2.2 - PowerShell

```
PS C:\> Set-ItemProperty -Force -Path "HKCU:\Control Panel\Desktop\" -name Wallpaper -value "C:\path\to\file.png"

PS C:\> rundll32.exe user32.dll,UpdatePerUserSystemParameters
```

---
## References

- [LOFLCAB: reg](https://lofl-project.github.io/loflcab/Binaries/reg/)

- [CYBER ARMS: Bringing Metasploit Exploits to Life with Powershell](https://cyberarms.wordpress.com/2015/01/22/bringing-metasploit-exploits-to-life-with-powershell/)