# Living off the Land

## 01 - Locking a Computer

## 01 - Command Prompt

```
C:\> rundll32.exe user32.dll,LockWorkstation
```

## 02 - MessageBox

### 2.1 - Command Prompt

```
C:\> msg.exe * this is a message
```

### 2.2 - PowerShell

TODO: Use the C# inline MessageBox WinAPI (refer to links)

```powershell
PS C:\>
```

## 03 - Wallpaper

### 3.1 - Command Prompt

```
C:\> reg.exe add "HKCU\Control Panel\Desktop" /v Wallpaper /t REG_SZ /d "C:\path\to\file.jpg" /f

C:\> reg.exe add "HKCU\Control Panel\Desktop" /v WallpaperStyle /t REG_SZ /d 2 /f

C:\> rundll32.exe user32.dll,UpdatePerUserSystemParameters
```

### 3.2 - PowerShell

```
PS C:\> Set-ItemProperty -Force -Path "HKCU:\Control Panel\Desktop\" -name Wallpaper -value "C:\path\to\file.png"

PS C:\> rundll32.exe user32.dll,UpdatePerUserSystemParameters
```

## 04 - Kick Out User Session

### 4.1 - Command Prompt

```
C:\> net.exe session \\<IP> /del /y

C:\> for /l %i in (1,0,2) do @net.exe session \\<IP> /del /y & ping.exe -n 127.0.0.1 >nul
```

## 05 - Power Management

### 5.1 - Restart Computer

#### 5.1.1 - Command Prompt

```
C:\> shutdown.exe [/m \\<IP>] /t 0 /r
```

#### 5.1.2 - PowerShell

```
PS C:\> Restart-Computer [-ComputerName <IP>] -Force
```

### 5.2 - Shutdown Computer

#### 5.2.1 - Command Prompt

Turn off the computer in an instant.

```
C:\> shutdown.exe [/m \\<IP>] /t 0 /s
```

#### 5.2.2 - PowerShell

```
PS C:\> Stop-Computer [-ComputerName <IP>] -Force
```

---
## References

### LOLFCAB

- [LOFLCAB: reg](https://lofl-project.github.io/loflcab/Binaries/reg/)

### Jakoby

- [Jakoby: PlaySound](https://github.com/I-Am-Jakoby/PowerShell-for-Hackers/blob/main/Functions/PlaySound.md)

### CYBER ARMS

- [CYBER ARMS: Bringing Metasploit Exploits to Life with Powershell](https://cyberarms.wordpress.com/2015/01/22/bringing-metasploit-exploits-to-life-with-powershell/)