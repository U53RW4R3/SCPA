# Living off the Land

## 01 - Command Prompt

```
C:\> psr.exe /start /output D:\screenshots.zip /sc 1 /gui 0
```

## 02 - Powershell Script

To capture screenshot via VLC.

```powershell
PS C:\> Get-Content .\Invoke-VLCScreenshot.ps1
function Take-VlcScreenshot {
    param(
        [string]$outputPath = "C:\screenshot"
    )
    $vlcPath = "C:\Program Files\VideoLAN\VLC\vlc.exe"
    $command = "-I dummy screen:// :screen-fps=1 :screen-follow-mouse --video-filter=scene --vout=dummy --start-time=1 --run-time=1 --scene-format=png --scene-prefix=screenshot --scene-path=$outputPath vlc://quit"
    Start-Process -FilePath $vlcPath -ArgumentList $command -NoNewWindow
}
```

To capture screenshot using .NET.

```powershell
PS C:\> Get-Content .\Invoke-Screenshot.ps1
Param(  
    [Parameter(Mandatory = $true)][string]$Path  
)  
  
$FileName = "$Env:COMPUTERNAME-$(Get-Date -Format yyyy-MM-dd_HHmmss).bmp"  
$File = "$Path\$FileName"  
  
Add-Type -AssemblyName System.Windows.Forms  
Add-Type -AssemblyName System.Drawing  
$Screen = [System.Windows.Forms.SystemInformation]::VirtualScreen  
$Width = $Screen.Width  
$Height = $Screen.Height  
$Left = $Screen.Left  
$Top = $Screen.Top  
  
$bitmap = New-Object System.Drawing.Bitmap $Width, $Height  
$graphic = [System.Drawing.Graphics]::FromImage($bitmap)  
$graphic.CopyFromScreen($Left, $Top, 0, 0, $bitmap.Size)  
$bitmap.Save($File)   
  
Write-Output "Screenshot saved to:"  
Write-Output $File
```

---
## References

- [LOLBAS: PSR](https://lolbas-project.github.io/lolbas/Binaries/Psr/)

- [CYBER ARMS: Using Problem Steps Recorder (PSR) Remotely with Metasploit](https://cyberarms.wordpress.com/2016/02/13/using-problem-steps-recorder-psr-remotely-with-metasploit/)