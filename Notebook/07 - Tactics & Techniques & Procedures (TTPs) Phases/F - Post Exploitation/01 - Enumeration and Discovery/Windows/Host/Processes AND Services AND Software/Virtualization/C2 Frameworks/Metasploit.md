# Metasploit

Search Tag(s): #post-exploitation #enumeration-and-discovery #defense-evasion #metasploit-framework #windows

## 01 - Post Module

### 1.1 - Enumerate virtualization software

```
meterpreter > run post/windows/gather/checkvm

meterpreter > run post/linux/gather/checkcontainer

meterpreter > run run post/multi/gather/enum_vbox

meterpreter > run post/multi/gather/find_vmx
```

### 1.2 - Enumerate USB activity

```
meterpreter > run post/windows/gather/usb_history
```

## 02 - Meterpreter

### 2.1 - Spawn Interactive Powershell

```powershell
meterpreter > powershell_shell
PS > $VMAdapter = Get-CimInstance Win32_NetworkAdapter -Filter 'Manufacturer LIKE "%VMware%" OR Name LIKE "%VMWare%"'
PS > $VMBios = Get-CimInstance Win32_BIOS -Filter 'SerialNumber LIKE "%VMWare%"'
PS > $VMToolsRunning = Get-CimInstance Win32_Process -Filter 'Name="vmtoolsd.exe"'
PS > [Bool]($VMAdapter -or $VMBios -or $VMToolsRunning)
```

---
## References

- [[04 - Powershell|Metasploit Extension: Powershell]]