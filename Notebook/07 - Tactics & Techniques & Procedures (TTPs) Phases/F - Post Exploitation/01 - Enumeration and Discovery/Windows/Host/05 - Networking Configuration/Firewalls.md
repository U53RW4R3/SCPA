# Firewalls

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #living-off-the-land #windows

## 01 - Command Prompt

Check firewall's state and configuration.

```
C:\> netsh firewall show state

C:\> netsh firewall show config

C:\> netsh advfirewall firewall dump

C:\> netsh advfirewall show currentprofile

C:\> netsh advfirewall firewall show rule name= all

C:\> netsh advfirewall export "firewall-rules.txt"
```

## 02 - Powershell

Check firewall's state and configuration.

```
PS C:\> Get-NetFirewallProfile

PS C:\> Get-NetFirewallProfile | Select Name, Enabled

PS C:\> Get-NetFirewallRule -all | Export-Csv firewall-rules.csv

PS C:\> Invoke-Command -ComputerName <IP> -ScriptBlock { Get-NetFirewallProfile | Select Name, Enabled }
```