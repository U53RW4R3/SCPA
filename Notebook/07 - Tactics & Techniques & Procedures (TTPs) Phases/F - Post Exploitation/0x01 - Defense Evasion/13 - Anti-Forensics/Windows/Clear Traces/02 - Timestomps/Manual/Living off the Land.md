---
author(s):
  - Userware
tags:
  - post-exploitation
  - defense-evasion
  - anti-forensics
  - living-off-the-land
  - T1070-006
  - windows
---
# Living off the Land

## 01 - Command Prompt

Erase the USN journal volume clear file creation activity.

```
C:\> fsutil.exe usn deletejournal /d <drive_letter>:
```

## 02 - PowerShell

### 2.1 - Manual timestomp

```powershell
PS C:\> $file = "C:\path\to\file.txt"
$creationtime = Get-Date "YYYY-MM-DD hh:mm:ss"
$lastwritetime = Get-Date "YYYY-MM-DD hh:mm:ss"
$lastaccesstime = Get-Date "YYYY-MM-DD hh:mm:ss"

Set-ItemProperty -Path $file -Name CreationTime -Value $creationtime
Set-ItemProperty -Path $file -Name LastWriteTime -Value $lastwritetime
Set-ItemProperty -Path $file -Name LastAccessTime -Value $lastaccesstime
```

### 2.2 - File timestamp reference

```powershell
PS C:\> $referenceFileTimeStamp = Get-Item old_file.txt
$TimestompFile = Get-Item new_file.txt
$TimestompFile.LastAccessTime = $referenceFileTimeStamp.LastAccessTime
$TimestompFile.CreationTime = $referenceFileTimeStamp.CreationTime
$TimestompFile.LastWriteTime = $referenceFileTimeStamp.LastWriteTime
```

---
## References

- [LOLBAS: fsutil](https://lolbas-project.github.io/lolbas/Binaries/Fsutil/)