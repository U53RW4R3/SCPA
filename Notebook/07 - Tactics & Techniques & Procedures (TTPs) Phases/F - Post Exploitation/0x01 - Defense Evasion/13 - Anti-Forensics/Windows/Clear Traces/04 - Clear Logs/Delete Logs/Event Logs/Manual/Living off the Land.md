# Living off the Land

## 01 - Command Prompt

List logs.

```
C:\> wevtutil.exe enum-logs

C:\> wevtutil.exe el
```

Clear logs in a specific category.

```
C:\> wevtutil.exe clear-log <logname>

C:\> wevtutil.exe cl <logname>

C:\> wmic.exe nteventlog where filename='<logname>' call cleareventlog
```

Delete all event logs.

```
C:\> for /f "tokens=*" %1 in ('wevtutil.exe enum-logs') do wevtutil.exe clear-log "%1"

C:\> for /f "tokens=*" %1 in ('wevtutil.exe enum-logs') do wmic nteventlog where filename='%1' call cleareventlog
```

Delete all logs.

```
C:\> del %WINDIR%\*.log /a /s /q /f
```

## 02 - PowerShell

Delete a specific event log.

```
PS C:\> Remove-EventLog [-ComputerName <IP>] -LogName "Application"
Remove-EventLog [-ComputerName <IP>] -LogName "Security"
Remove-EventLog [-ComputerName <IP>] -LogName "System"
```

Clear multiple event logs.

```
PS C:\> Clear-Eventlog [-ComputerName <IP>] -Log Application,Security,System

PS C:\> Clear-Eventlog [-ComputerName <IP>] -Log Application,Security,System -Confirm

PS C:\> Get-WinEvent -ListLog Application,Security,System -Force | % { Wevtutil.exe cl $_.Logname }
```

Delete all event logs.

```
PS C:\> Get-EventLog -LogName * | ForEach { Clear-EventLog $_.Log }

PS C:\> Get-WinEvent -ListLog * -Force | % { Wevtutil.exe cl $_.LogName }

PS C:\> wevtutil.exe el | Foreach-Object { Write-Host "Clearing $($_)" -ForegroundColor Green; Wevtutil.exe cl "$_"}

PS C:\> Get-WinEvent -ListLog * | where {$_.RecordCount} | ForEach-Object -Process { [System.Diagnostics.Eventing.Reader.EventLogSession]::GlobalSession.ClearLog($_.LogName) }
```

TODO: Get all event logs to each specific event category

```
PS C:\> Get-WinEvent -FilterHashTable @{LogName="Application"; ID=}
```

```
PS C:\> Get-WinEvent -FilterHashTable @{LogName="Microsoft-Windows-Terminal-Services-RemoteConnectionManager/Operational"; ID=1149}
```

```
PS C:\> Get-WinEvent -FilterHashTable @{LogName="Microsoft-Windows-Powershell/Operational"; ID=4100,4103,4104,}
```

```
PS C:\> Get-WinEvent -FilterHashTable @{LogName="Microsoft-Windows-TerminalServices-Gateway"; ID=400,800}
```

```
PS C:\> Get-WinEvent -FilterHashTable @{LogName="Security"; ID=1102,4624,4625,4634,4647,4648,4657,4658,4661,4663,4672,4674,4688,4697,4720,4722,4732,4738,4768,4769,4776,4778,4779,4782,5712}
```

```
PS C:\> Get-WinEvent -FilterHashTable @{LogName="System"; ID=7030,7036,7045,10000,100001,20001,20002,20003,24756,24577,24579}
```

Existing Even Logs
Microsoft-Windows-WinRM/Operational
Microsoft-Windows-WMI-Activity/Operational
Microsoft-Windows-DistributedCOM

```
PS C:\> Get-WmiObject -class Win32_NTLogEvent

PS C:\> Get-WmiObject -query "SELECT * FROM Win32_NTLogEvent WHERE EventCode = '4624'"

PS C:\> Get-WmiObject -query "SELECT * FROM Win32_NTLogEvent WHERE EventCode = '4624' and Message like '%User32%'"
```

---
## References

### Microsoft

- [Microsoft Powershell Management Powershell 7.2](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-event?view=powershell-7.2)

- [Microsoft Powershell Management Powershell 5.1](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/remove-eventlog?view=powershell-5.1)

### LOFLCAB

- [LOFLCAB: Clear-Eventlog](https://lofl-project.github.io/loflcab/Cmdlets/Clear-Eventlog/)

### Hacking Articles

- [Hacking Articles: Post Exploitation Using WMIC (System Command)](https://www.hackingarticles.in/post-exploitation-using-wmic-system-command/)

### svch0st

- [svch0st: Event Log Tampering Part 1 Disrupting The Eventlog Service](https://svch0st.medium.com/event-log-tampering-part-1-disrupting-the-eventlog-service-8d4b7d67335c)

### RedTeamRecipe

- [RedTeamRecipe: Event Codes for fun & profit](https://blog.redteamguides.com/event-codes-for-fun-profitrtc0020)