# Living off the Land

## 01 - Registry Backdoors

### 1.1 - HKLM

#### 1.1.1 - Add Registry Key Syntax

- Command Prompt

```
C\> reg import file.reg

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v <value> /t reg_sz /d "rundll32.exe C:\path\to\shell.dll,ExecDLL" /f
```

- Powershell

```powershell
PS C:\> Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" -Name "<value>" -PropertyType String -Value "C:\path\to\shell.exe" -Force
```

#### 1.1.2 - Delete Registry Key Syntax

```
C:\> reg del [\\<IP>\]hklm\\software\\microsoft\\currentversion\\run /v <value> /f
```

---
## References

- [[Windows Post Exploitation Persistence References]]

- [LOFLCAB: reg](https://lofl-project.github.io/loflcab/Binaries/reg/)