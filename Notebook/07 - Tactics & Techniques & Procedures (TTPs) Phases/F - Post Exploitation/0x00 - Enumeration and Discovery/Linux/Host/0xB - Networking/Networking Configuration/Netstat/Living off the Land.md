# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #living-off-the-land #networking #linux

Display the ports and protocol network of what user has rights for executing that kind of network program.

```
$ lsof -i

$ lsof -i :80
```

Display listening ports and host connections

`$ lsof -Pni`

```
$ getent services | grep <PORT>

$ grep <PORT> /etc/services

$ getent protocols
```

`$ netstat -antup`

`$ netstat -antpx`

`$ netstat -tulpn`

`$ netstat -anon`

`$ netstat -s`

`$ netstat -punta`

`$ netstat -ltp`

`$ netstat -latp`

`$ netstat -i`

`$ netstat -nltupw`

`$ ss -anon`

`$ ss -anp`

`$ ss -lnt`

`$ ss -ntpu`

`$ watch ss -stulp`

`$ chkconfig --list`

`$ chkconfig --list | grep 3:on`

## Established Connections

TODO: Arrange them here from the Netstat section and write each command of what it does

```
$ ss -utp

$ ss -nutp

$ ss -antp | grep ES

$ ss -auntp | grep ES

$ ss -auntp | grep -v ES
```

```
$ netstat -utp

$ netstat -an | grep ES

$ netstat -peanut | grep ES

$ netstat -peanut | grep -v ES
```

```
$ watch "netstat -tnpa | grep 'ESTABLISHED.*sshd'"
```

## Listening Connections

```
$ ss -nt
```

---
## References

- [nixCraft: How to check if port is in use on Linux or Unix](https://www.cyberciti.biz/faq/unix-linux-check-if-port-is-in-use-command/)