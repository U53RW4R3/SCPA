---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - networking
  - linux
---
# Living off the Land

```
$ getent services | grep <PORT>

$ grep <PORT> /etc/services

$ getent protocols
```

Files used by networks processes.

```
$ lsof -i
```

Files uses by networks processes

```
$ lsof -i :80
```

Files used by network IPv4 processes.

```
$ lsof -i 4
```

Files used by network IPv6 processes.

```
$ lsof -i 6
```

Display listening ports and host connections

```
$ lsof -Pni
```

```
$ netstat -antup

$ netstat -antpx



$ netstat -anon

$ netstat -s

$ netstat -punta



$ netstat -i



$ ss -anon

$ ss -anp



$ ss -ntpu

$ watch ss -stulp

$ chkconfig --list

$ chkconfig --list | grep 3:on
```

## Established Connections

TODO: Arrange them here from the Netstat section and write each command of what it does

```
$ ss -utp

$ ss -nutp

$ ss -antp | grep ES

$ ss -auntp | grep ES

$ ss -auntp | grep -v ES
```

```
$ netstat -utp

$ netstat -an | grep ES

$ netstat -peanut | grep ES

$ netstat -peanut | grep -v ES
```

```
$ watch "netstat -tnpa | grep 'ESTABLISHED.*sshd'"
```

## Listening Connections

```
$ netstat -tulpn

$ netstat -ltp

$ netstat -latp

$ netstat -nltupw

$ ss -nt

$ ss -lnt
```

---
## References

- [nixCraft: How to check if port is in use on Linux or Unix](https://www.cyberciti.biz/faq/unix-linux-check-if-port-is-in-use-command/)