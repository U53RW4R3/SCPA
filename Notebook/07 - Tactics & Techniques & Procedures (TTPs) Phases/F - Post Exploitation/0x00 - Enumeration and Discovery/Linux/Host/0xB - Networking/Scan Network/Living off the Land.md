# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #living-off-the-land #networking #linux

## Ping Sweep

### IPv4 Addresses

```
$ for i in $(seq 1 255); do ping -c 1 192.168.1.$i | grep "bytes from" | cut -d " " -f 4 | cut -d ":" -f 1; done

$ for i in $(seq 1 255); do ping -c 1 192.168.1.$i | tr \\n ' ' | awk '/1 received/ {print $2}'; done

$ for i in $(seq 1 255); do ping -c 1 192.168.1.$i | tr \\n ' ' | awk '/1 packets received/ {print $2}'; done
```

It is possible to ping IPv4 addresses with hexadecimal representation.

```
$ ping 0x7f000001
PING 0x7f000001 (127.0.0.1) 56(84) bytes of data. 
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.022 ms 
64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.028 ms 
64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=0.026 ms
```

### IPv6 Addresses

TODO: provide commands for ipv6 ping sweep

## ARP Scan

```
$ for i in $(seq 1 255); do arping -c 1 192.168.100.$i | grep "Unicast reply from" | cut -d " " -f 4; done
```

---
## References

- [IPUtils](https://github.com/iputils/iputils)

- [Infinite Logins: Using ping TTLs Values to Fingerprint Operating Systems](https://infinitelogins.com/2020/12/12/using-ping-ttls-values-to-fingerprint-operating-systems/)