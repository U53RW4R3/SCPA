# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #living-off-the-land #linux

## 01 - Operating System

### 1.1 - Distro Variant

```
$ cat /etc/issue

$ cat /etc/os-release

$ cat /usr/lib/os-release

$ cat /etc/lsb-release

$ cat /etc/*-release

$ cat /etc/arch-release

$ cat /etc/redhat-release
```

### 1.2 - Kernel

```
$ cat /proc/version

$ uname -a

$ uname -mrs

$ lsb_release -a

$ rpm -q kernel

$ dmesg | grep Linux

$ ls /boot | grep vmlinuz
```

Looking for kernel modules and to enumerate the version number

```
$ lsmod

$ modinfo <module_name>
```

## 02 - Hardware

### 2.1 - Time

Check the local date.

```
$ date
```

Check the duration of running system.

```
$ uptime

$ cat /proc/uptime
```

Idle time user activity.

```
$ w [username]

$ pinky [-l <username>]
```

### 2.2 - Storage

```
$ df -h

$ df -aH

$ dmesg | grep -E sd.{1}

$ ls /dev/ 2>/dev/null

$ ls /dev/ 2>/dev/null | grep -i "sd"

$ sudo fdisk -l

$ sudo fdisk -l | grep -B 1 "Disk model"
```

### 2.3 - Mounted Drives

Looking for mount drives with credentials or we can mount on to further move laterally.

```
$ findmnt -s

$ cat /etc/fstab

$ sed 's/#.*//' /etc/fstab | column -t -N SOURCE,TARGET,TYPE,OPTIONS,PASS,FREQ -R PASS,FREQ

$ grep -v "^#" /etc/fstab | grep -Pv "\W*\#" 2>/dev/null

$ mount [-l]

$ cat /proc/mounts

$ cat /proc/self/mounts

$ cat /proc/1/mounts

$ cat /proc/self/mountinfo

$ cat /proc/1/mountinfo
```

List mounted drives that is connected to the Linux system.

```
$ lsblk

$ sudo blockdev --report
```

### 2.4 - RAM

```
$ free -hm

$ vmstat -s
```

```
$ sudo cat /dev/mem | grep -i PASS
```

### 2.5 - CPU

#### 2.5.1 - Overview

```
$ lscpu

$ cat /proc/cpuinfo
```

#### 2.5.2 - Processors

```
$ grep -c processor /proc/cpuinfo

$ grep -c "cores" /proc/cpuinfo

$ grep "module name" /proc/cpuinfo | wc -l

$ grep -c "cpu" /proc/schedstat

$ lscpu | grep '^CPU(s):' | awk '{print $2}'
```

---
## References

- [Privilege Escalation Drives](https://book.hacktricks.xyz/linux-unix/privilege-escalation#drives)

- [Privilege Escalation /dev/mem](https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dev-mem)