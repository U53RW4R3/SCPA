# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #living-off-the-land #linux

## 01 - Window Display Server

> [!NOTE] `$DISPLAY` environment
> `:0` means `x11` and `:1` means `wayland`

```
$ loginctl show-session $(loginctl | grep $USER | awk '{print $1}') -p Type

$ echo $DISPLAY

$ echo $XDG_SESSION_TYPE
```

## 02 - Desktop Environment

```
$ echo $DESKTOP_SESSION
```

## 03 - Operating System

### 3.1 - Distro Variant

Universal distro enumeration.

```
$ cat /etc/issue

$ cat /etc/os-release

$ cat /usr/lib/os-release

$ cat /etc/lsb-release

$ cat /etc/*-release
```

Debian distro.

```
$ cat /etc/debian_release

$ cat /etc/debian_version
```

Redhat distro.

```
$ cat /etc/redhat-release

$ cat /etc/redhat_version
```

Fedora distro

```
$ cat /etc/fedora-release
```

SUSE distro.

```
$ cat /etc/SUSE-release
```

Arch Linux distro.

```
$ cat /etc/arch-release
```

Gentoo distro.

```
$ cat /etc/gentoo-release
```

### 3.2 - Kernel

```
$ cat /proc/version

$ uname -a

$ uname -mrs

$ lsb_release -a

$ rpm -q kernel

$ dmesg | grep Linux

$ ls /boot | grep vmlinuz
```

Architecture

```
$ arch
```

Looking for kernel modules and to enumerate the version number

```
$ lsmod

$ modinfo <module_name>
```

## 04 - Hardware

### 4.1 - Time

Check the local date.

```
$ date
```

Check the duration of running system.

```
$ uptime

$ cat /proc/uptime
```

Idle time user activity.

```
$ w [username]

$ pinky [-l <username>]
```

### 4.2 - Storage

```
$ df -h

$ df -aH

$ dmesg | grep -E sd.{1}

$ ls /dev/ 2>/dev/null

$ ls /dev/ 2>/dev/null | grep -i "sd"

$ sudo fdisk -l

$ sudo fdisk -l | grep -B 1 "Disk model"
```

### 4.3 - Mounted Drives

Looking for mount drives with credentials or we can mount on to further move laterally.

```
$ findmnt -s

$ cat /etc/fstab

$ sed 's/#.*//' /etc/fstab | column -t -N SOURCE,TARGET,TYPE,OPTIONS,PASS,FREQ -R PASS,FREQ

$ grep -v "^#" /etc/fstab | grep -Pv "\W*\#" 2>/dev/null

$ mount [-l]

$ mount [-l] | column -t

$ cat /proc/mounts

$ cat /proc/self/mounts

$ cat /proc/1/mounts

$ cat /proc/self/mountinfo

$ cat /proc/1/mountinfo
```

List mounted drives that is connected to the Linux system.

```
$ lsblk

$ sudo blockdev --report
```

### 4.4 - RAM

```
$ free -hm

$ vmstat -s

$ grep "MemTotal" /proc/meminfo
```

TODO: This is for scraping credentials but check if it works or not.

```
$ sudo grep -i PASS /dev/mem
```

### 4.5 - CPU

#### 4.5.1 - Overview

```
$ lscpu

$ cat /proc/cpuinfo
```

#### 4.5.2 - Processors

```
$ grep -c "processor" /proc/cpuinfo

$ grep -c "cores" /proc/cpuinfo

$ grep "module name" /proc/cpuinfo | wc -l

$ grep -c "cpu" /proc/schedstat

$ lscpu | grep '^CPU(s):' | awk '{print $2}'
```

---
## References

- [Privilege Escalation Drives](https://book.hacktricks.xyz/linux-unix/privilege-escalation#drives)

- [Privilege Escalation /dev/mem](https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dev-mem)