---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - linux
---
# Living off the Land

## 01 - Enumerate Current Account

Enumerate what user account you're logged in as.

```
$ id

$ whoami

$ echo $LOGNAME

$ echo $HOME
```

If executed and displays the output empty meaning it is part of administrator users.

```
$ who am i
```

## 02 - Enumerate User Accounts

List of users.

```
$ getent passwd

$ getent passwd {1000..60000}

$ compgen -A user

$ cat /etc/passwd

$ cat /etc/passwd-

$ column -t -s ":" -N "USER,NONE,USER_ID,GROUP_ID,DESCRIPTION,PATH,SHELL" -o "|" /etc/passwd

$ column -t -s ":" -N "USER,NONE,USER_ID,GROUP_ID,DESCRIPTION,PATH,SHELL" -o "|" /etc/passwd

$ cut -d ":" -f 1 /etc/passwd

$ grep "sh$" /etc/passwd

$ awk -F':' '{ print "User: " $1 "|Shell: " $7 "|Home: " $6}' /etc/passwd

$ cat /etc/passwd | grep "sh$" | cut -d ":" -f 1

$ cat /etc/passwd | grep "sh$" | awk -F ":" '{print $1}'

$ echo "$(< /etc/passwd)"

$ ls -l /home/

$ echo /home/*
```

Display user and group information.

```
$ id

$ echo $UID

$ echo $EUID

$ for user in $(awk -F ":" '{print $1}' /etc/passwd); do id $user 2>/dev/null; done

$ for user in $(cut -d ":" -f1 /etc/passwd); do id $user 2>/dev/null; done
```

Check password validity period.

```
$ passwd -S <username>

$ passwd -S $USER

$ for user in $(awk -F ":" '{print $1}' /etc/passwd); do passwd -S $user 2>/dev/null; done

$ for user in $(cut -d ":" -f1 /etc/passwd); do passwd -S $user 2>/dev/null; done
```

## 03 - Enumerate Local Groups

Enumerate on the current username.

```
$ groups

$ groups <username>

$ id -nG

$ id -nG <username>
```

Enumerate all groups.

```
$ getent group

$ compgen -A group

$ cat /etc/group
```

Enumerate users in a specific group

```
$ grep "^<group_name>" /etc/group

$ awk -F: '/^<group_name>/ {print $4;}' /etc/group
```

Enumerate administrator users (super users) accounts.

```
$ getent group adm sudo

$ grep "^sudo" /etc/group

$ awk -F: '/^sudo/ {print $4;}' /etc/group

$ sudo cat /etc/sudoers

$ grep -v -E "^#" /etc/passwd | awk -F: '$3 == 0 {print $1}'

$ awk -F ':' '($3 == "0") {print}' /etc/passwd
```

Enumerate `doas` users.

```
$ grep "^doas" /etc/group

$ awk -F: '/^doas/ {print $4;}' /etc/group

$ cat /etc/doas.conf

$ echo "$(< /etc/doas.conf)"
```

## 04 - Logged On Users

Identify the users who were logged in.

```
$ who

$ who | cut -c 1-8 | sort -u

$ who -a

$ who -uH
```

Same exact thing of the `who` command but it enumerates even further to check what the users activities determining what they are interacting. Moreover, you can also see commands.

```
$ w

$ pinky

$ w -h | awk '{print $1,$3}'
```

Last users who were logged on.

```
$ last

$ last -i

$ last -a

$ sudo lastb
```

## 05 - Environment Variables

Display predefined environment variables.

```
$ env

$ printenv

$ export -p

$ strings /proc/self/environ
```

Display predefined environment variables and POSIX functions.

```
$ set
```

---
## References

- [Wikipedia: Environment Variable](https://en.wikipedia.org/wiki/Environment_variable)