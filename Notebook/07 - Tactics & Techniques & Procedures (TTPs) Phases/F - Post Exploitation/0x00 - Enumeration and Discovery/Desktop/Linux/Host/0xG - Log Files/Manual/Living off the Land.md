---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - defense-evasion
  - living-off-the-land
  - linux
---
# Living off the Land

> [!IMPORTANT] Check User Privileges
> To read the logs the current user context must have `adm` group privileges which is used for system monitoring tasks. Run `id` to see if it's part of the group.

## 01 - System

```
$ cat /var/log/auth.log

$ cat /var/log/faillog

$ cat /var/log/lastlog

$ cat /var/log/messages

$ cat /var/log/secure

$ cat /var/log/syslog
```

## 02 - User

```
$ last

$ cat /var/log/wtmp

$ cat /var/run/utmp
```

## 03 - Protocols

### 3.1 - FTP

```
$ cat /var/log/xferlog

$ ls -l /var/log/proftpd/
```

### 3.2 - DHCP

```
$ journalctl -u dhcpcd

$ journalctl | grep -i dhcp

$ cat /var/log/dhcp.log
```

### 3.3 - HTTP

Discover logs that might be interesting, taken advantage of, and/or abuse the logs in some certain ways like **Local File Inclusion (LFI)**, or use this as an advantage to perform anti-forensics techniques that basically clears your traces.

#### 3.3.1 - Apache

```
$ cat /var/log/apache2/access_log

$ cat /var/log/apache2/access.log

$ cat /var/log/apache2/error_log

$ cat /var/log/apache2/error.log
```

#### 3.3.2 - Lighttpd

```
$ cat /var/log/lighttpd/access.log

$ cat /var/log/lighttpd/error.log

$ cat /var/log/lighttpd/lighttpd.access.log

$ cat /var/log/lighttpd/lighttpd.error.log
```

#### 3.3.3 - HTTPd

```
$ cat /var/log/chttp.log

$ cat /etc/httpd/logs/access_log

$ cat /etc/httpd/logs/access.log

$ cat /etc/httpd/logs/error_log

$ cat /etc/httpd/logs/error.log

$ cat /var/log/httpd/access_log

$ cat /var/log/httpd/access.log

$ cat /var/log/httpd/error_log

$ cat /var/log/httpd/error.log
```

#### 3.3.4 - Webmin

```
$ cat /var/webmin/miniserv.log
```

#### 3.3.5 - Others

```
$ cat /var/www/logs/access_log

$ cat /var/www/logs/access.log
```

### 3.4 - Samba

```
$ ls -l /var/log/samba/
```

### 3.5 - Printer

```
$ cat /var/log/cups/error_log
```

### 3.6 - Remote Desktops

#### 3.6.1 - RDP

Look for cached and known hosts for RDP connections

```
$ ls -l /home/$USER/.cache/remmina

$ ls -l /home/$USER/.config/freerdp/

$ ls -l /home/$USER/.local/share/rdesktop/
```

### 3.7 - DBMS

#### 3.7.1 - MySQL/MariaDB

TODO: Re-arrange them in a systematic order

```
connections.log
update.log
common.log
```

#### 3.7.2 - PostgreSQL

```
$ ls -l /var/log/postgresql/
```

## 04 - Package Manager

### 4.1 - DEB

```
$ cat /var/log/dpkg.log
```

### 4.2 - RPM

```
$ cat /var/log/yum.log
```

### 4.3 - AUR

```
$ cat /var/log/pacman.log
```

## 05 - Cloud

```
$ cat /var/log/cloud-init-output.log

$ cat /var/log/cloud-init.log
```

## 06 - Security Endpoints

### 6.1 - Mandatory Access Controls

```
$ grep /var/log/syslog | grep "apparmor="
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Linux/Host/0xA - Users/Manual/Living off the Land|Enumeration and Discovery: Users]]