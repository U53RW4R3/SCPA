---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - linux
---
# Living off the Land

## 01 - Discover compilers

### 1.1 - Interpreters

#### 1.1.1 - Python

```
$ which python python2 python3

$ command -v python python2 python3

$ which -a python python2 python3

$ type -ap python python2 python3
```

#### 1.1.2 - Perl

```
$ which perl

$ command -v perl

$ which -a perl

$ type -ap perl
```

### 1.2 - Compilers

#### 1.2.1 - C

```
$ which gcc cc clang

$ command -v gcc cc clang

$ which -a gcc cc clang

$ type -ap gcc cc clang

$ find / -type f \(-name "gcc*" -name "cc" -name "clang" \) 2>/dev/null

$ locate -r "/gcc[0-9\.-]\+$" 2>/dev/null | grep -v "/doc/"

$ locate -r "/gcc$" 2>/dev/null | grep -v "/doc/"

$ dpkg -l 2>/dev/null | grep "compiler" | grep -v "decompiler\|lib" 2>/dev/null

$ yum list installed 'gcc*' 2>/dev/null | grep gcc 2>/dev/null
```

#### 1.2.2 - C++

```
$ which g++

$ command -v g++

$ which -a g++

$ find / -type f -name "g++*" 2>/dev/null

$ locate -r "/g++[0-9\.-]\+$" 2>/dev/null | grep -v "/doc/"

$ locate -r "/g++$" 2>/dev/null | grep -v "/doc/"
```

## 02 - Archive Programs

```
$ which tar zip unzip 7z rar unrar

$ command -v tar zip unzip 7z rar unrar

$ which -a tar zip unzip 7z rar unrar

$ type -ap tar zip unzip 7z rar unrar
```

## 03 - File Transfer Programs

### 3.1 - Netcat

```
$ which nc.openbsd nc.traditional ncat

$ command -v nc.openbsd nc.traditional ncat

$ which -a nc.openbsd nc.traditional ncat

$ type -ap nc.openbsd nc.traditional ncat
```

### 3.2 - SSH

```
$ which scp rsync

$ command -v scp rsync

$ which -a scp rsync

$ type -ap scp rsync
```

### 3.3 - HTTP

```
$ which wget curl

$ command -v wget curl

$ which -a wget curl

$ type -ap wget curl
```

### 3.4 - FTP

```
$ which ftp tftp

$ command -v ftp tftp

$ which -a ftp tftp

$ type -ap ftp tftp
```

## 04 - Bash Completion

List all commands.

```
$ compgen -c

$ compgen -A command
```

List all aliases.

```
$ compgen -a

$ compgen -A alias
```

## 05 - Package Managers

### 5.1 - DEB Packages

```
$ apt list --installed

$ apt list --installed | cut -d "/" -f 1

$ dpkg -l
```

You can check archived packages even if some packages aren't installed.

```
$ ls -l /var/cache/apt/archives/*.deb
```

### 5.2 - RPM Packages

```
$ rpm -qa
```

You can check archived packages even if some packages aren't installed.

```
$ ls -l /var/cache/yum/

$ ls -l /var/cache/dnf/*/packages/*.rpm

$ ls -l /var/cache/zypp//
```

### 5.3 - Pacman Packages

```
$ pacman -Q
```

You can check archived packages even if some packages aren't installed.

```
$ ls -l /var/cache/pacman/pkg/*.zst
```

### 5.4 - Gentoo Packages

TODO: Check more archived destinations

```
$ ls -l /var/db/pkg/
```

## 06 - Current Desktop Environment

```
$ echo $XDG_CURRENT_DESKTOP

$ echo $XDG_SESSION_DESKTOP
```

## 07 - Current Display Server

```
$ echo $XDG_SESSION_TYPE

$ echo $DISPLAY

$ loginctl show-session $(loginctl | grep $USER | awk '{print $1}') -p Type | cut -d '=' -f 2

$ loginctl show-session $(loginctl | grep $(whoami) | awk '{print $1}') -p Type | cut -d '=' -f 2
```

## 08 - Current Shell Prompt

```
$ echo $SHELL

$ echo $0
```

---
## References

### Hacktricks

- [Hacktricks: Linux Privilege Escalation](https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html)