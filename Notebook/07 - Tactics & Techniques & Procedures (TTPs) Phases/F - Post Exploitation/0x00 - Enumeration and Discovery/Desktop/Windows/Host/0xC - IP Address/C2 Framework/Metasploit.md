---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - networking
  - network-protocols
  - msrpc
  - rdp
  - icmp
  - arp
  - dns
  - metasploit-framework
  - windows
---
# Metasploit

## 01 - NETBIOS Discovery

Metasploit auxiliary module to enumerate NetBIOS.

![[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Host/0xD - Scan Network/Live Host Identification/Network Ports/NetBIOS Enumeration/C2 Frameworks/Metasploit#^68ef3d]]

## 02 - Network Configuration

### 2.1 - IP Address

```
meterpreter > ifconfig
```

Using interactive ruby shell to enumerate IP address.

```
meterpreter > irb
>> init = client.net.config.interfaces
>> init.each { |x| puts x.pretty }
```

Enumerate route network.

```
meterpreter > route
```

### 3.2 - Netstat

```
meterpreter > netstat

meterpreter > run post/windows/gather/tcpnetstat
```

### 2.3 - RDP

```
meterpreter > run post/windows/gather/enum_termserv
```

## 03 - Ping Sweep

```
meterpreter > run post/multi/gather/ping_sweep rhosts=<IP>/<CIDR>
```

## 04 - ARP Discovery

```
meterpreter > run arp_scanner
Meterpreter Script for performing an ARPS Scan Discovery.

OPTIONS:

    -h   Help menu.
    -i   Enumerate Local Interfaces
    -r   The target address range or CIDR identifier
    -s   Save found IP Addresses to logs.

meterpreter > run arp_scanner -i

meterpreter > run arp_scanner -r <IP>/<CIDR>

meterpreter > run arp_scanner -r 10.0.2.1-15 -s
[*] ARP Scanning 10.0.2.1-15
[*] IP: 10.0.2.2 MAC 52:54:00:12:35:00
[*] IP: 10.0.2.1 MAC 52:54:00:12:35:00
[*] IP: 10.0.2.3 MAC 08:00:27:a5:d7:df
[*] IP: 10.0.2.4 MAC 08:00:27:8f:39:74
[*] IP: 10.0.2.15 MAC 08:00:27:3c:90:25
[*] Saving found IP's to /root/.msf4/logs/scripts/arp_scanner/DEFALT_20220515.2800/DEFALT_20220515.2800.txt

meterpreter > run post/windows/gather/arp_scanner rhosts=<IP>/<CIDR> threads=8
```

## 05 - Reverse DNS Lookup

TODO: Fill in the information

```
meterpreter > run post/multi/recon/reverse_lookup address=<IPv4>
```

```
meterpreter > run post/multi/recon/reverse_lookup range=192.168.0.<start_IP>-<end_IP>

meterpreter > run post/multi/gather/dns_reverse_lookup rhosts=<IP>/<CIDR>
```

---
## References

- [Rapid7: Metasploit Framework - Reverse Lookup Post Module](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/recon/reverse_lookup.md)