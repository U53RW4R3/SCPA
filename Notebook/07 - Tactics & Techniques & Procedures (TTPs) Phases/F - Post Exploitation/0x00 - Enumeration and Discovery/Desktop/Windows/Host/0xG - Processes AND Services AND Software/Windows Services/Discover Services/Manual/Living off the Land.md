---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - privilege-escalation
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Command Prompt

Listing all windows services with **Service Control Management**.

```
C:\> net.exe start

C:\> sc.exe [\\<IP>] query

C:\> sc.exe [\\<IP>] queryex

C:\> sc.exe [\\<IP>] query | findstr.exe SERVICE_NAME

C:\> sc.exe [\\<IP>] query type= service state= all

C:\> sc.exe [\\<IP>] queryex type= service
```

Obtain the full path of the service executable.

```
C:\> sc.exe query state= all | findstr.exe "SERVICE_NAME:" >> services.txt & FOR /F "tokens=2 delims= " %i in (services.txt) DO @echo %i >> binaries.txt & FOR /F %i in (binaries.txt) DO @(@echo %i & @echo --------- & @sc.exe qc %i | findstr.exe "BINARY_PATH_NAME" & @echo.) & del services.txt 2>nul & del binaries.txt 2>nul
```

## 02 - PowerShell

```
PS C:\> Get-Service | Format-List

PS C:\> Get-Service [-ComputerName <IP>] | Format-List

PS C:\> Get-Service | Where-Object {?_.Status -eq "Running" } | Format-Wide -Property Name -Column 1

PS C:\> Get-Service [-ComputerName <IP>] | Where-Object {?_.Status -eq "Running" } | Format-Wide -Property Name -Column 1
```

---
## References

- [LOFLCAB: Get-Service](https://lofl-project.github.io/loflcab/Cmdlets/Get-Service/)

- [Steflan Security: Windows Privilege Escalation Weak Permission](https://steflan-security.com/windows-privilege-escalation-weak-permission/)