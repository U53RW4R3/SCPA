# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #privilege-escalation #living-off-the-land #windows

## 01 - Command Prompt

Manual services

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] service get name,pathname,startname,startmode | findstr.exe /i "localsystem" | findstr.exe /i /v "c:\windows"
```

Auto and running services

```
C:\> wmic.exe [/node:<IP>] service get name,pathname,startname,startmode | findstr.exe /i "auto" | findstr.exe /i "localsystem" | findstr.exe /i /v "c:\windows"
```

## 02 - PowerShell

Auto and running services.

```
PS C:\> Get-CimInstance -ClassName Win32_Service | Select-Object Name, State, PathName | Where-Object {$_.State -like 'Running'}

PS C:\> Get-WmiObject -ClassName Win32_Service | Select-Object Name, State, PathName | Where-Object {$_.State -like 'Running'}
```

---
## References

- [Hacking Articles: Post Exploitation Using WMIC (System Command)](https://www.hackingarticles.in/post-exploitation-using-wmic-system-command/)

- [Steflan Security: Windows Privilege Escalation Weak Permission](https://steflan-security.com/windows-privilege-escalation-weak-permission/)