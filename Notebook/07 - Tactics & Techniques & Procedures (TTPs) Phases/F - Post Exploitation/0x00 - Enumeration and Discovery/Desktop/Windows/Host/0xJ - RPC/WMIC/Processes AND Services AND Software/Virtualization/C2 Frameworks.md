# C2 Frameworks

Search Tag(s): #post-exploitation #enumeration-and-discovery #defense-evasion #metasploit-framework #windows

## 01 - Metasploit

```powershell
meterpreter > powershell_shell
PS > $VMAdapter = Get-CimInstance Win32_NetworkAdapter -Filter 'Manufacturer LIKE "%VMware%" OR Name LIKE "%VMWare%"'
PS > $VMBios = Get-CimInstance Win32_BIOS -Filter 'SerialNumber LIKE "%VMWare%"'
PS > $VMToolsRunning = Get-CimInstance Win32_Process -Filter 'Name="vmtoolsd.exe"'
PS > [Bool]($VMAdapter -or $VMBios -or $VMToolsRunning)
```

---
## References

- [[04 - PowerShell|Metasploit Extension: PowerShell]]

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Host/0xG - Processes AND Services AND Software/Virtualization/C2 Frameworks/C2 Frameworks]]