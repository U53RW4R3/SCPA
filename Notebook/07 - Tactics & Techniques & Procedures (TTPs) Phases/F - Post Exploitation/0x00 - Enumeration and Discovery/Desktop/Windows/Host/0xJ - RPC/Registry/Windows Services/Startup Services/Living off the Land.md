---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - privilege-escalation
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Command Prompt

Discover startup services

```
C:\> reg.exe query [\\<IP>\]HKLM\Software\Microsoft\Windows\CurrentVersion\Run

C:\> reg.exe query [\\<IP>\]HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce

C:\> reg.exe query [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Run

C:\> reg.exe query [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce
```

## 02 - PowerShell

Discover startup services

```
PS C:\> Get-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run'

PS C:\> Get-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce'

PS C:\> Get-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run'

PS C:\> Get-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce'
```

---
## References

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Host/0xG - Processes AND Services AND Software/Windows Services/Startup Services/Living off the Land]]