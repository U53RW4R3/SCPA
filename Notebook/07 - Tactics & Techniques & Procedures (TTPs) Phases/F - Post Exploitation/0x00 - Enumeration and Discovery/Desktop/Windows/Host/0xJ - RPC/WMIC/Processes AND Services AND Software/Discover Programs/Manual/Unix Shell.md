---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - staying-off-the-land
  - networking
  - network-protocols
  - msrpc
  - smb
  - snmp
  - windows
---
# Unix Shell

## 01 - List Installed Software

Authentication syntax

```
$ wmiquery.py "<username>":"<password>"@<IP>

$ wmiquery.py [<domain>/]<username>@<IP> -hashes :<nt_hash>
```

Query installed programs.

```
WQL> SELECT Name,Version,Vendor FROM Product

WQL> SELECT Name,Caption,Version,IdentifyingNumber,InstallLocation FROM Win32_Product
```

DotNET MSBuild compilers

```
WQL> SELECT Description FROM Win32_Product WHERE Description '%.NET%'
```

List directories including hidden files and folders

```
WQL> SELECT Name FROM Win32_Directory WHERE Name LIKE 'C:\\%' AND Hidden = True
```

## 02 - Device Drivers

Query installed drivers.

```
WQL> SELECT DeviceName, DriverVersion, Manufacturer FROM Win32_PnPSignedDriver WHERE LIKE '%VMWare%'
```

## 03 - Antivirus and EDR

Query installed

```
WQL> SELECT Name,Caption,Version,IdentifyingNumber FROM Win32_Product
```