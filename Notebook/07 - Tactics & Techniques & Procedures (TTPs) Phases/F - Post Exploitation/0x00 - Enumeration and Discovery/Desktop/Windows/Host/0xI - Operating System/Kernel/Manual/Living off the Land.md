# Living off the Land

## 01 - Command Prompt

Enumerating the system to see any kind of potential version we can take over.

```
C:\> systeminfo.exe [/s <IP>] [/u <username> /p <password>]

C:\> systeminfo.exe [/s <IP>] [/u <username> /p <password>] | findstr.exe /b /c:"OS Name" /c:"OS Version"

C:\> ver

C:\> type c:\Windows\WindowsUpdate.log
```

Will show at the top.

```
C:\> type C:\Windows\System32\eula.txt
```

Will show at bottom (cdname/productname).

```
C:\> type C:\Windows\inf\layout.inf
```

Originally installed OS

```
C:\> type C:\Windows\System32\license.rtf
```

## 02 - PowerShell

Enumerating the system to see any kind of potential version we can take over.

```
PS C:\> [System.Environment]::OSVersion.Version
```

Enumerate hotfixes.

```
PS C:\> Get-Hotfix
```

---
## References

### LOFLCAB

- [LOFLCAB: systeminfo](https://lofl-project.github.io/loflcab/Binaries/systeminfo/)

### Moonpoint

- [Moonpoint: List Security Patches](https://support.moonpoint.com/os/windows/PowerShell/list-security-patches/)