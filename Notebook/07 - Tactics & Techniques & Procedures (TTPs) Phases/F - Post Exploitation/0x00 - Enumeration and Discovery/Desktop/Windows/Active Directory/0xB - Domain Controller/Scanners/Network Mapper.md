---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - networking
  - network-protocols
  - msrpc
  - smb
  - rdp
  - telnet
  - smtp
  - network-mapper
  - windows
---
# Network Mapper

## 01 - Enumerate Domain Controller

### 1.1 - DNS Port

```
$ nmap --script dns-srv-enum --script-args dns-srv-enum.domain=<domain>.<tld>
```

```
$ sudo nmap -v -sV -p 53 <IP>/<CIDR>

$ sudo nmap -v -sUV -p 53 <IP>/<CIDR>
```

### 1.2 - MSRPC Port

```
$ sudo nmap -Pn -p U:137,T:139 -sU -sS --script smb-enum-domains <IP>
```

^607221

### 1.3 - SMB Port

```
$ nmap -p 445 -Pn --script smb-os-discovery [--script-args unsafe=1] <IP>

$ nmap -p 445 -Pn --script smb-enum-domains --script-args "smbuser='<username>',smbpass='<password>'" <IP>
```

^1606ea

### 1.3 - LDAP Port

Enumerate LDAP root **DSA-specific Entry (DSE)**.

```
$ nmap -p 389 --script ldap-rootdse <IP>
```

## 02 - NTLM Information

### 2.1 - RDP Port

```
$ nmap -p 3389 -Pn --script rdp-ntlm-info <IP>
```

### 2.2 - Telnet Port

```
$ nmap -p 23 -Pn -n --script telnet-ntlm-info <IP>
```

### 2.3 - SMTP Port

```
$ nmap -p 587 -Pn --script smtp-ntlm-info <IP>
```

## 01 - MSRPC Port

Retrieve password information and policy.

![[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Active Directory/0xB - Domain Controller/Scanners/Network Mapper#^607221|Network Mapper: Domain Controller]]

## 02 - SMB Port

Retrieve password information and policy.

![[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Active Directory/0xB - Domain Controller/Scanners/Network Mapper#^1606ea|Network Mapper: Domain Controller]]


## 03 - LDAP Port

Novel Universal Password

```
$ nmap -p 636 --script ldap-novell-getpass --script-args 'ldap-novell-getpass.username="CN=<username>,O=<company>",ldap-novell-getpass.password=<password>,ldap-novell-getpass.account="CN=<username>,OU=<project>,O=<company>"'
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Cross Platform/Mail Server/SMTP|Manual: SMTP Active Enumeration]]

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Cross Platform/Remote Services/Graphical Remote Program/RDP|Manual: RDP Active Enumeration]]

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Cross Platform/Remote Services/Telnet|Manual: Telnet Active Enumeration]]

### Network Mapper

- [Network Mapper NSEDocs: smb-enum-domains Script](https://nmap.org/nsedoc/scripts/smb-enum-domains.html)

### The Hacker Recipes

- [The Hacker Recipes: DNS](https://www.thehacker.recipes/ad/recon/dns)

### Ethical hacking and penetration testing

- [Ethical hacking and penetration testing: SMB and Samba Security Audit Tools](https://miloserdov.org/?p=4066)