---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - offensive-tools
  - windows
---
# Scripts

## 01 - PowerSploit

Displays list of all the groups in the domain controller.

```
PS C:\> Get-NetGroup

PS C:\> Get-NetGroup -Domain <domain>
```

Retrieve information about the **domain name**.

```
PS C:\> Get-NetDomain

PS C:\> Get-NetDomainController
```

Retrieve the `objectsid` which outputs what privileges you're running as which could be a user, domain controller, administrator, etc. This help you understand when using **mimikatz** to dump the hashes and get a golden ticket to maintain access.

```
PS C:\> Get-DomainSID
```

If we're able to compromise the domain controller. We want to find admin access and which computers are active.

```
PS C:\> Find-LocalAdminAccess
```

## 01 - PowerView

Displays the requirements that was setup in the group policy in the Domain Controller to meet the requirements. If you see **`System Access`**. There are two things you need to look out for **`LockoutBadCount=0`** indicates that it was set to 0 that is disabled that it can bruteforce using password spraying attempts to retrieve the correct password (using online password cracker like `hydra` for example). Another one is called **`ClearTextPassword=0`** which sets the option to leave it unencrypted which suggests that it's visible in plain text.

```
PS C:\> Get-DomainPolicy
```


> [!NOTE]
> One of the crucial steps and to save more time without a ton of guess work when using [[07 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x00 - Exploitation/0xC - Password Cracking/Offline/Hashcat/Usage|hashcat]] for bruteforcing passwords that if the dictionary attack won't work. This information especially for the **`System Access`** as previously mentioned we have to look at the **`MinimumPasswordLength`** and **`PasswordComplexity`**. Passwords with complexity that may contains the following:
> 1. Must meet the minimum length of the password.
> 2. Alphabetic letters that are uppercase and lowercase at least one of them each.
> 3. Numbers and symbols that is non-alphabetic characters.
> 4. Doesn't match the user's account name or it's full name.

```
PS C:\> (Get-DomainPolicy)."System Access"
```

Retrieve information about Group Policies for the Domain Controller. This is useful to check if **Windows Security** is disabled or not, and other policies like **SMB Signing** when performing **LLNMR/NBT-NS/mDNS** poisoning using [[02 - Responder|responder]] or whatever has changed to get more information.

```
PS C:\> Get-NetGPO

PS C:\> Get-NetGPO | Select-Object displayname, whenchanged
```