---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - living-off-the-land
  - networking
  - network-protocols
  - windows
---
# Living off the Land

## 01 - NETBIOS

### 1.1 - Command Prompt

Enumerate hosts.

```
C:\> net.exe view

C:\> net.exe view /domain

C:\> net.exe view /domain:%userdomain%

C:\> net.exe view /domain:<domain>

C:\> net.exe group "Domain Computers" /domain
```

Enumerate **domain controllers**.

```
C:\> net.exe group "Domain Controllers" /domain
```

NetBIOS IP Addresses

```
C:\> nslookup.exe <IP>

C:\> ping.exe -n 1 <IP>

C:\> nbtstat.exe -c

C:\> nbtstat.exe -a <ComputerName>

C:\> nbtstat.exe -A <IP>
```

### 1.2 - PowerShell

NetBIOS IP Address

```
PS C:\> Resolve-DnsName <IP>

PS C:\> Test-Connection -Count 1 -ComputerName <IP>

PS C:\> [System.Net.Dns]::GetHostByAddress('<IP>').hostname
```

## 02 - LDAP

Enumerate **domain controllers**.

```
PS C:\> [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().DomainControllers 
```

---
## References

### LOFLCAB

- [LOFLCAB: `net.exe`](https://lofl-project.github.io/loflcab/Binaries/net/)

- [LOFLCAB: `nslookup.exe`](https://lofl-project.github.io/loflcab/Binaries/nslookup/)