---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - networking
  - network-protocols
  - msrpc
  - smb
  - smtp
  - metasploit-framework
  - windows
---
# Metasploit

## 01 - NETBIOS

### 1.1 - MSRPC Port

Scanning for NetBIOS hosts.

![[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Host/0xD - Scan Network/Live Host Identification/Network Ports/NetBIOS Enumeration/C2 Frameworks/Metasploit#^68ef3d]]

### Interactive Session

```
meterpreter > run post/windows/gather/enum_computers
```

## 02 - NTLM Information

### 2.1 - SMTP Port

![[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Cross Platform/Mail Server/SMTP#^ef9d56]]

## 02 - DNS Resolve Computer Names

### 2.1 - Meterpreter API

Resolve DNS

```
meterpreter > resolve <computer_name_1> <computer_name_n> [-f <IPv4 | IPv6>]

meterpreter > resolve 10.0.2.3

Host resolutions
================

    Hostname  IP Address
    --------  ----------
    10.0.2.3  10.0.2.3
```

### 2.2 - Post Module

```
msf > use post/multi/gather/resolve_hosts ai_family=<ipv4 | ipv6> hostfile=/path/to/dnshosts.txt

msf post(multi/gather/resolve_hosts) > set ai_family <ipv4 | ipv6>

msf post(multi/gather/resolve_hosts) > set hostnames <computer_name_1>,<computer_name_n>

msf post(multi/gather/resolve_hosts) > run
```

One-liner `meterpreter` command.

```
meterpreter > run post/multi/gather/resolve_hosts ai_family=<ipv4 | ipv6> hostfile=/path/to/dnshosts.txt
```

## 03 - LDAP

TODO: Check this module

```
meterpreter > run post/windows/gather/enum_ad_computers
```