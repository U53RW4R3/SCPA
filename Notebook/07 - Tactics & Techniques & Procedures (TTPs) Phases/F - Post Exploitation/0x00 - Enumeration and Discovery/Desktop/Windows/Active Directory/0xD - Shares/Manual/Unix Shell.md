---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - staying-off-the-land
  - networking
  - network-protocols
  - msrpc
  - smb
  - windows
---
# Unix Shell

## 01 - MSRPC Port

### 1.1 - `rpcclient`

Enumerate shares.

```
rpcclient $> enumshares
```

Retrieve information of SMB shares.

```
rpcclient $> netshareenum

rpcclient $> netshareenumall
```

Retrieve share information.

```
rpcclient $> netsharegetinfo <share_name>
```

### 1.2 - `net`

Enumerates all network shares.

```
$ net rpc share list -U "[<domain>/]<username>%<password>" -S <IP>

$ net rpc share list -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -S <IP>
```

List the registry shares

```
$ net <ads | rpc> conf listshares -U "[<domain>/]<username>%<password>" -S <IP>

$ net <ads | rpc> conf listshares -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -S <IP>
```

## 02 - SMB Port

### 2.1 - SMBClient

```
$ smbclient [-m smb<1|2|3>] -U "<username>%<password>" -L //<IP>

$ smbclient [-m smb<1|2|3>] -U "<username>" --pw-nt-hash <nt_hash> -L //<IP>
```

### 2.2 - NetExec

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --shares
```