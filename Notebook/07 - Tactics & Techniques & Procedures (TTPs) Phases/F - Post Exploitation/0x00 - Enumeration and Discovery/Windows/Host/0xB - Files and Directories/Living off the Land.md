---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Print Working Directory

### 1.1 - Command Prompt

```
C:\> cd

C:\> echo %CD%
```

### 1.2 - PowerShell

```
PS C:\> Get-Location

PS C:\> (Get-Item .).FullName

PS C:\> $Env:CD

PS C:\> [System.Environment]::CurrentDirectory

PS C:\> [System.Environment]::GetEnvironmentVariable('CD')
```

## 02 - Hidden Files and Directories

### 2.1 - Command Prompt

Display all the directories (including **hidden and alternate data stream**).

```
C:\> dir /r /a:h
```

Display directories and files in a tree structure. This is great for enumeration phase.

```
C:\> tree C:\ /f /a
```

### 2.2 - PowerShell

Display all the directories (including **hidden and alternate data stream**).

```
PS C:\> Get-ChildItem -Path [<drive_letter:\]path\to\directory] -File -Recurse - | ForEach-Object { Get-Item $_.FullName -Stream * }
```

## 03 - World Writable Folders

### 3.1 - Command Prompt

```
C:\> dir /ad-r C:\path\to\directory\
```

## 04 - Check File's Permission

### 4.1 - Command Prompt

```
C:\> dir /q C:\path\to\file.txt

C:\> dir /q C:\path\to\directory\
```

### 4.2 - PowerShell

```
PS C:\> Get-Acl -Path "C:\path\to\file.txt"

PS C:\> Get-Acl -Path "C:\path\to\directory\"
```

## 05 - List attributes from a file

### 5.1 - Command Prompt

```
C:\> attrib.exe C:\path\to\file.txt
```

### 5.2 - PowerShell

This will help you to gather ideas from a file/directory own attributes.

```
PS C:\> Get-Item [<drive_letter>:\]path\to\file.txt | Get-Member

PS C:\> Get-ItemProperty [<drive_letter>:\]path\to\file.txt | Get-Member
```

---
## References

- [SS64: Dir](https://ss64.com/nt/dir.html)

- [r00t-3xp10it: CmdLine Scripts for Reverse TCP Shell Addicts](https://github.com/r00t-3xp10it/venom/wiki/CmdLine-%26-Scripts-for-reverse-TCP-shell-addicts)