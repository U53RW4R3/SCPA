# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #living-off-the-land #windows

## 01 - Print Working Directory

### 1.1 - Command Prompt

```
C:\> pwd
```

## 02 - Hidden Files and Directories

### 2.1 - Command Prompt

Display all the directories (including **hidden and alternate data stream**).

```
C:\> dir /r /a:h
```

Display directories and files in a tree structure. This is great for enumeration phase.

```
C:\> tree C:\ /f /a
```

### 2.2 - Powershell

Display all the directories (including **hidden and alternate data stream**).

```
PS C:\> Get-ChildItem -Path [<drive_letter:\]path\to\directory] -File -Recurse - | ForEach-Object { Get-Item $_.FullName -Stream * }
```

## 03 - World Writable Folders

Common destinations to write files.

```
C:\Users\Public
C:\Windows\Temp
C:\Windows\Tasks
C:\Windows\tracing
C:\Windows\Registration\CRMLog
C:\Windows\debug\wia
C:\Windows\System32\tasks
C:\Windows\System32\FxsTmp
C:\Windows\System32\com\dmp
C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys
C:\Windows\System32\spool\printers
C:\Windows\System32\spool\servers
C:\Windows\System32\spool\drivers\color
C:\Windows\System32\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\System32\tasks_migrated\Microsoft\Windows\PLS\System
C:\Windows\SysWOW64\Tasks
C:\Windows\SysWOW64\FxsTmp
C:\Windows\SysWOW64\com\dmp
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\PLS\System
```

### 3.1 - Command Prompt

```
C:\> dir /ad-r C:\path\to\directory\
```

## 04 - List attributes from a file

### 4.1 - Powershell

This will help you to gather ideas from a file/directory own attributes.

```
PS C:\> Get-Item [<drive_letter>:\]path\to\file.txt | Get-Member

PS C:\> Get-ItemProperty [<drive_letter>:\]path\to\file.txt | Get-Member
```

---
## References

- [SS64: Dir](https://ss64.com/nt/dir.html)

- [CmdLine Scripts for Reverse TCP Shell Addicts](https://github.com/r00t-3xp10it/venom/wiki/CmdLine-%26-Scripts-for-reverse-TCP-shell-addicts)