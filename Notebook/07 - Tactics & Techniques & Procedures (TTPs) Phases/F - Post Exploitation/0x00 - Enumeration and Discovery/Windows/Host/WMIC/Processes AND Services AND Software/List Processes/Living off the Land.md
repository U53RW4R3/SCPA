# Living off the Land

# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #living-off-the-land #windows

## 01 - Command Prompt

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] process list brief

C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] process get caption,executablepath,commandline
```

## 02 - Powershell

```powershell
PS C:\> Get-CimInstance -Classname Win32_Process [-ComputerName <IP>] | Select-Object CommandLine

PS C:\> Get-CimInstance -Query "Select * from Win32_Process" [-ComputerName <IP>] | Where-Object {$_.Name -notlike "svchost*"} | Select Name, Handle, @{Label="Owner";Expression={$_.GetOwner().User}} | Format-Table -AutoSize

PS C:\> Get-WMiObject Win32_Process [-ComputerName <IP>]

PS C\> Get-WmiObject -Query "Select * from Win32_Process" [-ComputerName <IP>] | Where-Object {$_.Name -notlike "svchost*"} | Select-Object Name, Handle, @{Label="Owner";Expression={$_.GetOwner().User}} | Format-Table -AutoSize
```

---
## References

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Windows/Host/0xG - Processes AND Services AND Software/List Processes/Manual/Living off the Land]]