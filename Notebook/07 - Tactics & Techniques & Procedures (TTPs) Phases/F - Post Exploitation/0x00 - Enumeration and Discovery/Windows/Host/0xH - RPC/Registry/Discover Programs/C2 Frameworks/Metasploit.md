---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - metasploit-framework
  - windows
---
# Metasploit

## 01 - Installed Programs

TODO: Convert the manual methods to meterpreter

### 1.1 - List Installed Software

```
meterpreter > reg enumkey [-r <target_IP>] -k HKLM\\SOFTWARE
```

## 02 - PowerShell and .NET

Discover available PowerShell engines.

```
meterpreter > reg queryval [-r <target_IP>] -k hklm\\software\\microsoft\\powershell\\1\\powershellengine -v powershellversion

meterpreter > reg queryval [-r <target_IP>] -k hklm\\software\\microsoft\\powershell\\3\\powershellengine -v powershellversion
```

Discover PowerShell Logging.

```
meterpreter > reg enumkey [-r <target_IP>] -k HKLM\\SOFTWARE\\Wow6432Node\\Policies\\Microsoft\\Windows\\Powershell\\Transcription

meterpreter > reg enumkey [-r <target_IP>] -k HKLM\\SOFTWARE\\Wow6432Node\\Policies\\Microsoft\\Windows\\PowerShell\\ModuleLogging

meterpreter > reg enumkey [-r <target_IP>] -k HKLM\\SOFTWARE\\Wow6432Node\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging
```

Enumerate available Common Language Runtime (CLR) versions.

```
meterpreter > reg enumkey [-r <target_IP>] -k "HKLM\SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full Release"
```

---
## References

### Backlinks

- [[04 - PowerShell|Metasploit: Powershell Meterpreter Extension]]

### Rapid7

- [Rapid7: Metasploit Framework - Enumerate AV Gather Post Module](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_av.md)