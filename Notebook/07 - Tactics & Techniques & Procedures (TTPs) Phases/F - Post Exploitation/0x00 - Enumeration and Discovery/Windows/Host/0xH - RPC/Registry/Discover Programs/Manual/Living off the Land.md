---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Installed Programs

### 1.1 - Command Prompt

#### 1.1.1 - List Installed Software

```
C:\> reg.exe query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall /v "DisplayName" /s [/reg:<32 | 64>]

C:\> reg.exe query HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall /v "DisplayName" /s [/reg:<32 | 64>]

C:\> reg.exe query HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall /v "DisplayName" /s [/reg:<32 | 64>]

C:\> reg.exe query HKCU\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall /v "DisplayName" /s [/reg:<32 | 64>]
```

### 1.2 - PowerShell

#### 1.2.1 - List Installed Software

```
PS C:\> Get-ChildItem -Path Registry::HKEY_LOCAL_MACHINE\SOFTWARE | Format-Table Name

PS C:\> Get-ItemProperty Registry::HKLM:\SOFTWARE

PS C:\> Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*"

PS C:\> Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*" 
```

## 02 - PowerShell and .NET

### 2.1 - Command Prompt

Enumerate available **Common Language Runtime (CLR)** versions.

```
C:\> reg.exe query "HKLM\SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full Release"
```

### 2.2 - PowerShell

Discover available PowerShell engines.

```
PS C:\> Get-ItemPropertyValue HKLM:\SOFTWARE\Microsoft\PowerShell\*\PowerShellEngine -Name PowerShellVersion
```

---
## References

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Windows/Host/0xG - Processes AND Services AND Software/Discover Programs/Manual/Living off the Land]]