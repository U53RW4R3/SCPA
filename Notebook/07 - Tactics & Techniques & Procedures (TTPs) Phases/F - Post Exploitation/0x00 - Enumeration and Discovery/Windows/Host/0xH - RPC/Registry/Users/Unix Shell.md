# Unix Shell

## 01 - `net`

```
$ net rpc registry enumerate "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" -U "<username>%<password>" -S <IP>

$ net rpc registry getvalue "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" <valuename> -U "T-Bone%password123" -S 192.168.56.23
```

## 02 - `regshell`

```
$ regshell -U "<domain>/<username>%<password>" -R <IP>

$ regshell -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -R <IP>

\> predef HKEY_CURRENT_USER

\HKEY_CURRENT_USER> ck Environment

\HKEY_CURRENT_USER\Environment> info

\HKEY_CURRENT_USER\Environment> print <value>

\> predef HKEY_LOCAL_MACHINE

\HKEY_LOCAL_MACHINE> ck "SYSTEM\CurrentControlSet\Control\Session Manager\Environment"

\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment> info

\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment> print <value>
```

```
$ regshell -U "<domain>/<username>%<password>" -R <IP>

$ regshell -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -R <IP>

\> predef HKEY_CURRENT_USER

\HKEY_CURRENT_USER> ck Environment

\HKEY_CURRENT_USER\Environment> info

\HKEY_CURRENT_USER\Environment> print <value>

\> predef HKEY_LOCAL_MACHINE

\HKEY_LOCAL_MACHINE> ck "SYSTEM\CurrentControlSet\Control\Session Manager\Environment"

\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment> info

\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment> print PROCESSOR_ARCHITECTURE

\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment> print NUMBER_OF_PROCESSORS
```

## 03 - Impacket

```
$ reg.py "<username>":"<password>"@<IP> query -keyName "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment"
```