# Living off the Land

## 01 - Command Prompt

Manual services

```
C:\> wmic.exe [/node:<IP>] service get name,displayname,startname,pathname,startmode 2>nul | findstr /i /v "c:\windows" 2>nul | findstr /i /v """
```

Auto services

```
C:\> wmic.exe service get name,startname,pathname,startmode 2>nul | findstr /i "auto" 2>nul | findstr /i /v "c:\windows" | findstr /i /v """

C:\> wmic.exe [/node:<IP>] service list brief
```

## 02 - PowerShell

Auto services

```
PS C:\> Get-CimInstance -ClassName Win32_Service -Property Name, DisplayName, PathName, StartMode | Where-Object {$_.StartMode -eq "Auto" -and $_.PathName -notlike "C:\Windows*" -and $_.PathName -notlike '"*'} | Select-Object PathName, DisplayName, Name

PS C:\> Get-WmiObject -ClassName Win32_Service -Property Name, DisplayName, PathName, StartMode | Where-Object {$_.StartMode -eq "Auto" -and $_.PathName -notlike "C:\Windows*" -and $_.PathName -notlike '"*'} | Select-Object PathName, DisplayName, Name
```

---
## References

- [Hacking Articles: Post Exploitation Using WMIC (System Command)](https://www.hackingarticles.in/post-exploitation-using-wmic-system-command/)

- [Steflan Security: Windows Privilege Escalation Weak Permission](https://steflan-security.com/windows-privilege-escalation-weak-permission/)