# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #privilege-escalation #living-off-the-land #windows

## 01 - Command Prompt

```
C:\> reg.exe query [\\<IP>\]HKLM /f password /t REG_SZ /s

C:\> reg.exe query [\\<IP>\]HKCU /f password /t REG_SZ /s

C:\> reg.exe query "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"

C:\> reg.exe query "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" /v DefaultUserName [/reg:<32 | 64>]

C:\> reg.exe query "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" /v LastUsedUsername [/reg:<32 | 64>]
```

## 02 - PowerShell

TODO: Convert the commands into cmdlets

```
PS C:\> Get-ItemProperty -Path HKLM: -Type String -Filter "password"

C:\> reg.exe query [\\<IP>\]HKLM /f password /t REG_SZ /s

C:\> reg.exe query [\\<IP>\]HKCU /f password /t REG_SZ /s

C:\> reg.exe query "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"

C:\> reg.exe query "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" /v DefaultUserName [/reg:<32 | 64>]

C:\> reg.exe query "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" /v LastUsedUsername [/reg:<32 | 64>]
```

---
## References

- [[Autologon|AutoLogon Registry]]