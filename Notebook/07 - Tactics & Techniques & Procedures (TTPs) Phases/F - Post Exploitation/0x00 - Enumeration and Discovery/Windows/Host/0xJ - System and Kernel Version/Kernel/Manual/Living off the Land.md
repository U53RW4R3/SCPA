# Living off the Land

## 01 - Command Prompt

Enumerating the system to see any kind of potential version we can take over.

```
C:\> systeminfo [/s <IP>] [/u <username> /p <password>]

C:\> systeminfo [/s <IP>] [/u <username> /p <password>] | findstr /b /c:"OS Name" /c:"OS Version"

C:\> ver

C:\> wmic [/node:<IP>] [/user:<username> /password:<password>] computersystem list full

C:\> type C:\Windows\system32\eula.txt

C:\> type c:\windows\WindowsUpdate.log
```

Enumerate hotfixes.

```
C:\> wmic [/node:<IP>] [/user:<username> /password:<password>] qfe get caption,description,hotfixid,installedon

C:\> wmic [/node:<IP>] [/user:<username> /password:<password>] qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:"KB4012212" /C:"KB4012215"
```

## 02 - Powershell

Enumerating the system to see any kind of potential version we can take over.

```
PS C:\> [System.Environment]::OSVersion.Version

PS C:\> Get-CimInstance Win32_OperatingSystem
```

Enumerate hotfixes.

```
PS C:\> Get-Hotfix

PS C:\> Get-CimInstance -Classname Win32_QuickFixEngineering
```

---
## References

- [LOFLCAB: systeminfo](https://lofl-project.github.io/loflcab/Binaries/systeminfo/)

- [List Security Patches](https://support.moonpoint.com/os/windows/PowerShell/list-security-patches/)