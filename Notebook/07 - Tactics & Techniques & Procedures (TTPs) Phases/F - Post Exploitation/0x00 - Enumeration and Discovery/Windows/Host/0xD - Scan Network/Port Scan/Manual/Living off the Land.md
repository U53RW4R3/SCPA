# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #living-off-the-land #windows

## 01 - Powershell

```
PS C:\> 1..1024 | % { echo ((New-Object Net.Sockets.TcpClient).Connect("<IP>", $_)) "Port $_ is open" } 2>$null
```

## 02 - Sysinternals

Download the port scanner program.

```
C:\> certutil.exe -urlcache -split -f https://download.microsoft.com/download/0/d/9/0d9d81cf-4ef2-4aa5-8cea-95a935ee09c9/PortQryV2.exe PortQryV2.exe

C:\> curl.exe -o PortQryV2.exe https://download.microsoft.com/download/0/d/9/0d9d81cf-4ef2-4aa5-8cea-95a935ee09c9/PortQryV2.exe
```

Scan a single target.

```
C:\> PortQryV2.exe -n <IP> -p <tcp | udp | both> -e <PORT> -v
```

Scan multiple IP addresses.

```
C:\> for /l %i in (1,1,255) do PortQryV2.exe -n 192.168.1.%i -p <tcp | udp | both> -e <PORT> -v 2> nul && echo 192.168.1.%i
```

---
## References

- [Microsoft: PortQry](https://www.microsoft.com/en-us/download/details.aspx?id=17148)