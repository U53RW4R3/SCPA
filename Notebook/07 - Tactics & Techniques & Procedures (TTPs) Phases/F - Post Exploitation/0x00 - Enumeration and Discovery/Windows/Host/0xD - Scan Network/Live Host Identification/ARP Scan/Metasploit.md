---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - networking
  - network-protocols
  - arp
  - metasploit-framework
  - windows
---
# Metasploit

## 01 - Meterpreter API Command

### 1.1 - Help Menu

```
meterpreter > run arp_scanner
Meterpreter Script for performing an ARPS Scan Discovery.

OPTIONS:

    -h   Help menu.
    -i   Enumerate Local Interfaces
    -r   The target address range or CIDR identifier
    -s   Save found IP Addresses to logs.
```

### 1.2 - Usage

```
meterpreter > run arp_scanner -i -s
```

Scan a range of IP addresses.

```
meterpreter > run arp_scanner -r <start_IP>-<end_IP> -s

meterpreter > run arp_scanner -r 10.0.2.1-15 -s
[*] ARP Scanning 10.0.2.1-15
[*] IP: 10.0.2.2 MAC 52:54:00:12:35:00
[*] IP: 10.0.2.1 MAC 52:54:00:12:35:00
[*] IP: 10.0.2.3 MAC 08:00:27:a5:d7:df
[*] IP: 10.0.2.4 MAC 08:00:27:8f:39:74
[*] IP: 10.0.2.15 MAC 08:00:27:3c:90:25
[*] Saving found IP's to /root/.msf4/logs/scripts/arp_scanner/DEFALT_20220515.2800/DEFALT_20220515.2800.txt
```

Scan from a subnet mask IP range.

```
meterpreter > run arp_scanner -r <IP>/<CIDR> -s
```

## 02 - Post Module

```
meterpreter > run post/windows/gather/arp_scanner rhosts=<IP>/<CIDR> threads=8
```