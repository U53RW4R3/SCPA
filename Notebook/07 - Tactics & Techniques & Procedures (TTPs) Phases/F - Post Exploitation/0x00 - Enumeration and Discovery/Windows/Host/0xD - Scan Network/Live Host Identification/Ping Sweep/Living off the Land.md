---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - networking
  - network-protocols
  - icmp
  - windows
---
# Living off the Land

## 01 - Command Prompt

```
C:\> for /l %i in (1, 1, 255) do @ping.exe -n 1 -l 4 192.168.1.%i | find.exe "TTL"

C:\> for /k %i in (1, 1, 255) do @ping.exe -n 1 -w 200 192.168.1.%i 2> nul && echo 192.168.1.%i host is up
```

## 02 - PowerShell

```
PS C:\> 1..255 | % { "192.168.1.$($_): $(Test-Connection -Count 1 -ComputerName 192.168.1.$($_) -Quiet)" }

PS C:\> $ping = New-Object System.Net.NetworkInformation.Ping; 1..254 | ForEach-Object { $ping.Send("192.168.1.$_", 1) | Where-Object { $_.Status -ne [System.Net.NetworkInformation.IPStatus]::TimedOut } | Select-Object -Property Address | Format-List }
```