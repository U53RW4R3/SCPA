---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - networking
  - network-protocols
  - msrpc
  - windows
---
# Living off the Land

## 01 - Command Prompt

Check firewall's state and configuration.

```
C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] firewall show state

C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] firewall show config

C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] advfirewall firewall dump

C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] advfirewall show currentprofile

C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] advfirewall firewall show rule name= all

C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] advfirewall export "firewall-rules.txt"
```

## 02 - PowerShell

Check firewall's state and configuration.

```
PS C:\> Get-NetFirewallProfile

PS C:\> Get-NetFirewallProfile | Select-Object Name, Enabled

PS C:\> Get-NetFirewallProfile | Select-Object Enabled, Profile

PS C:\> Get-NetFirewallRule -all | Export-Csv firewall-rules.csv

PS C:\> Invoke-Command -ComputerName <IP> -ScriptBlock { Get-NetFirewallProfile | Select Name, Enabled }
```