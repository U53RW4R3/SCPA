# Unix Shell

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #staying-off-the-land #windows

## 01 - NETBIOS Discovery

### 1.1 - `nbtscan`

Scanning for NetBIOS hosts

```
$ sudo nbtscan -r <IP>/<CIDR>
```

Output IP targets

```
$ nbtscan –v –s : <IP>/<CIDR> | tee netbios-output.txt

$ cut -d ":" –f 1 netbios-output.txt > ip_targets.txt
```

### 1.2 - Netnet

Install the program.

```
$ go get github.com/hdm/nextnet && \
sudo cp ~/pkg/bin/nextnet /usr/local/bin/
```

Usage

```
> nextnet [-rate 10000] <IP>/<CIDR> | grep nets
```

### 1.3 - `nmap`

```
$ sudo nmap -p U:137 -sU --script smb-os-discovery --script-args unsafe=1 <IP>/<CIDR>

$ nmap -p 3389 -Pn -sV --script rdp-ntlm-info <IP>/<CIDR>
```

### 1.4 - Samba Suite Utils

```
$ nmblookup -A <IP>
```

## 02 - Interfaces

```
$ nmap -p 161,162 -sU --script snmp-interfaces --script-args creds.snmp=<password> <IP>
```

## 03 - Netstat

Enumerate open TCP ports

```
$ snmpwalk -c public -v1 <IP> | grep tcpConnState | cut -d "." -f 6 | sort -nu

$ snmpwalk -v 2c -c public <IP>:<PORT> | grep tcpConnState | cut -d "." -f 6 | sort -nu
```

Enumerate listening ports.

```
$ nmap -p 161,162 -sU --script snmp-netstat --script-args creds.snmp=<password> <IP>
```

---
## References

- [hdm: nextnet](https://github.com/hdm/nextnet)

- [0xffsec: NetBIOS (Network Basic Input/Output System)](https://0xffsec.com/handbook/services/netbios/)