---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - staying-off-the-land
  - networking
  - network-protocols
  - msrpc
  - smb
  - snmp
  - windows
---
# Unix Shell

## 01 - List Installed Software

### 1.1 - SMB Port

#### 1.1.1 - Samba Suite Utils

```
smb: \> ls "/Program Files/"

smb: \> ls "/Program Files (x86)/"
```

DotNET MSBuild compilers

```
smb: \> ls "/Windows/Microsoft.NET/Framework64"
```

#### 1.1.2 - SMBMap

```
$ smbmap -u <username> -p "< <password> | <nt_hash> >" -r 'C$\Program Files\' -H <IP>

$ smbmap -u <username> -p "< <password> | <nt_hash> >" -r 'C$\Program Files (x86)\' -H <IP>
```

DotNET MSBuild compilers

```
$ smbmap -u <username> -p "< <password> | <nt_hash> >" -r 'C$\Windows\Microsoft.NET\Framework64' -H <IP>
```

### 1.2 - SNMP Port

```
$ snmpwalk -c public -v1 <IP> | grep hrSWInstalledName | cut -d " " -f 4

$ snmpwalk -v 2c -c public <IP>:<PORT> | grep hrSWInstalledName | cut -d " " -f 4
```

## 02 - Antivirus and EDR

### 2.1 - NetCommands

```
$ net rpc service list -U "<username>%<password>" -S <IP>

$ net rpc service status <service> -U "<username>%<password>" -S <IP>
```

Check service current status.

```
$ net <ads | rpc> service status "<ServiceSVC>" -U "[<domain>/]<username>%<password>" -S <IP>

$ net <ads | rpc> service status "<ServiceSVC>" -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -S <IP>
```

### 2.2 - Impacket

List all services.

```
$ services.py [<domain>/]<username>:"<password>"@<IP> list

$ services.py [<domain>/]<username>@<IP> -hashes :<nt_hash> list
```

Enumerate current service.

```
$ services.py "<username>":"<password>"@<IP> config -name <service>

$ services.py [<domain>/]<username>@<IP> -hashes :<nt_hash> config -name <service>
```

Check service current status.

```
$ services.py "<username>":"<password>"@<IP> status -name <service>

$ services.py [<domain>/]<username>@<IP> -hashes :<nt_hash> status -name <service>
```