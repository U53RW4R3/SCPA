# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #privilege-escalation #living-off-the-land #windows

## 01 - Service Control Management

### 1.1 - Command Prompt

Listing all windows services with **Service Control Management**.

```
C:\> net start

C:\> sc [\\<IP>] query

C:\> sc [\\<IP>] queryex

C:\> sc [\\<IP>] query | findstr SERVICE_NAME

C:\> sc [\\<IP>] query type= service state= all

C:\> sc [\\<IP>] queryex type= service

C:\> wmic [/node:<IP>] service get name, startname
```

### 1.2 - Powershell

```
PS C:\> Get-Service | Format-List

PS C:\> Get-Service [-ComputerName <IP>] | Format-List

PS C:\> Get-Service | Where-Object {?_.Status -eq "Running" } | Format-Wide -Property Name -Column 1

PS C:\> Get-Service [-ComputerName <IP>] | Where-Object {?_.Status -eq "Running" } | Format-Wide -Property Name -Column 1
```

---
## References

- [LOFLCAB: Get-Service](https://lofl-project.github.io/loflcab/Cmdlets/Get-Service/)

- [Steflan Security: Windows Privilege Escalation Weak Permission](https://steflan-security.com/windows-privilege-escalation-weak-permission/)