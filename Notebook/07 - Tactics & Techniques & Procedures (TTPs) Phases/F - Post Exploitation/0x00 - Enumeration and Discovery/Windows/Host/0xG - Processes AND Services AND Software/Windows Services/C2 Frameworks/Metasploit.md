# Metasploit

Search Tag(s): #post-exploitation #enumeration-and-discovery #privilege-escalation #metasploit-framework #windows

TODO: enumerate directory permissions useful for privesc

run post/windows/gather/enum_dirperms

```
meterpreter > run post/windows/gather/enum_services
```


```
meterpreter > run service_manager -h
Meterpreter Script for managing Windows Services.

OPTIONS:

    -C   Create Service, service will be set to auto start
    -c   Change Service StartUp. Default <Auto>
    -d   Display Name of Service
    -D   Delete Service
    -h   Help menu.
    -i   Get Service Information
    -K   Stop Service
    -l   List Services
    -n   Service Name
    -p   Service command
    -S   Start Service
    -s   Startup Parameter for service. Specify Auto, Manual or Disabled

meterpreter > run service_manager -l
```

```
meterpreter > load extapi
..[omitted]..
Extapi: Service Management Commands
===================================

    Command          Description
    -------          -----------
    service_control  Control a single service (start/pause/resume/stop/restart)
    service_enum     Enumerate all registered Windows services
    service_query    Query more detail about a specific Windows service
..[omitted]..
```


```
meterpreter > service_enum

meterpreter > service_query <servicesvc>

meterpreter > service_control <start | pause | resume | stop | restart>
```

---
## References

- [Rapid7: Metasploit Framework - Enumerate Services Post Module](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/gather/enum_services.md)