# Living off the Land

## 01 - Command Prompt

Discover startup services

```
C:\> dir "C:\Users\All Users\Start Menu\Programs\Startup"

C:\> dir "C:\Users\<username>\Start Menu\Programs\Startup"

C:\> dir "\\<IP>\C$\Users\<username>\Start Menu\Programs\Startup"

C:\> wmic [/node:<IP>] startup service

C:\> wmic [/node:<IP>] startup list full

C:\> wmic [/node:<IP>] startup get caption,command

C:\> reg query [\\<IP>\]HKLM\Software\Microsoft\Windows\CurrentVersion\Run

C:\> reg query [\\<IP>\]HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce

C:\> reg query [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Run

C:\> reg query [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce
```

## 02 - Powershell

Discover startup services

```
PS C:\> Get-ChildItem "C:\Users\All Users\Start Menu\Programs\Startup"

PS C:\> Get-ChildItem "C:\Users\<username>\Start Menu\Programs\Startup"

PS C:\> Get-ChildItem "\\<IP>\C$\Users\<username>\Start Menu\Programs\Startup"

PS C:\> Get-CimInstance Win32_StartupCommand | Select-Object Name, Command, Location, User | Format-List

PS C:\> Get-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run'

PS C:\> Get-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce'

PS C:\> Get-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run'

PS C:\> Get-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce'
```

---
## References

- [Hacking Articles: Post Exploitation Using WMIC (System Command)](https://www.hackingarticles.in/post-exploitation-using-wmic-system-command/)

- [Steflan Security: Windows Privilege Escalation Weak Permission](https://steflan-security.com/windows-privilege-escalation-weak-permission/)