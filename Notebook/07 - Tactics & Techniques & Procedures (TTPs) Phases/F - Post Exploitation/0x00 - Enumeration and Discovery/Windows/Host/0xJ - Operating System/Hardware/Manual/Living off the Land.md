# Living off the Land

## 01 - Command Prompt

### 1.1 - Hardware Information

#### 1.1.1 - Hostname

```
C:\> hostname.exe

C:\> echo %COMPUTERNAME%
```

#### 1.1.2 - Date and Time

```
C:\> date.exe /T

C:\> time.exe /T

C:\> tzutil.exe /g

C:\> net.exe time [\\<IP>]
```

#### 1.1.3 - Mounted Drives

Enumerate for mounted and unmounted drives

```
C:\> mountvol.exe

C:\> vol.exe

C:\> fsutil.exe fsInfo drives
```

> [!INFO] Elevated Privileges is Required
> Must be with elevated privileges when running `fsutil.exe`.

```
C:\> fsutil.exe fsinfo drives
```

#### 1.1.4 - MAC Addresses

```
C:\> getmac.exe /v
```

#### 1.1.5 - Central Processing Unit (CPU)

```
C:\> echo %PROCESSOR_ARCHITECTURE%

C:\> echo %NUMBER_OF_PROCESSORS%
```

### 1.2 - User Activity

#### 1.2.1 - IDLE Time

```
C:\> quser.exe [/server:<IP>]

C:\> query.exe user <username> [/server:<IP>]
```

## 02 - Powershell

### 2.1 - Hardware Information

#### 2.1.1 - Hostname

Computer name.

```
PS C:\> Get-ComputerInfo -Property CSName

PS C:\> $Env:COMPUTERNAME

PS C:\> [System.Environment]::MachineName

PS C:\> [System.Net.Dns]::GetHostName()
```

#### 2.1.2 - Date and Time

Retrieve time

```
PS C:\> Get-Date

PS C:\> Invoke-Command -ComputerName <IP> -ScriptBlock { Get-Date }
```

#### 2.1.3 - Mounted Drives

Display mounted drives.

```
PS C:\> Get-PSDrive

PS C:\> Get-PSDrive | Where-Object {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"} | Format-Table Name, Root
```

#### 2.1.4 - MAC Addresses

Basic hardware information

```
PS C:\> Get-NetAdapter
```

#### 2.1.5 - Central Processing Unit (CPU)

```
PS C:\> $Env:PROCESSOR_ARCHITECTURE

PS C:\> $Env:NUMBER_OF_PROCESSORS
```

---
## References

- [LOFLCAB: quser](https://lofl-project.github.io/loflcab/Binaries/quser/)

- [LOFLCAB: Get-NetAdapter](https://lofl-project.github.io/loflcab/Cmdlets/Get-NetAdapter/)

- [Hacking Articles: Post Exploitation Using WMIC (System Command)](https://www.hackingarticles.in/post-exploitation-using-wmic-system-command/)

- [Powershell Guide Get CimInstance and Get WMIObject](https://www.pdq.com/blog/powershell-guide-get-ciminstance-and-get-wmiobject/)

- [20 Useful WMIC Command Examples in Windows Cheatsheet](https://www.cyberithub.com/20-useful-wmic-command-examples-in-windows-cheat-sheet/)

- [13cubed: Windows Registry Cheat Sheet](https://13cubed.s3.amazonaws.com/downloads/windows_registry_cheat_sheet.pdf)