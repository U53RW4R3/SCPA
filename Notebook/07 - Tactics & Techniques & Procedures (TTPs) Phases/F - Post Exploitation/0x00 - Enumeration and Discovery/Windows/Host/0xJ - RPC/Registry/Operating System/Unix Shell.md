---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - staying-off-the-land
  - networking
  - network-protocols
  - msrpc
  - windows
---
# Unix Shell

## 01 - `net`

### 1.1 - Kernel

```
$ net rpc registry getvalue "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" ProductName -U "<username>%<password>" -S <IP>
```

### 1.2 - Hardware Information

#### 1.2.1 - Hostname

```
$ net rpc registry enumerate "HKLM\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName" -U "<username>%<password>" -S <IP>

$ net rpc registry getvalue "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters" Hostname -U "<username>%<password>" -S <IP>
```

#### 1.2.2 - Date and Time

```
$ net rpc registry enumerate "HKLM\SYSTEM\CurrentControlSet\Control\TimeZoneInformation" -U "<username>%<password>" -S <IP>
```
#### 1.2.3 - Mounted Drives

```

```

#### 1.2.4 - CPU

Retrieving the number of CPU cores and threads.

```
$ net rpc registry getvalue "HKLM\HARDWARE\DESCRIPTION\System\CentralProcessor" ProcessNameString -U "<username>%<password>" -S <IP>
```

## 02 - `regshell`

### 2.1 - Kernel

```
$ regshell -U "<domain>/<username>%<password>" -R <IP>

$ regshell -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -R <IP>

\> predef HKEY_LOCAL_MACHINE
ck "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion"
print ProductName

$ net rpc registry getvalue "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" ProductName -U "<username>%<password>" -S <IP>
```

### 2.2 - Hardware Information

#### 2.2.1 - Hostname

```
\> predef HKEY_LOCAL_MACHINE
ck "SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
print Hostname
```

#### 2.2.2 - Date and Time

```
\> predef HKEY_LOCAL_MACHINE
ck "SYSTEM\CurrentControlSet\Services\Tcpip\Parameters"
print Hostname

$ net rpc registry enumerate "HKLM\SYSTEM\CurrentControlSet\Control\TimeZoneInformation" -U "<username>%<password>" -S <IP>
```
#### 2.2.3 - Mounted Drives

```
\> predef HKEY_LOCAL_MACHINE
ck "SYSTEM\CurrentControlSet\Control\TimeZoneInformation"
print ProcessNameString
```

## 03 - Impacket

### 3.1 - Kernel

```
$ reg.py [<domain>/]<username>:"<password>"@<IP> query -keyName "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" -v ProductName
```

### 3.2 - Hardware Information

#### 3.2.1 - Hostname

```
$ net rpc registry enumerate "HKLM\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName" -U "<username>%<password>" -S <IP>

$ net rpc registry getvalue "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters" Hostname -U "<username>%<password>" -S <IP>
```

#### 3.2.2 - Date and Time

```
$ net rpc registry enumerate "HKLM\SYSTEM\CurrentControlSet\Control\TimeZoneInformation" -U "<username>%<password>" -S <IP>
```

#### 3.2.3 - Mounted Drives

Check if there are external USB drives history activity to the workstation. This will provide leverage to insert malware to spread the infection or possibly to exfiltrate data.

```
$ reg.py [<domain>/]<username>:"<password>"@<IP> query -keyName "HKLM" -v some

$ reg.py [<domain>/]<username>@<IP> -hashes :<nt_hash> query -keyName "HKLM" -v something
```

#### 3.2.4 - CPU

```
$ reg.py [<domain>/]<username>@<IP> -hashes :<nt_hash> query -keyName "HKLM\HARDWARE\DESCRIPTION\System\CentralProcessor" -v ProcessNameString
```