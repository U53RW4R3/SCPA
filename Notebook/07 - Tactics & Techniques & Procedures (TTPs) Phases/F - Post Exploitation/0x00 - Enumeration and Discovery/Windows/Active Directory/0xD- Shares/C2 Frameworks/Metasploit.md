# Metasploit

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #active-directory #metasploit-framework #windows

## 01 - Modules

### 1.1 - SMB Network Protocol

```
msf > use auxiliary/scanner/smb/smb_enumshares

msf auxiliary(scanner/smb/smb_enumshares) > options

Module options (auxiliary/scanner/smb/smb_enumshares):

   Name            Current Setting  Required  Description
   ----            ---------------  --------  -----------
   LogSpider       3                no        0 = disabled, 1 = CSV, 2 = table (txt), 3 = one liner (txt) (Accepted: 0, 1, 2, 3)
   MaxDepth        999              yes       Max number of subdirectories to spider
   RHOSTS                           yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   SMBDomain       .                no        The Windows domain to use for authentication
   SMBPass                          no        The password for the specified username
   SMBUser                          no        The username to authenticate as
   ShowFiles       false            yes       Show detailed information when spidering
   SpiderProfiles  true             no        Spider only user profiles when share is a disk share
   SpiderShares    false            no        Spider shares recursively
   THREADS         1                yes       The number of concurrent threads (max one per host)

msf auxiliary(scanner/smb/smb_enumshares) > set smbuser <username>

msf auxiliary(scanner/smb/smb_enumshares) > set smbpass <password | aad3b435b51404eeaad3b435b51404ee:<nt_hash>>

msf auxiliary(scanner/smb/smb_enumshares) > set rhosts <IP>

msf auxiliary(scanner/smb/smb_enumshares) > set smbdomain [<domain>]

msf auxiliary(scanner/smb/smb_enumshares) > set showfiles <true | false>

msf auxiliary(scanner/smb/smb_enumshares) > set spidershares [true | false]

msf auxiliary(scanner/smb/smb_enumshares) > set threads 4

msf auxiliary(scanner/smb/smb_enumshares) > set logspider <0 | 1 | 2 | 3>

msf auxiliary(scanner/smb/smb_enumshares) > run
```

### 1.2 - SNMP Network Protocol

```
msf > use auxiliary/scanner/snmp/snmp_enumshares

msf auxiliary(scanner/snmp/snmp_enumshares) > options

Module options (auxiliary/scanner/snmp/snmp_enumshares):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   COMMUNITY  public           yes       SNMP Community String
   RETRIES    1                yes       SNMP Retries
   RHOSTS                      yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT      161              yes       The target port (UDP)
   THREADS    1                yes       The number of concurrent threads (max one per host)
   TIMEOUT    1                yes       SNMP Timeout
   VERSION    1                yes       SNMP Version <1/2c>

msf auxiliary(scanner/snmp/snmp_enumshares) > set community <password>

msf auxiliary(scanner/snmp/snmp_enumshares) > set version <1 | 2c>

msf auxiliary(scanner/snmp/snmp_enumshares) > set rhosts <target_IP>

msf auxiliary(scanner/snmp/snmp_enumshares) > set rport <target_PORT>

msf auxiliary(scanner/snmp/snmp_enumshares) > run
```

### 1.3 - Interactive Shell

```
meterpreter > run post/windows/gather/enum_shares

meterpreter > run enum_shares
```