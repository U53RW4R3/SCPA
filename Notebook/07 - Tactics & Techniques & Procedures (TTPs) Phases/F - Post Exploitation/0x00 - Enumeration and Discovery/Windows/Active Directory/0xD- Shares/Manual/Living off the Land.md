# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #active-directory #living-off-the-land #windows

## 1.1 - Command Prompt

Get a list of locally shared drives.

```
C:\> net share

C:\> net config workstation

C:\> net config server

C:\> wmic [/node:<IP>] [/user:<username> /password:<password>] share get /all
```

Remotely view net shares.

```
C:\> net view [\\<IP>]

C:\> net view [\\<IP>] /all

C:\> net view [\\<IP>] /all /domain
```

## 1.2 - Powershell

Get a list of locally shared drives.

```
PS C:\> Get-SmbShare

PS C:\> Get-SmbConnection

PS C:\> Get-WmiObject -ClassName Win32_Share -ComputerName <IP>

PS C:\> Get-WmiObject -ClassName Win32_Share -namespace "root\CIMV2" -ComputerName <IP>

PS C:\> Get-CimInstance -ClassName Win32_Share -ComputerName <IP>

PS C:\> Get-CimInstance -ClassName Win32_Share -namespace "root\CIMV2" -ComputerName <IP>
```

---
## References

- [LOFLCAB: net.exe](https://lofl-project.github.io/loflcab/Binaries/net/)

- [r00t-3xp10it: CmdLine Scripts for Reverse TCP Shell Addicts](https://github.com/r00t-3xp10it/venom/wiki/CmdLine-%26-Scripts-for-reverse-TCP-shell-addicts)