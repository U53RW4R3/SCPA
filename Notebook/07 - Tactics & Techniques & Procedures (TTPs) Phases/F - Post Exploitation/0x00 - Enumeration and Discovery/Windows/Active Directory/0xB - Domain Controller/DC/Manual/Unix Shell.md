# Unix Shell

Search Tag(s): #post-exploitation #enumeration-and-discovery #active-directory #network-protocols #msrpc #smb #staying-off-the-land #windows

## 01 - MSRPC Network Protocol

### 1.1 - `rpcclient`

TODO: Fill this info

- Domain Information

```
rpcclient $> querydominfo

rpcclient $> enumdomains
```

- Retrieve Domain SID

```
rpcclient $> lookupdomain <domain>
```

### 1.2 - Impacket

Authentication syntax

```
$ wmiquery.py <domain>/<username>:<password>@<IP>

$ wmiquery.py <domain>/<username>@<IP> -hashes :<nt_hash>
```

Enumerate domains.

```
WQL> SELECT domaincontrolleraddress,domainname,roles FROM NtDomain
```

## 02 - SMB Network Protocol

### 1.2 - `netexec`

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --wmi "SELECT domaincontrolleraddress,domainname,roles FROM NtDomain"
```

## 03 - RDP Network Protocol

```
$ nmap -p 3389 -Pn -sV --script rdp-ntlm-info <IP>
```