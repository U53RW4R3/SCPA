---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - networking
  - network-protocols
  - msrpc
  - smb
  - rdp
  - telnet
  - smtp
  - network-mapper
  - windows
---
# Network Mapper

## 01 - Enumerate Domain Controller

### 1.1 - MSRPC Port

```
$ sudo nmap -Pn -p U:137,T:139 -sU -sS --script smb-enum-domains <IP>
```

^607221

### 1.2 - SMB Port

```
$ nmap -p 445 -Pn --script smb-enum-domains <IP>
```

^1606ea

### 1.3 - LDAP Port

Enumerate LDAP root **DSA-specific Entry (DSE)**.

```
$ nmap -p 389 --script ldap-rootdse <IP>
```

## 02 - NTLM Information

### 2.1 - RDP Port

```
$ nmap -p 3389 -Pn -sV --script rdp-ntlm-info <IP>
```

### 2.2 - Telnet Port

```
$ nmap -p 23 -n -sV -Pn --script telnet-ntlm-info <IP>
```

### 2.3 - SMTP Port

```
$ nmap -p 587 -Pn --script smtp-ntlm-info <IP>
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Enumeration/Cross Platform/Mail Server/SMTP|Manual: SMTP Active Enumeration]]

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Enumeration/Cross Platform/Remote Services/Graphical Remote Program/RDP|Manual: RDP Active Enumeration]]

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Enumeration/Cross Platform/Remote Services/Telnet|Manual: Telnet Active Enumeration]]

### Network Mapper

- [Network Mapper NSEDocs: smb-enum-domains Script](https://nmap.org/nsedoc/scripts/smb-enum-domains.html)