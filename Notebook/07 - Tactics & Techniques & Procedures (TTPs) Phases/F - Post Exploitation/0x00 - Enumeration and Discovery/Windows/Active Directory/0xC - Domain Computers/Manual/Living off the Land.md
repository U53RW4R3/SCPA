# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #active-directory #living-off-the-land #windows

## 01 - NETBIOS

### 1.1 - Command Prompt

Enumerate hosts.

```
C:\> net.exe view

C:\> net.exe view /domain

C:\> net.exe view /domain:%userdomain%

C:\> net.exe view /domain:<domain>

C:\> net.exe group "Domain Computers" /domain
```

Enumerate **domain controllers**.

```
C:\> net.exe group "Domain Controllers" /domain
```

NetBIOS IP Addresses

```
C:\> nslookup.exe <IP>

C:\> ping.exe -n 1 <IP>

C:\> nbtstat.exe -c

C:\> nbtstat.exe -a <ComputerName>

C:\> nbtstat.exe -A <IP>
```

## 02 - Powershell

TODO: Convert the commands to powershell cmdlets

Enumerate **domain controllers**.

```
PS C:\> [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().DomainControllers 
```

NetBIOS IP Address

```
PS C:\> Test-Connection -Count 1 -ComputerName <IP>
```

---
## References

- [LOFLCAB: net.exe](https://lofl-project.github.io/loflcab/Binaries/net/)

- [LOFLCAB: nslookup.exe](https://lofl-project.github.io/loflcab/Binaries/nslookup/)