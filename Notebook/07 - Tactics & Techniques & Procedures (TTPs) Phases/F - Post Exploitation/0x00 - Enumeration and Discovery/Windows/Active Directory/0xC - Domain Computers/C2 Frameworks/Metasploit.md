# Metasploit

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #active-directory #metasploit-framework #windows

## 01 - NETBIOS

```
meterpreter > run post/windows/gather/enum_computers
```

TODO: Check this module

```
meterpreter > run post/windows/gather/enum_ad_computers
```

## 02 - DNS Resolve Computer Names

### 2.1 - Meterpreter API

Resolve DNS

```
meterpreter > resolve <computer_name_1> <computer_name_n> [-f <IPv4 | IPv6>]

meterpreter > resolve 10.0.2.3

Host resolutions
================

    Hostname  IP Address
    --------  ----------
    10.0.2.3  10.0.2.3
```

### 2.2 - Post Module

```
msf > use post/multi/gather/resolve_hosts ai_family=<ipv4 | ipv6> hostfile=/path/to/dnshosts.txt

msf post(multi/gather/resolve_hosts) > set ai_family <ipv4 | ipv6>

msf post(multi/gather/resolve_hosts) > set hostnames <computer_name_1>,<computer_name_n>

msf post(multi/gather/resolve_hosts) > run
```

One-liner `meterpreter` command.

```
meterpreter > run post/multi/gather/resolve_hosts ai_family=<ipv4 | ipv6> hostfile=/path/to/dnshosts.txt
```