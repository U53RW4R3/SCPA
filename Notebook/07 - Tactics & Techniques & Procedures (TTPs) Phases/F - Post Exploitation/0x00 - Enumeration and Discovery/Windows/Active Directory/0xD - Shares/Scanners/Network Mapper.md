---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - networking
  - port-scanners
  - network-mapper
  - windows
---
# Network Mapper

Authentication

```
$ nmap -p 445 -Pn --script smb-enum-shares,smb-ls --script-args "smbuser='<username>',smbpassword='<password>'" <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-shares,smb-ls --script-args "smbuser='<username>',smpassword='<password>'" <IP>
```

Pass the hash

```
$ nmap -p 445 -Pn --script smb-enum-shares,smb-ls --script-args "smbuser='<username>',smbhash='<nt_hash>'" <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-shares,smb-ls --script-args "smbuser='<username>',smbhash='<nt_hash>'" <IP>
```