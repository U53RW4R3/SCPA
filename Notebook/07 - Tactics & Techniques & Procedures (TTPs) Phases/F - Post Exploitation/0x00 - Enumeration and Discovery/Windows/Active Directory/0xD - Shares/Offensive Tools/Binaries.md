---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - networking
  - offensive-tools
  - windows
---
# Binaries

## 01 - [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x02 - Privilege Escalation/Windows/Auditing Tools/Local Privilege Escalation/Offensive Tools/Binaries/Seatbelt|Seatbelt]]

```
C:\> .\Seatbelt.exe NetworkShares [-computername=<IP> | <computername.domain.tld>] [-username=<DOMAIN>\<username> -password=<password>]
```

## 02 - SharpShares

### 2.1 - Setup

#### 2.1.1 - Download Pre-compiled Binary

Download the binary in command prompt.

```
C:\> CertUtil.exe -urlcache -split -f https://github.com/mitchmoser/SharpShares/releases/download/v2.4/SharpShares.exe SharpShares.exe

C:\> curl.exe -o SharpShares.exe https://github.com/mitchmoser/SharpShares/releases/download/v2.4/SharpShares.exe
```

Download the binary in PowerShell cmdlet.

```
PS C:\> Invoke-WebRequest -Uri https://github.com/mitchmoser/SharpShares/releases/download/v2.4/SharpShares.exe -OutFile SharpShares.exe
```

#### 2.1.2 - Compile

Install a targeting pack from this [link](https://dotnet.microsoft.com/en-us/download/dotnet-framework/net481).  Then compile `SharpShares`.

```
C:\> git clone https://github.com/mitchmoser/SharpShares.git

C:\> cd SharpShares

C:\SharpShares> dotnet build -c Release -p:TargetFrameworkVersion=v4.8.1
```

### 2.2 - Help Menu

```
C:\> .\SharpShares.exe help

Usage:
    SharpShares.exe /threads:50 /ldap:servers /ou:"OU=Special Servers,DC=example,DC=local" /filter:SYSVOL,NETLOGON,IPC$,PRINT$ /verbose /outfile:C:\path\to\file.txt

Optional Arguments:
    /threads  - specify maximum number of parallel threads  (default=25)
    /dc       - specify domain controller to query (if not ran on a domain-joined host)
    /domain   - specify domain name (if not ran on a domain-joined host)
    /ldap     - query hosts from the following LDAP filters (default=all)
         :all - All enabled computers with 'primary' group 'Domain Computers'
         :dc  - All enabled Domain Controllers (not read-only DCs)
         :exclude-dc - All enabled computers that are not Domain Controllers or read-only DCs
         :servers - All enabled servers
         :servers-exclude-dc - All enabled servers excluding Domain Controllers or read-only DCs
    /ou       - specify LDAP OU to query enabled computer objects from
                ex: "OU=Special Servers,DC=example,DC=local"
    /stealth  - list share names without performing read/write access checks
    /filter   - list of comma-separated shares to exclude from enumeration
                default: SYSVOL,NETLOGON,IPC$,PRINT$
    /outfile  - specify file for shares to be appended to instead of printing to std out
    /verbose  - return unauthorized shares
```

### 2.3 - Usage

TODO: Cover more about this tool's usage

```
C:\> .\SharpShares.exe /threads:50
```

```
C:\> .\SharpShares.exe /verbose
```

```
C:\> .\SharpShares.exe /stealth
```

```
C:\> .\SharpShares.exe /filter:SYSVOL,NETLOGON,IPC$,PRINT$,<share_name>
```

```
C:\> .\SharpShares.exe /dc:<domain_controller_IP>
```

```
C:\> .\SharpShares.exe /domain:<domain>
```

```
C:\> .\SharpShares.exe /ldap:all /ou:"OU=<organizational_unit>,[DC=<subdomain>,]DC=<domain>,DC=<tld>"
```

```
C:\> .\SharpShares.exe /ldap:dc /ou:"OU=<organizational_unit>,[DC=<subdomain>,]DC=<domain>,DC=<tld>"
```

```
C:\> .\SharpShares.exe /ldap:exclude-dc /ou:"OU=<organizational_unit>,[DC=<subdomain>,]DC=<domain>,DC=<tld>"
```

```
C:\> .\SharpShares.exe /ldap:servers /ou:"OU=<organizational_unit>,[DC=<subdomain>,]DC=<domain>,DC=<tld>"
```

```
C:\> .\SharpShares.exe /ldap:servers-exclude-dc /ou:"OU=<organizational_unit>,[DC=<subdomain>,]DC=<domain>,DC=<tld>"
```

```
C:\> .\SharpShares.exe /outfile:C:\path\to\file.txt
```

---
## References

- [SharpShares](https://github.com/mitchmoser/SharpShares)