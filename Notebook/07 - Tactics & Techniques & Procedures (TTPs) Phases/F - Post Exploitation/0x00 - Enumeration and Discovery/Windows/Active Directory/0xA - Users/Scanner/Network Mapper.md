# Network Mapper

Search Tag(s): #post-exploitation #enumeration-and-discovery #active-directory #networking #network-protocols #msrpc #smb #network-mapper #windows

## 01 - Enumerate user accounts

```
$ nmap -p 445 -Pn --script smb-enum-users --script-args "smbuser='<username>',smbpassword='<password>'" <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-users "smbuser='<username>',smbpassword='<password>'" <IP>
```

Pass the Hash

```
$ nmap -p 445 -Pn --script smb-enum-users --script-args "smbuser='<username>',smbhash='<nt_hash>' <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-users --script-args "smbuser='<username>',smbhash='<nt_hash>'" <IP>
```

TODO: Fill in the description to each NSE script.

```
$ nmap -p 445 -Pn --script smb-vuln-* --script-args unsafe=1 <IP>
```

```
$ nmap -p 445 -Pn --script smb-os-discovery --script-args unsafe=1 <IP>
```

```
$ nmap -p 445 -Pn --script smb-security-mode <IP>
```

```
$ nmap -p 445 -Pn --script smb2-security-mode,smb2-capabilities.nse <IP>
```

```
$ nmap -p 445 -Pn --script smb-server-stats <IP>
```

```
$ nmap -p 445 -Pn --script smb-system-info <IP>
```

```
$ nmap -p 445 -Pn --script smb-protocols <IP>
```