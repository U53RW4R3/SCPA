# PowerSploit

Search Tag(s): #post-exploitation #enumeration-and-discovery #active-directory #offensive-tools #windows

## 01 - PowerView

### 1.1 - Users

#### 1.1.1 - `Get-NetUser`

`adspath` which will print out the **GPP (Group Policy Object)** that uses the LDAP protocol. Especially the `description` object property that some sysadmins are intended to leave sensitive notes like passwords since they can't remember every credentials so they needed someone to store in case they forgot.

```
PS C:\> Get-NetUser | select cn, description, objectsid, adspath
```

Look for potential user accounts that have bad amount of weak passwords for a chance to breach it successfully (requires to connect the dots and some critical thinking to do I think).

```
PS C:\> Get-NetUser | Select-Object samaccountname, badpwdcount
```

Query a specific user account.

```
PS C:\> Get-NetUser -UserName <username>
```

#### 1.1.2 - `DomainUserLocation`

```
PS C:\> Find-DomainUserLocation

PS C:\> Invoke-UserHunter
```

Gather logged-on users.

```
PS C:\> Find-DomainUserLocation [-ComputerName <IP>] -UserName *
```

### 1.2 - Groups

#### 1.2.1 - `NetGroup`

Retrieve **group names**.

```
PS C:\> Get-NetLocalGroup [-ComputerName <IP>]
```

Retrieve information related to a specific **group name**.

```
PS C:\> Get-NetLocalGroupMember [-ComputerName <IP>] -Group <GroupName>
```

Displays list of all the groups in the domain controller.

```
PS C:\> Get-NetGroup
```

Enumerate groups in a active directory that is part of administrators.

```
PS C:\> Get-NetGroup -AdminCount
```

Enumerate a specific username in a active directory to display what privileges does the user have based of what member of.

```
PS C:\> Get-NetGroup -UserName <username>
```

Display the users that is part of the specific **group name**. In this example we want to find out which users have admin privileges.

```
PS C:\> Get-NetGroupMember -GroupName "Administators"

PS C:\> Get-NetGroupMember -GroupName "Domain Admins"

PS C:\> Get-NetGroupMember -GroupName "Enterprise Admins"

PS C:\> Get-NetGroup -GroupName *admin*
```

#### 1.2.2 - `DomainUserLocation`

```
PS C:\> Find-DomainUserLocation -ComputerFile .\hostnames.txt -GroupName "Administrators"

PS C:\> Find-DomainUserLocation -ComputerFile .\hostnames.txt -GroupName "Domain Admins"

PS C:\> Find-DomainUserLocation -ComputerFile .\hostnames.txt -GroupName "Enterprise Admins"

PS C:\> Find-DomainUserLocation -ComputerFile .\hostnames.txt -GroupName "*admin*"
```

### 1.3 - Group Policy Objects

Check for accounts that hasn't been changed their passwords for how long to coordinate with the current organization's date depending on the Group Policy's for changing passwords of how frequently.

```
PS C:\> Get-UserProperty -Properties pwdlastset
```

Identity which user accounts are active or suspiciously having high amount of logins that is humanly impossible that might be a honey pot.

```
PS C:\> Get-UserProperty -Properties logoncount
```

TODO: Re-arrange in the privilege escalation for **Impersonating Logged-on Users**

Retrieve active sessions of which users that is still interacting with the computer

```
PS C:\> Get-NetSession -ComputerName <IP>
```