# Living off the Land

## 01 - Command Prompt

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] path win32_groupuser where (groupcomponent="win32_group.name='domain admins', domain='<DOMAIN>'")
```

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] /namespace:\\root\directory\ldap path ds_user get ds_samaccountname
```

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] /namespace:\\root\directory\ldap path ds_group get ds_samaccountname
```

## 02 - Powershell

```
PS C:\> Get-CimInstance -ClassName Win32_UserInDomain | Format-Table -AutoSize

PS C:\> Get-CimInstance -Query "SELECT * FROM Win32_UserAccount WHERE LocalAccount=true" | Format-Table -AutoSize

PS C:\> Get-WmiObject -Query "SELECT * FROM Win32_UserAccount WHERE LocalAccount=true" | Format-Table -AutoSize
```