---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - networking
  - network-protocols
  - mysql
  - metasploit-framework
---
# Metasploit

## 01 - DBMS Version

```
msf > use auxiliary/admin/mysql/mysql_sql

msf auxiliary(admin/mysql/mysql_sql) > options

Module options (auxiliary/admin/mysql/mysql_sql):

   Name      Current Setting   Required  Description
   ----      ---------------   --------  -----------
   PASSWORD                    no        The password for the specified username
   RHOSTS                      yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT     3306              yes       The target port (TCP)
   SQL       select version()  yes       The SQL to execute.
   USERNAME                    no        The username to authenticate as

msf auxiliary(admin/mysql/mysql_sql) > set rhosts <IP>

msf auxiliary(admin/mysql/mysql_sql) > set sql SELECT VERSION()

msf auxiliary(admin/mysql/mysql_sql) > run username=<username> password=<password>
```

## 02 - Database Enumeration

### 2.1 - List Databases

```
msf > use auxiliary/admin/mysql/mysql_sql

msf auxiliary(admin/mysql/mysql_sql) > set rhosts <IP>

msf auxiliary(admin/mysql/mysql_sql) > set sql SHOW DATABASES

msf auxiliary(admin/mysql/mysql_sql) > run username=<username> password=<password>
```

### 2.2 - Schema

```
msf > use auxiliary/scanner/mysql/mysql_schemadump

msf auxiliary(scanner/mysql/mysql_schemadump) > options

Module options (auxiliary/scanner/mysql/mysql_schemadump):

   Name             Current Setting  Required  Description
   ----             ---------------  --------  -----------
   DISPLAY_RESULTS  true             yes       Display the Results to the Screen
   PASSWORD                          no        The password for the specified username
   RHOSTS                            yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT            3306             yes       The target port (TCP)
   THREADS          1                yes       The number of concurrent threads (max one per host)
   USERNAME                          no        The username to authenticate as

msf auxiliary(scanner/mysql/mysql_schemadump) > set rhosts <IP>

msf auxiliary(scanner/mysql/mysql_schemadump) > set threads 8

msf auxiliary(scanner/mysql/mysql_schemadump) > run username=<username> password=<password>
```

## 03 - Enumerate Instance

```
msf > use auxiliary/admin/mysql/mysql_enum

msf auxiliary(admin/mysql/mysql_enum) > options

Module options (auxiliary/admin/mysql/mysql_enum):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD                   no        The password for the specified username
   RHOSTS                     yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT     3306             yes       The target port (TCP)
   USERNAME                   no        The username to authenticate as

msf auxiliary(admin/mysql/mysql_enum) > set rhosts <IP>

msf auxiliary(admin/mysql/mysql_enum) > run username=<username> password=<password>
```

^7426c9

## 04 - Writable Directory

```
msf > use auxiliary/scanner/mysql/mysql_writable_dirs

msf auxiliary(scanner/mysql/mysql_writable_dirs) > options

Module options (auxiliary/scanner/mysql/mysql_writable_dirs):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   DIR_LIST                    yes       List of directories to test
   FILE_NAME  vDXcsdmE         yes       Name of file to write
   PASSWORD                    no        The password for the specified username
   RHOSTS                      yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT      3306             yes       The target port (TCP)
   THREADS    1                yes       The number of concurrent threads (max one per host)
   USERNAME   root             yes       The username to authenticate as

msf auxiliary(scanner/mysql/mysql_writable_dirs) > set rhosts <IP>

msf auxiliary(scanner/mysql/mysql_writable_dirs) > set file_name <file>

msf auxiliary(scanner/mysql/mysql_writable_dirs) > set threads 4

msf auxiliary(scanner/mysql/mysql_writable_dirs) > set dir_list </path/to/directory//>

msf auxiliary(scanner/mysql/mysql_writable_dirs) > run username=<username> password=<password>
```

## 05 - Enumerate Files

```
msf > use auxiliary/scanner/mysql/mysql_file_enum

msf auxiliary(scanner/mysql/mysql_file_enum) > options

Module options (auxiliary/scanner/mysql/mysql_file_enum):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   DATABASE_NAME  mysql            yes       Name of database to use
   FILE_LIST                       yes       List of directories to enumerate
   PASSWORD                        no        The password for the specified username
   RHOSTS                          yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT          3306             yes       The target port (TCP)
   TABLE_NAME     seWmJUSI         yes       Name of table to use - Warning, if the table already exists its contents will be corrupted
   THREADS        1                yes       The number of concurrent threads (max one per host)
   USERNAME       root             yes       The username to authenticate as

msf auxiliary(scanner/mysql/mysql_file_enum) > set rhosts <IP>

msf auxiliary(scanner/mysql/mysql_file_enum) > set database_name <database>

msf auxiliary(scanner/mysql/mysql_file_enum) > set table_name <table>

msf auxiliary(scanner/mysql/mysql_file_enum) > set file_list </usr/share/metasplot-framework/data/wordlists/sensitive_files.txt | /opt/metasploit/data/wordlists/sensitive_files.txt>

msf auxiliary(scanner/mysql/mysql_file_enum) > run username=<username> password=<password>
```

---
## References

- [Metasploit Unleashed: Admin MySQL Auxiliary Modules](https://www.offensive-security.com/metasploit-unleashed/admin-mysql-auxiliary-modules/)

- [Yeahhub: MySQL Pentesting Metasploit Framework](https://www.yeahhub.com/mysql-pentesting-metasploit-framework/)