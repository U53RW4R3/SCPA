# Metasploit

With internal recon of the compromised machine with least privileges you've probably discovered in this [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Linux/Host/0xA - Users/C2 Frameworks/Metasploit|section]]. Look more info on [GTFOBins](https://gtfobins.github.io). Depending on the command that contains a format looks like:

## Post Module

> [!NOTE]
> You can execute this module if you're interacting with [[05 - Red Team Infrastructure/B - Command and Control/0x00 - Metasploit/Interactive Shell/Meta Shell/Usage|Command Shell]] session.

```
msf > use post/multi/recon/sudo_commands

msf post(multi/recon/sudo_commands) > options 

Module options (post/multi/recon/sudo_commands):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD                    no        Password for the current user
   SESSION                     yes       The session to run this module on
   SUDO_PATH  /usr/bin/sudo    yes       Path to sudo executable


View the full module info with the info, or info -d command.

msf post(multi/recon/sudo_commands) > set sudo_path /path/to/sudo

msf post(multi/recon/sudo_commands) > set password [password]

msf post(multi/recon/sudo_commands) > set session <session_ID>

msf post(multi/recon/sudo_commands) > run
```

## Usage

```
meterpreter > run post/multi/recon/sudo_commands

[+] /usr/bin/find matches known privesc executable 'find' !
[+] /usr/bin/nano matches known privesc executable 'nano' !
[+] /usr/bin/vim matches known privesc executable 'vim' !
[+] /usr/bin/man matches known privesc executable 'man' !
[+] /usr/bin/awk matches known privesc executable 'awk' !
[+] /usr/bin/less matches known privesc executable 'less' !
[+] /usr/bin/ftp matches known privesc executable 'ftp' !
[+] /usr/bin/nmap matches known privesc executable 'nmap' !
[+] /bin/more matches known privesc executable 'more' !

Sudo Commands
=============

  Command            RunAsUsers  RunAsGroups  Password?  Privesc?
  -------            ----------  -----------  ---------  --------
  /bin/more          root                                True
  /usr/bin/awk       root                                True
  /usr/bin/find      root                                True
  /usr/bin/ftp       root                                True
  /usr/bin/less      root                                True
  /usr/bin/man       root                                True
  /usr/bin/nano      root                                True
  /usr/bin/nmap      root                                True
  /usr/bin/vim       root                                True
  /usr/sbin/apache2  root
  /usr/sbin/iftop    root

[+] Output stored in: /root/.msf4/loot/20220523174649_default_10.10.140.168_sudo.commands_049317.txt
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x02 - Privilege Escalation/Linux/Local Privilege Escalation/Superuser/Sudo/Shell Escape Sequences/Enumeration/Living off the Land]]