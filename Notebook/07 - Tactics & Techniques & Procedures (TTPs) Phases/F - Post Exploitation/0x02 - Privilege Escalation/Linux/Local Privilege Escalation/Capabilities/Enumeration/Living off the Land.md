# Living off the Land

Capabilities main purpose is to resemble by managing privileges. In addition, in the kernel level it has split into different categories for probable privileged kernel calls up into groups that shares functionality. If the system administrator has carelessly or accidentally configured it poorly. An attacker will take an advantage by elevating it. Keep on a eye out on **`cap_setuid+ep`**

```
$ getcap -r / 2>/dev/null
```

Check on [GTFOBins](https://gtfobins.github.io/) depending on what binary that has **capabilities** privileges that you're looking for to exploit the misconfigured kernel privileges. Here's an example of what the output may contain:

```
$ getcap -r / 2>/dev/null
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep
/usr/bin/traceroute6.iputils = cap_net_raw+ep
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/bin/ping = cap_net_raw+ep
/home/karen/vim = cap_setuid+ep
/home/ubuntu/view = cap_setuid+ep
```

---
## References

### Hacktricks

- [Hacktricks: Privilege Escalation](https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html)

### Hacking Articles

- [Hacking Articles: Linux Privilege Escalation Using Capabilities](https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/)