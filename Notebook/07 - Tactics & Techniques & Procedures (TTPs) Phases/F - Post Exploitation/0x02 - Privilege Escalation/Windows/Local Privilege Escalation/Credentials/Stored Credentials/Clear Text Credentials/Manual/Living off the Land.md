# Manual

## 01 - Command Prompt

TODO: Provide more information to gather stored passwords

Search for cleartext credentials

```
C:\> findstr.exe /si password *.txt *.ini *.vbs *.cmd *.ps1 *.bat *.xml *.inf *.eml

C:\> findstr.exe /si passw *.txt *.ini *.vbs *.cmd *.ps1 *.bat *.xml *.inf *.eml
```

Find all those strings in config files

```
C:\> dir /s *pass* == *cred* == *vnc* == *.config* 2>nul

C:\> dir /s /b *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config* == *.bkp == *.bak == *.backup 2>nul

C:\> where.exe /r C:\ user.txt

C:\> where.exe /r C:\ *.ini

C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] datafile where "drive='C:\\' AND name like '%password%'" get name,readable,size /value
```

Find all passwords in all files

```
C:\> findstr.exe /spin "password" *.*
```

## 02 - PowerShell

Search for cleartext credentials

```
PS C:\> Get-ChildItem -Path C:\ -Include *.config -Recurse | Select-String -Pattern 'password='

PS C:\> Get-ChildItem -Path C:\ -File -Recurse -ErrorAction SilentyContinue | ? {$_.Name -eq "*.txt" -or $_.Name -eq "*.pdf" -or $_.Name -eq "*.ini" -or $_.Name -eq "*.bkp" -or $_.Name -eq "*.bak" -or $_.Name -eq "*.backup"}
```

Find all those strings in config files

```
PS C:\> Get-Childitem -Path C:\Users\ -Include *password*,*vnc*,*.config -File -Recurse -ErrorAction SilentlyContinue

PS C:\> Get-ChildItem -Path C:\ -Include *unattend*,*sysprep* -File -Recurse -ErrorAction SilentyContinue | Where-Object {($_.Name -like "*.xml" -or $_.Name -like "*.txt" or $_.Name -like "*.ini")}
```

Dumping credentials from scheduled tasks

```
PS C:\> Get-ScheduledTask | Where-Object {$_.Principal.UserId -notlike 'S-1-5-18'} | Select-Object TaskName,
TaskPath, Principal
```

---
## References

### LOFLCAB

- [LOFLCAB: Get-ChildItem](https://lofl-project.github.io/loflcab/Cmdlets/Get-ChildItem/)

### Pentestlab

- [Pentestlab Blog: Stored Credentials](https://pentestlab.blog/2017/04/19/stored-credentials/)

### Internal All The Things

- [Internal All The Things: Windows Privilege Escalation](https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/windows-privilege-escalation/)