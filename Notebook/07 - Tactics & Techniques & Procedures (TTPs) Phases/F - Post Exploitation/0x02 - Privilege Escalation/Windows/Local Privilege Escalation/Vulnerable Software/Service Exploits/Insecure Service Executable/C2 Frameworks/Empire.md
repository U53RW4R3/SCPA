# Empire

## 01 - Detect

```
..[omitted]..
+------+------------------------------------------------+------+
| TEST | SERVICES > Binary Permissions                  | VULN |
+------+------------------------------------------------+------+
| DESC | List all services and check whether the current user  |
|      | can modify the target executable or write files in    |
|      | its parent folder.                                    |
+------+-------------------------------------------------------+
[*] Found 1 result(s).


Name              : filepermsvc
ImagePath         : "C:\Program Files\File Permissions Service\filepermservice.exe"
User              : LocalSystem
ModifiablePath    : C:\Program Files\File Permissions Service\filepermservice.exe
IdentityReference : Everyone
Permissions       : {WriteOwner, Delete, WriteAttributes, Synchronize...}
Status            : Stopped
UserCanStart      : True
UserCanRestart    : True
..[omitted]..
```

```
(Empire: AGP2TYXU) > usemodule powershell/privesc/powerup/allchecks
[*] Set Agent to AGP2TYXU
..[omitted]..
(Empire: usemodule/powershell/privesc/powerup/allchecks) > execute
[*] Tasked AGP2TYXU to run Task 2
Job started: HUYKAL
[*] Task 2 results received

[*] Running Invoke-AllChecks
..[omitted]..

[*] Checking service executable and argument permissions...


ServiceName                     : filepermsvc
Path                            : "C:\Program Files\File Permissions Service\filepermservice.exe"
ModifiableFile                  : C:\Program Files\File Permissions Service\filepermservice.exe
ModifiableFilePermissions       : {WriteOwner, Delete, WriteAttributes, Synchronize...}
ModifiableFileIdentityReference : Everyone
StartName                       : LocalSystem
AbuseFunction                   : Install-ServiceBinary -Name 'filepermsvc'
CanRestart                      : True
```