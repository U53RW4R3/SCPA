---
author(s):
  - Userware
tags:
  - initial-access
  - exploits
  - network-protocols
  - windows
  - linux
---
# FreeRDP

## 01 - OPSEC Consideration

Change your Linux hostname to the same target workstation to spoof the event logs.

![[Change Hostname#^09eb5b]]

Then apply changes.

![[Change Hostname#^153cb6]]

## 02 - Authenticate RDP

Choose keyboard layout that is familiar to you and then specify the `/kbd:0x<layout_id>` or `/kbd:US` flag.

```
$ xfreerdp /kbd-list
```

Fullscreen (the shortcut is `CTRL + ALT + Enter`) to toggle it.

```
$ xfreerdp /f
```

Drag resolution screen

```
$ xfreerdp /dynamic-resolution
```

Force specific protocol security. Older operating systems specify `/sec:rdp` and for modern operating system specify `/sec:tls` or `/sec:nla`.

```
$ xfreerdp /sec:<rdp | tls | nla>
```

Ignore certification

```
$ xfreerdp /cert:ignore
```

Reuse passwords

```
$ xfreerdp /kbd:US /clipboard /compression /dynamic-resolution /sec:<rdp | tls | nla> /u:"<username>" /d:"<domain>" /p:"<password>" /v:<IP> [/port:<PORT>]

$ xfreerdp /kbd:US /clipboard /compression /dynamic-resolution /sec:<rdp | tls | nla> /u:"[<domain>\]<username>" /p:"<password>" /v:<IP>:[<PORT>]
```

Pass the Hash

```
$ xfreerdp /kbd:US /clipboard /compression /dynamic-resolution /sec:<rdp | tls | nla> /u:"<username>" /d:"<domain>" /pth:<nt_hash> /v:<IP> [/port:<PORT>]

$ xfreerdp /kbd:US /clipboard /compression /dynamic-resolution /sec:<rdp | tls | nla> /u:"[<domain>\]<username>" /pth:<nt_hash> /v:<IP>:[<PORT>]
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/B - Vulnerability Assessment/04 - Vulnerable Network Ports/Remote Services/TODO Sort it/Graphical Remote Program/RDP|Vulnerability Assessment: RDP]]

- [[07 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x00 - Exploitation/0xF - Remote Services Exploitation/Network Ports/Remote Services/Graphical Remote Program/RemoteKeyStrokes|Initial Access: RemoteKeyStrokes]]

### Github

- [awakecoding: FreeRDP User Manual](https://github.com/awakecoding/FreeRDP-Manuals/blob/master/User/FreeRDP-User-Manual.markdown)

### Hacktricks

- [Hacktricks: Pentesting RDP](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-rdp.html)