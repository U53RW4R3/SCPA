# DNSWatch

## Setup

### Install Dependencies

Install the packages according to your package manager.

```
$ sudo apt install -y python3-argparse python3-colorama python3-requests python3-scapy python3-pyfiglet toilet-fonts
```

### Install DNSWatch

```
$ git clone https://github.com/HalilDeniz/DNSWatch && \
cd DNSWatch && sudo python setup.py install
```

## Help Menu

```
$ python dnswatch.py -h
    ____  _   _______    ____             __        __ 
   / __ \/ | / / ___/   / __ \____ ______/ /_____  / /_
  / / / /  |/ /\__ \   / /_/ / __ `/ ___/ //_/ _ \/ __/
 / /_/ / /|  /___/ /  / ____/ /_/ / /__/ ,< /  __/ /_  
/_____/_/ |_//____/  /_/    \__,_/\___/_/|_|\___/\__/  
                                                       
   _____       _ ________                  __             __           __    
  / ___/____  (_) __/ __/__  _____   _____/ /_____ ______/ /____  ____/ /    
  \__ \/ __ \/ / /_/ /_/ _ \/ ___/  / ___/ __/ __ `/ ___/ __/ _ \/ __  /     
 ___/ / / / / / __/ __/  __/ /     (__  ) /_/ /_/ / /  / /_/  __/ /_/ /_ _ _ 
/____/_/ /_/_/_/ /_/  \___/_/     /____/\__/\__,_/_/   \__/\___/\__,_/(_|_|_)
                                                                             

usage: dnswatch.py [-h] [-i INTERFACE] [-v] [-t TARGET_IP] [-d] [--doh] [-D TARGET_DOMAINS [TARGET_DOMAINS ...]]
                   [-p FILTER_PORT] [-s FILTER_SRC_IP] [-r FILTER_DST_IP] [--dns-type DNS_TYPE] [--pcap-file PCAP_FILE]
                   [--firewall] [--threshold THRESHOLD] [--window-size WINDOW_SIZE] [--version]

DNSWatch packet sniffer

options:
  -h, --help            show this help message and exit
  -i INTERFACE, --interface INTERFACE
                        Interface to listen on
  -v, --verbose         Enable verbose output
  -t TARGET_IP, --target-ip TARGET_IP
                        Target IP to analyze DNS responses for
  -d, --analyze-dns-type
                        Analyze DNS type
  --doh                 Resolve DNS using DNS over HTTPS (DoH)
  -D TARGET_DOMAINS [TARGET_DOMAINS ...], --target-domains TARGET_DOMAINS [TARGET_DOMAINS ...]
                        List of target domains to monitor
  -p FILTER_PORT, --filter-port FILTER_PORT
                        Filter by source or destination port
  -s FILTER_SRC_IP, --filter-src-ip FILTER_SRC_IP
                        Filter by source IP address
  -r FILTER_DST_IP, --filter-dst-ip FILTER_DST_IP
                        Filter by destination IP address
  --dns-type DNS_TYPE   Filter by DNS type
  --pcap-file PCAP_FILE
                        Save captured packets to a pcap file
  --firewall            Enable DNS firewall mode
  --threshold THRESHOLD
                        Threshold for DNS query count (default: 50)
  --window-size WINDOW_SIZE
                        Window size in seconds (default: 60)
  --version             show program's version number and exit
```

## Usage

TODO: Fill in the usage details

```
$ python dnswatch.py -i <interface>
```

---
## References

### Github

- [DNSWatch](https://github.com/HalilDeniz/DNSWatch)

### Deniz Halil

- [Deniz Halil: DNSWatch â€“ DNS Traffic Sniffer and Analyzer](https://denizhalil.com/dnswatch-dns-traffic-analysis-tool/)

### YouTube

- [DNSWatch - DNS Traffic Sniffer and Analyzer](https://www.youtube.com/watch?v=FY7eh1MXJLo)