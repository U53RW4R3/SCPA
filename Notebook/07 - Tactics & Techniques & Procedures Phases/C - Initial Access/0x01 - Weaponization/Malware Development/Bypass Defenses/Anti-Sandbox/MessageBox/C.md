# C

> [!TIP]
> Enumerate locale languages in the system to display a pop up message with an error message that the application is having some kind of error.


```c
#include <windows.h>
#include <winbase.h>
#include <winuser.h>

#pragma comment(lib, "user32.lib")

int APIENTRY WinMain(HINSTANCE hInst, HINSTANCE hInstPrev, PSTR cmdline, int cmdshow) {
    return MessageBox(NULL, "A text message", "Title", MB_ICONINFORMATION);
}
```

```c
#include <windows.h>
#include <winbase.h>
#include <winuser.h>

#pragma comment(lib, "user32.lib")

int DisplayResourceNAMessageBox();

int APIENTRY WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow) {
    int result = DisplayResourceNAMessageBox();

    // Handle the result if needed
    switch (result) {
    case IDCANCEL:
        MessageBoxA(NULL, L"Cancel was selected.", L"Result", MB_OK);
        break;
    case IDTRYAGAIN:
        MessageBoxA(NULL, L"Try Again was selected.", L"Result", MB_OK);
        break;
    case IDCONTINUE:
        MessageBoxA(NULL, L"Continue was selected.", L"Result", MB_OK);
        break;
    }

    return 0;
}

int DisplayResourceNAMessageBox() {
    int msgboxID = MessageBox(
        NULL,
        (LPCWSTR)L"Resource not available\nDo you want to try again?",
        (LPCWSTR)L"Account Details",
        MB_ICONWARNING | MB_CANCELTRYCONTINUE | MB_DEFBUTTON2
    );

    switch (msgboxID) {
    case IDCANCEL:
        // Add code for Cancel
        break;
    case IDTRYAGAIN:
        // Add code for Try Again
        break;
    case IDCONTINUE:
        // Add code for Continue
        break;
    }

    return msgboxID;
}
```

```
$ x86_64-w64-mingw32-gcc -l user32 -o payload.exe payload.c
```

---
## References

### Microsoft

- [WinAPI Documentation: MessageBox](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-messagebox)

- [WinAPI Documentation: MessageBoxA](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-messageboxa)

- [WinAPI Documentation: MessageBoxW](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-messageboxw)

- [WinAPI Documentation: MessageBoxExA](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-messageboxexa)

- [WinAPI Documentation: MessageBoxExW](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-messageboxexw)

- [MFC Documentation: CString Formatting and Message-Box Display](https://learn.microsoft.com/en-us/cpp/mfc/reference/cstring-formatting-and-message-box-display?view=msvc-170)

### InstallSetupConfig

- [InstallSetupConfig: Windows Directory Management 5](https://www.installsetupconfig.com/win32programming/windowsdirectoryapis3_4.html)

### Microsoft Foundation Classes

- [fragglet.github.io: MFC CWnd::MessageBox](https://fragglet.github.io/dos-help-files/mfc.hlp/MessageBox.html)

### FunctionX

- [FunctionX Tutorials: Message Boxes](https://www.functionx.com/visualc/msgboxes/messageboxes.htm)

### 0xPat

- [0xPat: Malware development part 2 - anti dynamic analysis & sandboxes](https://0xpat.github.io/Malware_development_part_2/)

### TrustedSec

- [TrustedSec: Enumerating Anti-Sandboxing Techniques](https://trustedsec.com/blog/enumerating-anti-sandboxing-techniques)