---
author(s):
  - Userware
tags:
  - helpers
  - malware-development
  - defense-evasion
---
# VMWare

## Cross Platform

### MAC Address Prefixes

```
00:05:69
00:0C:29
00:1C:14
00:50:56
```

Hexadecimal format.

```
"\x00\x05\x69"
"\x00\x0C\x29"
"\x00\x1C\x14"
"\x00\x50\x56"
```

## Linux

### Process Names

```
TODO: Fill it
```

### Files

Executable binary files.

```
TODO: Fill it
```

Service files.

```
/etc/systemd/system/vmtoolsd.service
/lib/systemd/system/open-vm-tools.service
/usr/lib/systemd/system/open-vm-tools.service
/etc/init.d/open-vm-tools
/etc/systemd/system/open-vm-tools.service.requires/vgauth.service
/lib/systemd/system/vgauth.service
/usr/lib/systemd/system/vgauth.service
```

### Running Services

```
vmtoolsd.service
open-vm-tools.service
vgauth.service
```

## Windows

### Registry Names

```
HKEY_LOCAL_MACHINE\HARDWARE\DEVICEMAP\Scsi\Scsi Port 2\Scsi Bus 0\Target Id 0\Logical Unit Id 0\Identifier
HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\SystemBiosVersion\SystemBiosVersion
HKEY_LOCAL_MACHINE\SOFTWARE\Vmware Inc.\Vmware Tools
SYSTEM\CurrentControlSet\Enum\SCSI\Disk&Ven_VMware_&Prod_VMware_Virtual_S
SYSTEM\CurrentControlSet\Control\CriticalDeviceDatabase\root#vmwvmcihostdev
SYSTEM\CurrentControlSet\Control\VirtualDeviceDrivers
```

### Process Names

```
VGAuthService.exe
Vmtoolsd.exe
Vmwaretrat.exe
Vmwareuser.exe
Vmacthlp.exe
```

### Files

Installed directory.

```
%PROGRAMFILES%\VMWare\
C:\Program Files\VMWare\
C:\Program Files\VMWare\VMWare Tools\vmtools.exe
```

Library binary files.

```
C:\Windows\System32\drivers\vm3dgl.dll
C:\Windows\System32\drivers\vmdum.dll
C:\Windows\System32\drivers\vm3dver.dll
C:\Windows\System32\drivers\vmtray.dll
C:\Windows\System32\drivers\VMToolsHook.dll
C:\Windows\System32\drivers\vmmousever.dll
C:\Windows\System32\drivers\vmGuestLib.dll
C:\Windows\System32\drivers\VmGuestLibJava.dll
C:\Windows\System32\drivers\vmhgfs.dll
```

Windows Drivers.

```
C:\Windows\System32\drivers\vmmouse.sys
C:\Windows\System32\drivers\vmmemctl.sys
C:\Windows\System32\drivers\vmci.sys
C:\Windows\System32\drivers\vm3dmp.sys
C:\Windows\System32\drivers\vmrawdsk.sys
C:\Windows\System32\drivers\vmhgfs.sys
C:\Windows\System32\drivers\vmusbmouse.sys
```

### Running Services

```
VGAuthService
VMTools
Vmhgfs
VMMEMCTL
Vmmouse
Vmrawdsk
Vmusbmouse
Vmvss
Vmscsi
Vmxnet
vmx_svga
Vmware Tools
Vmware Physical Disk Helper Service
```

### Virtual Devices

```
\\.\vmci
```

### Network Adapter

```
VMWare
```

### Network Shares

```
TODO: Fill this info
```

### WMI

```
SELECT AccessState FROM Win32_USBControllerDevice
SELECT * FROM CIM_ComputerSystem
SELECT * FROM Win32_PnPEntity (DeviceId)
SELECT * FROM Win32_NetworkAdapterConfiguration (MACAddress)
SELECT * FROM Win32_NTEventlogFile
```

---
## References

### Cyberbit

- [Cyberbit: Anti-VM and Anti-Sandbox Explained](https://www.cyberbit.com/endpoint-security/anti-vm-and-anti-sandbox-explained/)

### Hackmag

- [Hackmag: Malware under surveillance. Sandboxes and how to detect them](https://hackmag.com/security/malware-sandbox)

### CheckPoint

- [CheckPoint: Evasions Filesystem](https://evasions.checkpoint.com/src/Evasions/techniques/filesystem.html)

- [CheckPoint: Evasions Registry](https://evasions.checkpoint.com/src/Evasions/techniques/registry.html)

- [CheckPoint: Evasions Network](https://evasions.checkpoint.com/src/Evasions/techniques/network.html)

- [CheckPoint: Evasions CPU](https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html)

- [CheckPoint: Evasions Hardware](https://evasions.checkpoint.com/src/Evasions/techniques/hardware.html)

- [CheckPoint: Evasions Firmware tables](https://evasions.checkpoint.com/src/Evasions/techniques/firmware-tables.html)

- [CheckPoint: Evasions WMI](https://evasions.checkpoint.com/src/Evasions/techniques/wmi.html)