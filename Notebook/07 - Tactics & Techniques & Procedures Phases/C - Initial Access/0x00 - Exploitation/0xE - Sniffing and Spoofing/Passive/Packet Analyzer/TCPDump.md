---
author(s):
  - Userware
tags:
  - initial-access
  - exploitation
  - sniffing-and-spoofing
  - packet-analyzer
  - tcpdump
---
# TCPDump

## Usage

Sniff packets from a specific network interface

```
# tcpdump -i <interface>
```

Capture number of packets

```
# tcpdump -c <int> -i <interface>
```

Display captured packets in ASCII

```
# tcpdump -A -i <interface>
```

Display captured packets in HEX and ASCII

```
# tcpdump -XX -i <interface>
```

Save packets in a file

```
# tcpdump -w file.pcap -i <interface>
```

Read captured packets file

```
# tcpdump -r file.pcap
```

Sniff packets with a specific network protocol

```
# tcpdump -i <interface> <tcp | udp | icmp | icmp6>
```

Sniff packets from source IP

```
# tcpdump -i <interface> src <IP>
```

Sniff packets from destination IP

```
# tcpdump -i <interface> dst <IP>
```

## Use Cases

### Monitor every new TCP connection

```
# tcpdump -np 'tcp[tcpflags] ^ (tcp-syn|tcp-ack) == 0'
```

### Play a *bing*-noise for every new SSH connection

```
# tcpdump -nplq 'tcp[13] == 2 and dst port 22' | while read -r x; do echo "${x}"; echo -en \\a; done
```

### Ascii output

For all large packets. Change to `> 40` if no TCP options are used

```
# tcpdump -npAq -s0 'tcp and (ip[2:2] > 60)'
```

---
## References

### Source Repositories

- [hackerschoice: THC's favourite Tips, Tricks & Hacks (Cheat Sheet)](https://github.com/hackerschoice/thc-tips-tricks-hacks-cheat-sheet)