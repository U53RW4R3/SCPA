# Living off the Land

## 01 - Command Prompt

TODO: Provide more information to gather stored passwords

Find all those strings in config files.

```
C:\> where.exe /r <C:\ | \\<IP>\C$> unattend.xml 2>nul

C:\> findstr.exe /b /s unattend.xml 2>nul

C:\> where.exe /r <C:\ | \\<IP>\C$> *pass* *cred* *vnc* *.config* 2>nul

C:\> dir /s *pass* == *cred* == *vnc* == *.config* 2>nul

C:\> where.exe /r <C:\ | \\<IP>\C$> *pass*.txt *pass*.xml *pass*.ini *cred* *vnc* *.config* 2>nul

C:\> dir /s /b *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config* 2>nul

C:\> where.exe /r <C:\ | \\<IP>\C$> *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2>nul

C:\> dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2>nul
```

Find all passwords in all files.

```
C:\> findstr.exe /spin "password" *.* 2>nul
```

## 02 - PowerShell

Search for cleartext credentials

```
PS C:\> Get-ChildItem -Recurse -Path C:\ | ? {$_.Name -eq "*.txt" -or $_.Name -eq "*.pdf" -or $_.Name -eq "*.ini"}
```

Find all those strings in config files

```
PS C:\> Get-ChildItem -Path C:\ -Include *unattend*,*sysprep* -File -Recurse -ErrorAction SilentyContinue | where {($_.Name -like "*.xml" -or $_.Name -like "*.txt" or $_.Name -like "*.ini")}

PS C:\> Get-ChildItem -Path C:\ -Include *sysprep.inf,*sysprep.xml,*sysprep.txt,*unattended.xml,*unattend.xml,*unattend.txt -File -Recurse -EA SilentlyContinue
```

---
## References

### LOFLCAB

- [LOFLCAB: Get-ChildItem](https://lofl-project.github.io/loflcab/Cmdlets/Get-ChildItem/)

### Pentestlab

- [Pentestlab Blog: Stored Credentials](https://pentestlab.blog/2017/04/19/stored-credentials/)

### Internal All The Things

- [Internal All The Things: Windows Privilege Escalation](https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/windows-privilege-escalation/)

### InfoSec Matter

- [InfoSec Matter: Powershell Commands for Pentesters](https://www.infosecmatter.com/powershell-commands-for-pentesters/)