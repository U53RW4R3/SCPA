# [[03 - Offensive Infrastructure/E - Setup Machine/0x03 - Bring Your Own Land/Windows/Privilege Escalation/Seatbelt|Seatbelt]]
## 01 - Usage

Perform a full audit to the Windows system.

```
C:\> .\Seatbelt.exe -group=all full
```

Enumerate the user data.

```
C:\> .\Seatbelt.exe -group=user -outputfile="C:\Temp\userchecks.txt"
```

Enumerate the whole system.

```
C:\> .\Seatbelt.exe -group=system
```

Perform an audit related to networking.

```
C:\> .\Seatbelt.exe -group=remote -computername=< <IP> | computername.domain.tld> [-username=<DOMAIN>\<username> -password=<password>]
```

Perform miscellaneous checks.

```
C:\> .\Seatbelt.exe -group=misc
```

## 02 - Metasploit

```
msf > use post/windows/manage/execute_dotnet_assembly

msf post(windows/manage/execute_dotnet_assembly) > set dotnet_exe /path/to/seatbelt.exe

msf post(windows/manage/execute_dotnet_assembly) > set arguments -group=all full

msf post(windows/manage/execute_dotnet_assembly) > set signature <Automatic | Main() | Main(string[])>

msf post(windows/manage/execute_dotnet_assembly) > set amsibypass <true | false>

msf post(windows/manage/execute_dotnet_assembly) > set etwbypass <true | false>

msf post(windows/manage/execute_dotnet_assembly) > set process [process_name.exe]

msf post(windows/manage/execute_dotnet_assembly) > set pid [process_ID]

msf post(windows/manage/execute_dotnet_assembly) > set ppid [<parent_process_ID>]

msf post(windows/manage/execute_dotnet_assembly) > set usethreadtoken [true | false]

msf post(windows/manage/execute_dotnet_assembly) > set wait [seconds]

msf post(windows/manage/execute_dotnet_assembly) > set session <session_ID>

msf post(windows/manage/execute_dotnet_assembly) > run
```