# Living off the Land

^bc9e6e

Looking for web configuration files that could help us to perform privilege escalation to reuse the credentials with [[07 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x02 - Privilege Escalation/Linux/Local Privilege Escalation/Superuser/Sudo/Superuser Rights/Living off the Land#^4e12e8|superuser rights]].

## 01 - Manual

Configuration files related to webapp development that does contain a database to authenticate with credentials and others as well.

```
$ find . -name "*.php" 2>/dev/null

$ find / -type d -name config 2>/dev/null

$ ls -lR /var/www/

$ ls -lR /var/www/html/
```

## 02 - XAMPP

```
$ ls -lR /srv/www/htdocs/

$ ls -lR /opt/lampp/htdocs/
```

## 03 - PHPMyAdmin

```
$ cat /etc/phpmyadmin/config-db.php
```

## 04 - VBulletin

Extract VBulletin hashes

```
$ egrep -o "([0-9a-zA-Z]{32}):(S{3,32})" *.txt > vbulletin.txt
```

## 05 - phpBB

Extract phpBB3-MD5 hashes.

```
$ egrep -o '$H$S{31}' *.txt > phpBB3-md5.txt
```

## 06 - Content Management System (CMS)

### 6.1 - Wordpress

```
$ cat /var/www/html/wordpress/wp-config.php

$ grep "DB_USER\|DB_PASSWORD" /var/www/html/wordpress/wp-config.php
```

Extract Wordpress-MD5

```
$ egrep -o '$P$S{31}' *.txt > wordpress-md5.txt
```

### 6.2 - Joomla

Extract Joomla hashes.

```
$ egrep -o "([0-9a-zA-Z]{32}):(w{16,32})" *.txt > joomla.txt
```

### 6.3 - Drupal

```
$ cat /var/www/html/sites/default/settings.php
```

Extract Drupal hashes.

```
$ egrep -o '$S$S{52}' *.txt > drupal-7.txt
```

---
## References

### Hacktricks

- [Hacktricks: Privilege Escalation](https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html)

- [Hacktricks: Useful Linux Commands](https://book.hacktricks.wiki/en/linux-hardening/useful-linux-commands.html)