# VirtualBox

## 01 - Gathering Information

Enumerate available virtual machines.

```
$ VBoxManage list vms
```

Get the guest machine's NIC IDs, MAC & network mode (NAT/Bridged Adapter etc.).

```
$ VBoxManage showvminfo --details "<vm_name or ID>" | grep MAC
```

Get the guest machine's IP.

```
$ VBoxManage guestproperty enumerate "<vm_name or ID>" | grep IP
```

## 02 - Modify VM's Network Modes

^77b2b2

```
$ VBoxManage modifyvm "<vm_name or ID>" --nic <NIC_ID> bridged
```

## 03 - Search VDI Files

```
"$HOME/VirtualBox VMs"
```

```
$ VBoxManage showvminfo --details "<vm_name or ID>" | grep "Location:"
```

## 04 - Brute Force VM Login

Enumerate the virtual machine's username.

```
$ strings "$HOME/VirtualBox VMs/<VM_name>/<VM_name>.vdi" | grep "^USER_ID="
```

Start the virtual machine.

```
$ VBoxHeadless -s "<vm_name or ID>"
```

Create a simple script to perform brute force attempts on the current virtual machine.

> [!WARNING] Security Events & Account Lockout
> The brute force attempts will be stored in `/var/log/auth.log`.

```
$ VBoxManage guestcontrol "<vm_name or ID>" --username <username> --password <password> run --exe "[drive_letter:/]path/to/binary"
```

## 05 - Network Scanning VMs

After modifying the virtual machine's [[#^77b2b2|network mode]]. Scan the target to look for vulnerabilities.

## 06 - Sensitive Data

Search for credentials stored in virtual machine.

```
$ strings "$HOME/VirtualBox VMs/<VM_name>/<VM_name>.vdi" | grep -i password > passwords.txt
```

Enumerate username inside the virtual machine.

```
$ strings "$HOME/VirtualBox VMs/<VM_name>/<VM_name>.vdi" | grep -i <username> > sensitive_data.txt
```

## 07 - Creating a VM for Evasion

TODO: Write one more about deploying a VM to evade security endpoints

---
## References

- [Mrd0x: Leveraging VirtualBox During Engagements](https://mrd0x.com/leveraging-virtualbox-during-pentest-engagements/)