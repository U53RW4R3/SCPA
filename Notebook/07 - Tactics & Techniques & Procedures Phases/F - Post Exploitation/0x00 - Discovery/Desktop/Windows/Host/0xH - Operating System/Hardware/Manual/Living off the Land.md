---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Command Prompt

### 1.1 - Printers

```
C:\> net.exe print [\\<IP>]
```

### 1.2 - Mounted Drives

Enumerate for mounted and unmounted drives

```
C:\> mountvol.exe

C:\> vol

C:\> diskpart.exe then list disk
```

> [!INFO] Elevated Privileges is Required
> Must be with elevated privileges when running `fsutil.exe`.

```
C:\> fsutil.exe fsInfo drives
```

### 1.3 - MAC Addresses

```
C:\> getmac.exe /v
```

### 1.4 - Central Processing Unit (CPU)

Display CPU architecture type.

```
C:\> echo %PROCESSOR_ARCHITECTURE%
```

Display total number of processors.

```
C:\> echo %NUMBER_OF_PROCESSORS%
```

## 02 - PowerShell

### 2.1 - Printers

```
PS C:\> Get-Printer [-ComputerName <IP>]

PS C:\> Get-Printer [-ComputerName <IP>] | Format-List Name
```

### 2.2 - Mounted Drives

Display mounted drives.

```
PS C:\> Get-PSDrive

PS C:\> Get-PSDrive | Where-Object {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"} | Format-Table Name, Root

PS C:\> Get-Disk | Format-List *

PS C:\> [System.IO.DriveInfo]::GetDrives() | Format-Table
```

### 2.3 - MAC Addresses

```
PS C:\> Get-NetAdapter
```

### 2.4 - Central Processing Unit (CPU)

```
PS C:\> Get-ComputerInfo -Property CsSystemType

PS C:\> $Env:PROCESSOR_ARCHITECTURE

PS C:\> $Env:NUMBER_OF_PROCESSORS

PS C:\> [System.Environment]::Is32BitOperatingSystem

PS C:\> [System.Environment]::Is64BitOperatingSystem
```

## 03 - Sysinternals

### 3.1 - Central Processing Unit (CPU)

```
C:\> .\PsInfo64.exe [\\<IP> -u <username> -p <password>]
```

---
## References

### Backlinks

- [[07 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x08 - Impact/Windows/Manual/Living off the Land]]

### LOFLCAB

- [LOFLCAB: quser](https://lofl-project.github.io/loflcab/Binaries/quser/)

- [LOFLCAB: Get-NetAdapter](https://lofl-project.github.io/loflcab/Cmdlets/Get-NetAdapter/)

### Hacking Articles

- [Hacking Articles: Post Exploitation Using WMIC (System Command)](https://www.hackingarticles.in/post-exploitation-using-wmic-system-command/)

### 13cubed

- [13cubed: Windows Registry Cheat Sheet](https://13cubed.s3.amazonaws.com/downloads/windows_registry_cheat_sheet.pdf)