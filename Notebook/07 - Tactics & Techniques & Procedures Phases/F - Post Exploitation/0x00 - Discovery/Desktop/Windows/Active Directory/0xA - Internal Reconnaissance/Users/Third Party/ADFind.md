---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - active-directory
  - networking
  - network-protocols
  - ldap
  - third-party-tools
  - windows
---
# ADFind

## 01 - Installation

> [!TIP] Quick Download
> To copy the web request open the **Network Monitor `CTRL + SHIFT + E`** in Firefox. Then click the download button on wherever it appears in your browser. Wait for a few seconds then right click > **Copy Value** > **Copy as cURL**. This is also optional yet recommend to spoof the [[07 - Tactics & Techniques & Procedures Phases/D - Webapp Pentesting/0x03 - Bypass Webapp Security/Web Application Firewall (WAF)/Helpers/User Agents|user agent]].

```
$ curl -sO \
-H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' \
-H 'Accept-Language: en-US,en;q=0.5' \
-H 'Accept-Encoding: gzip, deflate, br, zstd' \
-H 'Content-Type: application/x-www-form-urlencoded' \
-H 'Origin: https://joeware.net' \
-H 'DNT: 1' \
-H 'Connection: keep-alive' \
-H 'Referer: https://joeware.net/' \
-H 'Upgrade-Insecure-Requests: 1' \
-H 'Sec-Fetch-Dest: document' \
-H 'Sec-Fetch-Mode: navigate' \
-H 'Sec-Fetch-Site: same-site' \
-H 'Sec-Fetch-User: ?1' \
-H 'Priority: u=0, i' \
--data-raw 'download=AdFind.zip&email=&B1=Download+Now' \
-X POST https://www.joeware.net/downloads/dl2.php
```

Extract the executable program from archive.

```
$ 7z x -pNotMalware ADFind.zip
```

## 02 - Usage

```
C:\> .\AdFind.exe -h <IP> -sc <adinfo | computers_pwdnotreqd | dclist | dcmodes | domainlist | trustdmp | u:<username>> -f <filter>

C:\> .\AdFind.exe -b dc=<domain>,dc=<tdl> -sc u:<username>

C:\> .\AdFind.exe -f "(objectcategory=<group>)"
```

## 03 - Enumerate Users

```
C:\> .\AdFind.exe -f "(objectcategory=person)" > active_directory_users.txt

C:\> .\AdFind.exe -f "(objectcategory=organizationalUnit)" > organizational_units.txt

C:\> .\AdFind.exe [-h <IP>] -f (name="Domain Admins") member -list > domain_admin_users.txt

C:\> .\AdFind.exe [-h <IP>] -f (objectcategory=*) > all_categories.txt
```

---
## References

### Joeware

- [ADFind Usage](https://www.joeware.net/freetools/tools/adfind/usage.htm)

### The DFIR Report

- [The DFIR Report: PYSA/Mespinoza Ransomware](https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/)

### Certcube

- [Certcube: AD Recon for Beginners](https://blog.certcube.com/ad-recon-for-beginners/)

### NoRed0x

- [NoRed0x: Active Directory Domain Enumeration Part 1](https://nored0x.github.io/red-teaming/active-directory-domain-enumeration-part-1/)