# VMWare

Search Tag(s): #helpers #malware-development #defense-evasion #anti-sandbox

## Cross Platform

### MAC Address Prefixes

```
00:05:69
00:0C:29
00:1C:14
00:50:56
```

Hexadecimal format.

```
"\x00\x05\x69"
"\x00\x0C\x29"
"\x00\x1C\x14"
"\x00\x50\x56"
```

## Linux

### Process Names

```
TODO: Fill it
```

### File Existence

```
TODO: Fill it
```

## Windows

### Registry Names

```
HKEY_LOCAL_MACHINE\HARDWARE\DEVICEMAP\Scsi\Scsi Port 2\Scsi Bus 0\Target Id 0\Logical Unit Id 0\Identifier
HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\SystemBiosVersion\SystemBiosVersion
HKEY_LOCAL_MACHINE\SOFTWARE\Vmware Inc.\Vmware Tools
SYSTEM\CurrentControlSet\Enum\SCSI\Disk&Ven_VMware_&Prod_VMware_Virtual_S
SYSTEM\CurrentControlSet\Control\CriticalDeviceDatabase\root#vmwvmcihostdev
SYSTEM\CurrentControlSet\Control\VirtualDeviceDrivers
```

### Process Names

```
VGAuthService.exe
Vmtoolsd.exe
Vmwaretrat.exe
Vmwareuser.exe
Vmacthlp.exe
```

### File Existence

Installed directory.

```
%PROGRAMFILES%\VMWare\
C:\Program Files\VMWare\
```

Library binary files.

```
C:\Windows\system32\drivers\vm3dgl.dll
C:\Windows\system32\drivers\vmdum.dll
C:\Windows\system32\drivers\vm3dver.dll
C:\Windows\system32\drivers\vmtray.dll
C:\Windows\system32\drivers\VMToolsHook.dll
C:\Windows\system32\drivers\vmmousever.dll
C:\Windows\system32\drivers\vmGuestLib.dll
C:\Windows\system32\drivers\VmGuestLibJava.dll
C:\Windows\system32\drivers\vmhgfs.dll
```

Windows Drivers.

```
C:\Windows\system32\drivers\vmmouse.sys
C:\Windows\system32\drivers\vmmemctl.sys
C:\Windows\system32\drivers\vmci.sys
C:\Windows\system32\drivers\vm3dmp.sys
C:\Windows\system32\drivers\vmrawdsk.sys
C:\Windows\system32\drivers\vmhgfs.sys
C:\Windows\system32\drivers\vmusbmouse.sys
```

### Running Services

```
VGAuthService
VMTools
Vmhgfs
VMMEMCTL
Vmmouse
Vmrawdsk
Vmusbmouse
Vmvss
Vmscsi
Vmxnet
vmx_svga
Vmware Tools
Vmware Physical Disk Helper Service
```

### Virtual Devices

```
\\.\vmci
```

### Network Adapter

```
VMWare
```

### Network Shares

```
TODO: Fill this info
```

---
## References

- [Cyberbit: Anti-VM and Anti-Sandbox Explained](https://www.cyberbit.com/endpoint-security/anti-vm-and-anti-sandbox-explained/)

- [Checkpoint: Evasions Filesystem](https://evasions.checkpoint.com/src/Evasions/techniques/filesystem.html)

- [Checkpoint: Evasions Registry](https://evasions.checkpoint.com/src/Evasions/techniques/registry.html)

- [Checkpoint: Evasions Network](https://evasions.checkpoint.com/src/Evasions/techniques/network.html)

- [Checkpoint: Evasions CPU](https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html)

- [Checkpoint: Evasions Hardware](https://evasions.checkpoint.com/src/Evasions/techniques/hardware.html)

- [Checkpoint: Evasions Firmware tables](https://evasions.checkpoint.com/src/Evasions/techniques/firmware-tables.html)

- [Checkpoint: Evasions WMI](https://evasions.checkpoint.com/src/Evasions/techniques/wmi.html)