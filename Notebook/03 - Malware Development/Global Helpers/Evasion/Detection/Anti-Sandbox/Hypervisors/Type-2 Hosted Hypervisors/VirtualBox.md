---
author(s):
  - Userware
tags:
  - helpers
  - malware-development
  - defense-evasion
  - anti-sandbox
---
# VirtualBox

## Cross Platform

### MAC Address Prefixes

```
08:00:27
```

Hexadecimal format.

```
"\x08\x00\x27"
```

## Linux

### Process Names

```
VBoxClient
VBoxDRMClient
```

### Files

Executable binary files.

```
/opt/VBoxGuestAdditions-*
/usr/bin/VBoxClient
/usr/bin/VBoxClient-all
/usr/bin/VBoxControl
/usr/bin/VBoxDRMClient
/usr/bin/VBoxService
```

Service files.

```
/etc/systemd/system/vmtoolsd.service
/lib/systemd/system/open-vm-tools.service
/usr/lib/systemd/system/open-vm-tools.service
/etc/systemd/system/open-vm-tools.service.requires/vgauth.service
/lib/systemd/system/vgauth.service
/usr/lib/systemd/system/vgauth.service
```

### Running Services

```
vboxadd-service.service
vboxadd.service
vgauth.service
vmtoolsd.service
```

## Windows

### Registry Names

```
HKEY_LOCAL_MACHINE\HARDWARE\ACPI\DSDT\VBOX__
HKEY_LOCAL_MACHINE\HARDWARE\ACPI\FADT\VBOX__
HKEY_LOCAL_MACHINE\HARDWARE\ACPI\RSDT\VBOX__
HKEY_LOCAL_MACHINE\HARDWARE\DEVICEMAP\Scsi\Scsi Port 2\Scsi Bus 0\Target Id 0\Logical Unit Id 0\Identifier
HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\SystemBiosVersion\SystemBiosVersion
HKEY_LOCAL_MACHINE\SOFTWARE\Oracle\VirtualBox Guest Additions
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VBoxGuest
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VBoxMouse
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VBoxService
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VBoxSF
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VBoxWddm
```

### Process Names

```
VBoxService.exe
VBoxTray.exe
```

### Files

Executable binary files.

```
C:\Windows\system32\VBoxService.exe
C:\Windows\system32\VBoxTray.exe
C:\Windows\system32\VBoxControl.exe
```

Installed directory.

```
C:\Program Files\Oracle\VirtualBox Guest Additions\
%PROGRAMFILES%\Oracle\VirtualBox Guest Additions\
```

Library binary files.

```
C:\Windows\system32\VBoxDispD3D.dll
C:\Windows\system32\VBoxDX.dll
C:\Windows\system32\VBoxGL.dll
C:\Windows\system32\VBoxDisp.dll
C:\Windows\system32\VBoxHook.dll
C:\Windows\system32\VBoxMRXNP.dll
C:\Windows\system32\VBoxNine.dll
C:\Windows\system32\VBoxSVGA.dll
C:\Windows\system32\VBoxOGL.dll
C:\Windows\system32\vboxoglarrayspu.dll
C:\Windows\system32\vboxoglcrutil.dll
C:\Windows\system32\vboxoglerrorspu.dll
C:\Windows\system32\vboxoglfeedbackspu.dll
C:\Windows\system32\vboxoglpackspu.dll
```

Windows Drivers.

```
C:\Windows\system32\drivers\VBoxGuest.sys
C:\Windows\system32\drivers\VBoxMouse.sys
C:\Windows\system32\drivers\VBoxSF.sys
C:\Windows\system32\drivers\VBoxWddm.sys
C:\Windows\system32\drivers\VBoxVideo.sys
```

### Running Services

Service names

```
VBoxService
```

Service display names.

```
VirtualBox Guest Additions Service
```

### Virtual Devices

```
\\.\VBoxMiniRdrDN
\\.\VBoxGuest
\\.\pipe\VBoxMiniRdDN
\\.\VBoxTrayIPC
\\.\pipe\VBoxTrayIPC
\\.\HGFS
```

### Network Adapter

```
VMWare
```

### Network Shares

```
VirtualBox Shared Folders
```

### Windows Class

```
VBoxTrayToolWndClass
VBoxTrayToolWnd
```

### WMI

```
SELECT * FROM Win32_PnPEntity (DeviceId)
SELECT * FROM Win32_NetworkAdapterConfiguration (MACAddress)
SELECT * FROM Win32_NTEventlogFile
```

---
## References

- [Cyberbit: Anti-VM and Anti-Sandbox Explained](https://www.cyberbit.com/endpoint-security/anti-vm-and-anti-sandbox-explained/)

- [Checkpoint: Evasions Filesystem](https://evasions.checkpoint.com/src/Evasions/techniques/filesystem.html)

- [Checkpoint: Evasions Registry](https://evasions.checkpoint.com/src/Evasions/techniques/registry.html)

- [Checkpoint: Evasions Network](https://evasions.checkpoint.com/src/Evasions/techniques/network.html)

- [Checkpoint: Evasions CPU](https://evasions.checkpoint.com/src/Evasions/techniques/cpu.html)

- [Checkpoint: Evasions Hardware](https://evasions.checkpoint.com/src/Evasions/techniques/hardware.html)

- [Checkpoint: Evasions Firmware tables](https://evasions.checkpoint.com/src/Evasions/techniques/firmware-tables.html)

- [Checkpoint: Evasions WMI](https://evasions.checkpoint.com/src/Evasions/techniques/wmi.html)