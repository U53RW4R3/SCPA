# VBA Macro

TODO: Fill this info

## EvilClippy

### Setup

```
$ git clone https://github.com/outflanknl/EvilClippy && cd EvilClippy && \
mcs /reference:OpenMcdf.dll,System.IO.Compression.FileSystem.dll /out:EvilClippy.exe *.cs
```

### Help Menu

```
$ mono EvilClippy.exe -h
Usage: eviloffice.exe [OPTIONS]+ filename

Author: Stan Hegt
Email: stan@outflank.nl

Options:
  -n, --name=VALUE           The target module name to stomp.
                               This argument can be repeated.
  -s, --sourcefile=VALUE     File containing substitution VBA code (fake 
                               code).
  -g, --guihide              Hide code from VBA editor GUI.
      --gg, --guiunhide      Unhide code from VBA editor GUI.
  -t, --targetversion=VALUE  Target MS Office version the pcode will run on.
  -w, --webserver=VALUE      Start web server on specified port to serve 
                               malicious template.
  -d, --delmetadata          Remove metadata stream (may include your name 
                               etc.).
  -r, --randomnames          Set random module names, confuses some analyst 
                               tools.
      --rr, --resetmodulenames
                             Undo the set random module names by making the 
                               ASCII module names in the DIR stream match their 
                               Unicode counter parts
  -u, --unviewableVBA        Make VBA Project unviewable/locked.
      --uu, --viewableVBA    Make VBA Project viewable/unlocked.
  -v                         Increase debug message verbosity.
  -h, --help                 Show this message and exit.
```

### Usage

```
$ mono EvilClippy.exe -g file.doc
```

#### VBA Stomping

```
$ mono EvilClippy.exe -s fakecode.vba file.doc
```

## Reverse Strings

```vbscript
Sub Reverse_String(string)
    reversed = StrReverse(string)
End Sub
```

---
## References

- [outflanknl: EvilClippy](https://github.com/outflanknl/EvilClippy)

- [Carrie Roberts: VBA Stomping â€” Advanced Maldoc Techniques]([https://medium.com/walmartglobaltech/vba-stomping-advanced-maldoc-techniques-612c484ab278](https://medium.com/walmartglobaltech/vba-stomping-advanced-maldoc-techniques-612c484ab278))

- [Excel 4.0 Macro Functions Reference](https://d13ot9o61jdzpp.cloudfront.net/files/Excel%204.0%20Macro%20Functions%20Reference.pdf#Register)

### TrustedSec

- [TrustedSec: The VBA Language for Script Kiddies](https://www.trustedsec.com/blog/the-vba-language-for-script-kiddies)

- [TrustedSec: Developing with VBA for Script Kiddies](https://www.trustedsec.com/blog/developing-with-vba-for-script-kiddies)

- [TrustedSec: Malicious Macros for Script Kiddies](https://www.trustedsec.com/blog/malicious-macros-for-script-kiddies)

### Depth Security

- [Depth Security: Obfuscating Malicious, Macro-Enabled Word Docs](https://www.depthsecurity.com/blog/obfuscating-malicious-macro-enabled-word-docs/)

### Focal Point

- [Focal Point: How to Build Obfuscated Macros for your Next Social Engineering Campaign](https://blog.focal-point.com/how-to-build-obfuscated-macros-for-your-next-social-engineering-campaign)