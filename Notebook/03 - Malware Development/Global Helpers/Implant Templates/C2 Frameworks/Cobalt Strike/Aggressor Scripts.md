# Aggressor Scripts

Search Tag(s): #helpers #malware-development #defense-evasion

## Generate Random String

```perl
sub random_string {
	$limit = $1;
	@random_str = @();
	$characters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
	for ($x = 0; $x < $limit; $x++) {
		$n = rand(strlen($characters));
		add(@random_str, charAt($characters, $n));
	}
	return join('', @random_str);
}
```

## RC4

```perl
#RC4 encryption implementation using Java Crypto API
#Author: @_EthicalChaos_

import javax.crypto.spec.*;
import java.security.*;
import javax.crypto.*;

# $1 = plaintext, $2 = key
sub encryptRC4 {

    $cipher = [Cipher getInstance: "RC4"];
    $key = [new SecretKeySpec: $2, "RC4"];

    [$cipher init: [Cipher ENCRYPT_MODE], $key];

    return [$cipher doFinal: $1];
}

sub decryptRC4 {

    $cipher = [Cipher getInstance: "RC4"];
    $key = [new SecretKeySpec: $2, "RC4"];

    [$cipher init: [Cipher DECRYPT_MODE], $key];

    return [$cipher doFinal: $1];
}

# $1 = transformation, $2 = key, $3 = iv, $4 = data
sub encryptData {

    $iv = $null;
    $cipher = [Cipher getInstance: $1];
    $algo = split('/', $1)[0];

    $key = [new SecretKeySpec: $2, $algo];

    if($3 != $null)
        $iv = [new IvParametersSpec: $3];

    if($iv != $null)
        [$cipher init:  [Cipher ENCRYPT_MODE], $key, $iv];
    else
        [$cipher init:  [Cipher ENCRYPT_MODE], $key, $iv];        
    
    return [$cipher doFinal: $1];
}
```

---
## References

- [Sleep Scripting Language](http://sleep.dashnine.org/manual/index.html)

- [CCob: Aggressor Script for RC4 encryption ](https://gist.github.com/CCob/9dd8de00c2c6ad069301a225589223fa)