# Open Mutex

If a certain mutex object already exists on the system. The shellcode will execute. This method checks if the object's existence. If it's absent then it will create and call a new instance of itself. The child process will try to create the mutex before the father process dies and will fall into the `ERROR_ALREADY_EXISTS` code branch.

## C

```c
int main() {
	HANDLE mutex;
	mutex = CreateMutex(NULL, TRUE, "muuuu");
	if (GetLastError() == ERROR_ALREADY_EXISTS) {
		// execute payload here
	} else {
		startExe("updater.exe");
		Sleep(100);
	}
	return 0;
}
```