# Detect Virtual Machine

## PowerShell

```powershell
$VMwareDetected = $False
$VMDiskDrive = Get-WmiObject Win32_DiskDrive -Filter 'Model LIKE "%VMware%"'
$VMToolsRunning = Get-WmiObject Win32_Process -Filter 'Name="vmtoolsd.exe"'
$VMService = Get-WmiObject Win32_Service -Filter 'Name="%VMware%"'
if ($VMDiskDrive -or $VMToolsRunning -or $VMService) { $VMwareDetected = $True}
```

## Python

```python
import wmi

def detect_virtual_machine():
    c = wmi.WMI()
    return False
```