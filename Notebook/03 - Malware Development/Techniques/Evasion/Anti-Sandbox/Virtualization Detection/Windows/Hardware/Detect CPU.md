# Detect CPU

## Count Processor Cores

### WinAPI

```c
SYSTEM_INFO sysinfo;
GetSystemInfo(&sysinfo);
int numCPU = sysinfo.dwNumberOfProcessors;

if (numCPU < 2) {
	return 0;
}
```

### Environment Variable

#### Macros

```vbscript
Sub CPU()
	Dim Processors As String
	Processors = Environ("NUMBER_OF_PROCESSORS")

	If Processors >= 2 Then
		MsgBox "Executing payload!"
	Else
		MsgBox "Sandbox detected!"
	End If
End Sub
```

---
## References

### Backlinks

- [[03 - Malware Development/Techniques/Evasion/Obfuscation/Obfuscation Techniques/String Manipulation/Windows/Batch]]

- [[03 - Malware Development/Techniques/Enumeration/Windows/Hardware/CPU]]