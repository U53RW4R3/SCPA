# Enumerate Passwords

```powershell
$pattern = "password"
$hives = "HKEY_CLASSES_ROOT","HKEY_CURRENT_USER","HKEY_LOCAL_MACHINE","HKEY_USERS","HKEY_CURRENT_CONFIG"

# Search in registry keys
foreach ($r in $hives) { Get-ChildItem "Registry::${r}\" -Recursive -ErrorAction SilentlyContinue | sls "$pattern" }

# Search in registry values
foreach ($r in $hives) { Get-ChildItem "Registry::${r}\" -Recursive -ErrorAction SilentlyContinue | ForEach-Object { if((Get-ItemProperty $_.PsPath -ea SilentlyContinue) -match "$pattern") { $_.PsPath; $_ | Out-String -Stream | sls "$pattern" }}}
```

---
## References

### InfoSec Matter

- [InfoSec Matter: Powershell Commands for Pentesters](https://www.infosecmatter.com/powershell-commands-for-pentesters/)