# Elevated Privileges

## C

```c
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>

int main() {
    if (getuid() == 0) {
        printf("You are root!\n");
    } else {
        printf("Elevated privileges are required!\n");
    }

    return 0;
}
```

You can use `geteuid()` for effective user identification.

```c
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>

int main() {
    if (geteuid() == 0) {
        printf("You are root!\n");
    } else {
        printf("Elevated privileges are required!\n");
    }

    return 0;
}
```

## Python

```python
#!/usr/bin/env python3
import os

def is_elevated() -> bool:
    if os.getuid() == 0:
        return True
    else
        return False

def main():
    if is_elevated():
        print("You are root!")
    else:
        print("Elevated privileges are required!")

main()
```

You can use `os.geteuid` for effective user identification.

```python
#!/usr/bin/env python3
import os

def is_elevated() -> bool:
    if os.geteuid() == 0:
        return True
    else
        return False

def main():
    if is_elevated():
        print("You are root!")
    else:
        print("Elevated privileges are required!")

main()
```

## Perl

```perl
#!/usr/bin/env perl
use POSIX;

sub is_elevated {
    if (getuid() == 0) {
        return 1;
    } else {
        return 0;
    }
}

sub main {
    if (is_elevated) {
        print "You are root!\n";
    } else {
        print "Elevated privileges is required!\n";
    }
}

main();
```

You can use `geteuid()` for effective user identification.

```perl
#!/usr/bin/env perl
use POSIX;

sub is_elevated {
    if (geteuid() == 0) {
        return 1;
    } else {
        return 0;
    }
}

sub main {
    if (is_elevated) {
        print "You are root!\n";
    } else {
        print "Elevated privileges is required!\n";
    }
}

main();
```

## Environment Variable

### Bash

```bash
#!/bin/bash

function check_privileges() {
	if [[ ${UID} -ne 0 ]]
	then
		return 0
	else
		return 1
	fi
}

if [[ ! $(check_privileges) ]]
then
	echo "Elevated privileges are required!"
fi
```

You can also use `${EUID}` environment variable.

```bash
#!/bin/bash

function check_privileges() {
	if [[ ${EUID} -ne 0 ]]
	then
		return 0
	else
		return 1
	fi
}

if [[ ! $(check_privileges) ]]
then
	echo "Elevated privileges are required!"
fi
```

---
## References

- [DMCXBlue Gitbook: Native API - Linux](https://dmcxblue.gitbook.io/red-team-notes-2-0/red-team-techniques/execution/t1059-command-and-scripting-interpreter/native-api-linux)