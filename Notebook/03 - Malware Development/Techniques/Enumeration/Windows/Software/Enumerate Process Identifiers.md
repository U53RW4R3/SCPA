# Enumerate Process Identifiers

## C

### WinAPI

#### `OpenProcess`

```

```

#### `EnumProcesses`

```

```

## VBA

### WinAPI

```vb
Public Type PROCESSENTRY32
    dwSize As Long
    cntUsage As Long
    th32ProcessID As Long
    th32DefaultHeapID As Long
    th32ModuleID As Long
    cntThreads As Long
    th32ParentProcessID As Long
    pcPriClassBase As Long
    dwFlags As Long
    szExeFile As String * 260
End Type

Const TH32CS_SNAPPROCESS As Long = &H2

Declare Function CreateToolhelp32Snapshot Lib "kernel32.dll" ( _
    ByVal dwFlags As Long, _
    ByVal th32ProcessID As Long _
) As Long

Declare PtrSafe Function Process32First Lib "kernel32.dll" ( _
    ByVal hSnapshot As LongPtr, _
    ByRef lpProcEntry As PROCESSENTRY32 _
) As Long

Declare PtrSafe Function Process32Next Lib "kernel32.dll" ( _
    ByVal hSnapshot As LongPtr, _
    ByRef lpProcEntry As PROCESSENTRY32 _
) As Long

Sub GetProcessList()
    Dim procEntry As PROCESSENTRY32
     hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0)
    procEntry.dwSize = Len(procEntry)
    success = Process32First(hSnapshot, procEntry)
    Do While success <> 0
         Debug.Print “Process: “ & procEntry.szExeFile
         procEntry.dwSize = Len(procEntry)
         procEntry.szExeFile = Space(260)
         success = Process32Next(hSnapshot, procEntry)
    Loop
End Sub
```

### WMI

```vb
Sub GetProcessList()
    Set objServices = GetObject("winmgmts:\.\root\CIMV2")
    Set objProcessSet = objServices.ExecQuery( _
        "SELECT Name FROM Win32_Process", , 48)
    For Each Process In objProcessSet
        Debug.Print "Process: " & Process.name
    Next
End Sub
```

## Python

```python
import wmi

wmi_obj = wmi.WMI()

processes = wmi_obj.Win32_Process()
for process in processes:
    print(f"Process ID: {process.ProcessId}, Name: {process.Name}")
```

---
## References

### Tenouk

- [Tenouk: Processes and Threads - WinAPIs - Part 6](https://www.tenouk.com/ModuleU.html)

- [Tenouk: Processes and Threads - WinAPIs - Part 7](https://www.tenouk.com/ModuleU1.html)

- [Tenouk: Windows Services - A Supplementary Note](https://www.tenouk.com/cddeestruct.html)

- [Tenouk: Another Windows Services - A Supplementary Note](https://www.tenouk.com/cddeefunction3.html)

### TrustedSec

- [TrustedSec: Enumerating Anti-Sandboxing Techniques](https://trustedsec.com/blog/enumerating-anti-sandboxing-techniques)

### Niraj Kharel

- [Niraj Kharel: Offensive C++ - Process Enumeration (ToolHelp32 Function)](https://nirajkharel.com.np/posts/process-enumeration-toolhelp32/)

- [Niraj Kharel: Offensive C++ - Process Enumeration (Windows Terminal Services API)](https://nirajkharel.com.np/posts/process-enumeration-windows-terminal-services/)

- [Niraj Kharel: Offensive C++ - Process Enumeration (EnumProcess Function)](https://nirajkharel.com.np/posts/process-enumeration-enum-process/)