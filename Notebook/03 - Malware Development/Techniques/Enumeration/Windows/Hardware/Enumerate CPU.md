# Enumerate CPU

## Architecture

This can be leveraged to include shellcode with specific architecture that makes it executable. It can also be used to execute specific binary programs depending on how it was weaponized.

### Environment Variable

#### VBA

```vbscript
Sub Architecture()
	Dim Arch As String
	Arch = Environ("PROCESSOR_ARCHITECTURE")

	If Arch = "AMD64" Then
		MsgBox "x86_64 (64-bit) CPU Architecture."
	End If
End Sub
```

---
## References

### Backlinks

- [[05 - Common Environment Variables]]

### MalAPI

- [MalAPI: GetLogicalProcessorInformation](https://malapi.io/winapi/GetLogicalProcessorInformation)

- [MalAPI: GetLogicalProcessorInformationEx](https://malapi.io/winapi/GetLogicalProcessorInformationEx)

### InstallSetupConfig

- [InstallSetupConfig: Win32 Windows Volume Program and Code Example 7](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_6.html)

### TrustedSec

- [TrustedSec: Enumerating Anti-Sandboxing Techniques](https://trustedsec.com/blog/enumerating-anti-sandboxing-techniques)