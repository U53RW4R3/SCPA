# Hostname

## `GetComputerNameA()`

```c
#include <stdio.h>
#include <windows.h>
#include <winbase.h>

#define MAX_COMPUTERNAME_LENGTH 255

int main() {
	char buffer[MAX_COMPUTERNAME_LENGTH + 1];
	DWORD size = MAX_COMPUTERNAME_LENGTH +1;

	if (!GetComputerNameA(buffer, &size)) {
		printf("Failed to retrieve hostname. Error: %lu\n", GetLastError());
		return 1;
	}

	printf("Computer name = %s\n", buffer);
	printf("Characters copied = %d\n", size);

	return 0;
}
```

Compile the source.

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o implant.exe implant.c
```

## `gethostname()`

```c
#include <windows.h>
#include <winsock.h>
#include <ws2tcpip.h>
#include <stdio.h>

#pragma comment(lib, "ws2_32.lib")

int main() {
	WSADATA wsadata;
	char hostname[256];
	int result = WSAStartup(MAKEWORD(2, 2), &wsadata);

	if (result != 0) {
		printf("WSAStartup failed: %d\n", result);
		return 1;
	}

	if (gethostname(hostname, sizeof(hostname)) == SOCKET_ERROR) {
		printf("gethostname failed: %d\n", WSAGetLastError());
		WSACleanup();
		return 1;
	}

	printf("Host Name: %s\n", hostname);

	WSACleanup();
	return 0;
}
```

Compile the source.

```
$ x86_64-w64-mingw32-gcc -l ws2_32 -o implant.exe implant.c
```

---
## References

### Microsoft

- [Microsoft Documentation: gethostname](https://learn.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-gethostname)

- [Microsoft Documentation: WSAStartup](https://learn.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-wsastartup)

### MalAPI

- [MalAPI: GetComputerNameA](https://malapi.io/winapi/GetComputerNameA)

- [MalAPI: Gethostname](https://malapi.io/winapi/Gethostname)

- [MalAPI: WSAStartup](https://malapi.io/winapi/WSAStartup)

### InstallSetupConfig

- [InstallSetupConfig: Win32 Windows Volume Program and Code Example 6](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_5.html)

- [InstallSetupConfig: Win32 Windows Volume Program and Code Example 7](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_6.html)