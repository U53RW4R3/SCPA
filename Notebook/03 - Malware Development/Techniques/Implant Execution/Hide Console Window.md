# Hide Console Window

## C

```c
#include <windows.h>

void HideConsole() {
    HWND hWnd = GetConsoleWindow();
    ShowWindow(hWnd, SW_MINIMIZE);
    ShowWindow(hWnd, SW_HIDE);
}

int main() {
	HideConsole();
	return 0;
}
```

## CPP

```cpp
#include <windows.h>

void HideConsole() {
	::ShowWindow(::GetConsoleWindow(), SW_HIDE)
}

int main() {
	HideConsole();
	return 0;
}
```

## C\#

```

```

## Powershell

```powershell
$Win32 = @"
public static void ShowConsoleWindow(int state) {
    var handle = GetConsoleWindow();
    ShowWindow(handle, state);
}
[DllImport("kernel32.dll")]
public static extern IntPtr GetConsoleWindow();

[DllImport("user32.dll")]
public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
"@
$hideconsole = Add-Type -MemberDefinition $Win32 -Name Hide -Namespace HideConsole -ReferencedAssemblies System.Runtime.InteropServices -PassThru
$hideconsole::ShowConsoleWindow(0)
```

```powershell
$hideconsole = @"
[DllImport("user32.dll")]
public static extern bool ShowWindow(int handle, int state);
"@

Add-Type -MemberDefinition $hideconsole -Name Win -Namespace Native
[Native.Win]::ShowWindow(([System.Diagnostics.Process]::GetCurrentProcess() | Get-Process).MainWindowHandle, 0)
```

```powershell
$hideconsole = '[DllImport("user32.dll")] public static extern bool ShowWindow(int handle, int state);'

Add-Type -MemberDefinition $hideconsole -Name Win -Namespace Native

$ShowWindow = "ShowWindow"
$GetCurrentProcess = "GetCurrentProcess"

$Process = [System.Diagnostics.Process]::$GetCurrentProcess
$WindowHandle = ($Process.Invoke() | Get-Process).MainWindowHandle
[Native.Win]::$ShowWindow.Invoke($WindowHandle, 0)
```

```powershell
Add-Type @'
using System;
using System.Runtime.InteropServices;

public class API {

    public enum SW : int {
        Hide            = 0,
        Normal          = 1,
        ShowMinimized   = 2,
        Maximize        = 3,
        ShowNoActivate  = 4,
        Show            = 5,
        Minimize        = 6,
        ShowMinNoActive = 7,
        ShowNA          = 8,
        Restore         = 9,
        Showdefault     = 10,
        Forceminimize   = 11
    }

    [DllImport("user32.dll")]
    public static extern int ShowWindow(IntPtr hwnd, SW nCmdShow);
}
'@

$ThisWindow = [System.Diagnostics.Process]::GetCurrentProcess().MainwindowHandle
[API]::ShowWindow($ThisWindow, 'Hide')
```

---
## References

- [Rob van der Woude: PowerShell Code Snippets](https://www.robvanderwoude.com/powershellsnippets.php)