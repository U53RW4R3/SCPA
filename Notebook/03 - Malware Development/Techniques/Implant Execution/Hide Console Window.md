# Hide Console Window

## C

```c
#include <windows.h>

void HideWindow() {
    HWND handle_window = GetConsoleWindow();
    ShowWindow(hWnd, SW_MINIMIZE);
    ShowWindow(hWnd, SW_HIDE);
}

void HideConsole() {
    FreeConsole();
}

int main() {
	HideWindow();
	// HideConsole();
	return 0;
}
```

## CPP

```cpp
#include <windows.h>

void HideWindow() {
	::ShowWindow(::GetConsoleWindow(), SW_HIDE)
}

void HideConsole() {
    FreeConsole();
}

int main() {
	HideWindow();
	// HideConsole();
	return 0;
}
```

## C\#

```csharp
using System;
using System.Runtime.InteropServices;

class Program {
    [DllImport("kernel32.dll")]
    private static extern IntPtr GetConsoleWindow();

    [DllImport("user32.dll")]
    private static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

    [DllImport("kernel32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool FreeConsole();

    private const int SW_HIDE = 0;

    static void Main(string[] args) {
        HideWindow();
        // HideConsole();
    }

    private static void HideWindow() {
        IntPtr handle_window = GetConsoleWindow();
        ShowWindow(hConsole, SW_HIDE);
    }

    private static void HideConsole() {
        FreeConsole();
    }
}
```

## Rust

```rust
#![windows_subsystem = "console"]
use std::ptr;
use winapi::um::wincon::GetConsoleWindow;
use winapi::um::winuser::{ShowWindow, SW_HIDE};

fn hide_window() {
    let window = unsafe {GetConsoleWindow()};

    if window != ptr::null_mut() {
        unsafe {
            ShowWindow(window, SW_HIDE);
        }
    }
}

fn hide_console() {
    let window = unsafe {GetConsoleWindow()};

	unsafe {
        winapi::um::wincon::FreeConsole()
    };
}
```

Add dependencies in the `Cargo.toml`.

```
[dependencies]
winapi = {version = "0.3", features = ["wincon", "winuser"]}
```

## Powershell

First variant.

```powershell
$Win32 = @"
public static void ShowConsoleWindow(int state) {
    var handle_window = GetConsoleWindow();
    ShowWindow(handle_window, state);
}
[DllImport("kernel32.dll")]
public static extern IntPtr GetConsoleWindow();

[DllImport("user32.dll")]
public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
"@
$hideconsole = Add-Type -MemberDefinition $Win32 -Name Hide -Namespace HideConsole -ReferencedAssemblies System.Runtime.InteropServices -PassThru
$hideconsole::ShowConsoleWindow(0)
```

Second variant.

```powershell
$hideconsole = @"
[DllImport("user32.dll")]
public static extern bool ShowWindow(int handle, int state);
"@

Add-Type -MemberDefinition $hideconsole -Name Win -Namespace Native
[Native.Win]::ShowWindow(([System.Diagnostics.Process]::GetCurrentProcess() | Get-Process).MainWindowHandle, 0)
```

Third variant.

```powershell
$hideconsole = '[DllImport("user32.dll")] public static extern bool ShowWindow(int handle, int state);'

Add-Type -MemberDefinition $hideconsole -Name Win -Namespace Native

$ShowWindow = "ShowWindow"
$GetCurrentProcess = "GetCurrentProcess"

$Process = [System.Diagnostics.Process]::$GetCurrentProcess
$WindowHandle = ($Process.Invoke() | Get-Process).MainWindowHandle
[Native.Win]::$ShowWindow.Invoke($WindowHandle, 0)
```

Fourth variant.

```powershell
Add-Type @'
using System;
using System.Runtime.InteropServices;

public class API {

    public enum SW : int {
        Hide            = 0,
        Normal          = 1,
        ShowMinimized   = 2,
        Maximize        = 3,
        ShowNoActivate  = 4,
        Show            = 5,
        Minimize        = 6,
        ShowMinNoActive = 7,
        ShowNA          = 8,
        Restore         = 9,
        Showdefault     = 10,
        Forceminimize   = 11
    }

    [DllImport("user32.dll")]
    public static extern int ShowWindow(IntPtr hWnd, SW nCmdShow);
}
'@

$ThisWindow = [System.Diagnostics.Process]::GetCurrentProcess().MainwindowHandle
[API]::ShowWindow($ThisWindow, 'Hide')
```

---
## References

- [Rob van der Woude: PowerShell Code Snippets](https://www.robvanderwoude.com/powershellsnippets.php)