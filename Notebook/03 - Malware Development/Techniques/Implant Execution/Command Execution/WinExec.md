# WinExec

## C

```c
#include <windows.h>
#include <winbase.h>

#pragma comment(lib, "kernel32.lib")

WinExec()
```

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o implant.exe implant.c
```

## PowerShell

```powershell
$WinAPI = @"
 
using System;
using System.Runtime.InteropServices;
 
public class Kernel32 {
[DllImport("kernel32.dll")]
public static extern uint WinExec(string lpCmdLine, uint uCmdShow);
}
"@
 
Add-Type $WinAPI
[uint32]$SHOW_HIDE = 0
[Kernel32]::WinExec("C:\Windows\System32\calc.exe", $SHOW_HIDE)
```

## VBA

```vb
Declare Function WinExec Lib "kernel32" ( _
     ByVal lpCmdLine As String, _
     ByVal nCmdShow As Long _
) As Long

Const SHOW_HIDE As Long = 0

Sub ExecuteFile ()
     WinExec "C:\Windows\System32\notepad.exe", SHOW_HIDE
End Sub
```

---
## References

### MalAPI

- [MalAPI: WinExec](https://malapi.io/winapi/WinExec)

### Bordergate

- [Bordergate: Offensive PowerShell](https://www.bordergate.co.uk/offensive-powershell/)