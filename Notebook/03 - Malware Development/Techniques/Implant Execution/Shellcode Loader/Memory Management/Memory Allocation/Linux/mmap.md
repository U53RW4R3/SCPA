# mmap

```c
#include <string.h>
#include <sys/mman.h>

// $ gcc [-m32] -zexestack -o implant implant.c

int main() {

	// mmap(NULL, length, PROT_READ | PROT_WRITE | PROT_EXEC, MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);
	void *region = mmap(NULL, sizeof(shellcode), PROT_READ | PROT_WRITE | PROT_EXEC, MAP_ANON | MAP_PRIVATE, 0, 0);

	if (region == MAP_FAILED) {
		perror("mmap");
		return 1;
	}
	
	// strncpy();

	// memcpy(&destMemAddr, &shellcode, sizeof(shellcode));
	memcpy(&region, &shellcode, sizeof(shellcode));

	((int(*)())region)();

	// Unreachable code
	munmap(region, sizeof(shellcode));
	return 0;
}
```

---
## References

- [Exploit-DB: Linux/ARM64 - execve("/bin/sh", NULL, NULL) + mmap() + read() Stager Shellcode (60 Bytes)](https://www.exploit-db.com/exploits/47055)