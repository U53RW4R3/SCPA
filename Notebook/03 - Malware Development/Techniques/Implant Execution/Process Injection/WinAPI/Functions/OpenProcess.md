# OpenProcess

> [!NOTE]
> `PROCESS_ALL_ACCESS` isn't required. Only `PROCESS_CREATE_PROCESS` is efficient.

## Powershell

```powershell
$OpenProcessAddress = Get-ProcAddress kernel32.dll OpenProcess
$OpenProcessDelegate = Get-DelegateType @([UInt32], [Bool], [UInt32]) ([IntPtr])
$OpenProcess = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($OpenProcessAddress, $OpenProcessDelegate)
$Win32Functions | Add-Member -MemberType NoteProperty -Name OpenProcess -Value $OpenProcess
```

## VBA

```vb
Const PROCESS_ALL_ACCESS = &H1F0FFF

Dim handle As LongPtr
Dim PID As Integer

PID = 4444
handle = OpenProcess(PROCESS_ALL_ACCESS, False, PID)
```

---
## References

### Tenouk

- [Tenouk: Processes and Threads - Win32 APIs - Part 6](https://www.tenouk.com/ModuleU.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 7](https://www.tenouk.com/ModuleU1.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 10](https://www.tenouk.com/ModuleU4.html)

### Github

- [Chvancooten: Process Injector](https://github.com/chvancooten/OSEP-Code-Snippets/tree/main/Shellcode%20Process%20Injector)