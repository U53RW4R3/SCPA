# CreateRemoteThread

Creates a thread that runs in the virtual address space of another process.

## C

```c
#include <windows.h>
#include <processthreadsapi.h>

#pragma comment(lib, "kernel32.lib")

CreateRemoteThread()
```

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o implant.exe implant.c
```

## Powershell

```powershell
$CreateRemoteThreadAddress = Get-ProcAddress kernel32.dll WriteProcessMemory
$CreateRemoteThreadDelegate = Get-DelegateType @([IntPtr], [IntPtr], [UIntPtr], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr])
$CreateRemoteThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($CreateRemoteThreadAddress, $CreateRemoteThreadDelegate)
$Win32Functions | Add-Member -MemberType NoteProperty -Name CreateRemoteThread -Value $CreateRemoteThread
```

---
## References

### Tenouk

- [Tenouk: Processes and Threads - C Run-Time - Part 1](https://www.tenouk.com/ModuleR.html)

- [Tenouk: Processes and Threads - C Run-Time - Part 4](https://www.tenouk.com/ModuleS.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 6](https://www.tenouk.com/ModuleU.html)