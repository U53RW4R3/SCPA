# Inject Spawned Process

## CreateProcess


> [!TIP]
> When you want to spawn a process then inject the implant. Implement conditions to discover uncommon programs that are installed in the computer.


```c
#include <windows.h>
#include <processthreadsapi.h>

#pragma comment(lib, "kernel32.lib")

CreateProcess()

DWORD PID = pInfo.dwProcessId;
```

```
CreateProcessA()
CreateProcessW()
```

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o implant.exe implant.c
```

---
## References

### Tenouk

- [Tenouk: Processes and Threads - C Run-Time - Part 1](https://www.tenouk.com/ModuleR.html)

- [Tenouk: Processes and Threads - C Run-Time - Part 2](https://www.tenouk.com/ModuleR1.html)

- [Tenouk: Processes and Threads - C Run-Time - Part 3](https://www.tenouk.com/ModuleR2.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 6](https://www.tenouk.com/ModuleU.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 8](https://www.tenouk.com/ModuleU2.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 9](https://www.tenouk.com/ModuleU3.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 10](https://www.tenouk.com/ModuleU4.html)

- [Tenouk: Windows Process and Thread References 2](https://www.tenouk.com/crstufunction1.html)

- [Tenouk: Windows Services & Process - A Supplementary Note](https://www.tenouk.com/cddeefunction1.html)

### Github

- [Chvancooten: Process Hollowing](https://github.com/chvancooten/OSEP-Code-Snippets/tree/main/Shellcode%20Process%20Hollowing)