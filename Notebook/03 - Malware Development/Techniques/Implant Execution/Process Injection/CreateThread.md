# CreateThread

```c
#include <windows.h>
#include <processthreadsapi.h>

#pragma comment(lib, "kernel32.lib")

CreateThread()
```

```
$ x86_64-w64-mingw32-gcc -l user32 -o implant.exe implant.c
```

## PowerShell

```powershell
$Win32Functions = New-Object System.Object

$CreateThreadAddress = Get-ProcAddress Kernel32.dll CreateThread
$CreateThreadDelegate = Get-DelegateType @([IntPtr], [IntPtr], [IntPtr], [IntPtr], [UInt32], [UInt32].MakeByRefType()) ([IntPtr])
$CreateThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($CreateThreadAddress, $CreateThreadDelegate)
$Win32Functions | Add-Member -MemberType NoteProperty -Name CreateThread -Value $CreateThread
```

---
## References

### Tenouk

- [Tenouk: Processes and Threads - C Run-Time - Part 1](https://www.tenouk.com/ModuleR.html)

- [Tenouk: Processes and Threads - C Run-Time - Part 4](https://www.tenouk.com/ModuleS.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 6](https://www.tenouk.com/ModuleU.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 8](https://www.tenouk.com/ModuleU2.html)

- [Tenouk: Processes and Threads - Win32 APIs - Part 10](https://www.tenouk.com/ModuleU4.html)

- [Tenouk: Windows Programming - Various Supplementary Note](https://www.tenouk.com/cddeefunction2.html)

### Github

- [Chvancooten: Process Hollowing](https://github.com/chvancooten/OSEP-Code-Snippets/tree/main/Shellcode%20Process%20Hollowing)