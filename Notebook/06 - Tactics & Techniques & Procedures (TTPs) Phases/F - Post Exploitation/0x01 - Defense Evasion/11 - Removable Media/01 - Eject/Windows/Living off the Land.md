# Living off the Land

> [!INFO] Elevated Privileges is not Required.
> You can eject this as a normal user.
> > [!TIP]
> > This is useful when you want to delete the disk image artifact that's been mounted by the victim after the initial access phrase.

## 01 - Command Prompt

```
C:\> diskpart.exe

DISKPART> list volume

DISKPART> select volume <volume_ID>

DISKPART> remove dismount

DISKPART> exit
```

## 02 - PowerShell

PowerShell cmdlet to safely eject a removable media.

```powershell
PS C:\> Remove-PartitionAccessPath -DriveLetter "<drive_letter>" -AccessPath "<drive_letter>:\"
```

A scriptable shell object.

```powershell
PS C:\> $driveEject = New-Object -ComObject Shell.Application
$driveEject.Namespace(17).ParseName("<drive_letter>:").InvokeVerb("Eject")
```

Windows Management Instrument.

```powershell
PS C:\> $volume = Get-CimInstance -ClassName Win32_Volume | Where-Object {$_.Name -eq '<drive_letter>:\'}
# $volume = Get-WmiObject -ClassName Win32_Volume | Where-Object {$_.Name -eq '<drive_letter>:\'}
$volume.DriveLetter = $null
$volume.Put()
$volume.Dismount($false, $false)
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xH - Operating System/Hardware/Manual/Living off the Land]]

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xI - RPC/Registry/Operating System/Manual/Living off the Land]]