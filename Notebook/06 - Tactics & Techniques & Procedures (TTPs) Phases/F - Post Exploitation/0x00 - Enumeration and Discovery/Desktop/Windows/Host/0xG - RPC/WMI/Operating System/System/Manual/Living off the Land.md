---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - T1047
  - windows
---
# Living off the Land

## 01 - Command Prompt

### 1.1 - System Information

#### 1.1.1 - Hostname

TODO: Convert it to `wmic`

```
C:\> hostname.exe

C:\> reg.exe query [\\<IP>\]HKLM\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName

C:\> reg.exe query [\\<IP>\]HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters /v Hostname

C:\> echo %COMPUTERNAME%
```

#### 1.1.2 - Date and Time

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] os get LocalDateTime
```

### 1.2 - User Activity

#### 1.2.1 - Uptime

TODO: fill in the information

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>]
```

## 02 - PowerShell

### 2.1 - System Information

#### 2.1.1 - Hostname

Computer name.

```
PS C:\> Get-CimInstance -ClassName Win32_ComputerSystem | Select-Object Name

PS C:\> Get-WmiObject -ClassName Win32_ComputerSystem | Select-Object Name
```

#### 2.1.2 - Date and Time

TODO: Convert it to Get-CimInstance and Get-WmiObject

Retrieve time

```
PS C:\> Get-Date

PS C:\> Invoke-Command -ComputerName <IP> -ScriptBlock { Get-Date }
```

### 2.2 - User Activity

#### 2.2.1 - Uptime

```
PS C:\> Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object LastBootUpTime

PS C:\> Get-WmiObject -ClassName Win32_OperatingSystem | Select-Object LastBootUpTime

PS C:\> (Get-CimInstance -ClassName Win32_OperatingSystem).LastBootUpTime

PS C:\> (Get-WmiObject -ClassName Win32_OperatingSystem).LastBootUpTime
```

The namespace is CIMV2

```
PS C:\> Get-CimInstance -ClassName Win32_PerfFormattedData_PerfOS_System | Select-Object SystemUpTime

PS C:\> Get-CimInstance -Query "SELECT SystemUpTime FROM Win32_PerfFormattedData_PerfOS_System"

PS C:\> Get-WmiObject -ClassName Win32_PerfFormattedData_PerfOS_System | Select-Object SystemUpTime

PS C:\> Get-WmiObject -Query "SELECT SystemUpTime FROM Win32_PerfFormattedData_PerfOS_System"
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Host/0xF - Operating System/Hardware/Manual/Living off the Land|Enumeration and Discovery: Windows Hardware]]

### CyberITHub

- [CyberITHub: 20 Useful WMIC Command Examples in Windows Cheatsheet](https://www.cyberithub.com/20-useful-wmic-command-examples-in-windows-cheat-sheet/)