---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - T1047
  - windows
---
# Living off the Land

## 01 - Command Prompt

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] computersystem list full
```

Enumerate hotfixes.

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] qfe get caption,description,hotfixid,installedon

C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] qfe get Caption,Description,HotFixID,InstalledOn | findstr.exe /C:"KB4012212" /C:"KB4012215"
```

Windows product key activation.

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] path SoftwareLicensingService get OA3xOriginalProductKey
```

## 02 - PowerShell

Enumerating the system to see any kind of potential version we can take over.

```
PS C:\> Get-WmiObject -Namespace "root\cimv2" -ClassName Win32_OperatingSystem | Select-Object Name

PS C:\> Get-CimInstance -Namespace "root\cimv2" -ClassName Win32_OperatingSystem | Select-Object Name
```

Enumerate hotfixes.

```
PS C:\> Get-CimInstance -Namespace "root\cimv2" -ClassName Win32_QuickFixEngineering
```

Windows product key activation.

```
PS C:\> Get-CimInstance -Namespace "root\cimv2" -Query "SELECT OA3xOriginalProductKey FROM SoftwareLicensingService"

PS C:\> (Get-CimInstance -Namespace "root\cimv2" -Query "SELECT * FROM SoftwareLicensingService").OA3xOriginalProductKey

PS C:\> Get-WmiObject -Namespace "root\cimv2" -Query "SELECT OA3xOriginalProductKey FROM SoftwareLicensingService"

PS C:\> (Get-WmiObject -Namespace "root\cimv2" -Query "SELECT * FROM SoftwareLicensingService").OA3xOriginalProductKey
```

---
## References

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Host/0xF - Operating System/Kernel/Manual/Living off the Land|Enumeration and Discovery: Windows Operating System]]