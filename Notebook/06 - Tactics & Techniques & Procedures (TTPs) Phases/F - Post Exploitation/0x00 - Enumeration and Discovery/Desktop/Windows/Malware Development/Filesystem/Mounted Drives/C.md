# C

## C Runtime

```c
#include <stdio.h>
#include <windows.h>
#include <direct.h>
#include <errhandlingapi.h>
#include <tchar.h>

#pragma comment(lib, "kernel32.lib")

int main() {
    ULONG drives = _getdrives();
    if (drives == 0) {
        printf("Failed to retrieve logical drives. Error: %lu\n", GetLastError());
        return 1;
    }

    printf("Logical drives:\n");
    for (TCHAR drive = 'A'; drive <= 'Z'; drive++) {
        if (drives & (1 << (drive - 'A'))) { // Check if the corresponding bit is set
            printf("%c:\\\n", drive);
        }
    }

    return 0;
}
```

Compile the program to list the available drives.

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o list_drives.exe list_drives.c
```

## WinAPI

### `GetLogicalDrives()`

```c
#include <stdio.h>
#include <windows.h>
#include <errhandlingapi.h>
#include <fileapi.h>
#include <tchar.h>

#pragma comment(lib, "kernel32.lib")

int main() {
    DWORD drives = GetLogicalDrives();
    if (drives == 0) {
        printf("Failed to retrieve logical drives. Error: %lu\n", GetLastError());
        return 1;
    }

    printf("Logical drives:\n");
    for (TCHAR drive = 'A'; drive <= 'Z'; drive++) {
        if (drives & (1 << (drive - 'A'))) { // Check if the corresponding bit is set
            printf("%c:\\\n", drive);
        }
    }

    return 0;
}
```

Compile the program to list the available drives.

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o enumerate_drives.exe enumerate_drives.c
```

### `GetLogicalDriveStringsA()`

```c
#include <windows.h>
#include <fileapi.h>

#pragma comment(lib, "kernel32.lib")

GetLogicalDriveStringsA()
```

---
## References

### Microsoft

- [C-Runtime: `_getdrives`](https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/getdrives?view=msvc-170)

- [WinAPI Documentation: `GetLogicalDriveStringsA`](https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-getlogicaldrivestringsa)

- [WinAPI Documentation: `GetLogicalDriveStringsW`](https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getlogicaldrivestringsw)

### MalAPI

- [MalAPI: `GetLogicalDrives`](https://malapi.io/winapi/GetLogicalDrives)

### Tenouk

- [Tenouk: ModuleA](https://www.tenouk.com/ModuleA.html)

- [Tenouk: Supplement](https://www.tenouk.com/Supplement.html)

- [Tenouk: ModuleF](https://www.tenouk.com/ModuleF.html)

- [Tenouk: ModuleF1](https://www.tenouk.com/ModuleF1.html)

- [Tenouk: GetLogicalDrives Code Example](https://www.tenouk.com/cpluscodesnippet/getlogicaldrives.html)

### InstallSetupConfig

- [InstallSetupConfig: Win32 Windows Volume Program and Code Example 4](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_3.html)

- [InstallSetupConfig: Win32 Windows Volume Program and Code Example 7](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_6.html)

- [InstallSetupConfig: Win32 Windows Volume Program and Code Example 8](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_7.html)

- [InstallSetupConfig: Win32 Windows Volume Program and Code Example 9](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_8.html)

- [InstallSetupConfig:  Win32 Windows Volume Program and Code Example 10](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_9.html)

- [InstallSetupConfig: Win32 Windows Volume Program and Code Example 27](https://www.installsetupconfig.com/win32programming/windowsvolumeapis1_26.html)

### ShellGeek

- [ShellGeek: How to Get Free Disk Space in PowerShell?]([https://shellgeek.com/how-to-get-free-disk-space-in-powershell/](https://shellgeek.com/how-to-get-free-disk-space-in-powershell/))

### TrustedSec

- [TrustedSec: Enumerating Anti-Sandboxing Techniques](https://trustedsec.com/blog/enumerating-anti-sandboxing-techniques)