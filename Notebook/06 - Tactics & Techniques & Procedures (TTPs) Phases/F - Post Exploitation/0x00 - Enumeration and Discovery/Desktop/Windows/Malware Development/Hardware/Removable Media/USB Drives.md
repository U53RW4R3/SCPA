# USB Drives

## .NET

### C\#

```csharp
using System;
using System.Management;

public class ListDrives {
	public static void Main(string[] args) {
		getUSBDevices();
	}

	public static void getUSBDevices() {
		try {
			ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT * FROM Win32_USBHub");
			ManagementObjectCollection collection = searcher.Get();
			Console.WriteLine("Enumerating USB Hub Devices:");
			
			foreach (ManagementObject usb in collection) {
				Console.WriteLine($"Device ID: {usb["DeviceID"]}");
				Console.WriteLine($"Description: {usb["Description"]}");
				Console.WriteLine($"Manufacturer: {usb["Manufacturer"]}");
				Console.WriteLine($"PNP Device ID: {usb["PNPDeviceID"]}");
			}
		} catch (ManagementException e) {
            Console.WriteLine($"An error occurred: {e.Message}");
        }
	}
}
```