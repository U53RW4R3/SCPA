---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - networking
  - network-protocols
  - postgresql
  - nuclei
  - metasploit-framework
---
# Scanners

## 01 - DBMS Version

```
msf > use auxiliary/admin/postgres/postgres_sql

msf auxiliary(scanner/postgres/postgres_schemadump) > set database <database>

msf auxiliary(admin/postgres/postgres_sql) > set sql SELECT VERSION()

msf auxiliary(admin/postgres/postgres_sql) > run postgres://<username>:<password>@<IP>
```

## 02 - Database Enumeration

### 2.1 - Schema

```
msf > use auxiliary/scanner/postgres/postgres_schemadump

msf auxiliary(scanner/postgres/postgres_schemadump) > options

Module options (auxiliary/scanner/postgres/postgres_schemadump):

   Name               Current Setting      Required  Description
   ----               ---------------      --------  -----------
   DATABASE           postgres             yes       The database to authenticate against
   DISPLAY_RESULTS    true                 yes       Display the Results to the Screen
   IGNORED_DATABASES  template1,template0  yes       Comma separated list of databases to ignore during the schema dump
   PASSWORD           postgres             no        The password for the specified username. Leave blank for a random password.
   RHOSTS                                  yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT              5432                 yes       The target port
   THREADS            1                    yes       The number of concurrent threads (max one per host)
   USERNAME           postgres             yes       The username to authenticate as

msf auxiliary(scanner/postgres/postgres_schemadump) > set database <database>

msf auxiliary(scanner/postgres/postgres_schemadump) > set ignored_databases <database1>,<database2>,<etc>

msf auxiliary(scanner/postgres/postgres_schemadump) > run postgres://<username>:<password>@<IP> threads=8
```

### 2.2 - Read File

```
msf > use auxiliary/admin/postgres/postgres_readfile

msf auxiliary(admin/postgres/postgres_readfile) > options

Module options (auxiliary/admin/postgres/postgres_readfile):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   DATABASE  template1        yes       The database to authenticate against
   PASSWORD  postgres         no        The password for the specified username. Leave blank for a random password.
   RFILE     /etc/passwd      yes       The remote file
   RHOSTS                     yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT     5432             yes       The target port
   USERNAME  postgres         yes       The username to authenticate as
   VERBOSE   false            no        Enable verbose output

msf auxiliary(admin/postgres/postgres_readfile) > set database <database>

msf auxiliary(admin/postgres/postgres_readfile) > set rfile /path/to/remote/file

msf auxiliary(admin/postgres/postgres_readfile) > run postgres://<username>:<password>@<IP> threads=8
```

## 03 - Username Enumeration

```
$ nuclei -u <IP> -t ~/nuclei-templates -id psql-user-enum
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Cross Platform/Databases/SQL/PostgreSQL|Active Fingerprinting: PostgreSQL]]

### Metasploit Unleashed

- [Metasploit Unleashed: Admin Postgre Auxiliary Module](https://www.offsec.com/metasploit-unleashed/admin-postgres-auxiliary-modules/)