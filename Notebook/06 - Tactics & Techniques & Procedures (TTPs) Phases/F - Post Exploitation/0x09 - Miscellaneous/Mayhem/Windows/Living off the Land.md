# Living off the Land

## 01 - Command Prompt

### 1.1 - Wipe Hard Drive

```
C:\> (echo select volume <drive_letter> && echo format override nowait) | diskpart.exe

C:\> cmd.exe /c "(echo select volume <drive_letter> && echo format override nowait) | diskpart.exe"

C:\> format.exe <drive_letter>: /fs:NTFS /p:1
```

### 1.2 - Print Files

> [!INFO]
> This command only works with text files only.

```
C:\> print.exe /d:<printer_name> file.txt

C:\> print.exe /d:\\UNC_PATH\printer_name file.txt
```

### 1.3 - Disable Network

```
C:\> ipconfig.exe /release
```

## 02 - PowerShell

### 2.1 - Clear Restore Points

```
PS C:\> Disable-ComputerRestore -Drive C:\\

PS C:\> Enable-ComputerRestore -Drive C:\\
```

### 2.2 - Format Drive

```powershell
PS C:\> New-Partition -DiskNumber 1 -UseMaximumSize -AssignDriveLetter C
Format-Volume -DriveLetter C -FileSystemLabel "New" -FileSystem NTFS -Full -Force -Confirm:$false
```

### 2.3 - Print Files

```
PS C:\> Get-ChildItem "H:\*.pdf" | ForEach-Object {Start-Process $_.Name -Verb Print}

PS C:\> Get-ChildItem "H:\*.pdf" -Recurse | ForEach-Object {Start-Process $_.Name -Verb PrintTo "\\Server\Printer1"}

PS C:\> Get-ChildItem "C:\path\to\file.pdf" | Out-Printer

PS C:\> Get-Content -Path 'C:\demo\document.txt' | Out-Printer

PS C:\> Get-Content -Path 'C:\demo\document.txt' | Out-Printer -Name 'HP Deskjet 2540 series (Netzwerk)'

PS C:\> Get-Content -Path file.pdf | Out-Printer

PS C:\> Start-Process -FilePath "c:\path\to\file.pdf" -Verb Print

PS C:\> Start-Process –FilePath "c:\path\to\file.pdf" –Verb Print -PassThru | %{ sleep 10; $_ } | kill
```

### 2.4 - Disable Network

```
PS C:\> Get-NetAdapter | Disable-NetAdapeter -Confirm:$True
```

---
## References

### CrowdStrike

- [Crowdstrike: Is There Such a Thing as a Malicious PowerShell Command?](https://www.crowdstrike.com/en-us/blog/is-there-such-a-thing-as-a-malicious-powershell-command/)