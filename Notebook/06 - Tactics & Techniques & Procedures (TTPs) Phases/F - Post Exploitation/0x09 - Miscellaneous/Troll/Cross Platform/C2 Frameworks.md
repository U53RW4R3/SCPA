# Metasploit

## 01 - Change Wallpaper

```
msf > use post/multi/manage/set_wallpaper

msf post(multi/manage/set_wallpaper) > options

Module options (post/multi/manage/set_wallpaper):

   Name            Current Setting  Required  Description
   ----            ---------------  --------  -----------
   SESSION                          yes       The session to run this module on
   WALLPAPER_FILE                   yes       The local wallpaper file to set on the remote session

msf post(multi/manage/set_wallpaper) > set session <session_ID>

msf post(multi/manage/set_wallpaper) > set wallpaper_file /path/to/image.jpeg

msf post(multi/manage/set_wallpaper) > run
```

## 02 - Keyboard and Mouse

### 2.1 - Disable Mouse and Keyboard

Disable keyboard.

```
meterpreter > uictl disable keyboard
```

Disable mouse.

```
meterpreter > uictl disable mouse
```

Disable both mouse and keyboard.

```
meterpreter > uictl disable all
```

Enable mouse and keyboard

```
meterpreter > uictl enable all
```

### 2.2 - Insert Keystrokes

```
meterpreter > keyboard_send "Hello! Who goes there?"
```

### 2.3 - Press Keystrokes

Syntax

```
meterpreter > keyevent <keycode> <press | up | down>
```

Press enter key.

```
meterpreter > keyevent 13 press
```

Control key down.

```
meterpreter > keyevent 17 down
```

### 2.4 - Insert Keystrokes

```
meterpreter > mouse
Usage: mouse action (move, click, up, down, rightclick, rightup, rightdown, doubleclick)
       mouse [x] [y] (click)
       mouse [action] [x] [y]
  e.g: mouse click
       mouse rightclick 1 1
       mouse move 640 480
```
## 03 - Play Audio

```
meterpreter > play /path/to/audio.wav
```

## 04 - Open Link via Web Browser

```
msf > use post/multi/open

msf post(multi/open) > set session <session_ID>

msf post(multi/open) > set URI <schema>://<URI>

msf post(multi/open) > run
```

## 05 - Play YouTube

```
msf > use post/multi/manage/play_youtube

msf post(multi/manage/play_youtube) > set session <session_ID>

msf post(multi/manage/play_youtube) > set vid <youtube_ID>

msf post(multi/manage/play_youtube) > run
```

---
## References

### Rapid7

- [Rapid7: Metasploit Framework - Manage Open URI](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/manage/open.md)

### CYBER ARMS

- [CYBER ARMS: Bringing Metasploit Exploits to Life with Powershell](https://cyberarms.wordpress.com/2015/01/22/bringing-metasploit-exploits-to-life-with-powershell/)