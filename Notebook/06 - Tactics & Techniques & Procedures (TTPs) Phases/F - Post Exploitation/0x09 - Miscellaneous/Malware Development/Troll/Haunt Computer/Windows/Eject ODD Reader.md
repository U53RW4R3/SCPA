# Eject Optical Disc Drive Reader

## Scripting

### PowerShell

```powershell
$wmplayer = New-Object -COM "WMPlayer.OCX.7"
$wmplayer.cdromCollection.Item(0).Eject()
```

## WinAPI

### Python

```python
import ctypes
from time import sleep

winmm = ctypes.windll.winmm

mciSendStringA = winmm.mciSendStringW

def oddtray(tray: bool) -> bool:
	if tray:
		mciSendStringA(u"set cdaudio door open", None, 0, None)
	elif not tray:
		mciSendStringA(u"set cdaudio door open", None, 0, None)

if __name__ == "__main__":
	print("Opening CD Tray!")
	oddtray(True)

	sleep(2)

	print("Closing CD Tray!")
	oddtray(True)

```

> [!INFO]
> Using `mciSendStringW` windows function works only in 64-bit architecture.


```python
import ctypes
from time import sleep

winmm = ctypes.windll.winmm

mciSendStringW = winmm.mciSendStringW

def oddtray(tray: bool) -> bool:
	if tray:
		mciSendStringW(u"set cdaudio door open", None, 0, None)
	elif not tray:
		mciSendStringW(u"set cdaudio door open", None, 0, None)

if __name__ == "__main__":
	print("Opening CD Tray!")
	oddtray(True)

	sleep(2)

	print("Closing CD Tray!")
	oddtray(True)

```

### C\#

```cs
using System;
using System.Runtime.InteropServices;
using System.Text;

namespace OpticalDiscDrive {
	public class DiscDrive {
		[DllImport("winmm.dll", EntryPoint="mciSendStringA", CharSet=CharSet.Ansi)]
        static extern Int32 mciSendString(string lpstrCommand, StringBuilder lpstrReturnString, int uReturnLength, IntPtr hwndCallback);

		static void Main(string[] args) {
			Console.WriteLine("Opening CD Tray!");
			ODDTray(true);
			Console.WriteLine("Closing CD Tray!");
			ODDTray(false);
		}

		public bool ODDTray(bool open) {
			StringBuilder ODDTrayString = new StringBuilder();

			int return_value = 0;
			
			switch (open) {
				case true:
					return_value = mciSendString("set cdaudio door open", ODDTrayString, 127, IntPtr.Zero);
					return return_value == 0;
				case false:
					return_value = mciSendString("set cdaudio door closed", ODDTrayString, 0, IntPtr.Zero);
					return return_value == 0;
				default:
					return false;
			}
		}
	}
}
```

### C++

```cpp
#include <windows.h>
#include <mmsystem.h>

#pragma comment(lib, "winmm.lib")

BOOL cdTray(BOOL open) {
	switch (open) {
		case TRUE:
			if (::mciSendString("set cdaudio door open", nullptr, 0, 0) == 0)
				return TRUE;
			else
				return FALSE;
		case FALSE:
			if (::mciSendString("set cdaudio door closed", nullptr, 0, 0) == 0)
				return TRUE;
			else
				return FALSE;
		default:
			return FALSE;
	}
}

int main() {
	std::cout << "Opening CD Tray!" << std::endl;

	if (cdTray(TRUE))
		std::cout << "CD Tray opened successfully." << std::endl;
	else
		std::cout << "Failed to open CD Tray." << std::endl;

	// Wait for 2 seconds
	::Sleep(20000);

	std::cout << "Closing CD Tray!" << std::endl;
	if (cdTray(FALSE))
		std::cout << "CD Tray closed successfully." << std::endl;
	else
		std::cout << "Failed to close CD Tray." << std::endl;
}
```

---
## References

### Microsoft

- [Microsoft: `mciSendString`](https://learn.microsoft.com/en-us/previous-versions/ms709492(v=vs.85))

### HellBound Hackers

- [HellBound Hackers: CD Drive Constantly Opening](https://hbh.sh/code/19/1510/cd-drive-constantly-opening-ported-to-python)