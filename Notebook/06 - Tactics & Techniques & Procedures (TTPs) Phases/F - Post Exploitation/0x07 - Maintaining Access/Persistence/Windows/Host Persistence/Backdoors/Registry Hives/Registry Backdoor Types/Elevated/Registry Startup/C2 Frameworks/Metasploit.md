# Metasploit

## 01 - Add Registry Key Syntax

Set registry key value.

```
meterpreter > reg setval [-r <target_IP>] -k <hive_name>\\path\\to\\registry\\key -v <value> -t <registry_type> -d 'C:\path\to\shell.exe'

meterpreter > reg setval [-r <target_IP>] -k HKLM\\SOFTWARE\\Microsoft\\CurrentVersion\\Run -v <value> -t REG_SZ -d "rundll32.exe C:\path\to\shell.dll,ExecDLL" [-w <32 | 64>]
```

Syntax registry meterpreter command.

```
meterpreter > reg <command> [-r <target_IP>] -k <hive_name>\\path\\to\\registry\\key -v <registry_value> -t <registry_type> [-w <32|64>]
```

Enumerate registry key.

```
meterpreter > reg enumkey [-r <target_IP>] -k <hive_name>\\path\\to\\registry\\key [-w <32|64>]
```

Query registry key value.

```
meterpreter > reg queryval [-r <target_IP>] -k <hive_name>\\path\\to\\registry\\key -v <value> [-w <32|64>]
```

Create registry subkey.

```
meterpreter > reg createkey [-r <target_IP>] -k <hive_name>\\path\\to\\registry\\new_key [-w <32 | 64>]
```

Query registry keys

```
meterpreter > reg queryclass [-r <target_IP>] -k <hive_name>\\path\\to\\registry [-w <32|64>]
```

## 02 - Delete Registry Key Syntax

Delete registry key value.

```
meterpreter > reg deleteval [-r <target_IP>] -k <hive_name>\\path\\to\\registry\\key -v <value>

meterpreter > reg deleteval [-r <target_IP>] -k HKLM\\SOFTWARE\\Microsoft\\CurrentVersion\\Run -v <value>
```

---
## References

### Metasploit

- [Metasploit Documentation: Meterpreter Registry Command](https://docs.metasploit.com/docs/using-metasploit/advanced/meterpreter/meterpreter-reg-command.html)