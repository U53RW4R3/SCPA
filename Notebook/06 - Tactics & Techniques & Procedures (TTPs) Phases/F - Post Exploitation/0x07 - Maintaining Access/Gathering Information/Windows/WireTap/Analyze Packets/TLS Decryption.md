# TLS Decryption

Refer to this [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x07 - Maintaining Access/Gathering Information/Windows/WireTap/Analyze Packets/Capture Packets/Living off the Land|section]] to capture packets after settings `SSLKEYLOGFILE` environment variable.

```
C:\> set SSLKEYLOGFILE="/path/to/sslkeyfile"
```

Open **Wireshark** then go to **Preferences** (shortcut is `Ctrl + Shift + A)`.

![[01 - Wireshark Protocols.png]]

Then scroll all the way down and select **TLS**. In **(Pre)-Master-Secret log filename** choose the `SSLKEYLOGFILE` that was captured then apply settings.

![[02 - Wireshark TLS Protocol.png]]

Now you can decrypt the captured packets.

---
## References

### F5

- [F5: Decrypt SSL traffic with the `SSLKEYLOGFILE` environment variable on Firefox or Google Chrome using Wireshark](https://my.f5.com/manage/s/article/K50557518)