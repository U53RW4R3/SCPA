---
author(s):
  - Userware
tags:
  - post-exploitation
  - enumeration-and-discovery
  - living-off-the-land
  - networking
  - network-protocols
  - dns
  - windows
---
# Living off the Land

## 01 - DNS Sweep

DNS `nslookup.exe`.

```
C:\> for /L %i in (1,1,255) do @nslookup.exe 192.168.1.%i 192.168.1.254 2> nul | find.exe "Name" && echo 192.168.1.%i
```

## 02 - Reverse DNS Lookup

### 2.1 - Command Prompt

Using `nslookup` performing a reverse DNS `lookups` on the internal network.

```
> nslookup -type=<DNS_record_type>

> server <IP_DNS>
> <target_IP>
```

### 2.2 - PowerShell

```
PS C:\> $net = "192.168.1."; 0..255 | foreach ($r = (Resolve-DNSname -ErrorAction SilentlyContinue) $net$_ | Format-Table NameHost -HideTableHeaders | Out-String).trim().replace("\s+", "").replace("`r", "").replace("`n", " "); Write-Output "$net$_ $r"} | Tee-Object output.txt
```

---
## References

### InfoSec Matter

- [InfoSec Matter: Powershell Commands for Pentesters](https://www.infosecmatter.com/powershell-commands-for-pentesters/)