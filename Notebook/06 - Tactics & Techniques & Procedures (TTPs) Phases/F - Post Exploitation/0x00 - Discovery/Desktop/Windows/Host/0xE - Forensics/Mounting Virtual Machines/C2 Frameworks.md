# C2 Frameworks

## 01 - Metasploit

MSF Windows Manage VMDK Mount Drive Post Module

```
msf > use post/windows/manage/vmdk_mount

msf post(windows/manage/vmdk_mount) > options

Module options (post/windows/manage/vmdk_mount):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   DEL_LCK    false            yes       Delete .vmdk lock file
   DRIVE      Z                yes       Mount point (drive letter)
   READ_MODE  true             yes       Open file in read-only mode
   SESSION                     yes       The session to run this module on
   VMDK_PATH                   yes       Full path to the .vmdk file

msf post(windows/manage/vmdk_mount) > set vmdk_path "C:\\path\\to\\file.vmdk"

msf post(windows/manage/vmdk_mount) > set read_mode <true | false>

msf post(windows/manage/vmdk_mount) > set drive <drive_letter>

msf post(windows/manage/vmdk_mount) > set del_lck <true | false>

msf post(windows/manage/vmdk_mount) > set verbose <true | false>

msf post(windows/manage/vmdk_mount) > set session <session_ID>

msf post(windows/manage/vmdk_mount) > run
```

## 02 - Meterpreter Commands

Find the `.vmx` file and view the contents to to mount the `.vmdk` file. (TODO: check the module `find_vmx`)

```
meterpreter > search -d C:\\Users\\ -f *.vmx

meterpreter > run post/multi/gather/find_vmx
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xE - Forensics/Mounting Virtual Machines/VirtualBox]]

### Shell is coming

- [Shell is coming: Post Exploitation Mounting VMDK Files](https://www.shelliscoming.com/2017/05/post-exploitation-mounting-vmdk-files.html)