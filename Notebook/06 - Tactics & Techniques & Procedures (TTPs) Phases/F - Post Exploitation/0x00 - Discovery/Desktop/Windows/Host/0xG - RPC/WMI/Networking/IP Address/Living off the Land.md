# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #living-off-the-land #windows

## 01 - Basic

### 1.1 - Command Prompt

IP Addresses and Subnet.

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] nicconfig get description,ipaddress,macaddress
```

Network interfaces.

```
C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] interface ipv4 show interfaces

C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] interface ipv4 show subinterfaces

C:\> netsh.exe [-r <IP>] [-u [DOMAIN\]username] [-p password | *] interface ipv4 show joins
```

Get RDP connections.

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] rdtoggle list
```

Last logon connection.

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] netlogin get name,lastlogon,badpasswordcount
```

### 1.2 - PowerShell

IP Addresses and Subnet

```
PS C:\> (Get-CimInstance -ClassName Win32_NetworkAdapterConfiguration | Where-Object { $_.IPAddress -ne $null })).IPAddress[0]
```

## 02 - Netstat

```
PS C:\> Get-WMIObject Win32_NetConnection | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, Protocol, State | Format-Table -AutoSize
```

---
## References

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xC - Networking/IP Address/Manual/Living off the Land]]