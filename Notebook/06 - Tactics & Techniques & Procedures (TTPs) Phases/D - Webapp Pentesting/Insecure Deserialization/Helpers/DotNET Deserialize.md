# DotNET Deserialize

## Detection

Known .NET RCE Gadgets

```
System.Configuration.Install.AssemblyInstaller
System.Activities.Presentation.WorkflowDesigner
System.Windows.ResourceDictionary
System.Windows.Data.ObjectDataProvider
System.Windows.Forms.BindingSource
Microsoft.Exchange.Management.SystemManager.WinForms.ExchangeSettingsProvider
System.Data.DataViewManager, System.Xml.XmlDocument/XmlDataDocument
System.Management.Automation.PSObject
```

## General Primer

### Gadgets in .NET

System.Configuration.Install.AssemblyInstaller

set_Path
Execute payload on local assembly load System.Activities.Presentation.WorkflowDesigner 
set_PropertyInspectorFontAndColorData
Arbitrary XAML load
Requires Single Threaded Apartment (STA) thread System.Windows.ResourceDictionary
set_Source
Arbitrary XAML load
Required to be able to work with setters of types derived from IDictionary System.Windows.Data.ObjectDataProvider
set_(MethodName | ObjectInstance | ObjectType)
Arbitrary Method Invocation

### WhiteBox

Search the source code for the following terms:

```
TypeNameHandling
JavaScriptTypeResolver
```

Look for any serializers where the type is set by a user controlled variable.

### BlackBox

Search for the following base64 encoded content that starts with:

```
AAEAAAD/////
```

Search for content with the following text:

```
TypeObject
$type:
```