# Scanners

TODO: Provide information for finding sensitive files related to source forge repositories

## 01 - Common data exposure

### 1.1 - Nuclei

```
$ nuclei -u <URL> -t ~/nuclei-templates -pt http -tags exposure,config,backup,files,db,database,secret
```

### 1.2 - Network Mapper

Probe HTML and JavaScript comments to search for sensitive data.

```
$ nmap -p 80,443,8000,8080,8443 --script http-comments-displayer --script-args="http.useragent='<user_agent>'[,httpspider.maxdepth=<int>,httpspider.maxpagecount=<int>]" <IP>
```

Enumerate HTTP, service version and some common directories.

```
$ nmap -p 80,443,8000,8080,8443 -Pn -n -sV --script http-enum --script-args "[http-enum.displayall,]http.useragent='<user_agent>'" <IP>

"smbuser='<username>',smbhash='<nt_hash>'"
```

Find backup folders.

```
$ nmap -p 80,443,8000,8080,8443 -Pn -n --script http-backup-finder --script-args http.useragent='<user_agent>' <IP>
```

### 1.3 - Wapiti

```
$ wapiti -u <URL> -m backup,buster
```

### 1.4 - Nikto

```
$ nikto -host <IP> -Display 3 -Tuning 1235c -no404 -Plugins "tests;domino" -evasion 12
```

## 02 - Configuration files and directories

### 2.1 - Nuclei

`.git` config directory

```
$ nuclei -u <URL> -t ~/nuclei-templates -pt http -tags git,github,exposure,config,backup

$ nuclei -u <URL> -t ~/nuclei-templates -id git-config,exposed-gitignore
```

DS_Store

```
$ nuclei <URL> -t ~/nuclei-templates -tags ds_store
```

Ansible

```
$ nuclei -u <URL> -t ~/nuclei-templates -id ansible-config-disclosure
```

### 2.2 - Network Mapper

Find configuration backup files.

```
$ nmap -p 80,443,8000,8080,8443 --script http-config-backup --script-args http.useragent='<user_agent>' <IP>
```

Find exposed git config repositories.

```
$ nmap -p 80,443,8000,8080,8443 -Pn -n -sV --script http-git --script-args http.useragent='<user_agent>' <IP>
```

Enumerate SVN config repositories.

```
$ nmap -p 80,443,8000,8080,8443 -Pn -n -sV --script http-svn-info --script-args http.useragent='<user_agent>' <IP>

$ nmap -p 80,443,8000,8080,8443 -Pn -n -sV --script http-svn-enum --script-args http.useragent='<user_agent>' <IP>
```

### 2.3 - Metasploit

```
msf > use auxiliary/scanner/http/backup_file

msf auxiliary(scanner/http/backup_file) > set rhosts <IP>
```

## 03 - Metadata

```
$ nmap -p 80,443,8000,8080,8443 -Pn -n --script http-exif-spider --script-args http.useragent='<user_agent>' <IP>
```

## 04 - Internal IP Disclosure

```
$ nuclei -l urls.txt -t ~/nuclei-templates -id internal-ip-disclosure -o ipv4-addresses-output.txt
```

---
## References

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/D - Webapp Pentesting/0x03 - Bypass Webapp Security/Web Application Firewall (WAF)/Helpers/User Agents]]

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/D - Webapp Pentesting/0x01 - WebApp Security Scanners/Nikto/01 - Basic|Nikto]]