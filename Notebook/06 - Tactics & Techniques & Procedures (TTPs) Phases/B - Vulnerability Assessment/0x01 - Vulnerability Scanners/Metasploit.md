---
author(s):
  - Userware
tags:
  - vulnerability-assessment
  - T1595
  - metasploit-framework
---
# Metasploit

## 01 - Import Scanned Results

```
msf > db_import 
Usage: db_import <filename> [file2...]

Filenames can be globs like *.xml, or **/*.xml which will search recursively
Currently supported file types include:
    Acunetix
    Amap Log
    Amap Log -m
    Appscan
    Burp Session XML
    Burp Issue XML
    CI
    Foundstone
    FusionVM XML
    Group Policy Preferences Credentials
    IP Address List
    IP360 ASPL
    IP360 XML v3
    Libpcap Packet Capture
    Masscan XML
    Metasploit PWDump Export
    Metasploit XML
    Metasploit Zip Export
    Microsoft Baseline Security Analyzer
    NeXpose Simple XML
    NeXpose XML Report
    Nessus NBE Report
    Nessus XML (v1)
    Nessus XML (v2)
    NetSparker XML
    Nikto XML
    Nmap XML
    OpenVAS Report
    OpenVAS XML
    Outpost24 XML
    Qualys Asset XML
    Qualys Scan XML
    Retina XML
    Spiceworks CSV Export
    Wapiti XML
```

Import XML scans.

```
msf > db_import output.xml
```

## 02 - Network Mapper Integration

```
msf > db_nmap -Pn -n -sV --script=vulners [--script-args mincvss=7] <IP>
```

## 03 - Metasploit Modules

### 3.1 - Exploit Modules as Scanners

Some exploit modules contain a `check` command to scan a target to confirm if it's vulnerable or not.

```
msf > use exploit/windows/http/exchange_proxyshell_rce

msf exploit(windows/http/exchange_proxyshell_rce) > options

msf exploit(windows/http/exchange_proxyshell_rce) > set rhosts <<IP>/<CIDR> | file:/path/to/ip_targets.txt>

msf exploit(windows/http/exchange_proxyshell_rce) > set rport <PORT>

msf exploit(windows/http/exchange_proxyshell_rce) > check
```

### 3.2 - Auxiliary Modules

TODO: Demonstrate any auxiliary and exploit module to use it as a vulnerability scanner

```
msf auxiliary(scanner/) > options
```

## 04 - Analyze Vulnerabilities

```
msf > vulns -h
Print all vulnerabilities in the database

Usage: vulns [addr range]


OPTIONS:

    -d, --delete             Delete vulnerabilities. Not officially supported.
    -h, --help               Show this help information.
    -i, --info               Display vuln information.
    -o, --output <filename>  Send output to a file in csv format.
    -p, --port <port>        List vulns matching this port spec.
    -R, --rhosts             Set RHOSTS from the results of the search.
    -S, --search <filter>    Search string to filter by.
    -s, --service <name>     List vulns matching these service names.

Examples:
  vulns -p 1-65536          # only vulns with associated services
  vulns -p 1-65536 -s http  # identified as http on any port
```

```
msf > vulns -i
```

Analyze the potential exploits

```
msf > analyze
```

---
## References

### Rapid7

- [Rapid7: Metasploit Framework - Proxyshell Exploit Module](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/exploit/windows/http/exchange_proxyshell_rce.md)