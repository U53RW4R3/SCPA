# USB Activity

## Scripting

### Python

```python
import subprocess

def check_usb() -> bool:
	commands: list = ['wmic.exe', 'logicaldisk', 'get', 'DriveType,', 'caption']
	output = subprocess.check_output(commands, shell=True)

	for drive in str(output).strip().split('\\r\\r\\n'):
		if '2' in drive:
			drive_letter = drive.split(':')[0]
			drive_type = drive.split(':')[1].strip()
			if drive_type == '2':
				return True
		else:
			return False

if __name__ == "__main__":
	if check_usb():
		print("Removable media is present!")
	else:
		print("Not found!")
```

## WinAPI

### Python

You find a removable media with a specific label name.

```python
import subprocess
import sys
from time import sleep
import psutil
import win32api

def get_drives() -> int:
	get_drive = subprocess.getoutput("fsutil.exe fsinfo drives").split(" ")[1:]
	last_drive = get_drive[-1]
	length_drives = get_drive.index(last_drive)
	return length_drives + 1

def check_usb_name(label_name: str) -> bool:
	for drive in range(0, get_drives()):
		try:
			removable = psutil.disk_partitions()[drive][3].split(",")[1]

			if "removable" in removable:
				disk_name = psutil.disk_partitions()[drive][1]
				disk_label = win32api.GetVolumeInformation(f"{disk_name}\\")[0]

				
				if disk_label == label_name:
					return True
		except IndexError:
			pass

	return False

if __name__ == '__main__':
	# Choose a specific removable media using label name to detect it
	removable_media_name = 'LABEL NAME'

	if check_usb_name(removable_media_name):
		print("USB drive detected:", str(removable_media_name))
	else:
		print("Not found!")
```