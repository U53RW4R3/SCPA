# Enumerate Debuggers

> [!NOTE]
> `PROCESS_ALL_ACCESS` isn't required. Only `PROCESS_CREATE_PROCESS` is efficient.

## Running Process

```
OpenProcess
```

### C++

```cpp
bool process_check() {
	string sandboxProcesses[numSandboxProcesses] = {
				"vmsrvc.exe",
				"tcpview.exe",
				"wireshark.exe",
				"srvmon.exe",
				"saHookMain.exe",
				"bmrt.exe"
	};
	
	WTS_PROCESS_INFO* pWPIs = NULL;
	DWORD dwProcCount = 0;
	if (WTSEnumerateProcesses(WTS_CURRENT_SERVER_HANDLE, NULL, 1, &pWPIs, &dwProcCount)) {
		//Go through all processes retrieved
		for (DWORD i = 0; i < dwProcCount; i++) {
			for (int j = 0; j < numSandboxProcesses; j++) {
				string enum_process = pWPIs[i].pProcessName;
				string av_process = (string)sandboxProcesses[j];
				if (!enum_process.compare(av_process)) {
					return true;
				}
			}
		}
	}
	
	//Free memory
	if (pWPIs) {
		WTSFreeMemory(pWPIs);
		pWPIs = NULL;
	}
	return false;
}

if (process_check()) {
	return 0;
}
```

## Window Name

```
FindWindow
```

---
## References

### CheckPoint

- [CheckPoint: Evasions Anti-Debug - Misc](https://evasions.checkpoint.com/src/Anti-Debug/techniques/misc.html)

### TrustedSec

- [TrustedSec: Enumerating Anti-Sandboxing Techniques](https://trustedsec.com/blog/enumerating-anti-sandboxing-techniques)