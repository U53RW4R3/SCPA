# Detect Domain Controller

```c
#include <stdio.h>
#include <string.h>
#include <windows.h>
#include <sysinfoapi.h>

#pragma comment(lib, "kernel32.lib")

#define MAX_PATH 255
#define DOMAIN_NAME L"<DOMAIN_NAME>"

BOOL domain_check() {
    DWORD buffer_size = MAX_PATH;
    TCHAR domain_name_buffer[MAX_PATH];
    LPCWSTR target_domain = DOMAIN_NAME;

    GetComputerNameExW(ComputerNameDnsDomain, domain_name_buffer, &buffer_size);
    if (domain_name_buffer != target_domain) {
        return FALSE;
    } else {
        return TRUE;
    }
}

int main() {
    if (!domain_check()) {
        printf("Doesn't seem like we're on the right system...\n");
        return 1;
    }

    printf("Looks safe! Continue with malicious stuff!\n");
    return 0;
}
```

---
## References

### Jake Adelson

- [Jake Adelson: Malware Development for Dummies](https://defcontoronto.com/wp-content/uploads/2022/10/malware_development_for_dummies_Jake_Adelson.pdf)