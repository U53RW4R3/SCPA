# Open System Process

## C

```c
int main() {
	HANDLE file
	HANDLE process;

	process = OpenProcess(PROCESS_ALL_ACCESS, FALSE, 4);

	if (process == NULL) {
		// execute payload here	
	}

	return 0;
}
```

## C\#

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Runtime.InteropServices;

namespace SystemProcess {
    class Runner {
        [DllImport("kernel32.dll", SetLastError = true)]
        public static extern IntPtr OpenProcess(
                uint processAccess,
                bool bInheritHandle,
                int processId
            );

        static void Main(string[] args) {
            IntPtr process = OpenProcess(0x001F0FFF, false, 4);
            if (process == IntPtr.Zero) {
                // execute payload here
            }
        }
    }
}
```

---
## References

### Source Repositories

- [cinzinga: Evasion-Practice](https://github.com/cinzinga/Evasion-Practice)