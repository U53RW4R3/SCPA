# PowerShell

## Encoding Scheme

### Base32

```
$ msfvenom -p cmd/windows/generic cmd="cat /etc/passwd" -f base32
```

### Base64

#### Encoding Strings

```
$ msfvenom -p cmd/windows/generic cmd="cat /etc/passwd" -f base64
```

Powershell Cmdlet works.

```powershell
PS C:\> $str = 'A string'

[System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($str))
```

#### Encoding File

This also applies to binary files especially to encode shellcode.

```powershell
PS C:\> $file = 'C:\path\to\shellcode.bin'
$raw_bytes = [IO.File]::ReadAllBytes($file)

# Or this option
# $raw_bytes = [Text.Encoding]::Unicode.GetBytes($(Get-Content $file -Encoding UTF-8 -Raw))

$encoded = [Convert]::ToBase64String($raw_bytes)
```