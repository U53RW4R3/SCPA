---
author(s):
  - Userware
tags:
  - helpers
  - malware-development
  - defense-evasion
---
# Batch

## String Manipulation

### Remove Extension

Just remove `.exe` to execute the command.

```
cmd

powershell
```

### Shorten Flags

```
powershell.exe -e <base64_encoded>
powershell.exe -ec <base64_encoded>
powershell.exe -en <base64_encoded>
powershell.exe -enc <base64_encoded>
powershell.exe -enco <base64_encoded>
powershell.exe -encod <base64_encoded>
powershell.exe -encode <base64_encoded>
powershell.exe -encoded <base64_encoded>
powershell.exe -encodedc <base64_encoded>
powershell.exe -encodedco <base64_encoded>
powershell.exe -encodedcom <base64_encoded>
powershell.exe -encodedcomm <base64_encoded>
powershell.exe -encodedcomma <base64_encoded>
powershell.exe -encodedcomman <base64_encoded>
powershell.exe -encodedcommand <base64_encoded>
```

### Case Insensitive

```
pOweRsHeLl.eXE
```

### Concatenation

```batch
"pow" & "er" & "shell.exe"
```

## Regular Expression

### Wildcards

Using the asterisk (`*`) as a placeholder to interpret whatever character will from the start to the end.

```
dir C:\*indows
```

### Character Substitution

```
dir C:\?indo?s
```

---
## References

### Source Repositories

- [r00t-3xp10it: Simple Obfuscation](https://github.com/r00t-3xp10it/hacking-material-books/blob/master/obfuscation/simple_obfuscation.md)

### TrustedSec

- [TrustedSec: Discovering the Anti-Virus Signature and Bypassing It](https://www.trustedsec.com/blog/discovering-the-anti-virus-signature-and-bypassing-it)

### Bordergate

- [Bordergate: Obfuscating Command Line Arguments](https://www.bordergate.co.uk/obfuscating-command-line-arguments/)

### Jeffrey Bencteux

- [Jeffrey Bencteux: File Types](https://www.bencteux.fr/posts/filetypes/)

### Rob van der Woude

- [Rob van der Woude: Useful commands for Windows administrators](https://www.robvanderwoude.com/ntadmincommands.php)

### 0xsp

- [0xsp: handy techniques to bypass environment restrictions](https://0xsp.com/offensive/handy-techniques-to-bypass-environment-restrictions/)