---
author(s):
  - Userware
tags:
  - initial-access
  - password-cracking
---
# #hashcat

## 01 - Attack Mode

Wordlist attack-mode.

```
$ hashcat -a 0 -m <hash_type> hashes.txt passwords.lst
```

Brute force attack-mode

```
$ hashcat -a 3 -m <hash_type> hashes.txt ?a?a?a?a?a?a
```

Display the cracked hashes.

```
$ hashcat --show --outfile-format 2 | sort
```

## 02 - Cracking Hashes

### 2.1 - Cryptographic Hash Functions

MD5 hash.

```
$ hashcat -a 0 -m 0 md5_hashes.txt passwords.lst
```

### 2.2 - Password Managers

KeePass(XC) hash.

```
$ hashcat -a 0 -m 13400 keepass_hash.txt passwords.lst
```

### 2.3 - Ansible Vault

![[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x00 - Exploitation/0xC - Password Cracking/Offline/John The Ripper#^7f9178]]
![[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x00 - Exploitation/0xC - Password Cracking/Offline/John The Ripper#^e0a1ed]]

Crack the hash.

```
$ hashcat -a 0 -m 16900 hash.txt passwords.lst
```

![[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x00 - Exploitation/0xC - Password Cracking/Offline/John The Ripper#^508ff7]]
![[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x00 - Exploitation/0xC - Password Cracking/Offline/John The Ripper#^3fa923]]

### 2.4 - Wi-Fi

WPA-EAPOL-PBKDF2

```
$ hashcat -a 0 -m 2500 wifi-handshakes.hccapx passwords.lst
```

### 2.5  - Network Ports

#### 2.5.1 - SSH

Private SSH Keys.

```
$ hashcat -a 0 -m 22911 ssh_hash.txt passwords.lst

$ hashcat -a 0 -m 22921 ssh_hash.txt passwords.lst

$ hashcat -a 0 -m 22931 ssh_hash.txt passwords.lst

$ hashcat -a 0 -m 22941 ssh_hash.txt passwords.lst

$ hashcat -a 0 -m 22951 ssh_hash.txt passwords.lst
```

Crack `known_hosts`.

Clone the repository.

```
$ git clone https://github.com/chris408/known_hosts-hashcat
```

Convert `known_hosts` using the script to start cracking.

```
$ python3 ~/known_hosts-hashcat/kh-converter.py known_hosts > converted_entry

$ hashcat -a 3 -m 160 --hex-salt converted_entry ~/known_hosts-hashcat/ipv4_hcmask.txt
```

### 2.6 - Linux

TODO: Fill in this information related to cracking linux hashes

### 2.7 - Windows

#### 2.7.1 - NTLM

```
$ hashcat -a 0 -m 1000 -r /usr/share/hashcat/rules/best64.rule nt_hashes.txt passwords.lst
```

#### 2.7.2 - Kerberoast

^87baa5

Kerberos 5, etype 23, TGS-REP

```
$ hashcat -a 0 -m 13100 kerberoast_hashes.txt passwords.lst
```

#### 2.7.3 - ASREPRoast

^6d0af5

Kerberos 5, etype 23, AS-REP

```
$ hashcat -a 0 -m 18200 asreproast_hashes.txt passwords.lst
```

---
## References

### Hashcat

- [Hashcat: Example Hashes](https://hashcat.net/wiki/doku.php?id=example_hashes)

### TrustedSec

- [TrustedSec: Better Hacking Through Cracking Know Your Rules](https://www.trustedsec.com/blog/better-hacking-through-cracking-know-your-rules/)

### Hackers Arise

- [Hackers Arise: Password Cracking Strategy](https://www.hackers-arise.com/password-cracking-strategy)

### Pentester Academy

- [Pentester Academy: Cracking SSH known_hosts file using Hashcat](https://blog.pentesteracademy.com/cracking-ssh-known-hosts-file-using-hashcat-1893eb6ff50)