# Command Execution

## Execute Commands

### C Runtime

```python
from ctypes import *

# Load the library
msvcrt = cdll.msvcrt

msvcrt.system.argtypes = [c_char_p]
msvcrt.system.restype = c_int

system = msvcrt.system

def execute_command(command: str) -> None:
    command_bytes = command.encode('utf-8')

    system(command_bytes)

def main() -> None:
	execute_command("dir")

if __name__ == '__main__':
	main()
```

## Run As Administrator

### Windows

#### WinAPI

##### `ctypes`

```python
import ctypes
from sys import executable

shell32 = ctypes.windll.shell32
ShellExecuteW = shell32.ShellExecuteW

def run_as():
    executable_path = os.path.realpath(executable)
    result = ShellExecuteW(None, 'runas', executable_path, '', None, 1)
    if result > 32:
        return None
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x01 - Weaponization/0xC - Client-Side Attacks/Delivery Methods/Command and Scripting Interpreter/Desktop/Windows/Code Execution/C/Malware Development/Command Execution]]