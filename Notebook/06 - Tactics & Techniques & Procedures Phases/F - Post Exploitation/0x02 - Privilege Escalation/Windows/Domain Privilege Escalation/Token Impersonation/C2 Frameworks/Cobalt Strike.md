# Cobalt Strike

## 01 - Steal Token

```
beacon> steal_token <pid>
```

Enumerate current user with privileges.

```
beacon> getuid

beacon> getprivs
```

## 02 - Make Token

```
beacon> make_token <domain>\<username> <password>
```

Enumerate current user with privileges.

```
beacon> getuid

beacon> getprivs
```

## 03 - SpawnAs

```
beacon> spawnas <domain>\<username> <password>
```

Enumerate current user.

```
beacon> getuid
```

## 04 - Revert Token

Revert back to original privileges.

```
beacon> rev2self
```

---
## References

- [Demystifying Cobalt Strike's `make_token` Command](https://research.nccgroup.com/2023/11/10/demystifying-cobalt-strikes-make_token-command/)

### DMCXBlue

- [DMCXBlue: Privilege Escalation Access Token Manipulation](https://dmcxblue.gitbook.io/red-team-notes/privesc/access-token-manipulation)