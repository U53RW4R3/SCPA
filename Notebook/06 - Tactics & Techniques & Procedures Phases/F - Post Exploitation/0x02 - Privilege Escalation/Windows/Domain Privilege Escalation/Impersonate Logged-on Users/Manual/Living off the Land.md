# Living off the Land

TODO: Refer to the link below

## 01 - Logged-on Users Enumeration

### 1.1 - Command Prompt

```
C:\> qwinsta [/server:<IP>]

C:\> query user [/server:<IP>]

C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] computersystem get name
```

### 1.2 - PowerShell

#### 1.2.1 - Logged-on users (locally)

```
PS C:\> Get-CimInstance -ClassName Win32_ComputerSystem [-ComputerName <IP>]

PS C:\> Get-WmiObject -ClassName Win32_ComputerSystem [-ComputerName <IP>]
```

#### 1.2.2 - Logged-on users

```
PS C:\> Get-LoggedOnUser [-ComputerName <IP>]

PS C:\> Get-Process -IncludeUserName

PS C:\> Get-Process | Where-Object {$_.UserName} | Format-Table UserName -Unique

PS C:\> Get-CimInstance -ClassName Win32_LoggedOnUser [-ComputerName <IP>]

PS C:\> Get-WmiObject -ClassName Win32_LoggedOnUser [-ComputerName <IP>]
```

#### 1.2.3 - Logon sessions

```
PS C:\> Get-CimInstance -ClassName Win32_LogonSession [-ComputerName <IP>]

PS C:\> Get-WmiObject -ClassName Win32_LogonSession [-ComputerName <IP>]
```

## 01 - Schtasks

## 02 - At

---
## References

### LOFLCAB

- [LOFLCAB: Get-Process](https://lofl-project.github.io/loflcab/Cmdlets/Get-Process/)

- [LOFLCAB: qwinsta](https://lofl-project.github.io/loflcab/Binaries/qwinsta/)

### Pentest Party

- [Pentest Party: Lateral Movement Scheduled Task](https://pentest.party/notes/lateral-movement/scheduled-task)