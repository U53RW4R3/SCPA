# WriteProcessMemory

Writes data to an area of memory in a specified process. The entire area to be written to must be accessible or the operation fails.

## Python

```python
import ctypes
import ctypes.wintypes as wt

kernel32 = ctypes.windll.kernel32

WriteProcessMemory = kernel32.WriteProcessMemory
WriteProcessMemory.argtypes = [
	wt.HANDLE, wt.LPVOID, wt.LPCVOID, ctypes.c_size_t, wt.LPVOID]
WriteProcessMemory.restype = wt.BOOL
```

## PowerShell

```powershell
$Win32Functions = New-Object System.Object

$WriteProcessMemoryAddress = Get-ProcAddress kernel32.dll WriteProcessMemory
$WriteProcessMemoryDelegate = Get-DelegateType @([IntPtr], [IntPtr], [IntPtr], [UIntPtr], [UIntPtr].MakeByRefType()) ([Bool])
$WriteProcessMemory = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WriteProcessMemoryAddress, $WriteProcessMemoryDelegate)
$Win32Functions | Add-Member -MemberType NoteProperty -Name WriteProcessMemory -Value $WriteProcessMemory
```