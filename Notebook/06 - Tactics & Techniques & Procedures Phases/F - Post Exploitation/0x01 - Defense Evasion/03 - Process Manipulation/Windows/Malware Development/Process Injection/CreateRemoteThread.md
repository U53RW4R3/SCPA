# CreateRemoteThread

Creates a thread that runs in the virtual address space of another process.

## Python

```python
import ctypes
import ctypes.wintypes as wt

kernel32 = ctypes.windll.kernel32

CreateRemoteThread = kernel32.CreateRemoteThread
CreateRemoteThread.argtypes = [
	wt.HANDLE, wt.LPVOID, ctypes.c_size_t, wt.LPVOID, wt.LPVOID, wt.DWORD, wt.LPVOID]
CreateRemoteThread.restype = wt.HANDLE

CloseHandle = kernel32.CloseHandle
CloseHandle.argtypes = [wt.HANDLE]
CloseHandle.restype = wt.BOOL

CloseHandle(remote_thread)
```

## C

```c
#include <windows.h>
#include <processthreadsapi.h>

#pragma comment(lib, "kernel32.lib")

CreateRemoteThread()
```

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o payload.exe payload.c
```

## PowerShell

```powershell
$Win32Functions = New-Object System.Object

$CreateRemoteThreadAddress = Get-ProcAddress kernel32.dll WriteProcessMemory
$CreateRemoteThreadDelegate = Get-DelegateType @([IntPtr], [IntPtr], [UIntPtr], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr])
$CreateRemoteThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($CreateRemoteThreadAddress, $CreateRemoteThreadDelegate)
$Win32Functions | Add-Member -MemberType NoteProperty -Name CreateRemoteThread -Value $CreateRemoteThread
```

---
## References

### Tenouk

- [Tenouk: Processes and Threads - C Run-Time - Part 1](https://www.tenouk.com/ModuleR.html)

- [Tenouk: Processes and Threads - C Run-Time - Part 4](https://www.tenouk.com/ModuleS.html)

- [Tenouk: Processes and Threads - WinAPIs - Part 6](https://www.tenouk.com/ModuleU.html)