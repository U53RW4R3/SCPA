# VirtualAllocEx

Reserves, commits, or changes the state of a region of memory within the virtual address space of a specified process. The function initializes the memory it allocates to zero.

## Python

```python
import ctypes
import ctypes.wintypes as wt

kernel32 = ctypes.windll.kernel32

VirtualAllocEx = kernel32.VirtualAllocEx
VirtualAllocEx.argtypes = [wt.HANDLE, wt.LPVOID, ctypes.c_size_t, wt.DWORD, wt.DWORD]
VirtualAllocEx.restype = wt.LPVOID
```

## PowerShell

```powershell
$Win32Functions = New-Object System.Object

$VirtualAllocExAddress = Get-ProcAddress kernel32.dll VirtualAllocEx
$VirtualAllocExDelegate = Get-DelegateType @([IntPtr], [IntPtr], [UIntPtr], [UInt32], [UInt32]) ([IntPtr])
$VirtualAllocEx = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($VirtualAllocExAddress, $VirtualAllocExDelegate)
$Win32Functions | Add-Member -MemberType NoteProperty -Name VirtualAllocEx -Value $VirtualAllocEx
```

```powershell
$Win32Functions = New-Object System.Object

$WaitForSingleObjectAddress = Get-ProcAddress kernel32.dll WaitForSingleObject
$WaitForSingleObjectDelegate = Get-DelegateType @([IntPtr], [UInt32]) ([UInt32])
$WaitForSingleObject = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WaitForSingleObjectAddress, $WaitForSingleObjectDelegate)
$Win32Functions | Add-Member -MemberType NoteProperty -Name WaitForSingleObject -Value $WaitForSingleObject
```

---
## References

### MalAPI

- [MalAPI: `VirtualAllocEx`](https://malapi.io/winapi/VirtualAllocEx)