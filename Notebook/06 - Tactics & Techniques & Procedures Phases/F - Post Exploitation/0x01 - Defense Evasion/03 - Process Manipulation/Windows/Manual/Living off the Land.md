# Living off the Land

## 01 - Terminate Process

### 1.1 - Command Prompt

Terminate the process with process identifier (PID).

```
C:\> taskkill.exe [/s <IP>] [/u <username> /p <password>] /pid <PID> /f
```

Terminate the process with a name.

```
C:\> taskkill.exe [/s <IP>] [/u <username> /p <password>] /im <process.exe> /f

C:\> tskill.exe <process.exe> [/server:<IP>] /a /v

C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] PROCESS WHERE "Name LIKE '<process.exe>'" CALL Terminate
```

### 1.2 - PowerShell

Terminate the process with process identifier (PID).

```
PS C:\> Stop-Process -Id <PID> -Force
```

Terminate the process with a name.

```
PS C:\> Stop-Process -Name <process.exe> -Force

PS C:\> Get-Process [-ComputerName <IP>] | Stop-Process -Force
```

### 1.3 - Sysinternals

> [!IMPORTANT] Conditions
> To execute sysinternal tool. EULA must be accepted (`-accepteula`). Otherwise this can be done in registry hive.
> ```
> C:\> reg.exe add [\\<IP>\]HKCU\Software\Sysinternals /t REG_DWORD /v 'EulaAccepted' /d 0x00000001
> 
> PS C:\> Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Type DWord -Name 'EulaAccepted' -Value 0x00000001
> ```

#### 1.3.1 - Command Prompt

```
C:\> net.exe use z: \\live.sysinternals.com\tools

C:\> copy z:\pskill64.exe .

C:\> net.exe use z: /delete
```

#### 1.3.2 - PowerShell

```
PS C:\> New-PSDrive -Name Z -PSProvider FileSystem -Root "\\live.sysinternals.com\tools"

PS C:\> Copy-Item z:\pskill64.exe .

PS C:\> Remove-PSDrive -Name Z
```

Accept the EULA.

```
C:\> .\pskill64.exe -accepteula
```

Terminate process identifier.

```
C:\> .\pskill64.exe [\\<IP> -u <username> -p <password>] <pid>
```

Terminate process name.

```
C:\> .\pskill64.exe [\\<IP> -u <username> -p <password>] <process_name>.exe
```

## 02 - Suspend Process

> [!IMPORTANT] Conditions
> To execute sysinternal tool. EULA must be accepted (`-accepteula`). Otherwise this can be done in registry hive.
> ```
> C:\> reg.exe add [\\<IP>\]HKCU\Software\Sysinternals /t REG_DWORD /v 'EulaAccepted' /d 0x00000001
> 
> PS C:\> Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Type DWord -Name 'EulaAccepted' -Value 0x00000001
> ```

### 2.1 - Command Prompt

```
C:\> net.exe use z: \\live.sysinternals.com\tools

C:\> copy z:\pssuspend64.exe .

C:\> net.exe use z: /delete
```

### 2.2 - PowerShell

```
PS C:\> New-PSDrive -Name Z -PSProvider FileSystem -Root "\\live.sysinternals.com\tools"

PS C:\> Copy-Item z:\pssuspend64.exe .

PS C:\> Remove-PSDrive -Name Z
```

Accept the EULA.

```
C:\> .\pssuspend64.exe -accepteula
```

Suspend process identifier.

```
C:\> .\pskill64.exe [\\<IP> -u <username> -p <password>] <pid>
```

Suspend process name.

```
C:\> .\pskill64.exe [\\<IP> -u <username> -p <password>] <process_name>.exe
```


---
## References

### LOFLCAB

- [LOFLCAB: tasklist](https://lofl-project.github.io/loflcab/Binaries/tasklist/)

- [LOFLCAB: taskkill](https://lofl-project.github.io/loflcab/Binaries/taskkill/)

- [LOFLCAB:  tskill](https://lofl-project.github.io/loflcab/Binaries/tskill/)

- [LOFLCAB: WMIC](https://lofl-project.github.io/loflcab/Binaries/wmic/)

### Hacking Articles

- [Hacking Articles: Post Exploitation Using WMIC (System Command)](https://www.hackingarticles.in/post-exploitation-using-wmic-system-command/)