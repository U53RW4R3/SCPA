# Count Processes

> [!TIP]
> - If the OS is equal to Windows 10 or later versions it should have at least 75 running processes by average. If it's less than Windows 10 it should have at least 50 running processes by average.
> - For Linux desktop the average minimum should be between a range of 200 to 300 running processes.

## Python

```python
#!/usr/bin/python3
import psutil

def processes_count() -> int:
    return len(psutil.pids())

if __name__ == "__main__":
    if processes_count() >= 75:
        print("Average amount of processes")
    else:
        print("Sandbox detected!")
```

```python
#!/usr/bin/python3
import psutil

def processes_count() -> int:
    return sum(1 for _ in psutil.process_iter())

if __name__ == "__main__":
    if processes_count() >= 75:
        print("Average amount of processes")
    else:
        print("Sandbox detected!")
```

## PowerShell

```powershell
if ((Get-Process).Count -gt 75) {
	Write-Output "Average amount of processes"
}
```

---
## References

### Hackmag

- [Hackmag: Malware under surveillance. Sandboxes and how to detect them](https://hackmag.com/security/malware-sandbox)