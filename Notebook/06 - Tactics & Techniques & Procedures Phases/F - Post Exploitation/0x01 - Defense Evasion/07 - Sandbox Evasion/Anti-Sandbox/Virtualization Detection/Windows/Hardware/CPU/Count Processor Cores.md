# Count Processor Cores

## WinAPI

### C

```c
#include <stdio.h>
#include <string.h>
#include <windows.h>

BOOL check_processor() {
    SYSTEM_INFO system_info;
    GetSystemInfo(&system_info);
    DWORD number_of_processors = system_info.dwNumberOfProcessors;
    if (number_of_processors < 2) {
        printf("Unusually low number of processors. Likely a VM\n");
        return FALSE;
    }
}

int main() {
    if (!check_processor()) {
        printf("Looks like we might be in a sandbox. Don't do anything suspicious\n");
        return 0;
    }

    printf("Looks safe! Continue with malicious stuff!\n");
}
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x01 - Defense Evasion/08 - Obfuscate Artifacts/Obfuscation/Malware Development/Obfuscation Techniques/String Manipulation/Windows/Batch]]

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xF - Operating System/System/Malware Development/Architecture]]

### Jake Adelson

- [Jake Adelson: Malware Development for Dummies](https://defcontoronto.com/wp-content/uploads/2022/10/malware_development_for_dummies_Jake_Adelson.pdf)