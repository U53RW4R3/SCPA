---
author(s):
  - Userware
tags:
  - post-exploitation
  - defense-evasion
  - anti-forensics
  - living-off-the-land
  - windows
---
# Living off the Land

> [!TIP] Tamper History (OPSEC Consideration)
> Fill in fake data to tamper history.

## 01 - Registry Logs

### 1.1 - Windows Dialog Box

#### 1.1.1 - Command Prompt

```
C:\> reg.exe add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU /v a /d "<fake_commands>" /f
```

#### 1.1.2 - PowerShell

```
PS C:\> Set-ItemProperty -Path Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU -Name 'a' -Value '<fake_commands>' -Force
```

### 1.2 - Windows File Explorer

#### 1.2.1 - Command Prompt

```
C:\> reg.exe add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths /v a /d "<fake_paths>" /f
```

#### 1.2.2 - PowerShell

```
PS C:\> Set-ItemProperty -Path Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths -Name 'a' -Value '<fake_paths>' -Force
```

### 1.3 - Windows Search

#### 1.3.1 - Command Prompt

```
C:\> reg.exe add "[\\<IP>\]HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v a /d "Fake search history" /f
```

#### 1.3.2 - PowerShell

Insert fake history in windows search box.

```
PS C:\> Set-ItemProperty -Path "Registry::HKEY_LOCAL_MACHINE\Policies\Microsoft\Windows\Windows Search" -Name 'a' -Value 'Fake search history' -Force
```

### 1.4 - Document History

#### 1.4.1 - Command Prompt

```
C:\> reg.exe add "[\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs" /v 0 /d fake-data /f
```

#### 1.4.2 - PowerShell

Insert fake trace of accessing documents.

```
Set-ItemProperty -Path "Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs" -Name '0' -Value 'fake-data' -Force
```