# Scripting
## PowerShell

### Set Timestomp File

```powershell
function Set-MacAttribute {
    param (
        [string]$FilePath,
        [string]$CreationTime,
        [string]$LastAccessTime,
        [string]$LastWriteTime,
        [string]$ModifiedTime
    )

    if (-not (Test-Path $FilePath)) {
        Write-Error "The specified file does not exist: $FilePath"
        return
    }

    $file = Get-Item $FilePath

    if ($CreationTime) {
        $file.CreationTime = [DateTime]::ParseExact($CreationTime, "yyyy-MM-dd HH:mm:ss", $null)
        Write-Host "Creation time set to $CreationTime"
    }

    if ($LastAccessTime) {
        $file.LastAccessTime = [DateTime]::ParseExact($LastAccessTime, "yyyy-MM-dd HH:mm:ss", $null)
        Write-Host "Last access time set to $LastAccessTime"
    }

    if ($LastWriteTime) {
        $file.LastWriteTime = [DateTime]::ParseExact($LastWriteTime, "yyyy-MM-dd HH:mm:ss", $null)
        Write-Host "Last write time set to $LastWriteTime"
    }

    if ($ModifiedTime) {
        # In PowerShell, LastWriteTime is often synonymous with ModifiedTime
        $file.LastWriteTime = [DateTime]::ParseExact($ModifiedTime, "yyyy-MM-dd HH:mm:ss", $null)
        Write-Host "Modified time set to $ModifiedTime"
    }
}
```

Set creation time.

```
PS C:\> Set-MacAttribute -FilePath "C:\Path\To\File.txt" -CreationTime "yyyy-MM-dd HH:mm:ss"
```

Set last access time.

```
PS C:\> Set-MacAttribute -FilePath "C:\Path\To\File.txt" -LastAccessTime "yyyy-MM-dd HH:mm:ss"
```

Set last write (modified) time.

```
PS C:\> Set-MacAttribute -FilePath "C:\Path\To\File.txt" -LastWriteTime "yyyy-MM-dd HH:mm:ss"
```

Set MFT entry modified time.

```
PS C:\> Set-MacAttribute -FilePath "C:\Path\To\File.txt" -ModifiedTime "yyyy-MM-dd HH:mm:ss"
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x01 - Defense Evasion/13 - Anti-Forensics/Desktop/Windows/Clear Traces/02 - Timestomps/Manual/Living off the Land]]

### ObscureSec

- [ObscureSec: Modifying MAC properties with PowerShell](https://obscuresecurity.blogspot.com/2014/05/touch.html)