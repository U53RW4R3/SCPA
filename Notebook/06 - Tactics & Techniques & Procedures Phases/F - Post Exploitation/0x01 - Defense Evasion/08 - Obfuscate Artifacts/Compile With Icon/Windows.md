# Windows

## Python

#nuitka either you can compile it with a `.ico` file or any custom `.exe` file.

```
$ WINEDEBUG=-all wine cmd.exe /c nuitka <--windows-icon-from-ico file.ico | --windows-icon-from-exe "/path/to/program.exe"> [--follow-imports] --standalone --onefile payload.py

$ WINEDEBUG=-all wine python -m nuitka <--windows-icon-from-ico file.ico | --windows-icon-from-exe "/path/to/program.exe"> [--follow-imports] --standalone --onefile payload.py

$ docker run -v $(pwd):/tmp tobix/pywine WINEDEBUG=-all wine python -m nuitka <--windows-icon-from-ico file.ico | --windows-icon-from-exe "/path/to/program.exe"> [--follow-imports] --standalone --onefile --output-dir=/tmp/ /tmp/payload.py
```

You can use #pyinstaller as well.

```
$ WINEDEBUG=-all wine pyinstaller -i file.ico -F -w payload.py

$ docker run -v $(pwd):/tmp tobix/pywine WINEDEBUG=-all wine pyinstaller -i file.ico -F -w /tmp/payload.py --distpath /tmp/dist
```

## C

```c
#include <windows.h>

IDI_ICON_1 ICON "filename.ico"

VS_VERSION_INFO VERSIONINFO
FILEVERSION 7,1,0,4
PRODUCTVERSION 1,0,0,0
FILEFLAGSMASK 0x3fL
#ifdef _DEBUG
FILEFLAGS 0x1L
#else
FILEFLAGS 0x0L
#endif
FILEOS 0x4L
FILETYPE 0x1L
FILESUBTYPE 0x0L
BEGIN
    BLOCK "StringFileInfo"
    BEGIN
        BLOCK "040904b0"
        BEGIN
            VALUE "FileDescription", "Gregs Best Friend Application"
            VALUE "FileVersion", "7.1.0.4"
            VALUE "ProductName", "Your Product Name"
            VALUE "ProductVersion", "7.1"
            VALUE "LegalCopyright", "Copyright Â© 2019-2023 Stigs"
        END
    END
    BLOCK "VarFileInfo"
    BEGIN
        VALUE "Translation", 0x409, 1200
    END
END
```

To cross compile the payload. ^7b8f2f

```
$ x86_64-w64-mingw32-windres resource.rc resource.o

$ x86_64-w64-mingw32-gcc -o embedded-payload.exe resource.o payload.c
```

^0156d0

To compile it in windows. ^8747ee

```
C:\> rc resource.rc

C:\> cvtres /machine:x64 /out:resource.o resource.res

C:\> cl.exe /nologo /0x /W0 /GS- /DNDEBUG /Tc:payload.c /link /out:embedded-payload.exe /subsystem:console /machine:x64 resource.o
```

^af4abd