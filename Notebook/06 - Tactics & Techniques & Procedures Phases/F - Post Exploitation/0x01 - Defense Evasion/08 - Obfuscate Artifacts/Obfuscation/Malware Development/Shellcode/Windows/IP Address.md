# IP Address

## Scripting

### C++

Convert shellcode to IP addresses.

```cpp
#include <vector>
#include <sstream>

std::vector<std::string> bytesToIPAddresses(const unsigned char *bytes, size_t length) {
	std::vector<std::string> ipAddresses;

	for (size_t i = 0; i < length; i += 4) {
		if (i + 3 < length) {
			std::stringstream ip;
			ip << static_cast<int>(bytes[i]) << '.'
				<< static_cast<int>(bytes[i + 1]) << '.'
				<< static_cast<int>(bytes[i + 2]) << '.'
				<< static_cast<int>(bytes[i + 3]);
			ipAddresses.push_back(ip.str());
		}
	}

	return ipAddresses;
}
```

Convert IP addresses to shellcode.

```cpp
#include <vector>
#include <sstream>

std::vector<unsigned char> ipAddressesToBytes(const std::vector<std::string>& ipAddresses) {
	std::vector<unsigned char> byteArray;

	for (const auto &ip : ipAddresses) {
		std::stringstream ss(ip);
		std::string segment;

		while (std::getline(ss, segment, '.')) {
			int byteValue = std::stoi(segment);
			byteArray.push_back(static_cast<unsigned char>(byteValue));
		}
	}

	return byteArray;
}
```

---
## References

### Source Repositories

- [RedSiege: Chromatophore](https://github.com/RedSiege/Chromatophore)

- [ytincodenito: ShellcodeEvasion](https://github.com/ytincodenito/ShellcodeEvasion)

### RedSiege

- [RedSiege: Part 9 - Shellcode as IP Addresses](https://redsiege.com/blog/2024/08/adventures-in-shellcode-obfuscation-part-9-shellcode-as-ip-addresses/)

### Bordergate

- [Bordergate: Encoding Shellcode as IP Addresses](https://www.bordergate.co.uk/encoding-shellcode-as-ip-addresses/)

### Black-Hat-Zig

- [Black-Hat-Zig: IP Address Obfuscation](https://black-hat-zig.cx330.tw/Basic-Payload-Management/Payload-Obfuscation/IP-Address-Obfuscation/)