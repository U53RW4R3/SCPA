# Makecab

## 01 - Common Files

### 1.1 - Linux

```
/usr/bin/gcab
/usr/bin/cabextract
```

### 1.2 - Windows

```
C:\Windows\system32\extrac32.exe
C:\Windows\system32\expand.exe
```

Tap Archive's location.

![[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x04 - File Transfer and Data Exfiltration/Cross Platform/Archive Files/Tape Archive/Manual#^4b5127]]

## 02 - Archive Files

### 2.1 - Linux

To install programs in Debian-based distros.

```
$ sudo apt install -y gcab
```

To archive files.

```
$ gcab -c[z] <destination> <source>

$ gcab -c[z] archive.cab file.txt

$ rm file.txt
```

The file(s) should be inside in the archive.

```
$ gcab -l archive.cab
```

### 2.2 - Windows

```
C:\> makecab.exe <source> <destination>

C:\> makecab.exe file.txt archive.cab
```

`makecab.exe` can archive from a list of files specified in a text file with destinations.

```
C:\> dir /a-d |find "04/25/2021" |findstr.exe /V COMPONENTS > C:\ProgramData\list.txt && for /f "tokens=4,* delims= " %a in (C:\ProgramData\list.txt) do @echo %b >> C:\ProgramData\mca.txt

C:\> makecab.exe /d CabinetNameTemplate=enum_results.cab /D DiskDirectoryTemplate=C:\ProgramData /f C:\ProgramData\mca.txt
```

You perform Alternate Data Streams (ADS) in hidden files.

```
C:\> makecab.exe file.txt C:\Windows\eula.txt:archive.cab

C:\> dir /r C:\Windows\eula.txt
```

## 03 - Extract Files

### 3.1 - Linux

#### 3.1.1 - `gcab`

```
$ gcab -x archive.cab
```

#### 3.1.2 - `cabextract`

```
$ cabextract archive.cab
```

### 3.2 - Windows

```
C:\> extrac32.exe archive.cab /l "C:\path\to\directory\"

C:\> expand.exe archive.cab -f:* "C:\path\to\directory\"

C:\> tar.exe -xf archive.cab
```

---
## References

### GNOME

- [GNOME: Msitools](https://wiki.gnome.org/msitools)

### CABExtract

- [CABExtract](https://www.cabextract.org.uk/)