# Create User

## Scripting

### Batch

```batch
@echo off

REM set credentials
set user=
set password=

set AdminGroupSID=S-1-5-32-544
set AdminGroup=

for /f "usebackq tokens=1* delims==" %%I in (`wmic.exe group where "SID == '%AdminGroupSID%'" Get Name /value ^ | find.exe "="`) do set AdminGroup=%%J

set AdminGroup=%AdminGroup:~0,-1%
net.exe user %user% %password% /add /passwordchg:yes
net.exe localgroup %AdminGroup% %user% /add
wmic.exe useraccount where name='%user%' set passwordexpires=false
```

---
## References

- [Tenouk: Windows OS: User Accounts and Groups - Part 1](https://www.tenouk.com/ModuleM.html)

- [Tenouk: User Accounts and Groups - Part 3](https://www.tenouk.com/ModuleN.html)

- [Tenouk: Windows Users & Groups - A Supplementary Note](https://www.tenouk.com/cmnusrgrpsupp.html)