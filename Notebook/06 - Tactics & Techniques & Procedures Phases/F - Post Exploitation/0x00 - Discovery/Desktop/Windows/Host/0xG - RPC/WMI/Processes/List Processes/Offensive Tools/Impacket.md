---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - staying-off-the-land
  - networking
  - network-protocols
  - windows
---
# Impacket

Authentication syntax.

```
$ wmiquery.py [<domain>/]<username>:"<password>"@<IP>

$ wmiquery.py [<domain>/]<username>@<IP> -hashes :<nt_hash>
```

Query process names and identifiers.

```
WQL> SELECT * FROM Win32_Process WHERE NAME like 'cmd%%'

WQL> SELECT Caption,ExecutablePath,CommandLine FROM Win32_Process

WQL> SELECT Caption,Name,OSName,ExecutablePath,ProcessId,WindowsVersion,CommandLine FROM Win32_Process

WQL> SELECT Caption,Name,OSName,ExecutablePath,ProcessId,WindowsVersion,ParentProcessId,SessionId,CommandLine FROM Win32_Process
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xA - Internal Reconnaissance/Processes/Manual/Unix Shell]]