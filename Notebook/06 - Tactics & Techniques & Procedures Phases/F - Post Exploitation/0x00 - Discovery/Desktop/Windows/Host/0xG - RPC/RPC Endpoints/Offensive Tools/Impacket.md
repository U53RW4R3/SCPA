# Impacket

## Table References

### Locator Services

| **RPC Locator Service** | **Description**                                |
| ----------------------- | ---------------------------------------------- |
| `ncacn_ip_tcp`          | TCP port 135                                   |
| `ncadg_ip_udp`          | UDP port 135                                   |
| `ncacn_http`            | RPC over HTTP via TCP port 80, 593, and others |
| `ncacn_np`              | The `\pipe\epmapper` named pipe via SMB        |

### Named Pipes

| **Named Pipes**  | **Service**                                                                            | **Description**                                                     |
| ---------------- | -------------------------------------------------------------------------------------- | ------------------------------------------------------------------- |
| `\pipe\lsarpc`   | Local Security Authority (LSA)                                                         | Enumerate privileges, trust relationships, SIDs, policies and more. |
| `\pipe\samr`     | Local SAM Database                                                                     | Enumerate domain/local users, domain/local groups and more.         |
| `\pipe\svcctl`   | Service Control Manager                                                                | Remotely create, start, and stop services to execute commands       |
| `\pipe\atsvc`    | Task Scheduler                                                                         | Remotely create scheduled tasks to execute commands                 |
| `\pipe\epmapper` | Distributed Component Object Model (DCOM) and Windows Management Instrumentation (WMI) | Remote command execution via WMI                                    |
| `\pipe\winreg`   | Remote Registry Service                                                                | Used to access the system registry                                  |
## Enumeration

List the RPC endpoints.

```
$ rpcdump.py <IP> -p <135 | 593>
```

Running services.

```
$ rpcdump.py <IP> -p <135 | 593> | grep -E 'MS-RPRN\|MS-PAR'
```

---
## References

### Wadcoms

- [Wadcoms: Impacket RPCDump](https://wadcoms.github.io/wadcoms/Impacket-RPCDump/)