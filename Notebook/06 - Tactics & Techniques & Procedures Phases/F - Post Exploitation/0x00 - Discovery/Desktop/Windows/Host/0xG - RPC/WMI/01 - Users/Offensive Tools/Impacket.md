---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - staying-off-the-land
  - networking
  - network-protocols
  - msrpc
  - smb
  - windows
---
# Impacket

## 01 - Enumerate user accounts

Authentication syntax

```
$ wmiquery.py [<domain>/]<username>:"<password>"@<IP>

$ wmiquery.py [<domain>/]<username>@<IP> -hashes :<nt_hash>
```

Query local user accounts.

```
WQL> SELECT Name FROM Win32_Account
```

## 02 - Local groups enumeration

```
WQL> SELECT Name FROM Win32_Group
```