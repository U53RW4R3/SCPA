---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Command Prompt

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] process list brief

C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] process get Caption,CSName,Description,ExecutablePath,CommandLine

C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] PATH Win32_Process GET Caption, Name, OSName, ExecutablePath, ProcessId, WindowsVersion, ParentProcessId, SessionId, CommandLine
```

Filter a specific process.

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] Process WHERE "name='<process_name>'" GET ProcessId
```

## 02 - PowerShell

```powershell
PS C:\> Get-CimInstance -ClassName Win32_Process [-ComputerName <IP>] | Select-Object CommandLine

PS C:\> Get-CimInstance -Query "Select * from Win32_Process" [-ComputerName <IP>] | Where-Object {$_.Name -notlike "svchost*"} | Select Name, Handle, @{Label="Owner";Expression={$_.GetOwner().User}} | Format-Table -AutoSize

PS C:\> Get-WMiObject -ClassName Win32_Process [-ComputerName <IP>]

PS C\> Get-WmiObject -Query "Select * from Win32_Process" [-ComputerName <IP>] | Where-Object {$_.Name -notlike "svchost*"} | Select-Object Name, Handle, @{Label="Owner";Expression={$_.GetOwner().User}} | Format-Table -AutoSize
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xA - Internal Reconnaissance/Processes/Manual/Living off the Land]]

### Mubix

- [Malicious.link: Get Process List](https://room362.com/posts/2020/get-process-list/)