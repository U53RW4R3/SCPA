---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - networking
  - living-off-the-land
  - windows
---
# Network History

## 01 - Command Prompt

The description of the network. ^da382e

```
C:\> reg.exe query [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\*\* /v Description

C:\> reg.exe query [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\*\* /v ProfileName

C:\> reg.exe query [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged\*\* /v Description
```

The default gateway of the router's MAC address. ^6b25c4

```
C:\> reg.exe query [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged\*\* /v DefaultGatewayMac
```

DNS nameserver for the domain network. ^29a146

```
C:\> reg.exe query [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged\*\* /v DnsSuffix
```

The SSID's name of the network. ^05a79a

```
C:\> reg.exe query [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged\*\* /v FirstNetwork
```

## 02 - PowerShell

![[#^da382e]]

```
PS C:\> Get-ItemProperty -Path "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\*\*" -Name Description

PS C:\> Get-ItemProperty -Path "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\*\*" -Name ProfileName

PS C:\> Get-ItemProperty -Path "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged\*\*" -Name Description -Verbose
```

![[#^6b25c4]]

```
PS C:\> Get-ItemProperty -Path "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged\*\*" -Name DefaultGatewayMac
```

![[#^29a146]]

```
PS C:\> Get-ItemProperty -Path "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged\*\*" -Name DnsSuffix
```

![[#^05a79a]]

```
PS C:\> Get-ItemProperty -Path "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged\*\*" -Name FirstNetwork
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xB - Networking/Network Configuration/Known Wi-Fi Networks]]