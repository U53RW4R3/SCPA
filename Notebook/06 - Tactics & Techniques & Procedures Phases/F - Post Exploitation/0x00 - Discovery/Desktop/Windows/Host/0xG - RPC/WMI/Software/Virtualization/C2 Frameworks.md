---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - defense-evasion
  - metasploit-framework
  - windows
---
# C2 Frameworks

## 01 - Metasploit

```powershell
meterpreter > powershell_shell
PS > $VMAdapter = Get-CimInstance Win32_NetworkAdapter -Filter 'Manufacturer LIKE "%VMware%" OR Name LIKE "%VMWare%"'
PS > $VMBios = Get-CimInstance Win32_BIOS -Filter 'SerialNumber LIKE "%VMWare%"'
PS > $VMToolsRunning = Get-CimInstance Win32_Process -Filter 'Name="vmtoolsd.exe"'
PS > [Bool]($VMAdapter -or $VMBios -or $VMToolsRunning)
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x00 - Discovery/Desktop/Windows/Host/0xA - Internal Reconnaissance/Software/Virtualization/C2 Frameworks/Metasploit]]