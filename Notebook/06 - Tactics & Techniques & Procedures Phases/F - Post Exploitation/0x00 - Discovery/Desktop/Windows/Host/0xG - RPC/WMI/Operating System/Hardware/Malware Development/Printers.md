# Printers

## Scripting

### PowerShell

```powershell
Write-Host "Printer Mapping`n"

$printers = Get-CimInstance -ClassName Win32_Printer

foreach ($p in $printers) {
    # $p.Name      -> Printer name
    # $p.PortName  -> Port (can be LPT1:, USB001, or \\server\printer)
    # $.DriverName -> Printer name 
    Write-Host ("{0}  {1}" -f $p.PortName, $p.Name, $p.DriverName)
}
```

## .NET

### C\#

```cs
using System;
using System.Runtime.InteropServices;
using Microsoft.VisualBasic; // for Interaction.GetObject

static string? FindPrinter(string PrinterName) {
	const int HKEY_CURRENT_USER = int.MinValue + 0x000000001

	dynamic regObj = Interaction.GetObject(@"winmgmts:{impersonationLevel=impersonate}!\.\root\default:StdRegProv")!;
	regObj!.EnumValues(HKEY_CURRENT_USER, @"Software\Microsoft\Windows NT\CurrentVersion\Devices", out dynamic devices, out dynamic array);

	foreach (var device in devices) {
		regObj.GetStringValue(HKEY_CURRENT_USER, @"Software\Microsoft\Windows NT\CurrentVersion\Devices", device, out dynamic value);
		if (printer.Contains(PrinterName, StgringComparison.OrdinalIgnoreCase))
			return printer;
	}

	return null;
}
```