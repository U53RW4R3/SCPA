# C Runtime

## Python

```python
from ctypes import *

# Load the library
msvcrt = cdll.msvcrt

# Define the _getdrives function
msvcrt._getdrives.argtypes = []
msvcrt._getdrives.restype = c_int

_getdrives = msvcrt._getdrives

def get_drives() -> str:
    drives_bitmask = _getdrives()

    drives = ""
    for i in range(26):
        if drives_bitmask & (1 << i):
            drives += chr(ord('A') + i) + ":\\"
    return drives

def main() -> None:
    drives = get_drives()
    print(f"Available Drives: {drives}")

if __name__ == '__main__':
    main()
```

## C

```c
#include <stdio.h>
#include <windows.h>
#include <direct.h>
#include <errhandlingapi.h>
#include <tchar.h>

#pragma comment(lib, "kernel32.lib")

int main() {
    ULONG drives = _getdrives();
    if (drives == 0) {
        printf("Failed to retrieve logical drives. Error: %lu\n", GetLastError());
        return 1;
    }

    printf("Logical drives:\n");
    for (TCHAR drive = 'A'; drive <= 'Z'; drive++) {
        if (drives & (1 << (drive - 'A'))) { // Check if the corresponding bit is set
            printf("%c:\\\n", drive);
        }
    }

    return 0;
}
```

Compile the program to list the available drives.

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o list_drives.exe list_drives.c
```

---
## References

### Microsoft

- [Microsoft Documentation: `_getdrives`](https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/getdrives?view=msvc-170)