# Scripting

## Batch

```batch
@echo off

rem Get the list of drives
for %%drive in (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) do (
    if exist %%drive:\ (
        echo %%drive
    )
)
```

## PowerShell

### Cmdlets

```powershell
function Get-Drives {
    for ($ascii in 65..90) {
        $letter = [char]$ascii
        $drive = "${letter}:\"
        if (Test-Path $drive) {
            $drive
        }
    }
}

Write-Output "Logical drives:"
Get-Drives
```

Using AST to get the drives.

```powershell
function Get-Drives {
    $drives = foreach ($letter in [char[]]'ABCDEFGHIJKLMNOPQRSTUVWXYZ') {
        $drivePath = "{0}:" -f $letter
        if (Test-Path -LiteralPath $drivePath -PathType Container) {
            $drivePath
        }
    }
    return $drives
}

Get-Drives
```

### DCOM

Another variant using DCOM object.

```powershell
$network = New-Object -ComObject WScript.Network
$mappedDrives = $network.EnumNetworkDrives()

for ($drive = 0; $drive -lt $mappedDrives.Count(); $drive = $drive + 2) {
	Write-Output $drive
}
```

### .NET

```powershell
function Get-Drives {
    $drives = [System.IO.DriveInfo]::GetDrives()

    foreach ($drive in $drives) {
        # Check if the drive is ready before outputting
        if ($drive.IsReady) {
            Write-Output $drive.Name
        }
    }
}

Write-Output "Logical drives:"
Get-Drives
```

## Python

```python
import os
import string

def get_drives():
    """
    Returns a list of all available drives in the Windows system.
    """
	drives = [letter for letter in string.ascii_uppercase]
    return [drive + ':' for drive in drives if os.path.exists(drive + ':')]

def main() -> None:
	drives = get_drives()
	print("List of drives:")
	for drive in drives:
	    print(drive)

if __name__ == "__main__":
	main()
```

Another variant.

```python
import os

def get_drives():
    """
    Returns a list of all available drives in the Windows system.
    """
    drives = [chr(i) for i in range(ord('A'), ord('Z') + 1)]
    return [drive + ':' for drive in drives if os.path.exists(drive + ':')]

def main() -> None:
	drives = get_drives()
	print("List of drives:")
	for drive in drives:
	    print(drive)

if __name__ == "__main__":
	main()
```

Another variant.

```python
import os

def get_drives():
    """
    Returns a list of all available drives in the Windows system.
    """
	return [drive for drive in os.listdir('/') if drive.endswith(':')]

def main() -> None:
	drives = get_drives()
	print("List of drives:")
	for drive in drives:
	    print(drive)

if __name__ == "__main__":
	main()
```