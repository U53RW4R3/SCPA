# Living off the Land

## 01 - Command Prompt

### 1.1 - OS Version

Enumerating the system to see any kind of potential version we can take over.

```
C:\> systeminfo.exe [/s <IP>] [/u <username> /p <password>]

C:\> systeminfo.exe [/s <IP>] [/u <username> /p <password>] | findstr.exe /b /c:"OS Name" /c:"OS Version"

C:\> ver

C:\> type C:\Windows\WindowsUpdate.log
```

Will show at the top.

```
C:\> type C:\Windows\eula.txt

C:\> type C:\Windows\System32\eula.txt
```

Originally installed OS

```
C:\> type C:\Windows\System32\license.rtf
```

### 1.2 - Product Name

Will show at bottom (cdname/productname).

```
C:\> type C:\Windows\inf\layout.inf
```

## 02 - PowerShell

### 2.1 - OS Version

Enumerating the system to see any kind of potential version we can take over.

```
PS C:\> Get-ComputerInfo -Property OsVersion, OsName

PS C:\> ($PSVersionTable).BuildVersion

PS C:\> [System.Environment]::OSVersion.Version
```

### 2.2 - Hotfixes

Enumerate hotfixes.

```
PS C:\> Get-Hotfix
```

## 03 - Sysinternals

### 3.1 - OS Version and Hotfixes

Enumerate the system.

```
C:\ .\PsInfo64.exe [\\<IP> -u <username> -p <password>] -h
```

---
## References

### LOFLCAB

- [LOFLCAB: systeminfo](https://lofl-project.github.io/loflcab/Binaries/systeminfo/)

### Moonpoint

- [Moonpoint: List Security Patches](https://support.moonpoint.com/os/windows/PowerShell/list-security-patches/)