# Query TXT Record

## C++

```cpp
std::string get_txt_record() {
    PDNS_RECORDA txt_record = nullptr;
    
    DNS_STATUS status = DnsQuery_A(
        "dev.mez0.cc",
        DNS_TYPE_TEXT,
        DNS_QUERY_STANDARD,
        NULL,
        &txt_record,
        NULL
    );

    if (status != ERROR_SUCCESS) {
        return "";
    }

    std::string record = txt_record->Data.TXT.pStringArray[0];

    DnsRecordListFree(txt_record, DnsFreeRecordListDeep);

    return record;
}
```

---
## References

### TrustedSec

- [TrustedSec: Execution Guardrails - No One Likes Unintentional Exposure](https://trustedsec.com/blog/execution-guardrails-no-one-likes-unintentional-exposure)