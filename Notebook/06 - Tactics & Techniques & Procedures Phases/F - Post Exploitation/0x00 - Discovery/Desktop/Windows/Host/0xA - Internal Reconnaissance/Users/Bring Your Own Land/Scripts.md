---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - offensive-tools
  - windows
---
# Scripts

## 01 - PowerSploit

### 1.1 - Enumerate Local Usernames

Getting users on the windows workstation (the second cmdlet is an alias).

```
PS C:\> Get-NetUser

PS C:\> Get-DomainUser
```

Retrieve **Computer Names**.

```
PS C:\> Get-NetUser | Select-Object -Property cn
```

SID will come in handy when using **mimikatz** to dump and get a golden ticket so look out for an SID object that ends with `"-500"` which is typically has administrators rights.

```
PS C:\> Get-NetUser | Select-Object -Property cn, objectsid
```

Retrieve user accounts.

```
PS C:\> Get-NetUser [-Filter "(description=*admins*)"] | Select-Object -Property samaccountname

PS C:\> Get-NetUser [-Filter "(title=*admins*)"] | Select-Object -Property samaccountname
```

TODO: Fill this information

### 1.2 - Logged On Users

**Enumerate users** who are part of the **administrators group** (the second cmdlet is an alias).

```
PS C:\> Invoke-EnumerateLocalAdmin

PS C:\> Find-DomainLocalGroupMember
```

Retrieve information to check which users are currently logged on in the computer.

```
PS C:\> Get-NetLoggedon [-ComputerName <IP>]
```

Retrieve information to print which is the last user who logged on the computer.

```
PS C:\> Get-LastLoggedOn [-ComputerName <IP>]
```

Check if a user is currently logged on with a RDP (Remote Desktop Protocol) session.

```
PS C:\> Get-NetRDPSession [-ComputerName <IP>]
```

---
## References

### NoRed0x

- [NoRed0x: Active Directory Domain Enumeration Part 1](https://nored0x.github.io/red-teaming/active-directory-domain-enumeration-part-1/)