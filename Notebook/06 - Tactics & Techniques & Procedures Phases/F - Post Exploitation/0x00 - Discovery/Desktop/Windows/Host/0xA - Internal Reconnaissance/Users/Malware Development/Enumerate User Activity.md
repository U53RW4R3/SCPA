# Enumerate User Activity

## Scripting

### PowerShell

```powershell
$logs = Get-EventLog system -ComputerName yourCompName `
    -Source Microsoft-Windows-Winlogon `
    -After (Get-Date).AddDays(-7)

$res = @()
ForEach ($log in $logs) {
    if ($log.InstanceId -eq 7001) {
        $type = "Logon"
    }
    elseif ($log.InstanceId -eq 7002) {
        $type = "Logoff"
    }
    else { Continue }

    $res += New-Object PSObject -Property @{
        Time  = $log.TimeWritten
        Event = $type
        User  = (New-Object System.Security.Principal.SecurityIdentifier `
                    $Log.ReplacementStrings[1]).Translate(
                    [System.Security.Principal.NTAccount])
    }
}
$res

$logs = Get-EventLog system -ComputerName yourCompName `
    -Source Microsoft-Windows-Winlogon `
    -After (Get-Date).AddDays(-7)

$res = @()
ForEach ($log in $logs) {
    if ($log.InstanceId -eq 7001) {
        $type = "Logon"
    }
    elseif ($log.InstanceId -eq 7002) {
        $type = "Logoff"
    }
    else { Continue }

    $res += New-Object PSObject -Property @{
        Time  = $log.TimeWritten
        Event = $type
        User  = (New-Object System.Security.Principal.SecurityIdentifier `
                    $Log.ReplacementStrings[1]).Translate(
                    [System.Security.Principal.NTAccount])
    }
}
$res
```

---
## References

### Hackmag

- [Hackmag: Malware under surveillance. Sandboxes and how to detect them](https://hackmag.com/security/malware-sandbox)