---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - metasploit-framework
  - sliver
  - havoc
  - cobalt-strike
  - windows
---
# C2 Frameworks

## 01 - Metasploit

### 1.1 - Current Process ID

```
meterpreter > getpid
```

Using interactive ruby shell to retrieve current process ID.

```
meterpreter > irb
>> session.sys.process.getpid

>> client.railgun.kernel32.GetCurrentProcessId
```

### 1.2 - List Running Processes ID

```
meterpreter > ps [-A <x64 | x86>]

meterpreter > ps [-A <x64 | x86>] -S <process_name>.exe [-U <username>]
```

### 1.3 - Retrieve Process ID

Retrieve PID from process name.

```
meterpreter > pgrep [-A <x64 | x86>] <process_name>
```

Filter only child processes of the current shell.

```
meterpreter > pgrep [-A <x64 | x86>] -c <process_name>
```

Filter on process name.

```
meterpreter > pgrep [-A <x64 | x86>] -S <process_name>
```

Filter on process name with a username.

```
meterpreter > pgrep [-A <x64 | x86>] -U <username> -S <process_name>
```

Filter only `NT AUTHORITY\SYSTEM` processes.

```
meterpreter > pgrep [-A <x64 | x86>] -s <process_name>
```

## 02 - Sliver

```
sliver (IMPLANT_NAME) > ps
```

## 03 - Havoc

```
Demon » proc list

Demon » proc grep <process_name>.exe
```

## 04 - Cobalt Strike

```
beacon> ps
```