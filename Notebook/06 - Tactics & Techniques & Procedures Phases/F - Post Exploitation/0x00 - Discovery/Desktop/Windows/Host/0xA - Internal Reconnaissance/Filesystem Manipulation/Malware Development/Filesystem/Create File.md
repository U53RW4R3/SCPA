# Create File

## Python

```python
from ctypes import wintypes

CreateFileW.argtypes = [
    wintypes.LPCWSTR,    # filename
    wintypes.DWORD,      # desired access
    wintypes.DWORD,      # share mode
    wintypes.LPVOID,     # security attributes
    wintypes.DWORD,      # creation disposition
    wintypes.DWORD,      # flags and attributes
    wintypes.HANDLE      # template file
]
CreateFileW.restype = wintypes.HANDLE

# Define the test data
filename = "file.txt" # Test file name
GENERIC_READ = 0x80000000
GENERIC_WRITE = 0x40000000
CREATE_ALWAYS = 2
FILE_ATTRIBUTE_NORMAL = 0x80

# Execute the function with test data
handle = CreateFileW(
    filename, # Auto converted from Python str to wintypes.LPCWSTR
    GENERIC_READ | GENERIC_WRITE,
    0,
    None, # Translates to NULL when passed to CreateFileW
    CREATE_ALWAYS,
    FILE_ATTRIBUTE_NORMAL,
    None
)
```

## C

```c
#include <windows.h>
#include <fileapi.h>

#pragma comment(lib, "kernel32.lib")
```

```
$ x86_64-w64-mingw32-gcc -l kernel32 -o payload.exe payload.c
```

---
## References

### Microsoft

- [Microsoft Documentation: `CreateFileA`](https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilea)

- [Microsoft Documentation: `CreateFileW`](https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilew)

### Tenouk

- [Tenouk: ModuleC1](https://www.tenouk.com/ModuleC1.html)

- [Tenouk: ModuleD](https://www.tenouk.com/ModuleD.html)

### InstallSetupConfig

- [InstallSetupConfig: The Windows File Management 13](https://www.installsetupconfig.com/win32programming/windowsfileapis4_12.html)

- [InstallSetupConfig: The Windows File Management 19](https://www.installsetupconfig.com/win32programming/windowsfileapis4_18.html)

- [InstallSetupConfig: The Windows File Management 20](https://www.installsetupconfig.com/win32programming/windowsfileapis4_19.html)

- [InstallSetupConfig: The Windows File Management 21](https://www.installsetupconfig.com/win32programming/windowsfileapis4_20.html)

- [InstallSetupConfig: The Windows File Management 22](https://www.installsetupconfig.com/win32programming/windowsfileapis4_21.html)

- [InstallSetupConfig: The Windows File Management 25](https://www.installsetupconfig.com/win32programming/windowsfileapis4_24.html)

- [InstallSetupConfig: Alternate Data Streams Program](https://www.installsetupconfig.com/win32programming/windowsfileapis4_25.html)

### Niraj Kharel

- [Niraj Kharel: Offensive C++ Basics](https://nirajkharel.com.np/posts/offensive-cplusplus-basics/)

### TrustedSec

- [TrustedSec: Operating Inside the Interpreted - Offensive Python](https://trustedsec.com/blog/operating-inside-the-interpreted-offensive-python)