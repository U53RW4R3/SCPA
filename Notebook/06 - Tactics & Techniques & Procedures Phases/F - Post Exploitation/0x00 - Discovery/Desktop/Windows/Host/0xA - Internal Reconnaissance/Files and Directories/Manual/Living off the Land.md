---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - List Files and Directories

### 1.1 - Command Prompt

```
C:\> dir
```

Find files with a specific extension

```
C:\> dir /s *.txt
```

### 1.2 - PowerShell

```
PS C:\> Get-ChildItem

PS C:\> Get-ChildItem | Format-Wide -Property Name -Column 1
```

## 02 - Change Directories

### 2.1 - Command Prompt

```
C:\> cd folder

C:\> chdir folder
```

### 2.2 - PowerShell

```
PS:\> Set-Location .\directory\
```

## 03 - Print Working Directory

### 3.1 - Command Prompt

```
C:\> cd

C:\> echo %CD%
```

### 3.2 - PowerShell

```
PS C:\> Get-Location

PS C:\> (Get-Item .).FullName

PS C:\> $Env:CD

PS C:\> [System.Environment]::CurrentDirectory

PS C:\> [System.Environment]::GetEnvironmentVariable('CD')
```

## 04 - Absolute Paths

```
C:\> dir /a /b /s C:\Users\<username>\ | findstr.exe /i /v "appdata application data local settings start menu"
```

## 05 - Hidden Files and Directories

### 5.1 - Command Prompt

Display all the directories (including **hidden and alternate data stream**).

```
C:\> dir /r /a:h
```

Display directories and files in a tree structure. This is great for enumeration phase.

```
C:\> tree C:\ /f /a
```

### 5.2 - PowerShell

Display all the directories (including **hidden and alternate data stream**).

```
PS C:\> Get-ChildItem -Path [<drive_letter:\]path\to\directory] -File -Recurse - | ForEach-Object { Get-Item $_.FullName -Stream * }
```

## 06 - World Writable Folders

```
C:\> dir /ad-r C:\path\to\directory\
```

## 07 - Check File's Permission

### 7.1 - Command Prompt

```
C:\> dir /q C:\path\to\file.txt

C:\> dir /q C:\path\to\directory\
```

### 7.2 - PowerShell

```
PS C:\> Get-Acl -Path "C:\path\to\file.txt"

PS C:\> Get-Acl -Path "C:\path\to\directory\"
```

## 08 - List attributes from a file

### 8.1 - Command Prompt

```
C:\> attrib.exe C:\path\to\file.txt
```

### 8.2 - PowerShell

This will help you to gather ideas from a file/directory own attributes.

```
PS C:\> Get-Item [<drive_letter>:\]path\to\file.txt | Get-Member

PS C:\> Get-ItemProperty [<drive_letter>:\]path\to\file.txt | Get-Member
```

## 09 - Calculate File Size

### 9.1 - Command Prompt

Display the size in bytes.

```
C:\> dir /s /a [<drive_letter>:\]path\to\directory\ [*.txt,*.pdf,*.doc] | findstr.exe "Dir(s)"

C:\> dir /s /a \\<IP>\<share_name>\path\to\directory\ [*.txt,*.pdf,*.doc] | findstr.exe "Dir(s)"
```

### 9.2 - PowerShell

#### 9.2.1 - Bytes

```
PS C:\> Get-ChildItem -Path [<drive_letter>:\]path\to\directory\ -Recurse -File | Measure-Object -Property Length -Sum

PS C:\> Get-ChildItem -Path \\<IP>\<share_name>\path\to\directory\ -Recurse -File | Measure-Object -Property Length -Sum

PS C:\> Get-ChildItem -Path [<drive_letter>:\]path\to\directory\ -Recurse -File | Measure-Object -Sum Length | Select-Object Count, Sum

PS C:\> Get-ChildItem -Path \\<IP>\<share_name>\path\to\directory\ -Recurse -File | Measure-Object -Sum Length | Select-Object Count, Sum
```

#### 9.2.2 - Kilobytes

```
PS C:\> (Get-ChildItem -Path [<drive_letter>:\]path\to\directory\ -Recurse -File | Measure-Object -Property Length -Sum).Sum / 1Kb

PS C:\> (Get-ChildItem -Path \\<IP>\<share_name>\path\to\directory\ -Recurse -File | Measure-Object -Property Length -Sum).Sum / 1Kb
```

#### 9.2.3 - Megabytes

```
PS C:\> (Get-ChildItem -Path [<drive_letter>:\]path\to\directory\ -Recurse -File | Measure-Object -Property Length -Sum).Sum / 1Mb

PS C:\> (Get-ChildItem -Path \\<IP>\<share_name>\path\to\directory\ -Recurse -File | Measure-Object -Property Length -Sum).Sum / 1Mb
```

#### 9.2.4 - Gigabytes

```
PS C:\> (Get-ChildItem -Path [<drive_letter>:\]path\to\directory\ -Recurse -File | Measure-Object -Property Length -Sum).Sum / 1Gb

PS C:\> (Get-ChildItem -Path \\<IP>\<share_name>\path\to\directory\ -Recurse -File | Measure-Object -Property Length -Sum).Sum / 1Gb
```

### 9.3 - Sysinternals

#### 9.3.1 - Copy File from WebDAV

##### 9.3.1.1 - Command Prompt

```
C:\> net.exe use z: \\live.sysinternals.com\tools

C:\> copy z:\DU64.exe .

C:\> net.exe use z: /delete
```

##### 9.3.1.2 - PowerShell

```
PS C:\> New-PSDrive -Name Z -PSProvider FileSystem -Root "\\live.sysinternals.com\tools"

PS C:\> Copy-Item z:\DU64.exe .

PS C:\> Remove-PSDrive -Name Z
```

Accept EULA

```
C:\> .\DU64.exe -accepteula
```

#### 9.3.2 - Kilobytes

```
C:\> .\DU64.exe -q -v [<drive_letter>:\]path\to\directory\

C:\> .\DU64.exe -q -v \\<IP>\<share_name>\path\to\directory\
```

---
## References

### Source Repositories

- [r00t-3xp10it: CmdLine Scripts for Reverse TCP Shell Addicts](https://github.com/r00t-3xp10it/venom/wiki/CmdLine-%26-Scripts-for-reverse-TCP-shell-addicts)

### Hacking Articles

- [Hacking Articles: Post Exploitation in Windows using dir Command](https://www.hackingarticles.in/post-exploitation-windows-using-dir-command/)