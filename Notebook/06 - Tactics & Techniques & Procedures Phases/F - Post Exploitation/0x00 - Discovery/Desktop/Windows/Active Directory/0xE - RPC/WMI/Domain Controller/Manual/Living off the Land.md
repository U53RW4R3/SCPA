---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - active-directory
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Command Prompt

Enumerate the current domain controller.

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] group list

C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] ntdomain get domaincontrolleraddress,domainname,roles
```

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] /namespace:\\root\directory\ldap path ds_computer get ds_samaccountname
```

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] computersystem get domain
```

## 02 - PowerShell

```
PS C:\> Write-Output (Get-WmiObject -ClassName Win32_ComputerSystem).Domain

PS C:\> Write-Output (Get-CimInstance -ClassName Win32_ComputerSystem).Domain
```

```
PS C:\> Get-CimInstance -ClassName Win32_NTDomain | Format-Table -AutoSize

PS C:\> Get-CimInstance -ClassName CIM_System | Format-Table -AutoSize
```