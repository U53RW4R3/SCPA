---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - networking
  - active-directory
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Command Prompt

Get a list of locally shared drives.

```
C:\> wmic.exe [/node:<IP>] [/user:<username> /password:<password>] share get /all
```

## 02 - PowerShell

Get a list of locally shared drives.

```
PS C:\> Get-WmiObject [-ComputerName <IP>] -ClassName Win32_Share -namespace "root\CIMV2"

PS C:\> Get-CimInstance [-ComputerName <IP>] -ClassName Win32_Share -namespace "root\CIMV2"

PS C:\> Get-CimInstance [-ComputerName <IP>] -ClassName Win32_NetworkConnection
```

---
## References

### LOFLCAB

- [LOFLCAB: net.exe](https://lofl-project.github.io/loflcab/Binaries/net/)

### r00t-3xp10it

- [r00t-3xp10it: CmdLine Scripts for Reverse TCP Shell Addicts](https://github.com/r00t-3xp10it/venom/wiki/CmdLine-%26-Scripts-for-reverse-TCP-shell-addicts)

### Hackmag

- [Hackmag: Malware under surveillance. Sandboxes and how to detect them](https://hackmag.com/security/malware-sandbox)