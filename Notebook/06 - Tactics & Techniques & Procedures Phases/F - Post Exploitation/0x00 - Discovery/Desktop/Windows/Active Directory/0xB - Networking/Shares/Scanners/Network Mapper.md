---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - active-directory
  - networking
  - port-scanners
  - network-mapper
  - windows
---
# Network Mapper

Authentication

```
$ nmap -p 445 -Pn --script smb-enum-shares,smb-ls --script-args "smbusername='<username>',smbpassword='<password>'" <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-shares,smb-ls --script-args "smbusername='<username>',smpassword='<password>'" <IP>
```

Pass the hash

```
$ nmap -p 445 -Pn --script smb-enum-shares,smb-ls --script-args "smbusername='<username>',smbhash='<nt_hash>'" <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-shares,smb-ls --script-args "smbusername='<username>',smbhash='<nt_hash>'" <IP>
```

---
## References

### Ethical Hacking and Penetration Testing

- [Ethical Hacking and Penetration Testing: SMB and Samba Security Audit Tools](https://miloserdov.org/?p=4066)