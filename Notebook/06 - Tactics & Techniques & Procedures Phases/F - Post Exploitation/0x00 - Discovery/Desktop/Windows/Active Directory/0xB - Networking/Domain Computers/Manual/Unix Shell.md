---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - active-directory
  - staying-off-the-land
  - networking
  - network-protocols
  - msrpc
  - ldap
  - windows
---
# Unix Shell

## 01 - MSRPC Port

```
$ nmblookup -A <IP>
```

## 02 - LDAP Port

### 2.1 - `ldapsearch`

Enumerate domain computers.

```
$ ldapsearch -x -D '<DOMAIN>\<username>' -w '' -b "CN=Computers,DC=<subdomain>,DC=<tdl>" -H ldap://<IP>
```

Enumerate active domain computers.

```
$ ldapsearch -x -D '<DOMAIN>\<username>' -w '' -b "(&(objectCategory=Computer)(!userAccountControl:1.2.840.113556.1.4.803:=2))" -H ldap://<IP>
```

Enumerate a specific computer name.

```
$ ldapsearch -x -D '<DOMAIN>\<username>' -w '' -b "(&(objectCategory=Computer)(name=<COMPUTERNAME>))" -H ldap://<IP>
```

### 2.2 - `samba-tool`

```
$ samba-tool computer list -U [<domain>/]<username>@<password> -H ldap://<IP>
```

TODO: Convert the commands from `ldapsearch`.

```
$ samba-tool user show <remote_username> --attributes=* -U [<domain>/]<username>@<password> -H ldap://<IP>
```