---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - active-directory
  - networking
  - living-off-the-land
  - windows
---
# Living off the Land

## 01 - Command Prompt

Get a list of locally shared drives.

```
C:\> net.exe share

C:\> net.exe config workstation

C:\> net.exe config server

C:\> openfiles.exe /query [/s <IP> /u <username> /p <password>]
```

Remotely view net shares.

```
C:\> net.exe view [\\<IP>]

C:\> net.exe view [\\<IP>] /all

C:\> net.exe view [\\<IP>] /all /domain
```

## 02 - PowerShell

Get a list of locally shared drives.

```
PS C:\> Get-SmbShare

PS C:\> Get-SmbConnection
```

## 03 - Sysinternals

### 3.1 - Command Prompt

```
C:\> net.exe use z: \\live.sysinternals.com\tools

C:\> copy z:\psfile64.exe .

C:\> net.exe use z: /delete
```

### 3.2 - PowerShell

```
PS C:\> New-PSDrive -Name Z -PSProvider FileSystem -Root "\\live.sysinternals.com\tools"

PS C:\> Copy-Item z:\psfile64.exe .

PS C:\> Remove-PSDrive -Name Z
```

Accept the EULA.

```
C:\> .\psfile64.exe -accepteula
```

Enumerate files from a share folder.

```
C:\> .\psfile64.exe [\\<IP>\ -u <username> -p <password>] [<drive_letter>:\path\to\directory\]
```

---
## References

### Source Repositories

- [r00t-3xp10it: CmdLine Scripts for Reverse TCP Shell Addicts](https://github.com/r00t-3xp10it/venom/wiki/CmdLine-%26-Scripts-for-reverse-TCP-shell-addicts)

### LOFLCAB

- [LOFLCAB: net.exe](https://lofl-project.github.io/loflcab/Binaries/net/)

### Hacking Articles

- [Hacking Articles: Remote Windows PC Enumeration using PSTools](https://www.hackingarticles.in/remote-windows-pc-enumeration-using-pstools/)