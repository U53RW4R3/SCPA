---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - active-directory
  - staying-off-the-land
  - networking
  - network-ports
  - smb
  - msrpc
  - enum4linux
  - windows
---
# Enum4Linux-NG

## 01 - Enumerate user accounts

> [!IMPORTANT] Condition
> `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa` registry path with a name `RestrictAnonymous` must have a set value of `0x0`.

```
$ enum4linux-ng -U [-w <domain> | --local-auth] -u "<username>" -p "<password>" <IP>
```

Pass the hash

```
$ enum4linux-ng -U [-w <domain> | --local-auth] -u "<username>" -H <nt_hash> <IP>
```

Pass the Ticket

```
$ export KRB5CCNAME=/path/to/file.ccache

$ enum4linux-ng -U -w <domain> -u "<username>" -K <IP>
```

## 02 - Enumerate groups

```
$ enum4linux-ng -G [-w <domain> | --local-auth] -u "<username>" -p "<password>" <IP>

$ enum4linux-ng -Gm [-w <domain> | --local-auth] -u "<username>" -p "<password>" <IP>
```

Pass the hash

```
$ enum4linux-ng -G [-w <domain> | --local-auth] -u "<username>" -H <nt_hash> <IP>

$ enum4linux-ng -Gm [-w <domain> | --local-auth] -u "<username>" -H <nt_hash> <IP>
```

Pass the Ticket

```
$ export KRB5CCNAME=/path/to/file.ccache

$ enum4linux-ng -G -w <domain> -u "<username>" -K <IP>

$ enum4linux-ng -Gm -w <domain> -u "<username>" -K <IP>
```

## 03 - User enumeration via RID Cycling

> [!IMPORTANT] Condition
> `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa` registry path with a name `RestrictAnonymous` must have a set value of `0x1`.

```
$ enum4linux-ng -r [-w <domain> | --local-auth] -u "<username>" -p "<password>" <IP>
```

Pass the hash

```
$ enum4linux-ng -r [-w <domain> | --local-auth] -u "<username>" -H <nt_hash> <IP>
```

Pass the Ticket

```
$ export KRB5CCNAME=/path/to/file.ccache

$ enum4linux-ng -r -w <domain> -u "<username>" -K <IP>
```

---
## References

### Source Repositories

- [Enum4Linux-NG](https://github.com/cddmp/enum4linux-ng)

### Ethical hacking and penetration testing

- [Ethical hacking and penetration testing: SMB and Samba Security Audit Tools](https://miloserdov.org/?p=4066)