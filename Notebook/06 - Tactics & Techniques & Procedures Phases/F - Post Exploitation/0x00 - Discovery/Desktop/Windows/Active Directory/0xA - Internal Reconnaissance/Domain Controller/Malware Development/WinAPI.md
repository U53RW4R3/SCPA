# WinAPI

## C++

```cpp
std::string get_domain_name() {
    PDOMAIN_CONTROLLER_INFO pDCI = NULL;
    std::string domainName;

    DWORD dwRetVal = DsGetDcNameA(
        NULL,
        NULL,
        NULL,
        NULL,
        DS_RETURN_DNS_NAME,
        &pDCI
    );

    if (dwRetVal == ERROR_SUCCESS) {
        if (pDCI) {
            domainName = pDCI->DomainName;
            NetApiBufferFree(pDCI);
        }
    } else {
        domainName = "Error: " + std::to_string(dwRetVal);
    }
    return domainName;
}
```

---
## References

### TrustedSec

- [TrustedSec: Execution Guardrails - No One Likes Unintentional Exposure](https://trustedsec.com/blog/execution-guardrails-no-one-likes-unintentional-exposure)