---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - living-off-the-land
  - linux
---
# Living off the Land

## 01 - Window Display Server

> [!NOTE] `$DISPLAY` environment
> - `:0` means `x11`
> - `:1` means `wayland`

```
$ loginctl show-session $(loginctl | grep $USER | awk '{print $1}') -p Type

$ echo $DISPLAY

$ echo $XDG_SESSION_TYPE
```

## 02 - Desktop Environment

```
$ echo $DESKTOP_SESSION
```

## 03 - Distro Variant

Universal distro enumeration.

```
$ cat /etc/issue

$ cat /etc/issue.net

$ cat /etc/os-release

$ cat /usr/lib/os-release

$ cat /etc/lsb-release

$ cat /etc/*-release

$ cat /proc/sys/kernel/ostype

$ cat /proc/sys/kernel/osrelease
```

Debian distro.

```
$ cat /etc/debian_release

$ cat /etc/debian_version
```

Redhat distro.

```
$ cat /etc/redhat-release

$ cat /etc/redhat_version
```

Fedora distro

```
$ cat /etc/fedora-release
```

SUSE distro.

```
$ cat /etc/SUSE-release
```

Arch Linux distro.

```
$ cat /etc/arch-release
```

Gentoo distro.

```
$ cat /etc/gentoo-release
```

## 04 - Locale

```
$ locale

$ localectl status

$ echo $LANG

$ echo $LANGUAGE

$ cat /etc/default/locale
```

## 05 - Date and Time

Check the current locale date.

```
$ date

$ date +%c

$ timedatectl
```

Check the formatted current date.

```
$ date +%F

$ date "+%m-%Y"

$ date +%D

$ date "+%b %a"

$ date "+%B %A"
```

Day, year and month

```
$ date "+Day: %u Month: %m Year: %Y"

$ date "+Day: %u Month: %m Year: %C%y"
```

Convert the current date into the day of the year.

```
$ date +%j
```

Convert the current date into the day of the month.

```
$ date +%_d

$ date +%e
```

Local time date.

```
$ date +%T

$ date +%H:%M:%S
```

PM and AM time date format.

```
$ date +%X

$ date "+%I:%M:%S %p"
```

Check the duration of how long the system was running.

```
$ uptime

$ uptime -p

$ uptime -s

$ cat /proc/uptime

$ echo "${BASH_MONOSECONDS}"
```

Idle time user activity.

```
$ w [username]

$ pinky [-l <username>]
```

## 06 - Storage

```
$ df -h

$ df -aH

$ du -hd 0 / 2>/dev/null

$ dmesg | grep -E sd.{1}

$ sudo fdisk -l

$ sudo fdisk -l | grep -B 1 "Disk model"

$ ls /dev/ 2>/dev/null

$ ls /dev/ 2>/dev/null | grep -i "sd"
```

---
## References

### Hacktricks

- [Hacktricks: Privilege Escalation](https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html)