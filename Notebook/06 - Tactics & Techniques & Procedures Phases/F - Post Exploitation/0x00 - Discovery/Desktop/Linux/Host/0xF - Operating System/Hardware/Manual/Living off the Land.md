---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - living-off-the-land
  - linux
---
# Living off the Land

## 01 - Mounted Drives

^d56c2c

Looking for mount drives with credentials or we can mount on to further move laterally.

```
$ findmnt -s

$ cat /etc/fstab

$ cat /etc/mtab

$ sed 's/#.*//' /etc/fstab | column -t -N SOURCE,TARGET,TYPE,OPTIONS,PASS,FREQ -R PASS,FREQ

$ grep -v "^#" /etc/fstab | grep -Pv "\W*\#" 2>/dev/null

$ mount [-l]

$ mount [-l] | column -t

$ cat /proc/mounts

$ cat /proc/self/mounts

$ cat /proc/1/mounts

$ cat /proc/self/mountinfo

$ cat /proc/1/mountinfo
```

List mounted drives that is connected to the Linux system.

```
$ lsblk

$ sudo blockdev --report
```

### 1.1 - CD/DVD Tray

List default device name.

```
$ eject -d
```

More information of the command execution.

```
$ eject -v
```

### 1.2 - Mounted Removable Medias

```
$ lsusb

$ lsusb -tv
```

## 03 - Network Interfaces

```
$ ip -o link show | awk -F ": " '{print $2}'

$ nmcli -g DEVICE device status

$ tcpdump -D

$ iwconfig

$ lspci | grep -Ei 'network\|ethernet\|wireless\|wi\-fi'

$ netstat -i

$ sudo hwinfo --short --network

$ sudo lshw -class network -short

$ grep -Eo "[a-z0-9]+:" /proc/net/dev | cut -d ":" -f 1

$ grep -Eo "[a-z0-9]+:" /proc/net/dev | awk -F ":" '{print $1}'

$ cut -d ":" -f 1 /proc/net/dev | tail -n +3 | sort -u | sed -e 's/[ \t]*//'

$ awk -F "[[:space:]]" '{print $5}' /proc/net/dev_mcast | sort -u

$ cut -d " " -f 5 /proc/net/dev_mcast | sort -u

$ ls -1 /proc/net/dev_snmp6
```

## 04 - MAC Address

### 4.1 - Network Interfaces

Show current network interface's MAC address

```
$ ip link show <interface> | grep -Eo "..:..:..:..:..:.."

$ ip link show <interface> | grep -Eo ..\(\:..\){5}

$ ip link show <interface> | grep -Eo '([[:xdigit:]]{1,2}:){5}[[:xdigit:]]{1,2}'

$ ip link show <interface> | awk '/ether/ {print $2}'

$ ip -o link show <interface> | awk '/permaddr/ {print $NF}'

$ ethtool -P <interface> | awk '{print $NF}'

$ ifconfig <interface> | grep -Eo ..\(\:..\){5}

$ cat /sys/class/net/<interface>/address
```

List all MAC addresses of network interfaces.

```
$ ifconfig -a | grep -Eo "..:..:..:..:..:.."

$ ifconfig -a | grep -Eo '([[:xdigit:]]{1,2}:){5}[[:xdigit:]]{1,2}'

$ ip address | awk '/ether/{print $2}'

$ ip address | awk '/link\/ether/{print $2}'

$ LANG=C ip link show | awk '/link\/ether/ {print $2}'

$ ip link show | awk '/permaddr/ {print $NF}'

$ ip -o link show | awk '/permaddr/ {print $NF}'

$ cat /sys/class/net/*/address
```

### 4.2 - Bluetooth

Show current network interface's MAC address

```
$ /var/lib/bluetooth/<interface>/classes
```

List all bluetooth MAC addresses.

```
$ cat /var/lib/bluetooth/*/classes
```

## 05 - Motherboard

```
$ inxi -M

$ sudo dmidecode -t baseboard

$ cat /sys/class/dmi/id/board_vendor

$ cat /sys/devices/virtual/dmi/id/board_name
```

## 06 - RAM

Memory size in bytes,

```
$ free -b
```

Memory size in kilobytes,

```
$ free -k

$ vmstat -s

$ grep "MemTotal\|MemFree\|MemAvailable" /proc/meminfo
```

Memory size in megabytes,

```
$ free -m
```

Memory size in gigabytes.

```
$ free -g
```

TODO: This is for scraping credentials but check if it works or not.

```
$ sudo strings /dev/mem -n10 | grep -i PASS
```

## 07 - CPU

### 7.1 - Overview

```
$ lscpu

$ cat /proc/cpuinfo
```

### 7.2 - Architecture

```
$ arch

$ uname -m

$ uname -mpi

$ getconf LONG_BIT

$ inxi -Fxz | grep bits

$ sudo lshw -class processor

$ dpkg --print-architecture

$ echo $HOSTTYPE
```

> [!INFO]
> - `lm` is short for Long Mode. Which is a 64-bit architecture.
> - Real mode 16 bit CPU
> - Protected Mode is 32-bit CPU.

```
$ grep -o -w 'lm' /proc/cpuinfo | sort -u 
```

### 7.3 - Processors

Physical cores

```
$ sudo dmidecode -t 4 | grep -Ei 'core (count|enabled)'

$ grep '^core id' /proc/cpuinfo | sort -u | wc -l

$ grep -m 1 "cores" /proc/cpuinfo | tr -d '[a-z]:[:space:]'
```

Logical cores

```
$ nproc --all

$ hwinfo --cpu --short

$ getconf _NPROCESSORS_CONF

$ getconf _NPROCESSORS_ONLN

$ lscpu | grep '^CPU(s):' | awk '{print $2}'

$ lscpu | grep '^CPU(s):' | tr -d "[:blank:]" | cut -d ":" -f 2

$ lscpu | grep '^CPU(s):' | tr -d "[:space:]" | cut -d ":" -f 2

$ sudo dmidecode -t 4 | grep -Ei 'thread count'

$ grep -c "processor" /proc/cpuinfo

$ grep -c "cores" /proc/cpuinfo

$ grep "model name" /proc/cpuinfo | wc -l

$ grep -c "cpu" /proc/schedstat

$ grep -cEo "cpu[0-9]+" /proc/stat

$ grep -Eo "^cpu[0-9]{1,2}" /proc/stat | wc -l

$ grep -Eo "CPU[0-9]+" /proc/interrupts | wc -l

$ grep -Eo "CPU[0-9]{1,2}" /proc/softirqs | wc -l
```

---
## References

### Hacktricks

- [Hacktricks: Privilege Escalation](https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html)