---
author(s):
  - Userware
tags:
  - post-exploitation
  - discovery
  - living-off-the-land
  - linux
---
# Living off the Land

## 01 - Display programs with process identifiers

Display running services that has users/root rights.

```
$ ps aux

$ ps aux | col

$ ps aux --forest

$ ps axjf

$ ps axjf --forest

$ ps -ef

$ ps -ef --forest
```

Display running services that and filter the user ownership.

```
$ ps aux | grep <username>

$ ps -ef | grep <username>

$ ps aux | grep root

$ ps -ef | grep root
```

View all the running process.

```
$ ps -A
```

Find docker processes (this might correlate with the `id` command for privilege escalation).

```
$ ps aux | grep docker

$ ps -ef | grep docker
```

This command will display the running process but contains a nice user interaction.

```
$ top

$ top -n 1
```

### Display PIDs via executed commands

```
$ ps -eo comm

$ readlink /proc/[0-9]*/exe

$ for process in /proc/[0-9]*; do printf "%10d - %s\n" $(basename $process) $(readlink $process/exe); done
```

Check running processes and list them as files via permissions.

```
$ ps aux | awk '{print $11}' | xargs -r ls -la 2>/dev/null | awk '!x[$0]++'
```

### Fetch process ID

```
$ pgrep <program>
```

## 02 - Display Services

Enumerate each services and protocols both TCP/UDP.

### 2.1 - List running services

```
$ systemctl --no-pager list-unit-files -t service --state=running | awk '/.service/{print $1}' | sed 's/.service$//'
```

### 2.2 - List enabled services

```
$ systemctl --no-pager list-unit-files -t service --state=enabled | awk '/.service/{print $1}' | sed 's/.service$//'
```

### 2.3 - List disabled services

```
$ systemctl --no-pager list-unit-files -t service --state=disabled | awk '/.service/{print $1}' | sed 's/.service$//'
```

### 2.4 - List active services

```
$ systemctl --no-pager list-unit-files -t service --state=active | awk '/.service/{print $1}' | sed 's/.service$//'
```

### 2.5 - List all services

```
$ systemctl --no-pager list-unit-files -t service -a | awk '/.service/{print $1}' | sed 's/.service$//'

$ service --status-all

$ compgen -A service

$ cat /etc/service
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/F - Post Exploitation/0x01 - Defense Evasion/03 - Process Manipulation/Linux/Manual/Living off the Land]]