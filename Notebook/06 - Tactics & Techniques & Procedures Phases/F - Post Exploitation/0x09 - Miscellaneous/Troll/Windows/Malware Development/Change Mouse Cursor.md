# Change Mouse Cursor

## .NET

### C\#

```cs
using System;
using System.IO;
using System.Reflection;
using System.Runtime.InteropServices;
using Microsoft.Win32;

namespace Malware {
    public class Payload {
	    public static void Main(string[] args) {
	        string cursor_arrow_file = @"C:\path\to\file.cur"
	        ChangeCursor(cursor_arrow_file);
	    }

	    public static void ChangeCursor(string cursor_file) {
	        try {
	            string assemblyPath = Assembly.GetExecutingAssembly().Location;
	            string startupPath = Path.GetDirectoryName(assemblyPath);
	
	            string cursorPath = Path.Combine(startupPath, cursor_file);
	            Registry.SetValue(
	                @"HKEY_CURRENT_USER\Control Panel\Cursors\", 
	                "Arrow", 
	                cursorPath, 
	                RegistryValueKind.String
	            );
	
	            uint flags = SPIF_UPDATEINFILE | SPIF_SENDCHANGE;
	            SystemParametersInfo(SPI_SETCURSORS, 0, 0, flags);
	        } catch (Exception ex) { }
	    }
    }
}
```