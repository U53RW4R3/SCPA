# Scripting

## .NET

```cs
using System;
using System.Runtime.InteropServices;
using System.ComponentModel;

public class DriveMounter {
    [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern bool DefineDosDevice(int dwFlags, string lpDeviceName, string lpTargetPath);

    private const int DDD_RAW_TARGET_PATH = 0x00000001;
    private const int DDD_REMOVE_DEFINITION = 0x00000002;
    private const int DDD_EXACT_MATCH_ON_REMOVE = 0x00000004;

    /// <summary>
    /// Mounts a local path to a drive letter (e.g., Mount("Z:", @"C:\Temp"))
    /// </summary>
    public static void Mount(string driveLetter, string path) {
        // 0 indicates we are adding a new mapping
        if (!DefineDosDevice(0, driveLetter, path)) {
            throw new Win32Exception(Marshal.GetLastWin32Error());
        }
        Console.WriteLine($"Successfully mounted {path} to {driveLetter}");
    }

    /// <summary>
    /// Dismounts the drive letter.
    /// </summary>
    public static void Dismount(string driveLetter) {
        // 2 (DDD_REMOVE_DEFINITION) indicates we are removing the mapping
        // We pass null or the path as the last argument. 
        if (!DefineDosDevice(DDD_REMOVE_DEFINITION, driveLetter, null)) {
            throw new Win32Exception(Marshal.GetLastWin32Error());
        }
        Console.WriteLine($"Successfully dismounted {driveLetter}");
    }
}
```