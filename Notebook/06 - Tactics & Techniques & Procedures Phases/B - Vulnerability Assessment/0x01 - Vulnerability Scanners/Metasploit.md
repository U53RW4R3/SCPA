---
author(s):
  - Userware
tags:
  - vulnerability-assessment
  - T1595
---
# #metasploit

## 01 - Import Scan Results

```
msf > db_import 
Usage: db_import <filename> [file2...]

Filenames can be globs like *.xml, or **/*.xml which will search recursively
Currently supported file types include:
    Acunetix
    Amap Log
    Amap Log -m
    Appscan
    Burp Session XML
    Burp Issue XML
    CI
    Foundstone
    FusionVM XML
    Group Policy Preferences Credentials
    IP Address List
    IP360 ASPL
    IP360 XML v3
    Libpcap Packet Capture
    Masscan XML
    Metasploit PWDump Export
    Metasploit XML
    Metasploit Zip Export
    Microsoft Baseline Security Analyzer
    NeXpose Simple XML
    NeXpose XML Report
    Nessus NBE Report
    Nessus XML (v1)
    Nessus XML (v2)
    NetSparker XML
    Nikto XML
    Nmap XML
    OpenVAS Report
    OpenVAS XML
    Outpost24 XML
    Qualys Asset XML
    Qualys Scan XML
    Retina XML
    Spiceworks CSV Export
    Wapiti XML
```

Import XML scans.

```
msf > db_import output.xml
```

## 02 - Network Mapper Integration

```
msf > db_nmap -Pn -n -sV --script=vulners [--script-args mincvss=7] <IP>
```

## 03 - Metasploit Modules

### 3.1 - Exploit Modules as Scanners

Some exploit modules contain a `check` command to scan a target to confirm if it's vulnerable or not.

> [!INFO]
> Not all exploit modules have `check` command. Use auxiliary modules if applicable.

```
msf > use exploit/windows/http/exchange_proxyshell_rce

msf exploit(windows/http/exchange_proxyshell_rce) > options

msf exploit(windows/http/exchange_proxyshell_rce) > set rhosts <<IP>/<CIDR> | file:/path/to/ip_targets.txt>

msf exploit(windows/http/exchange_proxyshell_rce) > set rport <PORT>

msf exploit(windows/http/exchange_proxyshell_rce) > check
```

### 3.2 - Auxiliary Modules

```
msf > use auxiliary/scanner/smb/smb_ms17_010

msf auxiliary(scanner/smb/smb_ms17_010) > run rhosts=<IP>
```

## 04 - Analyze Vulnerabilities

```
msf > vulns -i
```

List vulnerabilities by service names.

```
msf > vuln -s http
```

Set `RHOSTS` from the results.

```
msf > vuln -R
```

Analyze the potential exploits

```
msf > analyze
```

---
## References

### Rapid7

- [Rapid7: Metasploit Framework - Proxyshell Exploit Module](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/exploit/windows/http/exchange_proxyshell_rce.md)