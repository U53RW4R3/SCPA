---
author(s):
  - Userware
tags:
  - vulnerability-assessment
  - network-ports
  - ldap
---
# LDAP

## 01 - Null Credentials

### 1.1 - Manual

```
$ ldapsearch -x -b "DC=<subdomain>,DC=<tdl>" -h <IP> "*"

$ ldapsearch -x -D '' -w '' -b "DC=<subdomain>,DC=<tdl>" -H ldap://<domain>.<tld> "*"

$ ldapsearch -LLL -x -b "" -s base -H ldap://<domain>.<tld> '(objectclass=*)'
```

### 1.2 - #nuclei

```
$ nuclei -l ip_targets.txt -t ~/nuclei-templates -id ldap-anonymous-login
```

### 1.3 - #network-mapper

```
$ nmap -p 389 -n -sV --script "ldap* and not brute" <IP>
```

## 02 - Brute Force

### 2.1 - #hydra

For simple bind.

```
$ hydra -L users.lst -P passwords.lst <IP> ldap2
```

For SASL/StartTLS.

```
$ hydra -L users.lst -P passwords.lst -e ns -s 636 <IP> ldap3
```

### 2.2 - #network-mapper

```
$ nmap -p 389 --script ldap-brute --script-args ldap.base='"cn=users,dc=<domain>,dc=<tdl>"' <IP>
```

### 2.3 - #metasploit

```
msf > use auxiliary/scanner/ldap/ldap_login

msf auxiliary(scanner/ldap/ldap_login) > set rhosts <IP>

msf auxiliary(scanner/ldap/ldap_login) > set rport <PORT>

msf auxiliary(scanner/ldap/ldap_login) > run username=<username> pass_file=passwords.lst
```