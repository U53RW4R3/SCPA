# Unix Shell

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #active-directory #windows

## 01 - Samba Suite Utils

### 1.1 - SMBClient

```
$ smbclient [-m smb<1|2|3>] -U "<username>%<password>" -L //<IP>

$ smbclient [-m smb<1|2|3>] -U "<username>" --pw-nt-hash <nt_hash> -L //<IP>
```

### 1.2 - RPCClient

Enumerate shares.

```
rpcclient $> enumshares
```

Retrieve information of SMB shares.

```
rpcclient $> netshareenum

rpcclient $> netshareenumall
```

Retrieve share information.

```
rpcclient $> netsharegetinfo <share_name>
```

## 02 - NetExec

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --shares

$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --wmi "SELECT Caption,Name,Path FROM Win32_Share"
```

## 03 - Impacket

### 3.1 - Authentication

```
$ wmiquery.py "<username>":"<password>"@<IP>

$ wmiquery.py [<domain>/]<username>@<IP> -hashes :<nt_hash>
```

### 3.2 - Enumerate shares

```
WQL> SELECT Caption,Name,Path FROM Win32_Share
```

## 04 - Nmap

Authentication

```
$ nmap -p 445 -Pn --script smb-enum-shares --script-args "smbuser='<username>',smbpassword='<password>'" <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-shares --script-args "smbuser='<username>',smpassword='<password>'" <IP>
```

Pass the hash

```
$ nmap -p 445 -Pn --script smb-enum-shares --script-args "smbuser='<username>',smbhash='<nt_hash>'" <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-shares --script-args "smbuser='<username>',smbhash='<nt_hash>'" <IP>
```