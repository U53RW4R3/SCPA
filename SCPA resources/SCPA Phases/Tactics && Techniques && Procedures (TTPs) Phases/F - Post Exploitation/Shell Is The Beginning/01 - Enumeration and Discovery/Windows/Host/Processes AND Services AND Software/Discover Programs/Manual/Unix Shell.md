# Unix Shell

Search Tag(s): #post-exploitation #enumeration-and-discovery #staying-off-the-land #windows

## 01 - NetCommands

List all services.

```
$ net <ads | rpc> service list -U "[<domain>/]<username>%<password>" -S <IP>

$ net <ads | rpc> service list -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -S <IP>
```

Check service current status.

```
$ net <ads | rpc> service status "<ServiceSVC>" -U "[<domain>/]<username>%<password>" -S <IP>

$ net <ads | rpc> service status "<ServiceSVC>" -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -S <IP>
```

## 02 - Impacket

### 2.1 - `services.py`

List all services.

```
$ services.py "<username>":"<password>"@<IP> list

$ services.py [<domain>/]<username>@<IP> -hashes :<nt_hash> list
```

Enumerate current service.

```
$ services.py "<username>":"<password>"@<IP> config -name <service>

$ services.py [<domain>/]<username>@<IP> -hashes :<nt_hash> config -name <service>
```

Check service current status.

```
$ services.py "<username>":"<password>"@<IP> status -name <service>

$ services.py [<domain>/]<username>@<IP> -hashes :<nt_hash> status -name <service>
```

### 2.2 - `wmiquery.py`

```
$ wmiquery.py "<username>":"<password>"@<IP>

$ wmiquery.py [<domain>/]<username>@<IP> -hashes :<nt_hash>
```

TODO: Fill this info

Query all services.

```
WQL>
```

Enumerate current service.

```
WQL>
```

Check service current status.

```
WQL>
```