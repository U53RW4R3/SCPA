# Unix Shell

Search Tag(s): #post-exploitation #enumeration-and-discovery #windows

## 01 - Hardware Information

### 1.1 - Samba Suite Utils

Enumerate for mounted and unmounted drives.

```
rpcclient $> netdiskenum
```

Operating system version and server type.

```
rpcclient $> srvinfo
```

Retrieve information about the storage.

```
smb: \> du
```

### 1.2 - NetExec

Enumerate mounted disks.

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain_name> | --local-auth] --disks
```

### 1.3 - Impacket

TODO: Inspect the module (`meterpreter > run post/windows/gather/usb_history`) and convert into commands

- Check if there are external USB drives history activity to the workstation. This will provide leverage to insert malware to spread the infection or possibly to exfiltrate data.

```
$ reg.py [<domain>/]<username>:"<password>"@<IP> query -keyName "HKLM"

$ reg.py [<domain_name>/]<username>@<IP> -hashes :<nt_hash> query -keyName "HKLM"
```

Authentication syntax

```
$ wmiquery.py <domain_name>/<username>:<password>@<IP>

$ wmiquery.py <domain_name>/<username>@<IP> -hashes :<nt_hash>
```

Query operating system.

```
WQL> SELECT Caption FROM Win32_OperatingSystem
```

Query CPU.

```
WQL> SELECT NumberOfCores,NumberOfLogicalProcessors FROM Win32_Logicaldisk
```

Query only if the free space is less than 21 MB.

```
WQL> SELECT * FROM Win32_Logicaldisk WHERE FreeSpace < 2147483648
```