# Unix Shell

Search Tag(s): #post-exploitation #enumeration-and-discovery #windows

## 01 - Username enumeration

### 1.1 - Samba Suite Utils

Get current username.

```
rpcclient $> getusername
```

Retrieve username SID.

```
rpcclient $> lookupnames <username_1>,<username_2>,<username_n>

rpcclient $> samlookupnames builtin <username_1>,<username_2>,<username_n>
```

Enumerate username.

```
rpcclient $> queryuser <username | SID>

rpcclient $> queryusergroups <username_rid_value>
```

Check the user's privileges.

```
rpcclient $> enumprivs
```

### 1.2 - NetCommands

```
$ net rpc user info "<username>" -U "<username>%<password>" -S <IP>

$ net rpc user info "<username>" -U "<username>" --pw-nt-hash <nt_hash> -S <IP>
```

### 1.3 - NetExec

Enumerate current local users.

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain_name> | --local-auth] --users <user_1>,<user_2>,<user_n>
```

## 02 - Enumerate user accounts

### 2.1 - Samba Suite Utils

Enumerate groups.

```
rpcclient $> lookupnames <group_1>,<group_2>,<group_n>

rpcclient $> lookupnames Administrators
```

Enumerate alias group accounts.

```
rpcclient $> enumalsgroups builtin
```

### 2.2 - NetCommands

Enumerate **local users**.

```
$ net rpc user -U "<username>%<password>" -S <IP>

$ net rpc user -U "<username>" --pw-nt-hash <nt_hash> -S <IP>
```

Enumerate users from a local group.

```
$ net rpc group members '<group_name>' -U '[<domain_name>/]<username>%<password>' -S <IP>

$ net rpc group members '<group_name>' -U '[<domain_name>/]<username>' --pw-nt-hash <nt_hash> -S <IP>
```

Retrieve **local administrators**.

```
$ net rpc group members 'Administrators' -U '[<domain_name>/]<username>' -S <IP>
```

### 2.3 - NetExec

Enumerate local users.

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain_name> | --local-auth] --users
```

### 2.4 - Impacket

```
$ net.py "<username>":"<password>"@<IP> user

$ net.py [<domain_name>/]<username>@<IP> -hashes :<nt_hash> user
```

## 03 - Local groups enumeration

### 3.1 - NetCommands

```
$ net rpc group list -U '[<domain_name>/]<username>' -I <IP>
```

### 3.2 - NetExec

Enumerate local groups.

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain_name> | --local-auth] --local-groups
```

Enumerate current local group to retrieve user accounts.

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain_name> | --local-auth] --local-groups "Administrators"
```

### 3.3 - Impacket

```
$ net.py "<username>":"<password>"@<IP> localgroup

$ net.py [<domain_name>/]<username>@<IP> -hashes :<nt_hash> localgroup
```