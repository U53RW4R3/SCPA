# Living off the Land

## 01 - Powershell

## 1.1 - Manual timestomp

```powershell
PS C:\> $file = "C:\path\to\file.txt"
$creationtime = Get-Date "YYYY-MM-DD hh:mm:ss"
$lastwritetime = Get-Date "YYYY-MM-DD hh:mm:ss"
$lastaccesstime = Get-Date "YYYY-MM-DD hh:mm:ss"

Set-ItemProperty -Path $file -Name CreationTime -Value $creationtime
Set-ItemProperty -Path $file -Name LastWriteTime -Value $lastwritetime
Set-ItemProperty -Path $file -Name LastAccessTime -Value $lastaccesstime
```

## 1.2 - File timestamp reference

```powershell
PS C:\> $referenceFileTimeStamp = Get-Item old_file.txt
$TimestompFile = Get-Item new_file.txt
$TimestompFile.LastAccessTime = $referenceFileTimeStamp.LastAccessTime
$TimestompFile.CreationTime = $referenceFileTimeStamp.CreationTime
$TimestompFile.LastWriteTime = $referenceFileTimeStamp.LastWriteTime
```