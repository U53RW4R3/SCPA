# Configuration

## 01 - Manual

### 1.1 - Firewalls

#### 1.1.1 - Command Prompt

- Check firewall's state and configuration

`C:\> netsh firewall show state`

`C:\> netsh firewall show config`

`C:\> netsh advfirewall firewall dump`

`C:\> netsh advfirewall show currentprofile`

`C:\> netsh advfirewall firewall show rule name= all`

`C:\> netsh advfirewall export "firewall-rules.txt"`

#### 1.1.2 - Powershell

- Check firewall's state and configuration

`PS C:\> Get-NetFirewallRule -all | Export-csv firewall-rules.csv`

`PS C:\> Get-NetFirewallProfile`

`PS C:\> Get-NetFirewallProfile | Select Name, Enabled`

`PS C:\> Invoke-Command -ComputerName <IP> -ScriptBlock { Get-NetFirewallProfile | Select Name, Enabled }`

### 1.2 - Proxy

#### 1.2.1 - Command Prompt

`C:\> reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings"`

#### 1.2.2 - Powershell

`PS C:\> Get-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings'`

---
## References

- [Basic CMD for Pentesters](https://book.hacktricks.xyz/windows/basic-cmd-for-pentesters#firewall)

- [Top 10 Windows Firewall Netsh Commands](https://www.itprotoday.com/windows-8/top-10-windows-firewall-netsh-commands)