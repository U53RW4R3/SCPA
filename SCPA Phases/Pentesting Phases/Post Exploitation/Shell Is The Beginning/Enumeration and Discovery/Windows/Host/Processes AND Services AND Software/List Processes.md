# List Processes

## 01 - Manual

### 1.1 - Command Prompt

`C:\> tasklist /v`

`C:\> tasklist /v /s <IP>`

`C:\> tasklist /svc`

`C:\> tasklist /svc /s <IP>`

`C:\> tasklist /fi "imagename eq <process.exe>"`

`C:\> tasklist /fi "imagename eq <process.exe>" /s <IP>`

`C:\> query user /server:<IP>`

`C:\> wmic process list brief`

`C:\> wmic process get caption,executablepath,commandline`

`C:\> wmic /node:<IP> process list brief`

### 1.2 - Powershell

`PS C:\> Get-Process`

`PS C:\> Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id`

`PS C:\> get-wmiobject win32_process -computername <IP>`

`PS C:\> gwmi win32_process -computername <IP>`

`PS C\> Get-WmiObject -Query "Select * from Win32_Process" | where {$_.Name -notlike "svchost*"} | Select Name, Handle, @{Label="Owner";Expression={$_.GetOwner().User}} | ft -AutoSize`

`PS C:\> Get-CimInstance -Classname Win32_Process`

`PS C\> Get-CimInstance -Query "Select * from Win32_Process" | where {$_.Name -notlike "svchost*"} | Select Name, Handle, @{Label="Owner";Expression={$_.GetOwner().User}} | ft -AutoSize`

## 02 - Impacket

`$ wmiquery.py <domain_name>/<username>:<password>@<IP>`

`$ wmiquery.py <domain_name>/<username>@<IP> -hashes :<nt_hash>`

`WQL> SELECT * FROM win32_process WHERE NAME like 'cmd%%'`

`WQL> SELECT Caption,ExecutablePath,CommandLine FROM win32_process`

## 03 - Mimikatz

`mimikatz # process::list`

## 04 - Metasploit

`meterpreter > ps`

## 05 - Sliver

`sliver (IMPLANT_NAME) > ps`

## 06 - Havoc

`Demon Â» proc list`

## 07 - Cobalt Strike

`beacon> ps`