# SSH

## 1.1 - SCP

### 1.1.1 - Upload

`$ scp /path/to/file.txt -o "UserKnownHostsFile=/dev/null StrictHostKeyChecking=no" -i id_rsa <username>@<IP>:.`

**I**mprove scp file transfer performance by **using blowfish** and `compression` flag of `-C`

`$ scp -Cc blowfish /path/to/file.txt -o "UserKnownHostsFile=/dev/null StrictHostKeyChecking=no" -i id_rsa <username>@<IP>:.`

`$ scp -o HostKeyAlgorithms=+ssh-rsa /path/to/file.txt <username>@<IP>:.`

### 1.1.2 - Download

`$ scp <username>@<IP>:/path/to/file.txt -o "UserKnownHostsFile=/dev/null StrictHostKeyChecking=no" -i id_rsa .`

**I**mprove scp file transfer performance by **using blowfish** and `compression` flag of `-C`

`$ scp -Cc blowfish <username>@<IP>:/path/to/file.txt -o "UserKnownHostsFile=/dev/null StrictHostKeyChecking=no" -i id_rsa .`

`$ scp -o HostKeyAlgorithms=+ssh-rsa <username>@<IP>:/path/to/file.txt .`

## 1.2 - SFTP

### 1.2.1 - Setup

#### 1.2.1.1 - Installation

`$ sudo apt install openssh-server`

#### 1.2.1.2 - Hardening

```
$ sudo groupadd sftpusers

$ sudo mkdir -p /var/www/ftp/

$ sudo useradd -g aiden -s /sbin/nologin ftpuser

$ passwd aiden

$ sudo chown aiden:sftpusers /var/ftp/

$ sudo usermod -d /var/ftp -g sftpusers aiden
```

`$ cat /etc/ssh/sshd_config`

---

```
# Subsystem     sftp    /usr/libexec/openssh/sftp-server
Subsystem       sftp    internal-sftp

Match Group sftpusers
        ChrootDirectory %h
        ForceCommand internal-sftp
        AllowTcpForwarding no
        PermitTunnel no
        X11Forwarding no
        PermitTTY no
```

`$ sudo systemctl restart sshd`

### 1.2.2 - Usage

```
$ sftp <username>@<IP>

$ sftp -P <PORT> <username>@<IP>
```

## 1.3 - Rsync

### 1.3.1 - Upload

`$ rsync -ahuzPe "ssh -o UserKnownHostsFile=/dev/null" <file_source> <username>@<IP>:<file_destination>`

### 1.3.2 - Download

`$ rsync -ahuzPe "ssh -o UserKnownHostsFile=/dev/null" <username>@<IP>:<file_source> <file_destination>`

## References

- [Gabb4r Gitbook File Transfer Linux](https://gabb4r.gitbook.io/oscp-notes/file-transfer/linux)

- [Techmint SCP Commands Examples](https://www.tecmint.com/scp-commands-examples/)