# Mayhem

## 01 - Unix Shell

- Start CUPS service

`$ sudo systemctl start cups`

- Convert PDF file to Postscript

`$ pdf2ps file.pdf file.ps`

- Set default printer device

`$ lpoptions -d <printer_name> -l`

- Set default printer device and print A4 size paper

`$ lpoptions -d <printer_name> -o PageSize="A4"`

- Print files

```
$ lp -d <printer_name> -n 999 file.ps

$ lp -d <printer_name> -n 999 file.txt

$ lpr -P <printer_name> file.ps

$ pr -l 60 file.txt | lpr
```

## 02 - Command Prompt

### 2.1 - List Printer Devices

`C:\> wmic printer list brief`

## 03 - Powershell

### 3.1 - List Printer Devices

```
PS C:\> Get-Printer

PS C:\> Get-Printer | fl Name

PS C:\> Get-Printer -ComputerName <IP>
```

### 3.2 - Print files to a printer

```
PS C:\> Get-ChildItem "H:\*.pdf" | ForEach-Object {Start-Process $_.Name -Verb Print}

PS C:\> Get-ChildItem "H:\*.pdf" -Recurse | ForEach-Object {Start-Process $_.Name -Verb PrintTo "\\Server\Printer1"}

PS C:\> Get-ChildItem "C:\path\to\file.pdf" | Out-Printer

PS C:\> Get-Content -Path 'C:\demo\document.txt' | Out-Printer

PS C:\> Get-Content -Path 'C:\demo\document.txt' | Out-Printer -Name 'HP Deskjet 2540 series (Netzwerk)'

PS C:\> Get-Content -Path file.pdf | Out-Printer

PS C:\> Start-Process -FilePath "c:\path\to\file.pdf" -Verb Print

PS C:\> Start-Process –FilePath "c:\path\to\file.pdf" –Verb Print -PassThru | %{ sleep 10; $_ } | kill
```

## References

- [Print Command](https://windowscmd.com/print-command/)

- [Linux Hint: Print File From Powershell Script](https://linuxhint.com/print-file-from-powershell-script/)

- [NextOfWindows: Printing All PDF or Word Documents In a Folder to Any Printers at Once](https://www.nextofwindows.com/printing-all-pdf-or-word-documents-in-a-folder-to-any-printers-at-once)

- [Powershell to Print Files Automatically](https://gregcaporale.wordpress.com/2012/01/18/powershell-to-print-files-automatically/)