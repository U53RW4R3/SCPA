# Troll

## 01 - Windows

### 1.1 - MessageBox

#### 1.1.1 - Command Prompt

`C:\> msg * this is a message`

### 1.2 - Wallpaper

#### 1.2.1 - Command Prompt

```
C:\> reg add "HKCU\Control Panel\Desktop" /v Wallpaper /t REG_SZ /d "C:\path\to\file.jpg" /f

C:\> reg add "HKCU\Control Panel\Desktop" /v WallpaperStyle /t REG_SZ /d 2 /f

C:\> rundll32.exe user32.dll,UpdatePerUserSystemParameters
```

#### 1.2.2 - Powershell

```
PS C:\> Set-ItemProperty -Path "HKCU:\Control Panel\Desktop\" -name Wallpaper -value "C:\path\to\file.png"

PS C:\> rundll32.exe user32.dll,UpdatePerUserSystemParameters
```

## 02 - Multi

### 2.1 - Wallpaper

#### 2.1.1 - Metasploit

```
msf > use post/multi/manage/set_wallpaper

msf post(multi/manage/set_wallpaper) > options

Module options (post/multi/manage/set_wallpaper):

   Name            Current Setting  Required  Description
   ----            ---------------  --------  -----------
   SESSION                          yes       The session to run this module on
   WALLPAPER_FILE                   yes       The local wallpaper file to set on the remote session

msf post(multi/manage/set_wallpaper) > set session <session_id>

msf post(multi/manage/set_wallpaper) > set wallpaper_file /path/to/image.jpeg

msf post(multi/manage/set_wallpaper) > run
```

### 2.2 - Keyboard and Mouse

#### 2.2.1 - Metasploit

##### 2.2.1.1 - Help Menu

```
meterpreter > uictl -h
Usage: uictl [enable/disable] [keyboard/mouse/all]

meterpreter > keyboard_send
Please specify input string

meterpreter > keyevent
Usage: keyevent keycode [action] (press, up, down)
  e.g: keyevent 13 press (send the enter key)
       kevevent 17 down (control key down)

meterpreter > mouse
Usage: mouse action (move, click, up, down, rightclick, rightup, rightdown, doubleclick)
       mouse [x] [y] (click)
       mouse [action] [x] [y]
  e.g: mouse click
       mouse rightclick 1 1
       mouse move 640 480
```

##### 2.2.1.2 - Usage

TODO: Fill this info

### 2.3 - Play Audio

#### 2.3.1 - Metasploit

`meterpreter > play /path/to/audio.wav`

## 03 - Mac OSX

### 3.1 - Text To Speech

#### 3.1.1 - Metasploit

```
msf > use post/osx/admin/say

msf post(osx/admin/say) > options

Module options (post/osx/admin/say):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on
   TEXT     meta-sploit!     yes       The text to say
   VOICE    alex             yes       The voice to use

msf post(osx/admin/say) > set voice <voice_name>

msf post(osx/admin/say) > set text <text>

msf post(osx/admin/say) > set session <session_id>

msf post(osx/admin/say) > exploit
```