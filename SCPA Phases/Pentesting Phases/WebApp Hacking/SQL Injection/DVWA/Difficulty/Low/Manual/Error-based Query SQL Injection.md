# Error-based Query SQL Injection

#dvwa #sqli

Refer to [[Lab Simulation Setup/Webapps/DVWA/Setup#^214bb7|DVWA Lab Setup]] for the attacker machine to map the IP address in the `/etc/hosts`.

TODO: Demonstrate using error-based SQL payloads after filling in the info related with UNION SQL

https://www.youtube.com/watch?v=5ulehtDTuvE

## 01 - Vulnerability Detection

### 1.1 - Error Detection

#### 1.1.1 - Break the Query

We will trigger a SQL error using `'` as a prefix to take advantage of unsantized user input.

`<Insert screenshot>`

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''''' at line 1
```

#### 1.1.2 - Copying the Error Statement

TODO: Provide a step by step to breakdown the SQL statement before proceeding to join the query

#### 1.1.3 - Joining the Query

Now we need a suffix to terminate to get results. In MySQL we will terminate it with `--` to treat it as a suffix. It will treat it as a comment. We can leverage it to craft the payload to exploit further.

`'--`

`<Insert screenshot>`

```
You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''' at line 1
```

Looks like it didn't work. Let's instead try adding the `#` as a suffix.

`'#`

`<Insert screenshot>`

We have no errors
### 1.2 - Craft Payload

This is the syntax with a place holder of SQL payload.

`'<SQL_Payload>#`

`' OR 1=1#`

`<Insert screenshot>`

## References

- [Web Application Pentesting â€“ Manual SQL Injection With Error Based String Method](https://gbhackers.com/manual-sql-injection/)

- [Acunetix: SQLi - How it works](https://www.acunetix.com/blog/articles/sqli-how-it-works/)