# Scripts

Search Tag(s): #helpers

## 01 - Python

`$ cat shellcode-formatter.py`

---

```python
#!/usr/bin/env python3  
import sys  
  
def hex_format(filename):
    try:  
        with open(filename, "rb") as file:
            shellcode = file.read()
    except FileNotFoundError:  
        print(f"File not Found: {filename}")  
        return  
  
    print(f"Payload size: {len(shellcode)}")  
    print('{ 0x' + ', 0x'.join(hex(i)[2:] for i in shellcode) + ' };')

hex_format(sys.argv[1])
```

## 02 - Perl

`$ cat shellcode-formatter.pl`

---

```perl
#!/usr/bin/env perl

sub hex_format {
    my $filename = $_[0];
    open(my $FILE, "<$filename") or die("Cannot open file $filename\n");
    binmode($FILE);
    my $count = 0;
    my $hexadecimal;

    while (read $FILE, my $data, 1) {
        $hexadecimal .= sprintf(" 0x%02x,", ord($data));
        $count++;
    }
    close($FILE);
    print "Payload size: $count\n";
    print chr(123);
    print "$hexadecimal";
    print chr(125) . chr(59);
}

hex_format($ARGV[0]);
```

## 03 - Golang

`$ cat shellcode-formatter.go`

---

```go
package main

import (
	"bufio"
	"fmt"
	"os"
)

func formatShellcode(filename string) {
	file, err := os.Open(filename)
	if err != nil {
		fmt.Println(err)
		return
	}
	defer file.Close()

	stats, statsErr := file.Stat()
	if statsErr != nil {
		fmt.Println(statsErr)
		return
	}

	var size int64 = stats.Size()
	bytes := make([]byte, size)

	bufr := bufio.NewReader(file)
	_, err = bufr.Read(bytes)
	if err != nil {
		fmt.Println(err)
		return
	}

	fmt.Print("{ ")
	for i := 0; i < len(bytes); i++ {
		if i < len(bytes)-1 {
			fmt.Printf("0x%02x, ", bytes[i])
		} else {
		 fmt.Printf("0x%02x };\n", bytes[i])
		}
	}
}

func main() {
	filename := os.Args[1]
	formatShellcode(filename)
}
```