# Powershell

Search Tag(s): #helpers #weaponization #implant-development #defense-evasion

TODO: Fill this info

## 01 - Remove Spaces and Comments

```
$ sed -i -e '/<#/,/#>/c\\' implant.ps1

$ sed -i -e 's/^[[:space:]]*#.*$//g' implant.ps1
```

## 02 - Modify Variables and Concatenate Strings

```
$ sed -i 's/-Name VirtualProtect/-Name "Virtual"+"Protect"/g' \
-e 's/-Name WriteProcessMemory/-Name "Write"+"ProcessMemory"/g' \
-e 's/::logonPass/::logon"+"Pass"/g' 
-e "s/'TVq/'TV'+'q/g" Invoke-Mimikatz.ps1
```

---
## References

- [Powershell Obfuscation](https://huebicode.com/blog/20230502_powershell_obfuscation.php)

- [Powershell Obfuscation Bible](https://github.com/t3l3machus/PowerShell-Obfuscation-Bible)

- [gh0x0st: Layer 0 Obfuscation](https://github.com/gh0x0st/Invoke-PSObfuscation/blob/main/layer-0-obfuscation.md)

- [geoda: Running an Obfuscated version of Mimikatz in Memory to bypass AntiVirus and other host based controls](https://blog.geoda-security.com/2018/05/running-obfuscated-version-of-mimikatz.html)

- [Black Hills Information Security: How to Bypass Anti-Virus to Run Mimikatz](https://www.blackhillsinfosec.com/bypass-anti-virus-run-mimikatz/)

- [CTFIoT: Bypassing Windows Defender](https://www.ctfiot.com/112423.html)

- [r00t-3xp10it: Simple Obfuscation](https://github.com/r00t-3xp10it/hacking-material-books/blob/master/obfuscation/simple_obfuscation.md)