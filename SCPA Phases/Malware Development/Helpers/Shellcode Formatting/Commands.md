# Commands

## 01 - Unix Shell

- Hexadecimal C array shellcode

`$ xxd -i shellcode.bin`

`$ hexdump -v -e '"\\\x" 1/1 "%02x"' shellcode.bin`

- One line of hex shellcode format

`$ xxd -p shellcode.bin | tr -d "\n"`

`$ hexdump -v -e '"\" 1/1 "%x"' shellcode.bin`

## 02 - Powershell

- **Read bytes from the shellcode using Powershell**

```powershell
PS C:\> $file = "shellcode.bin"

PS C:\> $bytes = [IO.File]::ReadAllBytes($file)
```

C language shellcode format

```powershell
$shellcode_format = '\x' + (($bytes | ForEach-Object ToString x2) -join '\x')

"`nStandard shellcode format:`n`n" + $shellcode_format | Add-Content ($file + ".b64")`
```

C# shellcode format

```powershell
$csharpformat = '0x' + (($bytes | ForEach-Object ToString x2 | ForEach-Object { $_ + ',' }) -join '0x')

$csharpformat = $csharpformat.SubString(0, $csharpformat.Length - 1)

"`nC# formatted shellcode:`n`n" + $csharpformat | Add-Content ($file + ".txt")

$cs_bytes = [System.Text.Encoding]::UTF8.GetBytes($csharpformat)

$cs_b64 = [Convert]::ToBase64($cs_bytes)

"`nBase64 Encoded C# shellcode:`n`n" + $cs_b64 | Add-Content ($file + ".b64")
```

F# shellcode format

```powershell
$fsharpformat = '0x' + (($bytes | ForEach-Object ToString x2 | ForEach-Object { $_ + 'uy;' }) -join '0x')

$fsharpformat = $fsharpformat.SubString(0, $fsharpformat.Length - 1)

"`nF# formatted shellcode:`n`n" + $fsharpformat | Add-Content ($file + ".txt")
```

---
## References

- [Shellcode Formatter](https://www.redteam.cafe/red-team/shellcode-injection/shellcode-formatter)