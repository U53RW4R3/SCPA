# Description

Search Tag(s): #malware-development #defense-evasion

TODO: I got this whenever I have free time - Userware

- Create steps to make a flowchart diagram of what evasion features to implement the program. It allows you to articulate to understand of what an engineer or a programmer would think.
- Most importantly never reinvent the wheel unless necessary to be a persistent adversary.
- Find references from malware analysis blog post or research whitepapers that provides to generate new ideas of what to make.

## Required Tools

- A **text editor** or **IDE** for implant development. I recommend

- A **compiler**. We will use C and C++ to understand how WinAPI and NtAPI functions. This is essential for implant development to build our executable programs. Visit this link (https://visualstudio.microsoft.com/downloads/) and search for **"Build Tools for Visual Studio 2022"**. To cross-compile windows binaries in Linux install [mingw-w64](https://musl.cc/) stable release. Refer to this [[Command Line/Compilers/Windows/C|section]] of how you can install it.

- **x64dbg** debugger to analyze and understand how the internal modules work in the developed malware.

- **PE-Bear** and **pestudio** to inspect PE files to look for indicators.

- **Process Hacker** to inspect processes.

- A shellcode generator. [[Shellcode Format|MSFVenom]] has payload modules to aid us for implant development.

- `sigcheck.exe` or [[Malware Development/Helpers/Scripts and Programs/Entropy/Scripts|python script]] to calculate entropy for static signatures.

- [[ThreatCheck]] and [[AVRed]] to find malicious offset bytes to assists us how to obfuscate the program.

## Additional Tools

- WiX to compile binary files into `.msi`.

- **ILSpy** or **dotPeek** to decompile .NET programs. **AvalonialLSpy** is cross platform.

---
## References

### IDE

- [Embarcadero IDE Source Repository](https://github.com/Embarcadero/Dev-Cpp)

- [Embarcadero IDE for Windows C++](https://www.embarcadero.com/free-tools/dev-cpp)

### Toolchains

- [[Command Line/Compilers/Windows/C|Mingw-w64]]

- [Microsoft Documentation: Use the Microsoft C++ toolset from the command line](https://learn.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-170)

- [Microsoft C++ Build Tools](https://visualstudio.microsoft.com/visual-cpp-build-tools)

### Decompilers

- [x64dbg](https://x64dbg.com/)

- [AvalonialLSpy](https://github.com/icsharpcode/AvaloniaILSpy)

- [ILSpy](https://github.com/icsharpcode/ILSpy)

- [dotPeek](https://www.jetbrains.com/decompiler/)

### PE Inspection

- [PE-Bear](https://github.com/hasherezade/pe-bear)

- [pestudio](https://www.winitor.com/download2)

### Process Inspection

- [Process Hacker](https://processhacker.sourceforge.io/)

### Entropy

- [[Malware Development/Helpers/Scripts and Programs/Entropy/Scripts|Entropy Script]]

- [Sigcheck](https://learn.microsoft.com/en-us/sysinternals/downloads/sigcheck)

- [[Malware Development/Helpers/Scripts and Programs/Entropy/Commands|Entropy Commands]]

### Setup MSI

- [WiX Toolset](https://wixtoolset.org/)

- [GNOME: MSITools](https://wiki.gnome.org/msitools)

- [WiX Toolset v3 Tutorial](https://www.firegiant.com/docs/wix/v3/tutorial/)