# Living off the Land

## 01 - Registry Backdoors

### 1.1 - HKLM

#### 1.1.1 - Add Registry Key Syntax

- Command Prompt

```
C\> reg import file.reg

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v <value> /t reg_sz /d "rundll32.exe C:\path\to\shell.dll,ExecDLL" /f
```

- Powershell

```powershell
PS C:\> set-itemproperty -path "hklm:\software\microsoft\windows\currentversion\run" -name "<value>" -propertytype string -value "C:\path\to\shell.exe" -force
```

#### 1.1.2 - Delete Registry Key Syntax

```
C:\> reg del [\\<IP>\]hklm\\software\\microsoft\\currentversion\\run /v <value> /f
```

---
## References

- [[Windows Post Exploitation Persistence References]]