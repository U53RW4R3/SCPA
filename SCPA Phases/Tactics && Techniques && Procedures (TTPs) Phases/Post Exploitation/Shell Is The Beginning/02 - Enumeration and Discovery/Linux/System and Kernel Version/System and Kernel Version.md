# System and Kernel Version

## 01 - Manual

### 1.1 - Operating System

#### 1.1.1 - Distro Variant

```
$ cat /etc/issue

$ cat /etc/os-release

$ cat /etc/lsb-release

$ cat /etc/*-release

$ cat /etc/redhat-release
```

#### 1.1.2 - Kernel

```
$ cat /proc/version

$ uname -a

$ uname -mrs

$ lsb_release -a

$ rpm -q kernel

$ dmesg | grep Linux

$ ls /boot | grep vmlinuz
```

- Looking for kernel modules and to enumerate the version number

`$ lsmod`

`$ modinfo <module_name>`

### 1.2 - Hardware

#### 1.2.1 - Time

`$ date`

`$ uptime`

`$ cat /proc/uptime`

- Idle time user activity

`$ w`

#### 1.2.2 - Storage

`$ df -h`

`$ df -aH`

`$ ls /dev/ 2>/dev/null`

`$ ls /dev/ 2>/dev/null | grep -i "sd"`

#### 1.2.3 - Mounted Drives

- Looking for mount drives with credentials or we can mount on to further move laterally

```
$ cat /etc/fstab

$ sed 's/#.*//' /etc/fstab | column -t -N SOURCE,TARGET,TYPE,OPTIONS,PASS,FREQ -R PASS,FREQ

$ grep -v "^#" /etc/fstab | grep -Pv "\W*\#" 2>/dev/null
```

`$ mount`

`$ lsblk`

#### 1.2.4 - RAM

`$ sudo cat /dev/mem | grep -i PASS`

#### 1.2.5 - CPU

`$ lscpu`

`$ cat /proc/cpuinfo`

## 02 - Metasploit

`meterpreter > sysinfo`

`meterpreter > run post/linux/gather/enum_protections`

`meterpreter > run post/linux/gather/enum_configs`

`meterpreter > run post/linux/gather/enum_system`

---
## References

- [Privilege Escalation Drives](https://book.hacktricks.xyz/linux-unix/privilege-escalation#drives)

- [Privilege Escalation /dev/mem](https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dev-mem)