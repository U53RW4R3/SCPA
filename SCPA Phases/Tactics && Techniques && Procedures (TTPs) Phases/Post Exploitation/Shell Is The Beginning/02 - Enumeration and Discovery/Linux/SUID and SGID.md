# SUID and SGID

## 01 - Manual

### 1.1 - SUID/SGID

- Find all SUID/SGID executable binaries

```
$ find / -perm -g=s -o -perm -u=s -type f 2>/dev/null

$ find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null

$ find / -perm -04000 -type f -ls 2>/dev/null

$ find / -perm -6000 -type f -exec ls -la {} 2>/dev/null \;
```

- Look for common places: `/bin`, `/sbin`, `/usr/bin`, `/usr/sbin`, `/usr/local/bin`, `/usr/local/sbin`

```
$ for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2>/dev/null; done
```

### 1.2 - SUID

- Find all SUID (user owned) executable binaries

```
$ find / -perm -u=s -type f 2>/dev/null

$ find / -perm -4000 -type f -exec ls -la {} 2>/dev/null \;

$ find / -perm -u=s -type f -exec ls -la {} 2>/dev/null \;

$ find / -perm -u=s 2>/dev/null | xargs ls -la
```

### 1.3 - SGID

- Find SGID files

```
$ find / -perm -g=s -type f 2>/dev/null

$ find / -perm -02000 -type f  -ls 2>/dev/null

$ find / -perm -2000 -type f -exec ls -la {} 2>/dev/null \;

$ find / -perm -g=s -type f -exec ls -la {} 2>/dev/null \;

$ find / -perm -g=s 2>/dev/null | xargs ls -la
```

## 02 - Metasploit

`meterpreter > run post/linux/gather/enum_system`