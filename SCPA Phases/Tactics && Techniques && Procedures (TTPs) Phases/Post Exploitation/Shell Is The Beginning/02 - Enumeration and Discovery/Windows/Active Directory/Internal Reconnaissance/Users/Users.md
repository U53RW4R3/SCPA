# Users

## 01 - Manual

### 1.1 - Command Prompt

`C:\> net user <username> /domain`

`C:\> net user %username% /domain`

`C:\> net user /domain`

`C:\> set userdomain`

`C:\> net group "Domain Admins" /domain`

`C:\> net group "Enterprise Admins" /domain`

### 1.2 - Powershell

`PS C:\> Get-LocalGroup | ft Name -AutoSize`

`PS C:\> Get-LocalGroupMember Administrators | ft Name, PrincipalSource`

## 02 - Powersploit

### 2.1 - PowerView

- `adspath` which will print out the GPP (Group Policy Object) that uses the LDAP protocol. Especially the `description` object property that some sysadmins are intended to leave sensitive notes like passwords since they can't remember every credentials so they needed someone to store in case they forgot.

`PS C:\> Get-NetUser | select cn, description, objectsid, adspath`

- Look for potential user accounts that have bad amount of weak passwords for a chance to breach it successfully (requires to connect the dots and some critical thinking to do I think)

`PS C:\> Get-NetUser | Select-Object samaccountname, badpwdcount`

- Query a specific user account

`PS C:\> Get-NetUser -UserName <username>`

- Retrieve GroupNames

`PS C:\> Get-NetLocalGroup`

- Retrieve information related to a specific **GroupName**

`PS C:\> Get-NetLocalGroupMember -Group <GroupName>`

- Displays list of all the groups in the Domain Controller

`PS C:\> Get-NetGroup`

- Enumerate Groups in a Active Directory that is part of Admins

`PS C:\> Get-NetGroup -AdminCount`

- Enumerate a specific username in a Active Directory to display what privileges does the user have based of what member of

`PS C:\> Get-NetGroup -UserName <username>`

- Display the users that is part of the specific group name. In this example we want to find out which users have admin privileges.

`PS C:\> Get-NetGroupMember -GroupName "Administators"`

`PS C:\> Get-NetGroupMember -GroupName "Domain Admins"`

`PS C:\> Get-NetGroupMember -GroupName "Enterprise Admins"`

`PS C:\> Get-NetGroup -GroupName *admin*`

- Retrieve active sessions of which users that is still interacting with the domain controller

`PS C:\> Get-NetSession -ComputerName <IP>`

- Check for accounts that hasn't been changed their passwords for how long to coordinate with the current organization's date depending on the Group Policy's for changing passwords of how frequently.

`PS C:\> Get-UserProperty -Properties pwdlastset`

- Identity which user accounts are active or suspiciously having high amount of logins that is humanly impossible that might be a honey pot.

`PS C:\> Get-UserProperty -Properties logoncount`

## 03 - Metasploit

### 3.1 - Modules

#### 3.1.1 - Post

```
msf > use post/windows/gather/enum_domain_group_users

msf post(windows/gather/enum_domain_group_users) > options

Module options (post/windows/gather/enum_domain_group_users):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   GROUP                     yes       Domain Group to enumerate
   SESSION                   yes       The session to run this module on

msf post(windows/gather/enum_domain_group_users) > set group Domain Admins

msf post(windows/gather/enum_domain_group_users) > set session <SESSION_ID>

msf post(windows/gather/enum_domain_group_users) > exploit

and gather Enterprise Admins as well

msf post(windows/gather/enum_domain_group_users) > set group Enterprise Admins

msf post(windows/gather/enum_domain_group_users) > set session <session_id>

msf post(windows/gather/enum_domain_group_users) > run
```

## 04 - Havoc

TODO: Fill this info