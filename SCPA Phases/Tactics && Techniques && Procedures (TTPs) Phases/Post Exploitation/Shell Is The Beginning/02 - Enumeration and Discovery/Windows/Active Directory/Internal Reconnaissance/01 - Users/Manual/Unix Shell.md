# Unix Shell

## 01 - Samba Suite Utils

- Authenticate `guest` account.

```
$ rpcclient <IP> -U 'guest%'
rpcclient $>
```

### 1.1 - User enumeration

- Lookup SID accounts

`rpcclient $> lookupsids <SID>`

- Lookup username accounts

`rpcclient $> lookupnames <username>`

## 02 - NetExec

### 2.1 - User enumeration via RID Cycling

`$ netexec smb <IP> -u guest -p '' --rid-brute`

## 03 - Impacket

### 3.1 - User enumeration via RID Cycling

`$ lookupsids.py guest@<IP> -no-pass`

## 04 - Nmap

### 4.1 - Users

```
$ nmap -p 445 -Pn --script smb-enum-users --script-args 'smbuser=<username>,smbpassword=<password>' <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-users 'smbuser=<username>,smbpassword=<password>' <IP>
```

- Pass the Hash

```
$ nmap -p 445 -Pn --script smb-enum-users --script-args 'smbuser=<username>,smbhash=<nt_hash>' <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-users --script-args 'smbuser=<username>,smbhash=<nt_hash>' <IP>
```

### 4.2 - Groups

```
$ nmap -p 445 -Pn --script smb-enum-groups --script-args 'smbuser=<username>,smbpassword=<password>' <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-groups 'smbuser=<username>,smbpassword=<password>' <IP>
```

- Pass the Hash

```
$ nmap -p 445 -Pn --script smb-enum-groups --script-args 'smbuser=<username>,smbhash=<nt_hash>' <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-groups --script-args 'smbuser=<username>,smbhash=<nt_hash>' <IP>
```