# Unix Shell

## 01 - Samba Suite Utils

- Enumerate shares

```
rpcclient $> enumshares

rpcclient $> netshareenum

rpcclient $> netshareenumall
```

- Retrieve share information

`rpcclient $> netsharegetinfo`

## 02 - NetExec

TODO: Use netexec WMI query function to every section in post exploitation

```
$ netexec smb <IP> -u <username> -p <password> [-d <domain_name> | --local-auth] --shares

$ netexec smb <IP> -u <username> -p <password> [-d <domain_name> | --local-auth] --wmi "SELECT * FROM Win32_Share"
```

## 03 - Impacket

`$ wmiquery.py <domain_name>/<username>:<password>@<IP>`

`$ wmiquery.py <domain_name>/<username>@<IP> -hashes :<nt_hash>`

```
WQL> SELECT * FROM win32_share
```

## 04 - Nmap

- Authentication

```
$ nmap -p 445 -Pn --script smb-enum-shares --script-args 'smbuser=<username>,smbpassword=<password>' <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-shares --script-args 'smbuser=<username>,smpassword=<password>' <IP>
```

- Pass the hash

```
$ nmap -p 445 -Pn --script smb-enum-shares --script-args 'smbuser=<username>,smbhash=<nt_hash>' <IP>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-enum-shares --script-args 'smbuser=<username>,smbhash=<nt_hash>' <IP>
```