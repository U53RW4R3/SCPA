# Manual

## 01 - Basic

### 1.1 - Command Prompt

- **IP Addresses and Subnet**

`C:\> ipconfig`

`C:\> ipconfig /displaydns`

`C:\> ipconfig /all`

`C:\> ipconfig /allcompartments /all`

`C:\> type C:\Windows\System32\drivers\etc\hosts`

`C:\> netsh interface ip addresses`

`C:\> netsh interface ip route`

`C:\> netsh interface ip neighbors`

`C:\> wmic rdtoggle list`

`C:\> wmic netlogin get name,lastlogon,badpasswordcount`

`C:\> wmic nicconfig get description,ipaddress,macaddress`

### 1.2 - Powershell

- **IP Addresses and Subnet**

`PS C:\> Get-NetIPAddress -AddressFamily IPv4 | ft Interfacealias, IPv4Address`

`PS C:\> Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address`

`PS C:\> Get-DnsClientServerAddress -AddressFamily IPv4 | ft -Autosize`

`PS C:\> Get-CimInstance -ClassName CIM_System | Format-Table -AutoSize`

`PS C:\> Get-CimInstance -ClassName Win32_NTDomain | Format-Table -AutoSize`

## 02 - ARP Discovery

### 2.1 - Command Prompt

- Returns an ARP network with a list of ip address

`C:\> arp -a`

### 2.2 - Powershell

- Returns an ARP network with a list of ip address

`PS C:\> Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State`

## 03 - Route Table

### 3.1 - Command Prompt

- Routing table

Print the routing table

`C:\> route print`

`C:\> netstat -r`

`C:\> netstat -ano`

All in one go

`C:\> ipconfig /all && route print && arp -a`

### 3.2 - Powershell

- Routing table

Print the routing table

`PS C:\> Get-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex`

## 04 - Netstat

#### 1.4.1 - Command Prompt

- Note: Must be with elevated privileges when running a flag with `netstat.exe -b`

`C:\Windows\system32> netstat -abno`

- Prints the network statistics. Display the loopback services and other computers that is which the machine is interacting with

`C:\> netstat -anto`

- Find all `LISTENING` ports and connection on port 445

`C:\> netstat -na | findstr :445`

- Find all `ESTABLISHED` ports connections

`C:\> netstat -an | findstr ES`

- Specify a protocol with -p flag either via `IP`, `IPv6`, `ICMP`, `ICMPv6`, `TCP`, `TCPv6`, `UDP`, and `UDPv6`

`C:\> netstat -antp <IP | IPv6 | ICMP | ICMPv6 | TCP | TCPv6 | UDP | UDPv6>`

- for example:

`C:\> netstat -antp icmp`

## 05 - DNS

### 5.1 - Command Prompt

`C:\> type c:\Windows\system32\drivers\etc\hosts`

### 5.2 - Powershell

`PS C:\> Resolve-DnsName <dns_server> -Type A`

`PS C:\> Get-DNSServerZone`

`PS C:\> Get-DNSServerZoneResourceRecord -ZoneName <domain.com>`

## 06 - Network Configuration

### 6.1 - Command Prompt

`C:\> netsh wlan show profiles`

`C:\> netsh wlan show profile "<Name>" key=clear`

`C:\> netsh wlan show wlanreport`

`C:\> netsh dump`

`C:\> reg query HKLM\SYSTEM\CurrentControlSet\Services\SNMP /s`

### 6.2 - Powershell

`PS C:\> Get-ChildItem -Path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse`