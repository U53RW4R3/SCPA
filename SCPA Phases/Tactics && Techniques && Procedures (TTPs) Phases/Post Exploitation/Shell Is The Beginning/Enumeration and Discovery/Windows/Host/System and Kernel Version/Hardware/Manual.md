# Manual

## 01 - Command Prompt

### 1.1 - Hardware Information

- Retrieve time.

`C:\> net time [\\<IP>]`

- Retrieve idle time user activity.

`C:\> quser [/server:<IP>]`

`C:\> query user <username> [/server:<IP>]`

- Looking for unmounted drives yet physically connected

`C:\> mountvol`

`C:\> vol`

TODO: Inspect the module and convert into commands

- Check if there are external USB drives history activity to the workstation. This will provide leverage to insert malware to spread the infection or possibly to exfiltrate data.

`meterpreter > run post/windows/gather/usb_history`

- MAC Addresses.

`C:\> getmac /v`

- Motherboard.

`C:\> wmic [/node:<IP>] bios`

`C:\> wmic [/node:<IP>] bios get serialnumber`

`C:\> wmic [/node:<IP>] baseboard get manufacturer`

`C:\> wmic [/node:<IP>] cpu list full`

- Retrieving the number of CPU cores and threads.

`C:\> wmic [/node:<IP>] cpu get deviceid,numberofcores,numberoflogicalprocessors`

- Storage Size

```
C:\> wmic [/node:<IP>] path win32_logicaldisk get caption,filesystem,freespace,size,volumename

C:\> wmic [/node:<IP>] logicaldisk where drivetype=3 get name,freespace,systemname,filesystem,size,volumeserialnumber
```

`C:\> wmic [/node:<IP>] logicaldisk get caption`

`C:\> wmic [/node:<IP>] volume list brief`

**Note: Must be with elevated privileges when running fsutil.exe**

`C:\Windows\system32> fsutil fsinfo drives`

## 02 - Powershell

### 2.1 - Hardware Information

- Retrieve time

```
PS C:\> Get-Date

PS C:\> Invoke-Command -ComputerName <IP> -ScriptBlock { Get-Date }
```

- Looking for unmounted drives yet physically connected

`PS C:\> Get-PSDrive`

`PS C:\> Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root`

TODO: Inspect the module and convert into cmdlets

- Check if there are external USB drives history activity to the workstation. This will provide leverage to insert malware to spread the infection or possibly to exfiltrate data.

`meterpreter > run post/windows/gather/usb_history`

- Basic hardware information

`PS C:\> Get-NetAdapter`

`PS C:\> Get-CimInstance Win32_Processor | format-list -AutoSize`

- Retrieving the number of CPU cores and threads

`PS C:\> [Bool](Get-CimInstance -Classname Win32_ComputerSystem -Filter "NumberOfLogicalProcessors < 2 OR TotalPhysicalMemory < 2147483648")`


---
## References

- [Powershell Guide Get CimInstance and Get WMIObject](https://www.pdq.com/blog/powershell-guide-get-ciminstance-and-get-wmiobject/)

- [20 Useful WMIC Command Examples in Windows Cheatsheet](https://www.cyberithub.com/20-useful-wmic-command-examples-in-windows-cheat-sheet/)