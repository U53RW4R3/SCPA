# Hardware

## 01 - Manual

### 1.1 - Command Prompt

#### 1.1.1 - Hardware Information

- Retrieve time

`C:\> net time`

- Looking for unmounted drives yet physically connected

`C:\> mountvol`

`C:\> vol`

- Basic hardware info

`C:\> getmac /v`

`C:\> wmic bios`

`C:\> wmic bios get serialnumber`

`C:\> wmic baseboard get manufacturer`

`C:\> wmic cpu list full`

- Retrieving the number of CPU cores and threads

`C:\> wmic cpu get deviceid,numberofcores,numberoflogicalprocessors`

`C:\> wmic logicaldisk where drivetype=3 get name,freespace,systemname,filesystem,size,volumeserialnumber`

`C:\> wmic logicaldisk get caption`

`C:\> wmic volume list brief`

**Note: Must be with elevated privileges when running fsutil.exe**

`C:\Windows\system32> fsutil fsinfo drives`

### 1.2 - Powershell

#### 1.2.1 - Hardware Information

- Retrieve time

`PS C:\> Get-Date`

- Looking for unmounted drives yet physically connected

`PS C:\> Get-PSDrive`

`PS C:\> Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root`

- Basic hardware info

`PS C:\> Get-NetAdapter`

`PS C:\> Get-CimInstance Win32_Processor | format-list -AutoSize`

- Retrieving the number of CPU cores and threads

`PS C:\> [Bool](Get-CimInstance -Classname Win32_ComputerSystem -Filter "NumberOfLogicalProcessors < 2 OR TotalPhysicalMemory < 2147483648")`

## 02 - Mimikatz

`mimikatz # localtime`

## 03 - Metasploit

`meterpreter > show_mount`

`meterpreter > run post/windows/gather/forensics/enum_drives`

`meterpreter > run post/windows/gather/usb_history`

---
## References

- [Powershell Guide Get CimInstance and Get WMIObject](https://www.pdq.com/blog/powershell-guide-get-ciminstance-and-get-wmiobject/)

- [20 Useful WMIC Command Examples in Windows Cheatsheet](https://www.cyberithub.com/20-useful-wmic-command-examples-in-windows-cheat-sheet/)