# Base64

## 01 - Command Prompt

### 1.1 - Certutil

```
C:\> certutil -encode file.txt encoded_file.txt

C:\> certutil -decode encoded_file.txt decoded_file.txt
```

## 02 - Powershell

### 2.1 - Encoding a File to Base64

```powershell
PS C:\> $file = 'C:\path\to\file.txt'
$bytes = [IO.File]::ReadAllBytes($file)
$encoded = [Convert]::ToBase64String($bytes)
Set-Content -Path 'encodedb64.txt' -Value $encoded
```

- A much shorter one.

```powershell
PS C:\> $file = 'C:\path\to\file.txt'
$encoded = [Convert]::ToBase64String([IO.File]::ReadAllBytes($file)); 
Set-Content -Path 'encodedb64.txt' -Value $encoded
```

### 2.2 - Decoding Base64 to a File

- Decode text files

```powershell
PS C:\> $encoded_file = [IO.File]::ReadAllLines("encodedb64.txt")
PS C:\> $encoded_file = [IO.File]::ReadAllText("encodedb64.txt")
$decoded = [Convert]::FromBase64String($encoded_file)
$bytes = [char[]]([int[]]$decoded) -join ""
Set-Content -Path 'file.txt' -Value $bytes
```

- Decode binary files

```powershell
PS C:\> $payload = "<base64_encoded_payload>"
[byte[]]$decoded = [Convert]::FromBase64String($payload)
[IO.File]::WriteAllBytes("implant.exe", $decoded)
```

---
## References

- [DmFrSecurity Windows Base64 Encoding and Decoding Using Certutil](https://dmfrsecurity.com/2017/01/07/windows-base64-encoding-and-decoding-using-certutil/)

- [Powershell Base64](https://www.educba.com/powershell-base64/)

- [Encoding Binary Files to Include In Scripts](https://davejlong.com/encoding-binary-files-to-include-in-scripts/)