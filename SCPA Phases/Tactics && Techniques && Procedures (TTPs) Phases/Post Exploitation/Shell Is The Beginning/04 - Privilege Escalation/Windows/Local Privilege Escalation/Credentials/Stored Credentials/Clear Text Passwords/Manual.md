# Manual

## 01 - Command Prompt

TODO: Provide more information to gather sttored passwords

- Common Windows files destination.

```
C:\unattend.xml
C:\Windows\Panther\Unattend.xml
C:\Windows\Panther\Unattend\Unattend.xml
C:\Windows\system32\sysprep.inf
C:\Windows\system32\sysprep\sysprep.xml
```

- Search for Cleartext Passwords

```
C:\> findstr /si password *.txt

C:\> findstr /si password *.xml

C:\> findstr /si password *.ini
```

- Find all those strings in config files

```
C:\> findstr /si password *.txt

C:\> findstr /b /s unattend.xml

C:\> dir /s *pass* == *cred* == *vnc* == *.config* 2>nul

C:\> dir /s /b *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config* 2>nul

C:\> dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2>nul

C:\> where /r C:\ user.txt

C:\> where /r C:\ *.ini

C:\> wmic datafile where "drive='C:' AND name like '%password%'" get name,readable,size /value
```

- Find all passwords in all files

`C:\> findstr /spin "password" *.*`

## 02 - Powershell

- Search for Cleartext Passwords

`PS C:\> Get-ChildItem -Recurse -Path C:\ | ? {$_.Name -eq "*.txt" -or $_.Name -eq "*.pdf" -or $_.Name -eq "*.ini"}`

- Find all those strings in config files

```
PS C:\> Get-Childitem -Path C:\Users\ -Include *password*,*vnc*,*.config -File -Recurse -ErrorAction SilentlyContinue

PS C:\> Get-ChildItem -Path C:\ -Include *unattend*,*sysprep* -File -Recurse -ErrorAction SilentyContinue | where {($_.Name -like "*.xml" -or $_.Name -like "*.txt" or $_.Name -like "*.ini")}
```

---
## References

- [Pentestlab Blog: Stored Credentials](https://pentestlab.blog/2017/04/19/stored-credentials/)