# Unix Shell

## 01 - Impacket

`$ atexec.py <username>:<password>@<IP> -silentcommand "<command>"`

## 02 - NetExec

### 2.1 - At

```
$ netexec smb <IP> -u "<username>" -p "<password>" --no-output --exec-method atexec -x "<command>"

$ netexec smb <IP> -u "<username>" -p "<password>" --no-output --exec-method atexec -X "<cmdlet>"
```

### 2.2 - Schtasks

- Enumerate logged-on users.

`$ netexec smb <IP> -u "<username>" -p "<password>" [--local-auth] --loggedon-users`

- Execute command from a logged-on user.

`$ netexec smb <IP> -u "<username>" -p "<password>" -M schtask_as -o USER=<logged-on_user> CMD=<command>`

---
## References

- [NetExec Wiki: Impersonate logged-on Users](https://www.netexec.wiki/smb-protocol/impersonate-logged-on-users)

- [Pentest Party: Lateral Movement Scheduled Task](https://pentest.party/notes/lateral-movement/scheduled-task)