# Living off the Land

## 01 - Command Prompt

- List logs

`C:\> wevtutil el`

- Clear logs in a specific category

`C:\> wevutil cl <logname>`

- Delete all event logs

`C:\> for /f "tokens=*" %1 in ('wevtutil.exe el') do wevtutil.exe cl "%1"`

- Delete all logs

`C:\> del %WINDIR%\*.log /a /s /q /f`

## 02 - Powershell

- Delete all event logs

`PS C:\> Get-WinEvent -ListLog * | where {$_.RecordCount} | ForEach-Object -Process { [System.Diagnostics.Eventing.Reader.EventLogSession]::GlobalSession.ClearLog($_.LogName) }`

- Delete specific event logs

`PS C:\> Clear-Eventlog -Log Application,Security,System`

`PS C:\> Clear-Eventlog -Log Application,Security,System -Confirm`

`PS C:\> Get-WinEvent -ListLog Application,Security,System -Force | % { Wevtutil.exe cl $_.Logname }`

TODO: Get all event logs to each specific event category

`PS C:\> Get-WinEvent -FilterHashTable @{LogName="Application"; ID=}`

`PS C:\> Get-WinEvent -FilterHashTable @{LogName="Microsoft-Windows-Terminal-Services-RemoteConnectionManager/Operational"; ID=1149}`

`PS C:\> Get-WinEvent -FilterHashTable @{LogName="Microsoft-Windows-Powershell/Operational"; ID=4100,4103,4104,}`

`PS C:\> Get-WinEvent -FilterHashTable @{LogName="Microsoft-Windows-TerminalServices-Gateway"; ID=400,800}`

`PS C:\> Get-WinEvent -FilterHashTable @{LogName="Security"; ID=1102,4624,4625,4634,4647,4648,4657,4658,4661,4663,4672,4674,4688,4697,4720,4722,4732,4738,4768,4769,4776,4778,4779,4782,5712}`

`PS C:\> Get-WinEvent -FilterHashTable @{LogName="System"; ID=7030,7036,7045,10000,100001,20001,20002,20003,24756,24577,24579}`

---
## References

- [Event Log Tampering Part 1 Disrupting The Eventlog Service](https://svch0st.medium.com/event-log-tampering-part-1-disrupting-the-eventlog-service-8d4b7d67335c)

- [Microsoft Powershell Management Powershell 7.2](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-event?view=powershell-7.2)

- [Microsoft Powershell Management Powershell 5.1](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/remove-eventlog?view=powershell-5.1)