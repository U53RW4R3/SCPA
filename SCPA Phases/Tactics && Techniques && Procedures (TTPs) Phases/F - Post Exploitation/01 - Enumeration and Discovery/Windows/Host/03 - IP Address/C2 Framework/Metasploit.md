# Metasploit

Search Tag(s): #post-exploitation #enumeration-and-discovery #networking #metasploit-framework #windows

## 01 - NETBIOS Discovery

Metasploit auxiliary module to enumerate NetBIOS.

```
msf > use auxiliary/scanner/netbios/nbname

msf auxiliary(scanner/netbios/nbname) > options

Module options (auxiliary/scanner/netbios/nbname):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   BATCHSIZE  256              yes       The number of hosts to probe in each set
   RHOSTS                      yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT      137              yes       The target port (UDP)
   THREADS    10               yes       The number of concurrent threads

msf auxiliary(scanner/netbios/nbname) > set rhosts <IP>

msf auxiliary(scanner/netbios/nbname) > run -j
```

## 02 - Network Configuration

### 2.1 - IP Address

```
meterpreter > ifconfig

meterpreter > route
```

### 3.2 - Netstat

```
meterpreter > netstat

meterpreter > run post/windows/gather/tcpnetstat
```

### 3.3 - WLAN

```
meterpreter > run post/windows/wlan/wlan_bss_list

meterpreter > run post/windows/wlan/wlan_current_connection

meterpreter > run post/windows/wlan/wlan_profile

meterpreter > run post/windows/wlan/wlan_probe_request
```

### 3.4 - RDP

```
meterpreter > run post/windows/gather/enum_termserv
```

## 03 - Ping Sweep

```
meterpreter > run post/multi/gather/ping_sweep rhosts=<IP>/<CIDR>
```

## 04 - ARP Discovery

```
meterpreter > run arp_scanner
Meterpreter Script for performing an ARPS Scan Discovery.

OPTIONS:

    -h   Help menu.
    -i   Enumerate Local Interfaces
    -r   The target address range or CIDR identifier
    -s   Save found IP Addresses to logs.

meterpreter > run arp_scanner -i

meterpreter > run arp_scanner -r <IP>/<CIDR>

meterpreter > run arp_scanner -r 10.0.2.1-15 -s
[*] ARP Scanning 10.0.2.1-15
[*] IP: 10.0.2.2 MAC 52:54:00:12:35:00
[*] IP: 10.0.2.1 MAC 52:54:00:12:35:00
[*] IP: 10.0.2.3 MAC 08:00:27:a5:d7:df
[*] IP: 10.0.2.4 MAC 08:00:27:8f:39:74
[*] IP: 10.0.2.15 MAC 08:00:27:3c:90:25
[*] Saving found IP's to /root/.msf4/logs/scripts/arp_scanner/DEFALT_20220515.2800/DEFALT_20220515.2800.txt

meterpreter > run post/windows/gather/arp_scanner rhosts=<IP>/<CIDR> threads=8
```