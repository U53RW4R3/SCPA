# Living off the Land

Search Tag(s): #post-exploitation #enumeration-and-discovery #active-directory #living-off-the-land #windows

## 01 - Command Prompt

### 1.1 - Users

- Enumerate current user

```
C:\> whoami /fqdn

C:\> whoami /upn
```

- Retrieve basic domain user information

```
C:\> net user <username> /domain

C:\> net user %username% /domain
```

- Gather logged-on domain users

`C:\> net accounts /domain`

### 1.2 - Groups

- Enumerate domain users

`C:\> net user /domain`

`C:\> set userdomain`

- Enumerate domain admins

```
C:\> net group "Domain Admins" /domain

C:\> net group "Enterprise Admins" /domain
```

## 02 - Powershell

### 2.1 - Users

Import Module

```
PS C:\> Import-Module ActiveDirectory
```

Find obsolete users.

```
PS C:\> Get-ADUser -Filter { -Not (ScriptPath -Like "*")}
```

### 2.2 - Groups

`PS C:\> Get-LocalGroup | ft Name -AutoSize`

```
PS C:\> Get-LocalGroupMember "<Local_group_name>" | ft Name, PrincipalSource

PS C:\> Get-LocalGroupMember Administrators | ft Name, PrincipalSource
```