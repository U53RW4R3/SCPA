# 01 - adfind.exe

## 1.1 - Basic Usage with Examples

`C:\> adfind.exe -h <IP> -sc < adinfo | computers_pwdnotreqd | dclist | dcmodes | domainlist | trustdmp | u:<username> > -f <filter>`

`C:\> adfind.exe -b dc=<domain_name>,dc=<tdl> -sc u:<username>`

`C:\> adfind.exe -f "(objectcategory=<group>)"`

## 1.2 - Find all computers

`C:\> adfind.exe -f "objectcategory=computer" > ad_computers.txt`

## 1.3 - Gather all subnets in the active directory network

`C:\> adfind.exe -subnets -f (objectCategory=subnet) > subnets.txt`

## 1.4 - Find all users

`C:\> adfind.exe -f "(objectcategory=person)" > ad_users.txt`

`C:\> adfind.exe -f "(objectcategory=organizationalUnit)" > org_units.txt`

`C:\> adfind.exe -h <IP> -f (name="Domain Admins") member -list > da_users.txt`

`C:\> adfind.exe -h <IP> -f (objectcategory=*) > all_categories.txt`

## 1.5 - Dump Trust Objects of the domain controllers

`C:\> adfind.exe -sc trustdmp > trustdmp.txt`

## 1.6 - Dump Trust Objects of the Forest (the root of the active directory network of the hierarchy)

`C:\> adfind.exe -gcb -sc trustdmp > forest_trustdmp.txt`

---
## References

- [The DFIR Report: PYSA/Mespinoza Ransomware](https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/)

- [Certcube: AD Recon for Beginners](https://blog.certcube.com/ad-recon-for-beginners/)

- [ADFind Usage](https://www.joeware.net/freetools/tools/adfind/usage.htm)

- [Active Directory Domain Enumeration Part 1](https://nored0x.github.io/red-teaming/active-directory-domain-enumeration-part-1/)

- [Deep Dive into the Solorigate Second Stage Activation from Sunburst to Teardrop and Raindrop](https://www.microsoft.com/en-us/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/)

- [Mubix Post Exploitation Wiki: Active Directory Discovery and Enumeration](https://github.com/mubix/post-exploitation/blob/master/win32bins/activedirectory/readme.md)