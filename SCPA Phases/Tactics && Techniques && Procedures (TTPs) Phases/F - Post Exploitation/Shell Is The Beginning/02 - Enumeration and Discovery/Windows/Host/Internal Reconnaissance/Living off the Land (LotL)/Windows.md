# Windows

## 01 - Internal Reconnaissance

### 1.1 - DNS Enumeration

#### 1.1.1 - Command Prompt

- DNS NSlookup

`C:\> for /L %i in (1,1,255) do @nslookup 192.168.1.%i 192.168.1.254 2> nul | find "Name" && echo 192.168.1.%i`

#### 1.1.2 - Powershell

- DNS using LDAP

`PS C:\> Get-ADComputer -Filter * -Properties IPv4Address | Where {4_.IPV4Address} | Select-Object Name,IPv4Address`

`PS C:\> Get-ADComputer -Filter { IPV4Address -eq '<IP>' } -Properties LastLogonDate,PasswordLastSet,IPv4Address`

### 1.2 - NetBIOS Enumeration

`C:\> for /l %i in (1,1,255) do @nbtstat -A 192.168.1.%i 2> nul && echo 192.168.1.%i`

### 1.3 - Ping Sweep

#### 1.3.1 - Command Prompt

```
C:\> for /l %i in (1, 1, 255) do @ping -n 1 -l 4 192.168.1.%i | find "TTL"

C:\> for /k %i in (1, 1, 255) do @ping -n 1 192.168.1.%i 2> nul && echo 192.168.1.%i host is up
```

#### 1.3.2 - Powershell

`PS C:\> 1..255 | % { "192.168.1.$($_): $(Test-Connection -Count 1 -Computername 192.168.1.$($_) -Quiet)" }`

### 1.4 - Port Scan

`PS C:\> 1..1024 | % { echo ((New-Object Net.Sockets.TcpClient).Connect("<IP>", $_)) "Port $_ is open" } 2>$null`