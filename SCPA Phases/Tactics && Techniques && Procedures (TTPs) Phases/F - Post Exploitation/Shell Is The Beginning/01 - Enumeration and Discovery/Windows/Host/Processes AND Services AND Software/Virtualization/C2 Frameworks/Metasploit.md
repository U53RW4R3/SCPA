# Metasploit

Search Tag(s): #post-exploitation #enumeration-and-discovery #defense-evasion #metasploit-framework #windows

## 01 - Post Module

### 1.1 - Enumerate virtualization software

```
meterpreter > run post/windows/gather/checkvm
```

### 1.2 - Enumerate USB activity

```
meterpreter > run post/windows/gather/usb_history
```

## 02 - Meterpreter

### 2.1 - Powershell Extension

#### 2.1 - Spawn Interactive Powershell

```powershell
meterpreter > powershell_shell
PS > $VMAdapter = Get-CimInstance Win32_NetworkAdapter -Filter 'Manufacturer LIKE "%VMware%" OR Name LIKE "%VMWare%"'
PS > $VMBios = Get-CimInstance Win32_BIOS -Filter 'SerialNumber LIKE "%VMWare%"'
PS > $VMToolsRunning = Get-CimInstance Win32_Process -Filter 'Name="vmtoolsd.exe"'
PS > [Bool]($VMAdapter -or $VMBios -or $VMToolsRunning)
```