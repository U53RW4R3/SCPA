# PowerSploit

Search Tag(s): #post-exploitation #enumeration-and-discovery #offensive-tools #windows

## 01 - PowerView

### 1.1 - Basic

Getting users on the windows workstation.

```
PS C:\> <Get-NetUser | Get-DomainUser>
```

Retrieve **common names**.

```
PS C:\> Get-NetUser | Select-Object cn

PS C:\> Get-NetUser | select cn
```

SID will come in handy when using **mimikatz** to dump and get a golden ticket so look out for an SID object that ends with `"-500"` which is typically has administrators rights.

```
PS C:\> Get-NetUser | select cn, objectsid
```

Retrieve user accounts.

```
PS C:\> Get-NetUser | select samaccountname
```

### 1.2 - Enumerate User Accounts

TODO: Fill this information

### 1.3 - Logged On Users

**Enumerate users** who are part of the **administrators group.**

```
PS C:\> <Invoke-EnumerateLocalAdmin | Find-DomainLocalGroupMember>

PS C:\> Invoke-EnumerateLocalAdmin
```

Retrieve information to check which users are currently logged on in the computer.

```
PS C:\> Get-NetLoggedon [-ComputerName <IP>]
```

Retrieve information to print which is the last user who logged on the computer.

```
PS C:\> Get-LastLoggedOn [-ComputerName <IP>]
```

Check if a user is currently logged on with a RDP (Remote Desktop Protocol) session.

```
PS C:\> Get-NetRDPSession [-ComputerName <IP>]
```

---
## References

- [Active Directory Domain Enumeration Part 1](https://nored0x.github.io/red-teaming/active-directory-domain-enumeration-part-1/)